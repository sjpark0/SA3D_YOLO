Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set1/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 46.30it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set1 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set1
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set1_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 3.4ms preprocess, 20.7ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.5ms
Speed: 1.2ms preprocess, 18.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.9ms
Speed: 1.4ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.8ms
Speed: 1.2ms preprocess, 19.8ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.7ms
Speed: 1.2ms preprocess, 19.7ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.8ms
Speed: 1.2ms preprocess, 19.8ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.2ms
Speed: 1.2ms preprocess, 19.2ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.2ms preprocess, 19.1ms inference, 0.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.1ms
Speed: 1.2ms preprocess, 20.1ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.5ms
Speed: 1.2ms preprocess, 18.5ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.9ms
Speed: 1.2ms preprocess, 19.9ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.5ms
Speed: 1.2ms preprocess, 19.5ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.2ms preprocess, 19.1ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.6ms
Speed: 1.2ms preprocess, 19.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.2ms preprocess, 19.1ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.4ms
Speed: 1.5ms preprocess, 19.4ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.8ms
Speed: 1.5ms preprocess, 19.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.7ms
Speed: 1.4ms preprocess, 19.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.4ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.0ms
Speed: 15.5ms preprocess, 21.0ms inference, 3.4ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 20
view_order: [25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.9ms
Speed: 2.7ms preprocess, 20.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9656
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8572
Instance 5: Confidence=0.7074
Selected instance: 5 (Confidence: 0.7074)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

463 132 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.6422836780548096
Seok, iteration idx= 1 IoU = tensor(0.6423)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 2.5ms preprocess, 23.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9558
Instance 1: Confidence=0.9384
Instance 2: Confidence=0.9350
Instance 3: Confidence=0.9330
Instance 4: Confidence=0.8556
Instance 5: Confidence=0.8479
Selected instance: 5 (Confidence: 0.8479)
tmp min: tensor(0.) tmp max: tensor(1.)
527 88 540 960
There are 12 prompts
current IoU is: 0.5008209943771362
Seok, iteration idx= 2 IoU = tensor(0.5008)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9492
Instance 1: Confidence=0.9473
Instance 2: Confidence=0.8976
Instance 3: Confidence=0.8878
Instance 4: Confidence=0.7385
Selected instance: 1 (Confidence: 0.9473)
tmp min: tensor(0.) tmp max: tensor(1.)
626 28 540 960
There are 17 prompts
current IoU is: 0.006260543130338192
Seok, iteration idx= 3 IoU = tensor(0.0063)
SKIP, unacceptable sam prediction, IoU is tensor(0.0063)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.0ms
Speed: 4.0ms preprocess, 22.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9493
Instance 1: Confidence=0.9481
Instance 2: Confidence=0.9454
Instance 3: Confidence=0.8710
Instance 4: Confidence=0.5295
Instance 5: Confidence=0.5013
Selected instance: 4 (Confidence: 0.5295)
tmp min: tensor(0.) tmp max: tensor(1.)
700 52 540 960
There are 11 prompts
current IoU is: 0.13637857139110565
Seok, iteration idx= 4 IoU = tensor(0.1364)
SKIP, unacceptable sam prediction, IoU is tensor(0.1364)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 3.3ms preprocess, 22.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9719
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9354
Instance 3: Confidence=0.8589
Instance 4: Confidence=0.5243
Selected instance: 3 (Confidence: 0.8589)
tmp min: tensor(0.) tmp max: tensor(1.)
691 88 540 960
There are 18 prompts
current IoU is: 0.4980531632900238
Seok, iteration idx= 5 IoU = tensor(0.4981)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.5ms
Speed: 1.2ms preprocess, 21.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9585
Instance 2: Confidence=0.9417
Instance 3: Confidence=0.9039
Instance 4: Confidence=0.8364
Instance 5: Confidence=0.4622
Selected instance: 3 (Confidence: 0.9039)
tmp min: tensor(0.) tmp max: tensor(1.)
747 60 540 960
There are 14 prompts
current IoU is: 0.8753838539123535
Seok, iteration idx= 6 IoU = tensor(0.8754)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.3ms preprocess, 22.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9523
Instance 2: Confidence=0.9520
Instance 3: Confidence=0.8925
Instance 4: Confidence=0.6584
Selected instance: 3 (Confidence: 0.8925)
tmp min: tensor(0.) tmp max: tensor(1.)
778 72 540 960
There are 13 prompts
current IoU is: 0.7030916810035706
Seok, iteration idx= 7 IoU = tensor(0.7031)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 1.7ms preprocess, 23.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9462
Instance 2: Confidence=0.9264
Instance 3: Confidence=0.8582
Instance 4: Confidence=0.8035
Instance 5: Confidence=0.7958
Instance 6: Confidence=0.3784
Selected instance: 4 (Confidence: 0.8035)
tmp min: tensor(0.) tmp max: tensor(1.)
785 136 540 960
There are 18 prompts
current IoU is: 0.571216881275177
Seok, iteration idx= 8 IoU = tensor(0.5712)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 4
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9397
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.9188
Selected instance: 0 (Confidence: 0.9626)
tmp min: tensor(0.) tmp max: tensor(1.)
852 48 540 960
There are 15 prompts
current IoU is: 0.005636360961943865
Seok, iteration idx= 9 IoU = tensor(0.0056)
SKIP, unacceptable sam prediction, IoU is tensor(0.0056)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.4ms
Speed: 1.3ms preprocess, 23.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 4
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9233
Instance 2: Confidence=0.8993
Instance 3: Confidence=0.7667
Selected instance: 3 (Confidence: 0.7667)
tmp min: tensor(0.) tmp max: tensor(1.)
906 100 540 960
There are 14 prompts
current IoU is: 0.7389652132987976
Seok, iteration idx= 10 IoU = tensor(0.7390)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 1.4ms preprocess, 20.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9608
Instance 1: Confidence=0.9321
Instance 2: Confidence=0.9267
Instance 3: Confidence=0.6191
Instance 4: Confidence=0.4317
Instance 5: Confidence=0.4099
Selected instance: 4 (Confidence: 0.4317)
tmp min: tensor(0.) tmp max: tensor(1.)
954 100 540 960
current IoU is: 0.83314049243927
Seok, iteration idx= 11 IoU = tensor(0.8331)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.3ms preprocess, 23.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9405
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9210
Instance 5: Confidence=0.9140
Selected instance: 0 (Confidence: 0.9554)
tmp min: tensor(0.) tmp max: tensor(1.)
47 88 540 960
There are 17 prompts
current IoU is: 0.8275402188301086
Seok, iteration idx= 12 IoU = tensor(0.8275)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 1.5ms preprocess, 20.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9598
Instance 1: Confidence=0.9502
Instance 2: Confidence=0.9318
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9104
Instance 5: Confidence=0.8862
Selected instance: 0 (Confidence: 0.9598)
tmp min: tensor(0.) tmp max: tensor(1.)
25 80 540 960
current IoU is: 0.7445739507675171
Seok, iteration idx= 13 IoU = tensor(0.7446)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.7ms
Speed: 1.2ms preprocess, 20.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.9447
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.7582
Instance 5: Confidence=0.7479
Instance 6: Confidence=0.3858
Selected instance: 0 (Confidence: 0.9593)
tmp min: tensor(0.) tmp max: tensor(1.)
40 72 540 960
There are 19 prompts
current IoU is: 0.798825204372406
Seok, iteration idx= 14 IoU = tensor(0.7988)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.0ms
Speed: 1.7ms preprocess, 21.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 7
Instance 0: Confidence=0.9569
Instance 1: Confidence=0.9488
Instance 2: Confidence=0.9424
Instance 3: Confidence=0.9368
Instance 4: Confidence=0.3790
Instance 5: Confidence=0.3706
Instance 6: Confidence=0.3087
Selected instance: 0 (Confidence: 0.9569)
tmp min: tensor(0.) tmp max: tensor(1.)
34 76 540 960
There are 17 prompts
current IoU is: 0.888816773891449
Seok, iteration idx= 15 IoU = tensor(0.8888)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.3ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9515
Instance 2: Confidence=0.9465
Instance 3: Confidence=0.9285
Instance 4: Confidence=0.5979
Selected instance: 0 (Confidence: 0.9530)
tmp min: tensor(0.) tmp max: tensor(1.)
62 56 540 960
There are 18 prompts
current IoU is: 0.8617076277732849
Seok, iteration idx= 16 IoU = tensor(0.8617)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.0ms
Speed: 4.0ms preprocess, 22.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9450
Instance 2: Confidence=0.9402
Instance 3: Confidence=0.9285
Instance 4: Confidence=0.6814
Selected instance: 1 (Confidence: 0.9450)
tmp min: tensor(0.) tmp max: tensor(1.)
135 72 540 960
There are 16 prompts
current IoU is: 0.8375377058982849
Seok, iteration idx= 17 IoU = tensor(0.8375)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.2ms
Speed: 2.8ms preprocess, 22.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 8
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9512
Instance 2: Confidence=0.9320
Instance 3: Confidence=0.9235
Instance 4: Confidence=0.8462
Instance 5: Confidence=0.5823
Instance 6: Confidence=0.4505
Instance 7: Confidence=0.2670
Selected instance: 1 (Confidence: 0.9512)
tmp min: tensor(0.) tmp max: tensor(1.)
153 68 540 960
There are 15 prompts
current IoU is: 0.8565795421600342
Seok, iteration idx= 18 IoU = tensor(0.8566)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.6ms
Speed: 2.3ms preprocess, 22.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9517
Instance 2: Confidence=0.9480
Instance 3: Confidence=0.9387
Instance 4: Confidence=0.9152
Instance 5: Confidence=0.5453
Instance 6: Confidence=0.3526
Selected instance: 0 (Confidence: 0.9519)
tmp min: tensor(0.) tmp max: tensor(1.)
173 80 540 960
There are 16 prompts
current IoU is: 0.8534554839134216
Seok, iteration idx= 19 IoU = tensor(0.8535)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.1ms
Speed: 3.4ms preprocess, 22.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9603
Instance 1: Confidence=0.9415
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9376
Instance 4: Confidence=0.7264
Instance 5: Confidence=0.3404
Selected instance: 4 (Confidence: 0.7264)
tmp min: tensor(0.) tmp max: tensor(1.)
953 228 540 960
There are 16 prompts
current IoU is: 0.6527317762374878
Seok, iteration idx= 20 IoU = tensor(0.6527)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.5ms preprocess, 20.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9516
Instance 1: Confidence=0.9497
Instance 2: Confidence=0.9427
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.3692
Selected instance: 4 (Confidence: 0.3692)
tmp min: tensor(0.) tmp max: tensor(1.)
952 272 540 960
There are 15 prompts
current IoU is: 0.2896551787853241
Seok, iteration idx= 21 IoU = tensor(0.2897)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.4ms
Speed: 1.3ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 4
Instance 0: Confidence=0.9620
Instance 1: Confidence=0.9516
Instance 2: Confidence=0.9441
Instance 3: Confidence=0.8590
Selected instance: 0 (Confidence: 0.9620)
tmp min: tensor(0.) tmp max: tensor(1.)
93 20 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 22 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 4
Instance 0: Confidence=0.9596
Instance 1: Confidence=0.9460
Instance 2: Confidence=0.9159
Instance 3: Confidence=0.3852
Selected instance: 0 (Confidence: 0.9596)
tmp min: tensor(0.) tmp max: tensor(1.)
50 24 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 23 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9604
Instance 1: Confidence=0.9048
Instance 2: Confidence=0.8323
Instance 3: Confidence=0.7273
Instance 4: Confidence=0.5794
Instance 5: Confidence=0.3322
Selected instance: 2 (Confidence: 0.8323)
tmp min: tensor(0.) tmp max: tensor(1.)
508 40 540 960
There are 17 prompts
current IoU is: 0.005033556837588549
Seok, iteration idx= 24 IoU = tensor(0.0050)
SKIP, unacceptable sam prediction, IoU is tensor(0.0050)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 3.1ms preprocess, 22.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9554
Instance 2: Confidence=0.9503
Instance 3: Confidence=0.9088
Instance 4: Confidence=0.2799
Instance 5: Confidence=0.2793
Selected instance: 5 (Confidence: 0.2793)
tmp min: tensor(0.) tmp max: tensor(1.)
950 312 540 960
There are 12 prompts
current IoU is: 0.4053560495376587
Seok, iteration idx= 25 IoU = tensor(0.4054)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 2.6ms preprocess, 22.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9443
Instance 1: Confidence=0.9402
Instance 2: Confidence=0.9050
Instance 3: Confidence=0.8995
Instance 4: Confidence=0.8411
Instance 5: Confidence=0.8070
Selected instance: 3 (Confidence: 0.8995)
tmp min: tensor(0.) tmp max: tensor(1.)
949 48 540 960
There are 14 prompts
current IoU is: 0.7655189037322998
Seok, iteration idx= 26 IoU = tensor(0.7655)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 2.8ms preprocess, 22.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9572
Instance 1: Confidence=0.9524
Instance 2: Confidence=0.9424
Instance 3: Confidence=0.9414
Instance 4: Confidence=0.8698
Selected instance: 0 (Confidence: 0.9572)
tmp min: tensor(0.) tmp max: tensor(1.)
867 72 540 960
There are 15 prompts
current IoU is: 0.8699139952659607
Seok, iteration idx= 27 IoU = tensor(0.8699)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.7ms
Speed: 1.3ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 7
Instance 0: Confidence=0.9549
Instance 1: Confidence=0.9432
Instance 2: Confidence=0.9343
Instance 3: Confidence=0.9288
Instance 4: Confidence=0.8839
Instance 5: Confidence=0.5460
Instance 6: Confidence=0.2770
Selected instance: 0 (Confidence: 0.9549)
tmp min: tensor(0.) tmp max: tensor(1.)
255 80 540 960
There are 15 prompts
current IoU is: 0.7866081595420837
Seok, iteration idx= 28 IoU = tensor(0.7866)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.9376
Instance 2: Confidence=0.9306
Instance 3: Confidence=0.8279
Instance 4: Confidence=0.7871
Instance 5: Confidence=0.3723
Instance 6: Confidence=0.2568
Selected instance: 1 (Confidence: 0.9376)
tmp min: tensor(0.) tmp max: tensor(1.)
268 96 540 960
There are 15 prompts
current IoU is: 0.8816834092140198
Seok, iteration idx= 29 IoU = tensor(0.8817)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 1.3ms preprocess, 22.1ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9439
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9349
Instance 3: Confidence=0.8851
Instance 4: Confidence=0.5107
Selected instance: 0 (Confidence: 0.9439)
tmp min: tensor(0.) tmp max: tensor(1.)
314 128 540 960
There are 16 prompts
current IoU is: 0.8704202175140381
Seok, iteration idx= 30 IoU = tensor(0.8704)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.3ms preprocess, 22.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9620
Instance 1: Confidence=0.9385
Instance 2: Confidence=0.9375
Instance 3: Confidence=0.9245
Instance 4: Confidence=0.8593
Selected instance: 1 (Confidence: 0.9385)
tmp min: tensor(0.) tmp max: tensor(1.)
380 80 540 960
There are 16 prompts
current IoU is: 0.8845961093902588
Seok, iteration idx= 31 IoU = tensor(0.8846)
Selected Instance Confidence List: [tensor(0.9101), tensor(0.6683, device='cpu'), tensor(0.6397, device='cpu'), tensor(0.3827, device='cpu'), tensor(0.3822, device='cpu'), tensor(0.6424, device='cpu'), tensor(0.8868, device='cpu'), tensor(0.7788, device='cpu'), tensor(0.6641, device='cpu'), tensor(0.3884, device='cpu'), tensor(0.7501, device='cpu'), tensor(0.6726, device='cpu'), tensor(0.8787, device='cpu'), tensor(0.8306, device='cpu'), tensor(0.8630, device='cpu'), tensor(0.9160, device='cpu'), tensor(0.8982, device='cpu'), tensor(0.8805, device='cpu'), tensor(0.8944, device='cpu'), tensor(0.8928, device='cpu'), tensor(0.6822, device='cpu'), tensor(0.3806, device='cpu'), tensor(0.3848, device='cpu'), tensor(0.3838, device='cpu'), tensor(0.3842, device='cpu'), tensor(0.3861, device='cpu'), tensor(0.8191, device='cpu'), tensor(0.9048, device='cpu'), tensor(0.8539, device='cpu'), tensor(0.9040, device='cpu'), tensor(0.8998, device='cpu'), tensor(0.9061, device='cpu')]
Sorted Confidence Order: [tensor(0.9160, device='cpu'), tensor(0.8630, device='cpu'), tensor(0.8982, device='cpu'), tensor(0.8805, device='cpu'), tensor(0.8944, device='cpu'), tensor(0.8928, device='cpu'), tensor(0.8539, device='cpu'), tensor(0.9040, device='cpu'), tensor(0.8998, device='cpu'), tensor(0.9061, device='cpu'), tensor(0.9101), tensor(0.6683, device='cpu'), tensor(0.6397, device='cpu'), tensor(0.3827, device='cpu'), tensor(0.3822, device='cpu'), tensor(0.6424, device='cpu'), tensor(0.8868, device='cpu'), tensor(0.7788, device='cpu'), tensor(0.6641, device='cpu'), tensor(0.3884, device='cpu'), tensor(0.7501, device='cpu'), tensor(0.6726, device='cpu'), tensor(0.6822, device='cpu'), tensor(0.3806, device='cpu'), tensor(0.3848, device='cpu'), tensor(0.3838, device='cpu'), tensor(0.3842, device='cpu'), tensor(0.3861, device='cpu'), tensor(0.8191, device='cpu'), tensor(0.9048, device='cpu'), tensor(0.8787, device='cpu'), tensor(0.8306, device='cpu')]
sorted_indices: [15, 14, 16, 17, 18, 19, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 20, 21, 22, 23, 24, 25, 26, 27, 12, 13]
Initial view (highest confidence): 16
New training order: [4, 3, 5, 6, 7, 8, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 9, 10, 11, 12, 13, 14, 15, 16, 1, 2]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 3.4ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 7
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.9447
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.7582
Instance 5: Confidence=0.7479
Instance 6: Confidence=0.3858
tmp min: tensor(0.) tmp max: tensor(1.)
40 72 540 960
There are 19 prompts
current IoU is: 0.88483065366745
Seok, iteration idx= 1 IoU = tensor(0.8848)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 1.3ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 5
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9515
Instance 2: Confidence=0.9465
Instance 3: Confidence=0.9285
Instance 4: Confidence=0.5979
tmp min: tensor(0.) tmp max: tensor(1.)
62 56 540 960
There are 18 prompts
current IoU is: 0.9144802689552307
Seok, iteration idx= 2 IoU = tensor(0.9145)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9450
Instance 2: Confidence=0.9402
Instance 3: Confidence=0.9285
Instance 4: Confidence=0.6814
tmp min: tensor(0.) tmp max: tensor(1.)
135 72 540 960
There are 16 prompts
current IoU is: 0.8979499936103821
Seok, iteration idx= 3 IoU = tensor(0.8979)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.3ms
Speed: 1.6ms preprocess, 22.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 8
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9512
Instance 2: Confidence=0.9320
Instance 3: Confidence=0.9235
Instance 4: Confidence=0.8462
Instance 5: Confidence=0.5823
Instance 6: Confidence=0.4505
Instance 7: Confidence=0.2670
tmp min: tensor(0.) tmp max: tensor(1.)
153 68 540 960
There are 15 prompts
current IoU is: 0.9060444235801697
Seok, iteration idx= 4 IoU = tensor(0.9060)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.6ms
Speed: 1.4ms preprocess, 24.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 7
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9517
Instance 2: Confidence=0.9480
Instance 3: Confidence=0.9387
Instance 4: Confidence=0.9152
Instance 5: Confidence=0.5453
Instance 6: Confidence=0.3526
tmp min: tensor(0.) tmp max: tensor(1.)
173 80 540 960
There are 16 prompts
current IoU is: 0.908058762550354
Seok, iteration idx= 5 IoU = tensor(0.9081)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.4ms
Speed: 1.7ms preprocess, 22.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 7
Instance 0: Confidence=0.9549
Instance 1: Confidence=0.9432
Instance 2: Confidence=0.9343
Instance 3: Confidence=0.9288
Instance 4: Confidence=0.8839
Instance 5: Confidence=0.5460
Instance 6: Confidence=0.2770
tmp min: tensor(0.) tmp max: tensor(1.)
255 80 540 960
There are 15 prompts
current IoU is: 0.8972087502479553
Seok, iteration idx= 6 IoU = tensor(0.8972)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.9376
Instance 2: Confidence=0.9306
Instance 3: Confidence=0.8279
Instance 4: Confidence=0.7871
Instance 5: Confidence=0.3723
Instance 6: Confidence=0.2568
tmp min: tensor(0.) tmp max: tensor(1.)
268 96 540 960
There are 15 prompts
current IoU is: 0.893537700176239
Seok, iteration idx= 7 IoU = tensor(0.8935)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.3ms preprocess, 24.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9439
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9349
Instance 3: Confidence=0.8851
Instance 4: Confidence=0.5107
tmp min: tensor(0.) tmp max: tensor(1.)
314 128 540 960
There are 16 prompts
current IoU is: 0.8847905397415161
Seok, iteration idx= 8 IoU = tensor(0.8848)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.6ms preprocess, 23.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9620
Instance 1: Confidence=0.9385
Instance 2: Confidence=0.9375
Instance 3: Confidence=0.9245
Instance 4: Confidence=0.8593
tmp min: tensor(0.) tmp max: tensor(1.)
380 80 540 960
There are 16 prompts
current IoU is: 0.8907800316810608
Seok, iteration idx= 9 IoU = tensor(0.8908)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 8
Instance 0: Confidence=0.9529
Instance 1: Confidence=0.9375
Instance 2: Confidence=0.9180
Instance 3: Confidence=0.9101
Instance 4: Confidence=0.8697
Instance 5: Confidence=0.7282
Instance 6: Confidence=0.3680
Instance 7: Confidence=0.3032
tmp min: tensor(0.) tmp max: tensor(1.)
452 92 540 960
There are 16 prompts
current IoU is: 0.8496388792991638
Seok, iteration idx= 10 IoU = tensor(0.8496)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.3ms preprocess, 23.0ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9656
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8572
Instance 5: Confidence=0.7074
tmp min: tensor(0.) tmp max: tensor(1.)
463 132 540 960
There are 16 prompts
current IoU is: 0.8326194286346436
Seok, iteration idx= 11 IoU = tensor(0.8326)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9558
Instance 1: Confidence=0.9384
Instance 2: Confidence=0.9350
Instance 3: Confidence=0.9330
Instance 4: Confidence=0.8556
Instance 5: Confidence=0.8479
tmp min: tensor(0.) tmp max: tensor(1.)
527 88 540 960
There are 12 prompts
current IoU is: 0.7568157315254211
Seok, iteration idx= 12 IoU = tensor(0.7568)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9492
Instance 1: Confidence=0.9473
Instance 2: Confidence=0.8976
Instance 3: Confidence=0.8878
Instance 4: Confidence=0.7385
tmp min: tensor(0.) tmp max: tensor(1.)
626 28 540 960
There are 17 prompts
current IoU is: 0.010015157982707024
Seok, iteration idx= 13 IoU = tensor(0.0100)
SKIP, unacceptable sam prediction, IoU is tensor(0.0100)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.8ms
Speed: 1.4ms preprocess, 24.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9493
Instance 1: Confidence=0.9481
Instance 2: Confidence=0.9454
Instance 3: Confidence=0.8710
Instance 4: Confidence=0.5295
Instance 5: Confidence=0.5013
tmp min: tensor(0.) tmp max: tensor(1.)
700 52 540 960
There are 11 prompts
current IoU is: 0.41721853613853455
Seok, iteration idx= 14 IoU = tensor(0.4172)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 2.3ms preprocess, 22.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9719
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9354
Instance 3: Confidence=0.8589
Instance 4: Confidence=0.5243
tmp min: tensor(0.) tmp max: tensor(1.)
691 88 540 960
There are 18 prompts
current IoU is: 0.828274667263031
Seok, iteration idx= 15 IoU = tensor(0.8283)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 2.9ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9585
Instance 2: Confidence=0.9417
Instance 3: Confidence=0.9039
Instance 4: Confidence=0.8364
Instance 5: Confidence=0.4622
tmp min: tensor(0.) tmp max: tensor(1.)
747 60 540 960
There are 14 prompts
current IoU is: 0.9001532196998596
Seok, iteration idx= 16 IoU = tensor(0.9002)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.9ms
Speed: 3.0ms preprocess, 21.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9523
Instance 2: Confidence=0.9520
Instance 3: Confidence=0.8925
Instance 4: Confidence=0.6584
tmp min: tensor(0.) tmp max: tensor(1.)
778 72 540 960
There are 13 prompts
current IoU is: 0.7950587272644043
Seok, iteration idx= 17 IoU = tensor(0.7951)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 2.8ms preprocess, 23.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 7
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9462
Instance 2: Confidence=0.9264
Instance 3: Confidence=0.8582
Instance 4: Confidence=0.8035
Instance 5: Confidence=0.7958
Instance 6: Confidence=0.3784
tmp min: tensor(0.) tmp max: tensor(1.)
785 136 540 960
There are 18 prompts
current IoU is: 0.6791381239891052
Seok, iteration idx= 18 IoU = tensor(0.6791)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.0ms
Speed: 3.2ms preprocess, 23.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 4
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9397
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.9188
tmp min: tensor(0.) tmp max: tensor(1.)
852 48 540 960
There are 15 prompts
current IoU is: 0.005236878991127014
Seok, iteration idx= 19 IoU = tensor(0.0052)
SKIP, unacceptable sam prediction, IoU is tensor(0.0052)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 4
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9233
Instance 2: Confidence=0.8993
Instance 3: Confidence=0.7667
tmp min: tensor(0.) tmp max: tensor(1.)
906 100 540 960
There are 14 prompts
current IoU is: 0.8110511302947998
Seok, iteration idx= 20 IoU = tensor(0.8111)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 1.3ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9608
Instance 1: Confidence=0.9321
Instance 2: Confidence=0.9267
Instance 3: Confidence=0.6191
Instance 4: Confidence=0.4317
Instance 5: Confidence=0.4099
tmp min: tensor(0.) tmp max: tensor(1.)
954 100 540 960
current IoU is: 0.8165959715843201
Seok, iteration idx= 21 IoU = tensor(0.8166)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.3ms preprocess, 23.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9603
Instance 1: Confidence=0.9415
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9376
Instance 4: Confidence=0.7264
Instance 5: Confidence=0.3404
tmp min: tensor(0.) tmp max: tensor(1.)
953 228 540 960
There are 16 prompts
current IoU is: 0.7561501860618591
Seok, iteration idx= 22 IoU = tensor(0.7562)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 2.2ms preprocess, 23.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9516
Instance 1: Confidence=0.9497
Instance 2: Confidence=0.9427
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.3692
tmp min: tensor(0.) tmp max: tensor(1.)
952 272 540 960
There are 15 prompts
current IoU is: 0.2862069010734558
Seok, iteration idx= 23 IoU = tensor(0.2862)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 4
Instance 0: Confidence=0.9620
Instance 1: Confidence=0.9516
Instance 2: Confidence=0.9441
Instance 3: Confidence=0.8590
tmp min: tensor(0.) tmp max: tensor(1.)
93 20 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 24 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.3ms
Speed: 3.2ms preprocess, 23.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 4
Instance 0: Confidence=0.9596
Instance 1: Confidence=0.9460
Instance 2: Confidence=0.9159
Instance 3: Confidence=0.3852
tmp min: tensor(0.) tmp max: tensor(1.)
50 24 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 25 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 3.1ms preprocess, 22.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9604
Instance 1: Confidence=0.9048
Instance 2: Confidence=0.8323
Instance 3: Confidence=0.7273
Instance 4: Confidence=0.5794
Instance 5: Confidence=0.3322
tmp min: tensor(0.) tmp max: tensor(1.)
43 48 540 960
There are 12 prompts
current IoU is: 0.0
Seok, iteration idx= 26 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.7ms preprocess, 24.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9554
Instance 2: Confidence=0.9503
Instance 3: Confidence=0.9088
Instance 4: Confidence=0.2799
Instance 5: Confidence=0.2793
tmp min: tensor(0.) tmp max: tensor(1.)
950 312 540 960
There are 12 prompts
current IoU is: 0.5454545617103577
Seok, iteration idx= 27 IoU = tensor(0.5455)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.6ms preprocess, 22.4ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9443
Instance 1: Confidence=0.9402
Instance 2: Confidence=0.9050
Instance 3: Confidence=0.8995
Instance 4: Confidence=0.8411
Instance 5: Confidence=0.8070
tmp min: tensor(0.) tmp max: tensor(1.)
949 48 540 960
There are 14 prompts
current IoU is: 0.8708663582801819
Seok, iteration idx= 28 IoU = tensor(0.8709)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.6ms preprocess, 22.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9572
Instance 1: Confidence=0.9524
Instance 2: Confidence=0.9424
Instance 3: Confidence=0.9414
Instance 4: Confidence=0.8698
tmp min: tensor(0.) tmp max: tensor(1.)
867 72 540 960
There are 15 prompts
current IoU is: 0.9238002300262451
Seok, iteration idx= 29 IoU = tensor(0.9238)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9405
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9210
Instance 5: Confidence=0.9140
tmp min: tensor(0.) tmp max: tensor(1.)
47 88 540 960
There are 17 prompts
current IoU is: 0.8796916007995605
Seok, iteration idx= 30 IoU = tensor(0.8797)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.3ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9598
Instance 1: Confidence=0.9502
Instance 2: Confidence=0.9318
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9104
Instance 5: Confidence=0.8862
tmp min: tensor(0.) tmp max: tensor(1.)
25 80 540 960
current IoU is: 0.8573277592658997
Seok, iteration idx= 31 IoU = tensor(0.8573)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set1_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set1_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.24s/it]
Testing psnr 28.20988915860653 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set1_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.17it/s]
Testing psnr 3.32282405346632 (avg)
train: coarse segmentation in 00:08:04
train: finish (eps time 00:08:05 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set1_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set2/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 39.12it/s]
Loaded image data (540, 960, 3, 32) [        540         960      752.26]
Loaded ./data/360_v2/Set2 1.2440621357132549 85.66757164363565
UserWarning: Optimal rotation is not uniquely or poorly defined for the given sets of vectors.
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960      752.26] ./data/360_v2/Set2
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.2539947867393494
original far 19.433752059936523
NEAR FAR 0 2.2590632
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.0105, -0.9112, -0.8033])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7333, 0.8326, 0.9405])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set2_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 3.5ms preprocess, 20.2ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.6ms
Speed: 1.2ms preprocess, 19.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.5ms
Speed: 1.2ms preprocess, 18.5ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.5ms
Speed: 1.4ms preprocess, 18.5ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.5ms
Speed: 1.3ms preprocess, 18.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.5ms
Speed: 1.2ms preprocess, 18.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.4ms
Speed: 1.3ms preprocess, 19.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.6ms
Speed: 1.3ms preprocess, 19.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.7ms
Speed: 1.2ms preprocess, 19.7ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.2ms
Speed: 1.2ms preprocess, 19.2ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.4ms
Speed: 2.9ms preprocess, 21.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.3ms
Speed: 1.3ms preprocess, 19.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9300
Instance 3: Confidence=0.8918
Instance 4: Confidence=0.8458
Instance 5: Confidence=0.3819
Selected instance: 4 (Confidence: 0.8458)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

363 80 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 15 prompts
current IoU is: 0.6740090250968933
Seok, iteration idx= 1 IoU = tensor(0.6740)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 1.4ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 5
Instance 0: Confidence=0.9629
Instance 1: Confidence=0.9472
Instance 2: Confidence=0.9233
Instance 3: Confidence=0.8755
Instance 4: Confidence=0.7944
Selected instance: 4 (Confidence: 0.7944)
tmp min: tensor(0.) tmp max: tensor(1.)
376 100 540 960
There are 18 prompts
current IoU is: 0.6314576268196106
Seok, iteration idx= 2 IoU = tensor(0.6315)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.8868
Instance 4: Confidence=0.7933
Selected instance: 4 (Confidence: 0.7933)
tmp min: tensor(0.) tmp max: tensor(1.)
382 140 540 960
There are 15 prompts
current IoU is: 0.5538881421089172
Seok, iteration idx= 3 IoU = tensor(0.5539)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9409
Instance 3: Confidence=0.9232
Instance 4: Confidence=0.7056
Instance 5: Confidence=0.5562
Selected instance: 5 (Confidence: 0.5562)
tmp min: tensor(0.) tmp max: tensor(1.)
630 52 540 960
There are 18 prompts
current IoU is: 0.3458416163921356
Seok, iteration idx= 4 IoU = tensor(0.3458)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 3.6ms preprocess, 20.5ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9383
Instance 3: Confidence=0.8695
Instance 4: Confidence=0.6814
Selected instance: 4 (Confidence: 0.6814)
tmp min: tensor(0.) tmp max: tensor(1.)
579 56 540 960
There are 13 prompts
current IoU is: 0.4467414915561676
Seok, iteration idx= 5 IoU = tensor(0.4467)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 3.1ms preprocess, 22.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9612
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8944
Instance 4: Confidence=0.5440
Instance 5: Confidence=0.3031
Selected instance: 5 (Confidence: 0.3031)
tmp min: tensor(0.) tmp max: tensor(1.)
560 104 540 960
There are 11 prompts
current IoU is: 0.14657415449619293
Seok, iteration idx= 6 IoU = tensor(0.1466)
SKIP, unacceptable sam prediction, IoU is tensor(0.1466)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 3.5ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9577
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.8692
Instance 4: Confidence=0.8435
Instance 5: Confidence=0.2911
Selected instance: 3 (Confidence: 0.8692)
tmp min: tensor(0.) tmp max: tensor(1.)
559 52 540 960
current IoU is: 0.2958146631717682
Seok, iteration idx= 7 IoU = tensor(0.2958)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.9ms
Speed: 1.8ms preprocess, 20.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9609
Instance 2: Confidence=0.9381
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9067
Instance 5: Confidence=0.8774
Selected instance: 3 (Confidence: 0.9365)
tmp min: tensor(0.) tmp max: tensor(1.)
502 48 540 960
There are 14 prompts
current IoU is: 0.606285572052002
Seok, iteration idx= 8 IoU = tensor(0.6063)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9636
Instance 1: Confidence=0.9628
Instance 2: Confidence=0.9492
Instance 3: Confidence=0.9315
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.3011
Selected instance: 2 (Confidence: 0.9492)
tmp min: tensor(0.) tmp max: tensor(1.)
469 24 540 960
There are 13 prompts
current IoU is: 0.8814125657081604
Seok, iteration idx= 9 IoU = tensor(0.8814)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.9ms
Speed: 1.7ms preprocess, 21.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 7
Instance 0: Confidence=0.9600
Instance 1: Confidence=0.9489
Instance 2: Confidence=0.9429
Instance 3: Confidence=0.9350
Instance 4: Confidence=0.7563
Instance 5: Confidence=0.5645
Instance 6: Confidence=0.3526
Selected instance: 1 (Confidence: 0.9489)
tmp min: tensor(0.) tmp max: tensor(1.)
415 36 540 960
There are 14 prompts
current IoU is: 0.938785195350647
Seok, iteration idx= 10 IoU = tensor(0.9388)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 1.7ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9504
Instance 3: Confidence=0.7410
Instance 4: Confidence=0.5533
Instance 5: Confidence=0.5528
Instance 6: Confidence=0.3753
Selected instance: 1 (Confidence: 0.9558)
tmp min: tensor(0.) tmp max: tensor(1.)
408 24 540 960
There are 14 prompts
current IoU is: 0.9705178737640381
Seok, iteration idx= 11 IoU = tensor(0.9705)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9540
Instance 2: Confidence=0.9500
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9019
Instance 5: Confidence=0.7190
Selected instance: 1 (Confidence: 0.9540)
tmp min: tensor(0.) tmp max: tensor(1.)
394 4 540 960
There are 17 prompts
current IoU is: 0.9177625775337219
Seok, iteration idx= 12 IoU = tensor(0.9178)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9389
Instance 3: Confidence=0.9388
Instance 4: Confidence=0.9250
Selected instance: 0 (Confidence: 0.9458)
tmp min: tensor(0.) tmp max: tensor(1.)
349 52 540 960
There are 15 prompts
current IoU is: 0.9169427156448364
Seok, iteration idx= 13 IoU = tensor(0.9169)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9248
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9204
Instance 5: Confidence=0.5236
Instance 6: Confidence=0.2980
Selected instance: 2 (Confidence: 0.9248)
tmp min: tensor(0.) tmp max: tensor(1.)
334 20 540 960
There are 15 prompts
current IoU is: 0.847435474395752
Seok, iteration idx= 14 IoU = tensor(0.8474)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.9090
Instance 5: Confidence=0.8731
Selected instance: 1 (Confidence: 0.9407)
tmp min: tensor(0.) tmp max: tensor(1.)
325 40 540 960
There are 15 prompts
current IoU is: 0.8646524548530579
Seok, iteration idx= 15 IoU = tensor(0.8647)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.4ms
Speed: 1.3ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9339
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9057
Instance 5: Confidence=0.8295
Selected instance: 4 (Confidence: 0.9057)
tmp min: tensor(0.) tmp max: tensor(1.)
311 124 540 960
There are 15 prompts
current IoU is: 0.9043195247650146
Seok, iteration idx= 16 IoU = tensor(0.9043)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9287
Instance 4: Confidence=0.9237
Selected instance: 4 (Confidence: 0.9237)
tmp min: tensor(0.) tmp max: tensor(1.)
303 96 540 960
There are 15 prompts
current IoU is: 0.8125160336494446
Seok, iteration idx= 17 IoU = tensor(0.8125)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9501
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9253
Instance 3: Confidence=0.9167
Instance 4: Confidence=0.9130
Instance 5: Confidence=0.7570
Selected instance: 3 (Confidence: 0.9167)
tmp min: tensor(0.) tmp max: tensor(1.)
294 100 540 960
There are 16 prompts
current IoU is: 0.8758482336997986
Seok, iteration idx= 18 IoU = tensor(0.8758)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.7ms preprocess, 22.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9468
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9173
Instance 3: Confidence=0.9139
Instance 4: Confidence=0.9082
Instance 5: Confidence=0.8839
Selected instance: 4 (Confidence: 0.9082)
tmp min: tensor(0.) tmp max: tensor(1.)
300 68 540 960
There are 17 prompts
current IoU is: 0.8505451083183289
Seok, iteration idx= 19 IoU = tensor(0.8505)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 2.6ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9123
Instance 4: Confidence=0.8140
Instance 5: Confidence=0.7047
Selected instance: 5 (Confidence: 0.7047)
tmp min: tensor(0.) tmp max: tensor(1.)
600 100 540 960
There are 11 prompts
current IoU is: 0.34096017479896545
Seok, iteration idx= 20 IoU = tensor(0.3410)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 2.8ms preprocess, 23.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9382
Instance 3: Confidence=0.9325
Instance 4: Confidence=0.8753
Selected instance: 3 (Confidence: 0.9325)
tmp min: tensor(0.) tmp max: tensor(1.)
779 48 540 960
There are 14 prompts
current IoU is: 0.010470712557435036
Seok, iteration idx= 21 IoU = tensor(0.0105)
SKIP, unacceptable sam prediction, IoU is tensor(0.0105)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 3.2ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9564
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9442
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.9084
Selected instance: 4 (Confidence: 0.9084)
tmp min: tensor(0.) tmp max: tensor(1.)
652 68 540 960
There are 16 prompts
current IoU is: 0.7818769812583923
Seok, iteration idx= 22 IoU = tensor(0.7819)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 2.4ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9426
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9157
Instance 4: Confidence=0.8987
Instance 5: Confidence=0.8984
Selected instance: 4 (Confidence: 0.8987)
tmp min: tensor(0.) tmp max: tensor(1.)
635 60 540 960
There are 15 prompts
current IoU is: 0.8281078338623047
Seok, iteration idx= 23 IoU = tensor(0.8281)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.8ms preprocess, 24.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9580
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9340
Instance 3: Confidence=0.9104
Instance 4: Confidence=0.8875
Selected instance: 3 (Confidence: 0.9104)
tmp min: tensor(0.) tmp max: tensor(1.)
644 44 540 960
There are 14 prompts
current IoU is: 0.8908390402793884
Seok, iteration idx= 24 IoU = tensor(0.8908)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9439
Instance 2: Confidence=0.9419
Instance 3: Confidence=0.9107
Instance 4: Confidence=0.8744
Instance 5: Confidence=0.8606
Selected instance: 3 (Confidence: 0.9107)
tmp min: tensor(0.) tmp max: tensor(1.)
671 36 540 960
There are 15 prompts
current IoU is: 0.9347177147865295
Seok, iteration idx= 25 IoU = tensor(0.9347)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.4ms
Speed: 2.1ms preprocess, 21.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9461
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9423
Instance 3: Confidence=0.8899
Instance 4: Confidence=0.8821
Instance 5: Confidence=0.8120
Selected instance: 3 (Confidence: 0.8899)
tmp min: tensor(0.) tmp max: tensor(1.)
640 32 540 960
There are 14 prompts
current IoU is: 0.9099749326705933
Seok, iteration idx= 26 IoU = tensor(0.9100)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.6ms preprocess, 23.5ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9428
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.8651
Instance 4: Confidence=0.8009
Instance 5: Confidence=0.6158
Selected instance: 4 (Confidence: 0.8009)
tmp min: tensor(0.) tmp max: tensor(1.)
616 16 540 960
There are 17 prompts
current IoU is: 0.7811183333396912
Seok, iteration idx= 27 IoU = tensor(0.7811)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.6ms preprocess, 23.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9324
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9186
Instance 3: Confidence=0.9152
Instance 4: Confidence=0.9005
Instance 5: Confidence=0.7954
Selected instance: 5 (Confidence: 0.7954)
tmp min: tensor(0.) tmp max: tensor(1.)
246 76 540 960
There are 17 prompts
current IoU is: 0.6822412610054016
Seok, iteration idx= 28 IoU = tensor(0.6822)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9442
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8480
Instance 4: Confidence=0.7411
Instance 5: Confidence=0.4972
Instance 6: Confidence=0.3251
Selected instance: 6 (Confidence: 0.3251)
tmp min: tensor(0.) tmp max: tensor(1.)
265 128 540 960
There are 16 prompts
current IoU is: 0.765154242515564
Seok, iteration idx= 29 IoU = tensor(0.7652)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9406
Instance 1: Confidence=0.9192
Instance 2: Confidence=0.8926
Instance 3: Confidence=0.8394
Instance 4: Confidence=0.4365
Instance 5: Confidence=0.4170
Instance 6: Confidence=0.3318
Selected instance: 4 (Confidence: 0.4365)
tmp min: tensor(0.) tmp max: tensor(1.)
322 52 540 960
There are 12 prompts
current IoU is: 0.25579291582107544
Seok, iteration idx= 30 IoU = tensor(0.2558)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 7
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9065
Instance 2: Confidence=0.7635
Instance 3: Confidence=0.5051
Instance 4: Confidence=0.4478
Instance 5: Confidence=0.4426
Instance 6: Confidence=0.2696
Selected instance: 4 (Confidence: 0.4478)
tmp min: tensor(0.) tmp max: tensor(1.)
320 52 540 960
There are 14 prompts
current IoU is: 0.4248683750629425
Seok, iteration idx= 31 IoU = tensor(0.4249)
Selected Instance Confidence List: [tensor(0.7253), tensor(0.7427, device='cpu'), tensor(0.6966, device='cpu'), tensor(0.6497, device='cpu'), tensor(0.4402, device='cpu'), tensor(0.5406, device='cpu'), tensor(0.3867, device='cpu'), tensor(0.5252, device='cpu'), tensor(0.7384, device='cpu'), tensor(0.9085, device='cpu'), tensor(0.9428, device='cpu'), tensor(0.9646, device='cpu'), tensor(0.9323, device='cpu'), tensor(0.9285, device='cpu'), tensor(0.8784, device='cpu'), tensor(0.8951, device='cpu'), tensor(0.9049, device='cpu'), tensor(0.8570, device='cpu'), tensor(0.8922, device='cpu'), tensor(0.8736, device='cpu'), tensor(0.4865, device='cpu'), tensor(0.3793, device='cpu'), tensor(0.8325, device='cpu'), tensor(0.8563, device='cpu'), tensor(0.8987, device='cpu'), tensor(0.9251, device='cpu'), tensor(0.9019, device='cpu'), tensor(0.7890, device='cpu'), tensor(0.7275, device='cpu'), tensor(0.5891, device='cpu'), tensor(0.3841, device='cpu'), tensor(0.4340, device='cpu')]
Sorted Confidence Order: [tensor(0.9646, device='cpu'), tensor(0.9323, device='cpu'), tensor(0.9285, device='cpu'), tensor(0.8784, device='cpu'), tensor(0.8951, device='cpu'), tensor(0.9049, device='cpu'), tensor(0.8570, device='cpu'), tensor(0.8922, device='cpu'), tensor(0.8736, device='cpu'), tensor(0.7275, device='cpu'), tensor(0.5891, device='cpu'), tensor(0.3841, device='cpu'), tensor(0.4340, device='cpu'), tensor(0.7253), tensor(0.7427, device='cpu'), tensor(0.6966, device='cpu'), tensor(0.6497, device='cpu'), tensor(0.4865, device='cpu'), tensor(0.3793, device='cpu'), tensor(0.8325, device='cpu'), tensor(0.8563, device='cpu'), tensor(0.8987, device='cpu'), tensor(0.9251, device='cpu'), tensor(0.9019, device='cpu'), tensor(0.7890, device='cpu'), tensor(0.4402, device='cpu'), tensor(0.5406, device='cpu'), tensor(0.3867, device='cpu'), tensor(0.5252, device='cpu'), tensor(0.7384, device='cpu'), tensor(0.9085, device='cpu'), tensor(0.9428, device='cpu')]
sorted_indices: [11, 12, 13, 14, 15, 16, 17, 18, 19, 28, 29, 30, 31, 0, 1, 2, 3, 20, 21, 22, 23, 24, 25, 26, 27, 4, 5, 6, 7, 8, 9, 10]
Initial view (highest confidence): 12
New training order: [28, 29, 30, 31, 32, 33, 34, 35, 36, 9, 10, 11, 12, 13, 14, 15, 16, 1, 2, 3, 4, 5, 6, 7, 8, 21, 22, 23, 24, 25, 26, 27]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 3.0ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9540
Instance 2: Confidence=0.9500
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9019
Instance 5: Confidence=0.7190
tmp min: tensor(0.) tmp max: tensor(1.)
394 4 540 960
There are 17 prompts
current IoU is: 0.9659613966941833
Seok, iteration idx= 1 IoU = tensor(0.9660)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 2.8ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 5
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9389
Instance 3: Confidence=0.9388
Instance 4: Confidence=0.9250
tmp min: tensor(0.) tmp max: tensor(1.)
349 52 540 960
There are 15 prompts
current IoU is: 0.9626971483230591
Seok, iteration idx= 2 IoU = tensor(0.9627)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.7ms
Speed: 3.1ms preprocess, 23.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9248
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9204
Instance 5: Confidence=0.5236
Instance 6: Confidence=0.2980
tmp min: tensor(0.) tmp max: tensor(1.)
334 20 540 960
There are 15 prompts
current IoU is: 0.949293315410614
Seok, iteration idx= 3 IoU = tensor(0.9493)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 2.8ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.9090
Instance 5: Confidence=0.8731
tmp min: tensor(0.) tmp max: tensor(1.)
325 40 540 960
There are 15 prompts
current IoU is: 0.9476902484893799
Seok, iteration idx= 4 IoU = tensor(0.9477)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 3.1ms preprocess, 22.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 6
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9339
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9057
Instance 5: Confidence=0.8295
tmp min: tensor(0.) tmp max: tensor(1.)
311 124 540 960
There are 15 prompts
current IoU is: 0.9388638138771057
Seok, iteration idx= 5 IoU = tensor(0.9389)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 2.8ms preprocess, 23.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9287
Instance 4: Confidence=0.9237
tmp min: tensor(0.) tmp max: tensor(1.)
303 96 540 960
There are 15 prompts
current IoU is: 0.9184303879737854
Seok, iteration idx= 6 IoU = tensor(0.9184)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 2.7ms preprocess, 23.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9501
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9253
Instance 3: Confidence=0.9167
Instance 4: Confidence=0.9130
Instance 5: Confidence=0.7570
tmp min: tensor(0.) tmp max: tensor(1.)
294 100 540 960
There are 16 prompts
current IoU is: 0.9087174534797668
Seok, iteration idx= 7 IoU = tensor(0.9087)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9468
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9173
Instance 3: Confidence=0.9139
Instance 4: Confidence=0.9082
Instance 5: Confidence=0.8839
tmp min: tensor(0.) tmp max: tensor(1.)
300 68 540 960
There are 17 prompts
current IoU is: 0.895760715007782
Seok, iteration idx= 8 IoU = tensor(0.8958)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.7ms preprocess, 23.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9324
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9186
Instance 3: Confidence=0.9152
Instance 4: Confidence=0.9005
Instance 5: Confidence=0.7954
tmp min: tensor(0.) tmp max: tensor(1.)
246 76 540 960
There are 17 prompts
current IoU is: 0.7639136910438538
Seok, iteration idx= 9 IoU = tensor(0.7639)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.3ms
Speed: 1.4ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 7
Instance 0: Confidence=0.9442
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8480
Instance 4: Confidence=0.7411
Instance 5: Confidence=0.4972
Instance 6: Confidence=0.3251
tmp min: tensor(0.) tmp max: tensor(1.)
265 128 540 960
There are 16 prompts
current IoU is: 0.7859072089195251
Seok, iteration idx= 10 IoU = tensor(0.7859)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9406
Instance 1: Confidence=0.9192
Instance 2: Confidence=0.8926
Instance 3: Confidence=0.8394
Instance 4: Confidence=0.4365
Instance 5: Confidence=0.4170
Instance 6: Confidence=0.3318
tmp min: tensor(0.) tmp max: tensor(1.)
322 52 540 960
There are 12 prompts
current IoU is: 0.2696290612220764
Seok, iteration idx= 11 IoU = tensor(0.2696)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.8ms
Speed: 1.6ms preprocess, 24.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 7
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9065
Instance 2: Confidence=0.7635
Instance 3: Confidence=0.5051
Instance 4: Confidence=0.4478
Instance 5: Confidence=0.4426
Instance 6: Confidence=0.2696
tmp min: tensor(0.) tmp max: tensor(1.)
320 52 540 960
There are 14 prompts
current IoU is: 0.44256094098091125
Seok, iteration idx= 12 IoU = tensor(0.4426)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.5ms
Speed: 1.5ms preprocess, 22.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 8
Instance 0: Confidence=0.9377
Instance 1: Confidence=0.9249
Instance 2: Confidence=0.9153
Instance 3: Confidence=0.7253
Instance 4: Confidence=0.7085
Instance 5: Confidence=0.4352
Instance 6: Confidence=0.3452
Instance 7: Confidence=0.2772
tmp min: tensor(0.) tmp max: tensor(1.)
322 64 540 960
There are 19 prompts
current IoU is: 0.7606145739555359
Seok, iteration idx= 13 IoU = tensor(0.7606)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9300
Instance 3: Confidence=0.8918
Instance 4: Confidence=0.8458
Instance 5: Confidence=0.3819
tmp min: tensor(0.) tmp max: tensor(1.)
363 80 540 960
There are 15 prompts
current IoU is: 0.7343276739120483
Seok, iteration idx= 14 IoU = tensor(0.7343)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9629
Instance 1: Confidence=0.9472
Instance 2: Confidence=0.9233
Instance 3: Confidence=0.8755
Instance 4: Confidence=0.7944
tmp min: tensor(0.) tmp max: tensor(1.)
376 100 540 960
There are 18 prompts
current IoU is: 0.7706223130226135
Seok, iteration idx= 15 IoU = tensor(0.7706)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.8868
Instance 4: Confidence=0.7933
tmp min: tensor(0.) tmp max: tensor(1.)
382 140 540 960
There are 15 prompts
current IoU is: 0.6421709656715393
Seok, iteration idx= 16 IoU = tensor(0.6422)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.6ms
Speed: 1.6ms preprocess, 24.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9123
Instance 4: Confidence=0.8140
Instance 5: Confidence=0.7047
tmp min: tensor(0.) tmp max: tensor(1.)
600 100 540 960
There are 11 prompts
current IoU is: 0.5618455410003662
Seok, iteration idx= 17 IoU = tensor(0.5618)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 1.6ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9382
Instance 3: Confidence=0.9325
Instance 4: Confidence=0.8753
tmp min: tensor(0.) tmp max: tensor(1.)
557 92 540 960
There are 15 prompts
current IoU is: 0.00275400816462934
Seok, iteration idx= 18 IoU = tensor(0.0028)
SKIP, unacceptable sam prediction, IoU is tensor(0.0028)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 1.5ms preprocess, 22.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9564
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9442
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.9084
tmp min: tensor(0.) tmp max: tensor(1.)
652 68 540 960
There are 16 prompts
current IoU is: 0.9310535192489624
Seok, iteration idx= 19 IoU = tensor(0.9311)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.9ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9426
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9157
Instance 4: Confidence=0.8987
Instance 5: Confidence=0.8984
tmp min: tensor(0.) tmp max: tensor(1.)
635 60 540 960
There are 15 prompts
current IoU is: 0.9153100252151489
Seok, iteration idx= 20 IoU = tensor(0.9153)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9580
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9340
Instance 3: Confidence=0.9104
Instance 4: Confidence=0.8875
tmp min: tensor(0.) tmp max: tensor(1.)
644 44 540 960
There are 14 prompts
current IoU is: 0.9385457038879395
Seok, iteration idx= 21 IoU = tensor(0.9385)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 3.0ms preprocess, 23.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9439
Instance 2: Confidence=0.9419
Instance 3: Confidence=0.9107
Instance 4: Confidence=0.8744
Instance 5: Confidence=0.8606
tmp min: tensor(0.) tmp max: tensor(1.)
671 36 540 960
There are 15 prompts
current IoU is: 0.9506497979164124
Seok, iteration idx= 22 IoU = tensor(0.9506)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 4.2ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9461
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9423
Instance 3: Confidence=0.8899
Instance 4: Confidence=0.8821
Instance 5: Confidence=0.8120
tmp min: tensor(0.) tmp max: tensor(1.)
640 32 540 960
There are 14 prompts
current IoU is: 0.9364629983901978
Seok, iteration idx= 23 IoU = tensor(0.9365)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 3.3ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9428
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.8651
Instance 4: Confidence=0.8009
Instance 5: Confidence=0.6158
tmp min: tensor(0.) tmp max: tensor(1.)
616 16 540 960
There are 17 prompts
current IoU is: 0.7910643815994263
Seok, iteration idx= 24 IoU = tensor(0.7911)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.5ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9409
Instance 3: Confidence=0.9232
Instance 4: Confidence=0.7056
Instance 5: Confidence=0.5562
tmp min: tensor(0.) tmp max: tensor(1.)
630 52 540 960
There are 18 prompts
current IoU is: 0.6969202160835266
Seok, iteration idx= 25 IoU = tensor(0.6969)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 1.4ms preprocess, 22.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9383
Instance 3: Confidence=0.8695
Instance 4: Confidence=0.6814
tmp min: tensor(0.) tmp max: tensor(1.)
579 56 540 960
There are 13 prompts
current IoU is: 0.5803594589233398
Seok, iteration idx= 26 IoU = tensor(0.5804)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9612
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8944
Instance 4: Confidence=0.5440
Instance 5: Confidence=0.3031
tmp min: tensor(0.) tmp max: tensor(1.)
560 104 540 960
There are 11 prompts
current IoU is: 0.278917133808136
Seok, iteration idx= 27 IoU = tensor(0.2789)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.7ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9577
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.8692
Instance 4: Confidence=0.8435
Instance 5: Confidence=0.2911
tmp min: tensor(0.) tmp max: tensor(1.)
559 52 540 960
current IoU is: 0.8308221697807312
Seok, iteration idx= 28 IoU = tensor(0.8308)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.6ms preprocess, 22.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9609
Instance 2: Confidence=0.9381
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9067
Instance 5: Confidence=0.8774
tmp min: tensor(0.) tmp max: tensor(1.)
502 48 540 960
There are 14 prompts
current IoU is: 0.9516848921775818
Seok, iteration idx= 29 IoU = tensor(0.9517)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.6ms preprocess, 23.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9636
Instance 1: Confidence=0.9628
Instance 2: Confidence=0.9492
Instance 3: Confidence=0.9315
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.3011
tmp min: tensor(0.) tmp max: tensor(1.)
469 24 540 960
There are 13 prompts
current IoU is: 0.952396035194397
Seok, iteration idx= 30 IoU = tensor(0.9524)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.9ms
Speed: 1.6ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 7
Instance 0: Confidence=0.9600
Instance 1: Confidence=0.9489
Instance 2: Confidence=0.9429
Instance 3: Confidence=0.9350
Instance 4: Confidence=0.7563
Instance 5: Confidence=0.5645
Instance 6: Confidence=0.3526
tmp min: tensor(0.) tmp max: tensor(1.)
415 36 540 960
There are 14 prompts
current IoU is: 0.9680444598197937
Seok, iteration idx= 31 IoU = tensor(0.9680)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set2_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set2_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.24s/it]
Testing psnr 28.1736521422863 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set2_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.16it/s]
Testing psnr 3.4619060158729553 (avg)
train: coarse segmentation in 09:03:09
train: finish (eps time 09:03:09 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set2_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set3/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 45.01it/s]
Loaded image data (540, 960, 3, 32) [        540         960      752.34]
Loaded ./data/360_v2/Set3 1.7761290072006928 55.6629549596001
UserWarning: Optimal rotation is not uniquely or poorly defined for the given sets of vectors.
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960      752.34] ./data/360_v2/Set3
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.36282292306423186
original far 12.634090423583984
NEAR FAR 0 2.2571032
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-0.9373, -0.8730, -0.7720])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.6911, 0.7554, 0.8564])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set3_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.3ms
Speed: 3.0ms preprocess, 20.3ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.4ms preprocess, 20.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.5ms preprocess, 20.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.8ms
Speed: 1.4ms preprocess, 20.8ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.7ms
Speed: 1.5ms preprocess, 20.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.4ms
Speed: 1.5ms preprocess, 20.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.4ms
Speed: 1.5ms preprocess, 20.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.8ms
Speed: 2.3ms preprocess, 20.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.7ms
Speed: 1.6ms preprocess, 19.7ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 1.4ms preprocess, 20.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.3ms
Speed: 1.5ms preprocess, 20.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.0ms
Speed: 1.6ms preprocess, 21.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 1.4ms preprocess, 20.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.0ms
Speed: 1.4ms preprocess, 20.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.8ms
Speed: 1.5ms preprocess, 20.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.0ms
Speed: 1.4ms preprocess, 21.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.4ms preprocess, 20.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.4ms preprocess, 20.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.8ms
Speed: 1.4ms preprocess, 20.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.0ms
Speed: 1.4ms preprocess, 22.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.0ms
Speed: 1.4ms preprocess, 20.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.0ms
Speed: 1.8ms preprocess, 21.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.4ms
Speed: 1.4ms preprocess, 20.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.8ms
Speed: 1.5ms preprocess, 20.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.1ms
Speed: 1.5ms preprocess, 22.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.5ms
Speed: 1.5ms preprocess, 20.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.8ms
Speed: 1.7ms preprocess, 22.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.0ms
Speed: 1.2ms preprocess, 21.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9418
Instance 2: Confidence=0.9238
Instance 3: Confidence=0.9103
Instance 4: Confidence=0.8137
Instance 5: Confidence=0.3678
Selected instance: 4 (Confidence: 0.8137)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

319 84 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 17 prompts
current IoU is: 0.7639631032943726
Seok, iteration idx= 1 IoU = tensor(0.7640)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 2.6ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9432
Instance 1: Confidence=0.9382
Instance 2: Confidence=0.9229
Instance 3: Confidence=0.9166
Instance 4: Confidence=0.8470
Instance 5: Confidence=0.8422
Selected instance: 4 (Confidence: 0.8470)
tmp min: tensor(0.) tmp max: tensor(1.)
339 100 540 960
There are 15 prompts
current IoU is: 0.6711441874504089
Seok, iteration idx= 2 IoU = tensor(0.6711)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 2.2ms preprocess, 22.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9398
Instance 1: Confidence=0.9287
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.8930
Instance 4: Confidence=0.8873
Selected instance: 0 (Confidence: 0.9398)
tmp min: tensor(0.) tmp max: tensor(1.)
368 128 540 960
There are 14 prompts
current IoU is: 0.01030475739389658
Seok, iteration idx= 3 IoU = tensor(0.0103)
SKIP, unacceptable sam prediction, IoU is tensor(0.0103)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.6ms
Speed: 3.1ms preprocess, 21.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 7
Instance 0: Confidence=0.9443
Instance 1: Confidence=0.9263
Instance 2: Confidence=0.9112
Instance 3: Confidence=0.8529
Instance 4: Confidence=0.7917
Instance 5: Confidence=0.5320
Instance 6: Confidence=0.4048
Selected instance: 3 (Confidence: 0.8529)
tmp min: tensor(0.) tmp max: tensor(1.)
691 52 540 960
There are 14 prompts
current IoU is: 0.3254275619983673
Seok, iteration idx= 4 IoU = tensor(0.3254)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.8ms
Speed: 3.3ms preprocess, 21.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 8
Instance 0: Confidence=0.9391
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9228
Instance 3: Confidence=0.8782
Instance 4: Confidence=0.6843
Instance 5: Confidence=0.5397
Instance 6: Confidence=0.5218
Instance 7: Confidence=0.3399
Selected instance: 3 (Confidence: 0.8782)
tmp min: tensor(0.) tmp max: tensor(1.)
639 52 540 960
There are 14 prompts
current IoU is: 0.772891104221344
Seok, iteration idx= 5 IoU = tensor(0.7729)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.0ms
Speed: 2.3ms preprocess, 22.0ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9437
Instance 1: Confidence=0.9314
Instance 2: Confidence=0.9091
Instance 3: Confidence=0.8747
Instance 4: Confidence=0.8331
Selected instance: 3 (Confidence: 0.8747)
tmp min: tensor(0.) tmp max: tensor(1.)
634 84 540 960
There are 17 prompts
current IoU is: 0.8420454263687134
Seok, iteration idx= 6 IoU = tensor(0.8420)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.9ms
Speed: 2.9ms preprocess, 21.9ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9220
Instance 1: Confidence=0.9218
Instance 2: Confidence=0.9069
Instance 3: Confidence=0.9049
Instance 4: Confidence=0.9018
Instance 5: Confidence=0.8183
Selected instance: 4 (Confidence: 0.9018)
tmp min: tensor(0.) tmp max: tensor(1.)
609 48 540 960
There are 14 prompts
current IoU is: 0.910980761051178
Seok, iteration idx= 7 IoU = tensor(0.9110)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 2.5ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.8996
Instance 3: Confidence=0.8888
Instance 4: Confidence=0.8676
Selected instance: 1 (Confidence: 0.9503)
tmp min: tensor(0.) tmp max: tensor(1.)
550 40 540 960
There are 14 prompts
current IoU is: 0.9197301864624023
Seok, iteration idx= 8 IoU = tensor(0.9197)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.5ms
Speed: 2.4ms preprocess, 24.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9476
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.8890
Instance 3: Confidence=0.8363
Instance 4: Confidence=0.8338
Selected instance: 0 (Confidence: 0.9476)
tmp min: tensor(0.) tmp max: tensor(1.)
505 16 540 960
There are 15 prompts
current IoU is: 0.9497578144073486
Seok, iteration idx= 9 IoU = tensor(0.9498)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.7ms
Speed: 2.6ms preprocess, 21.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9144
Instance 2: Confidence=0.9064
Instance 3: Confidence=0.9036
Instance 4: Confidence=0.8918
Instance 5: Confidence=0.8164
Selected instance: 0 (Confidence: 0.9510)
tmp min: tensor(0.) tmp max: tensor(1.)
437 24 540 960
There are 11 prompts
current IoU is: 0.95400470495224
Seok, iteration idx= 10 IoU = tensor(0.9540)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 2.9ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9670
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9256
Instance 3: Confidence=0.8502
Instance 4: Confidence=0.8407
Instance 5: Confidence=0.5675
Instance 6: Confidence=0.2603
Selected instance: 0 (Confidence: 0.9670)
tmp min: tensor(0.) tmp max: tensor(1.)
418 12 540 960
There are 13 prompts
current IoU is: 0.9522712230682373
Seok, iteration idx= 11 IoU = tensor(0.9523)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 2.8ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9585
Instance 1: Confidence=0.9275
Instance 2: Confidence=0.9113
Instance 3: Confidence=0.9041
Instance 4: Confidence=0.8095
Selected instance: 0 (Confidence: 0.9585)
tmp min: tensor(0.) tmp max: tensor(1.)
378 0 540 960
There are 15 prompts
current IoU is: 0.9285157322883606
Seok, iteration idx= 12 IoU = tensor(0.9285)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.9ms
Speed: 1.2ms preprocess, 21.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 4
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9405
Instance 2: Confidence=0.9168
Instance 3: Confidence=0.8296
Selected instance: 0 (Confidence: 0.9616)
tmp min: tensor(0.) tmp max: tensor(1.)
329 44 540 960
There are 13 prompts
current IoU is: 0.9164854884147644
Seok, iteration idx= 13 IoU = tensor(0.9165)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9529
Instance 1: Confidence=0.9514
Instance 2: Confidence=0.9135
Instance 3: Confidence=0.9119
Instance 4: Confidence=0.3781
Selected instance: 0 (Confidence: 0.9529)
tmp min: tensor(0.) tmp max: tensor(1.)
302 12 540 960
There are 15 prompts
current IoU is: 0.9164049625396729
Seok, iteration idx= 14 IoU = tensor(0.9164)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.9ms
Speed: 1.3ms preprocess, 21.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9456
Instance 1: Confidence=0.9262
Instance 2: Confidence=0.8959
Instance 3: Confidence=0.8348
Instance 4: Confidence=0.6141
Instance 5: Confidence=0.3271
Selected instance: 1 (Confidence: 0.9262)
tmp min: tensor(0.) tmp max: tensor(1.)
286 36 540 960
There are 15 prompts
current IoU is: 0.9301775693893433
Seok, iteration idx= 15 IoU = tensor(0.9302)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.9ms
Speed: 1.5ms preprocess, 21.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9397
Instance 2: Confidence=0.9054
Instance 3: Confidence=0.8999
Instance 4: Confidence=0.8815
Instance 5: Confidence=0.8617
Selected instance: 0 (Confidence: 0.9430)
tmp min: tensor(0.) tmp max: tensor(1.)
273 120 540 960
There are 14 prompts
current IoU is: 0.9359536170959473
Seok, iteration idx= 16 IoU = tensor(0.9360)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.8ms
Speed: 1.2ms preprocess, 21.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9502
Instance 1: Confidence=0.9332
Instance 2: Confidence=0.9264
Instance 3: Confidence=0.9254
Instance 4: Confidence=0.9229
Instance 5: Confidence=0.5863
Selected instance: 4 (Confidence: 0.9229)
tmp min: tensor(0.) tmp max: tensor(1.)
253 92 540 960
There are 15 prompts
current IoU is: 0.8801105618476868
Seok, iteration idx= 17 IoU = tensor(0.8801)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.3ms preprocess, 22.2ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9502
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9259
Instance 3: Confidence=0.9246
Instance 4: Confidence=0.7572
Selected instance: 3 (Confidence: 0.9246)
tmp min: tensor(0.) tmp max: tensor(1.)
239 100 540 960
There are 17 prompts
current IoU is: 0.8739209771156311
Seok, iteration idx= 18 IoU = tensor(0.8739)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.1ms
Speed: 1.4ms preprocess, 22.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9451
Instance 2: Confidence=0.9205
Instance 3: Confidence=0.8957
Instance 4: Confidence=0.7199
Instance 5: Confidence=0.6674
Instance 6: Confidence=0.4065
Selected instance: 3 (Confidence: 0.8957)
tmp min: tensor(0.) tmp max: tensor(1.)
239 64 540 960
There are 18 prompts
current IoU is: 0.8462777137756348
Seok, iteration idx= 19 IoU = tensor(0.8463)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9306
Instance 1: Confidence=0.9305
Instance 2: Confidence=0.9199
Instance 3: Confidence=0.9194
Instance 4: Confidence=0.9074
Instance 5: Confidence=0.8918
Selected instance: 1 (Confidence: 0.9305)
tmp min: tensor(0.) tmp max: tensor(1.)
625 100 540 960
There are 15 prompts
current IoU is: 0.9113205075263977
Seok, iteration idx= 20 IoU = tensor(0.9113)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 2.2ms preprocess, 23.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9305
Instance 1: Confidence=0.9276
Instance 2: Confidence=0.9191
Instance 3: Confidence=0.8996
Instance 4: Confidence=0.8552
Instance 5: Confidence=0.8230
Selected instance: 2 (Confidence: 0.9191)
tmp min: tensor(0.) tmp max: tensor(1.)
655 76 540 960
There are 15 prompts
current IoU is: 0.8140568733215332
Seok, iteration idx= 21 IoU = tensor(0.8141)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.9ms
Speed: 1.2ms preprocess, 21.9ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 8
Instance 0: Confidence=0.9374
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9352
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.5537
Instance 5: Confidence=0.3907
Instance 6: Confidence=0.3726
Instance 7: Confidence=0.3383
Selected instance: 1 (Confidence: 0.9363)
tmp min: tensor(0.) tmp max: tensor(1.)
686 68 540 960
There are 15 prompts
current IoU is: 0.8020740747451782
Seok, iteration idx= 22 IoU = tensor(0.8021)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9308
Instance 2: Confidence=0.9301
Instance 3: Confidence=0.9154
Instance 4: Confidence=0.8041
Selected instance: 2 (Confidence: 0.9301)
tmp min: tensor(0.) tmp max: tensor(1.)
672 64 540 960
There are 14 prompts
current IoU is: 0.8281600475311279
Seok, iteration idx= 23 IoU = tensor(0.8282)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 1.3ms preprocess, 22.1ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9390
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9113
Instance 3: Confidence=0.9079
Instance 4: Confidence=0.8845
Selected instance: 0 (Confidence: 0.9390)
tmp min: tensor(0.) tmp max: tensor(1.)
692 44 540 960
There are 14 prompts
current IoU is: 0.8772202134132385
Seok, iteration idx= 24 IoU = tensor(0.8772)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.8ms
Speed: 1.3ms preprocess, 21.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9429
Instance 1: Confidence=0.9358
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.8998
Instance 4: Confidence=0.8047
Instance 5: Confidence=0.7897
Selected instance: 1 (Confidence: 0.9358)
tmp min: tensor(0.) tmp max: tensor(1.)
721 36 540 960
There are 15 prompts
current IoU is: 0.9123283624649048
Seok, iteration idx= 25 IoU = tensor(0.9123)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9544
Instance 1: Confidence=0.9382
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.9165
Instance 4: Confidence=0.9129
Selected instance: 3 (Confidence: 0.9165)
tmp min: tensor(0.) tmp max: tensor(1.)
700 28 540 960
There are 16 prompts
current IoU is: 0.9435386657714844
Seok, iteration idx= 26 IoU = tensor(0.9435)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.3ms preprocess, 23.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9328
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.9281
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8874
Instance 5: Confidence=0.8685
Selected instance: 1 (Confidence: 0.9302)
tmp min: tensor(0.) tmp max: tensor(1.)
678 12 540 960
There are 16 prompts
current IoU is: 0.9378223419189453
Seok, iteration idx= 27 IoU = tensor(0.9378)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.4ms
Speed: 1.4ms preprocess, 21.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 7
Instance 0: Confidence=0.9433
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.9262
Instance 3: Confidence=0.9099
Instance 4: Confidence=0.9046
Instance 5: Confidence=0.7494
Instance 6: Confidence=0.2752
Selected instance: 5 (Confidence: 0.7494)
tmp min: tensor(0.) tmp max: tensor(1.)
252 52 540 960
current IoU is: 0.7400023341178894
Seok, iteration idx= 28 IoU = tensor(0.7400)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.1ms
Speed: 1.6ms preprocess, 22.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9436
Instance 2: Confidence=0.9257
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9060
Instance 5: Confidence=0.4599
Selected instance: 5 (Confidence: 0.4599)
tmp min: tensor(0.) tmp max: tensor(1.)
242 56 540 960
There are 13 prompts
current IoU is: 0.21028277277946472
Seok, iteration idx= 29 IoU = tensor(0.2103)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9418
Instance 2: Confidence=0.9267
Instance 3: Confidence=0.9179
Instance 4: Confidence=0.8670
Selected instance: 0 (Confidence: 0.9594)
tmp min: tensor(0.) tmp max: tensor(1.)
276 12 540 960
There are 17 prompts
current IoU is: 0.003441876731812954
Seok, iteration idx= 30 IoU = tensor(0.0034)
SKIP, unacceptable sam prediction, IoU is tensor(0.0034)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.3ms preprocess, 22.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9559
Instance 1: Confidence=0.9546
Instance 2: Confidence=0.9364
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.8237
Instance 5: Confidence=0.3776
Selected instance: 5 (Confidence: 0.3776)
tmp min: tensor(0.) tmp max: tensor(1.)
302 76 540 960
There are 19 prompts
current IoU is: 0.5263223648071289
Seok, iteration idx= 31 IoU = tensor(0.5263)
Selected Instance Confidence List: [tensor(0.8634), tensor(0.7839, device='cpu'), tensor(0.7415, device='cpu'), tensor(0.3821, device='cpu'), tensor(0.5364, device='cpu'), tensor(0.8150, device='cpu'), tensor(0.8551, device='cpu'), tensor(0.9073, device='cpu'), tensor(0.9320, device='cpu'), tensor(0.9489, device='cpu'), tensor(0.9528, device='cpu'), tensor(0.9582, device='cpu'), tensor(0.9405, device='cpu'), tensor(0.9345, device='cpu'), tensor(0.9310, device='cpu'), tensor(0.9286, device='cpu'), tensor(0.9388, device='cpu'), tensor(0.8972, device='cpu'), tensor(0.8942, device='cpu'), tensor(0.8661, device='cpu'), tensor(0.9190, device='cpu'), tensor(0.8561, device='cpu'), tensor(0.8558, device='cpu'), tensor(0.8689, device='cpu'), tensor(0.9020, device='cpu'), tensor(0.9217, device='cpu'), tensor(0.9327, device='cpu'), tensor(0.9348, device='cpu'), tensor(0.7438, device='cpu'), tensor(0.3816, device='cpu'), tensor(0.3858, device='cpu'), tensor(0.4668, device='cpu')]
Sorted Confidence Order: [tensor(0.9582, device='cpu'), tensor(0.9405, device='cpu'), tensor(0.9345, device='cpu'), tensor(0.9310, device='cpu'), tensor(0.9286, device='cpu'), tensor(0.9388, device='cpu'), tensor(0.8972, device='cpu'), tensor(0.8942, device='cpu'), tensor(0.8661, device='cpu'), tensor(0.7438, device='cpu'), tensor(0.3816, device='cpu'), tensor(0.3858, device='cpu'), tensor(0.4668, device='cpu'), tensor(0.8634), tensor(0.7839, device='cpu'), tensor(0.7415, device='cpu'), tensor(0.3821, device='cpu'), tensor(0.9190, device='cpu'), tensor(0.8561, device='cpu'), tensor(0.8558, device='cpu'), tensor(0.8689, device='cpu'), tensor(0.9020, device='cpu'), tensor(0.9217, device='cpu'), tensor(0.9327, device='cpu'), tensor(0.9348, device='cpu'), tensor(0.5364, device='cpu'), tensor(0.8150, device='cpu'), tensor(0.8551, device='cpu'), tensor(0.9073, device='cpu'), tensor(0.9320, device='cpu'), tensor(0.9489, device='cpu'), tensor(0.9528, device='cpu')]
sorted_indices: [11, 12, 13, 14, 15, 16, 17, 18, 19, 28, 29, 30, 31, 0, 1, 2, 3, 20, 21, 22, 23, 24, 25, 26, 27, 4, 5, 6, 7, 8, 9, 10]
Initial view (highest confidence): 12
New training order: [28, 29, 30, 31, 32, 33, 34, 35, 36, 9, 10, 11, 12, 13, 14, 15, 16, 1, 2, 3, 4, 5, 6, 7, 8, 21, 22, 23, 24, 25, 26, 27]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.4ms
Speed: 1.2ms preprocess, 20.4ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 1.3ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9585
Instance 1: Confidence=0.9275
Instance 2: Confidence=0.9113
Instance 3: Confidence=0.9041
Instance 4: Confidence=0.8095
tmp min: tensor(0.) tmp max: tensor(1.)
378 0 540 960
There are 15 prompts
current IoU is: 0.9524449110031128
Seok, iteration idx= 1 IoU = tensor(0.9524)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 4
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9405
Instance 2: Confidence=0.9168
Instance 3: Confidence=0.8296
tmp min: tensor(0.) tmp max: tensor(1.)
329 44 540 960
There are 13 prompts
current IoU is: 0.916031539440155
Seok, iteration idx= 2 IoU = tensor(0.9160)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 1.5ms preprocess, 22.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9529
Instance 1: Confidence=0.9514
Instance 2: Confidence=0.9135
Instance 3: Confidence=0.9119
Instance 4: Confidence=0.3781
tmp min: tensor(0.) tmp max: tensor(1.)
302 12 540 960
There are 15 prompts
current IoU is: 0.9331650137901306
Seok, iteration idx= 3 IoU = tensor(0.9332)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9456
Instance 1: Confidence=0.9262
Instance 2: Confidence=0.8959
Instance 3: Confidence=0.8348
Instance 4: Confidence=0.6141
Instance 5: Confidence=0.3271
tmp min: tensor(0.) tmp max: tensor(1.)
286 36 540 960
There are 15 prompts
current IoU is: 0.9347295761108398
Seok, iteration idx= 4 IoU = tensor(0.9347)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 6
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9397
Instance 2: Confidence=0.9054
Instance 3: Confidence=0.8999
Instance 4: Confidence=0.8815
Instance 5: Confidence=0.8617
tmp min: tensor(0.) tmp max: tensor(1.)
273 120 540 960
There are 14 prompts
current IoU is: 0.9490153193473816
Seok, iteration idx= 5 IoU = tensor(0.9490)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9502
Instance 1: Confidence=0.9332
Instance 2: Confidence=0.9264
Instance 3: Confidence=0.9254
Instance 4: Confidence=0.9229
Instance 5: Confidence=0.5863
tmp min: tensor(0.) tmp max: tensor(1.)
253 92 540 960
There are 15 prompts
current IoU is: 0.9133636355400085
Seok, iteration idx= 6 IoU = tensor(0.9134)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 2.3ms preprocess, 22.7ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9502
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9259
Instance 3: Confidence=0.9246
Instance 4: Confidence=0.7572
tmp min: tensor(0.) tmp max: tensor(1.)
239 100 540 960
There are 17 prompts
current IoU is: 0.8999110460281372
Seok, iteration idx= 7 IoU = tensor(0.8999)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.7ms
Speed: 3.9ms preprocess, 22.7ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9451
Instance 2: Confidence=0.9205
Instance 3: Confidence=0.8957
Instance 4: Confidence=0.7199
Instance 5: Confidence=0.6674
Instance 6: Confidence=0.4065
tmp min: tensor(0.) tmp max: tensor(1.)
239 64 540 960
There are 18 prompts
current IoU is: 0.8717673420906067
Seok, iteration idx= 8 IoU = tensor(0.8718)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.4ms
Speed: 2.9ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 7
Instance 0: Confidence=0.9433
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.9262
Instance 3: Confidence=0.9099
Instance 4: Confidence=0.9046
Instance 5: Confidence=0.7494
Instance 6: Confidence=0.2752
tmp min: tensor(0.) tmp max: tensor(1.)
252 52 540 960
current IoU is: 0.7894835472106934
Seok, iteration idx= 9 IoU = tensor(0.7895)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 3.0ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9436
Instance 2: Confidence=0.9257
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9060
Instance 5: Confidence=0.4599
tmp min: tensor(0.) tmp max: tensor(1.)
242 56 540 960
There are 13 prompts
current IoU is: 0.2445913404226303
Seok, iteration idx= 10 IoU = tensor(0.2446)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.4ms
Speed: 2.4ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9418
Instance 2: Confidence=0.9267
Instance 3: Confidence=0.9179
Instance 4: Confidence=0.8670
tmp min: tensor(0.) tmp max: tensor(1.)
276 12 540 960
There are 17 prompts
current IoU is: 0.0030597292352467775
Seok, iteration idx= 11 IoU = tensor(0.0031)
SKIP, unacceptable sam prediction, IoU is tensor(0.0031)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 2.6ms preprocess, 23.9ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9559
Instance 1: Confidence=0.9546
Instance 2: Confidence=0.9364
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.8237
Instance 5: Confidence=0.3776
tmp min: tensor(0.) tmp max: tensor(1.)
302 76 540 960
There are 19 prompts
current IoU is: 0.6606088876724243
Seok, iteration idx= 12 IoU = tensor(0.6606)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.5ms
Speed: 2.3ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 8
Instance 0: Confidence=0.9478
Instance 1: Confidence=0.9216
Instance 2: Confidence=0.9111
Instance 3: Confidence=0.8634
Instance 4: Confidence=0.7675
Instance 5: Confidence=0.6778
Instance 6: Confidence=0.3866
Instance 7: Confidence=0.3368
tmp min: tensor(0.) tmp max: tensor(1.)
296 64 540 960
current IoU is: 0.8606256246566772
Seok, iteration idx= 13 IoU = tensor(0.8606)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 3.3ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9418
Instance 2: Confidence=0.9238
Instance 3: Confidence=0.9103
Instance 4: Confidence=0.8137
Instance 5: Confidence=0.3678
tmp min: tensor(0.) tmp max: tensor(1.)
319 84 540 960
There are 17 prompts
current IoU is: 0.8756804466247559
Seok, iteration idx= 14 IoU = tensor(0.8757)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 2.5ms preprocess, 22.9ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9432
Instance 1: Confidence=0.9382
Instance 2: Confidence=0.9229
Instance 3: Confidence=0.9166
Instance 4: Confidence=0.8470
Instance 5: Confidence=0.8422
tmp min: tensor(0.) tmp max: tensor(1.)
339 100 540 960
There are 15 prompts
current IoU is: 0.8047631978988647
Seok, iteration idx= 15 IoU = tensor(0.8048)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.8ms
Speed: 2.7ms preprocess, 21.8ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9398
Instance 1: Confidence=0.9287
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.8930
Instance 4: Confidence=0.8873
tmp min: tensor(0.) tmp max: tensor(1.)
368 128 540 960
There are 14 prompts
current IoU is: 0.011090810410678387
Seok, iteration idx= 16 IoU = tensor(0.0111)
SKIP, unacceptable sam prediction, IoU is tensor(0.0111)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 2.7ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9306
Instance 1: Confidence=0.9305
Instance 2: Confidence=0.9199
Instance 3: Confidence=0.9194
Instance 4: Confidence=0.9074
Instance 5: Confidence=0.8918
tmp min: tensor(0.) tmp max: tensor(1.)
625 100 540 960
There are 15 prompts
current IoU is: 0.919603705406189
Seok, iteration idx= 17 IoU = tensor(0.9196)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 3.4ms preprocess, 22.9ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9305
Instance 1: Confidence=0.9276
Instance 2: Confidence=0.9191
Instance 3: Confidence=0.8996
Instance 4: Confidence=0.8552
Instance 5: Confidence=0.8230
tmp min: tensor(0.) tmp max: tensor(1.)
655 76 540 960
There are 15 prompts
current IoU is: 0.9393420219421387
Seok, iteration idx= 18 IoU = tensor(0.9393)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.5ms
Speed: 2.6ms preprocess, 22.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 8
Instance 0: Confidence=0.9374
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9352
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.5537
Instance 5: Confidence=0.3907
Instance 6: Confidence=0.3726
Instance 7: Confidence=0.3383
tmp min: tensor(0.) tmp max: tensor(1.)
686 68 540 960
There are 15 prompts
current IoU is: 0.9415616989135742
Seok, iteration idx= 19 IoU = tensor(0.9416)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 2.8ms preprocess, 23.4ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 5
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9308
Instance 2: Confidence=0.9301
Instance 3: Confidence=0.9154
Instance 4: Confidence=0.8041
tmp min: tensor(0.) tmp max: tensor(1.)
672 64 540 960
There are 14 prompts
current IoU is: 0.9431688785552979
Seok, iteration idx= 20 IoU = tensor(0.9432)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 2.7ms preprocess, 23.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9390
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9113
Instance 3: Confidence=0.9079
Instance 4: Confidence=0.8845
tmp min: tensor(0.) tmp max: tensor(1.)
692 44 540 960
There are 14 prompts
current IoU is: 0.9526183605194092
Seok, iteration idx= 21 IoU = tensor(0.9526)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 2.4ms preprocess, 22.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9429
Instance 1: Confidence=0.9358
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.8998
Instance 4: Confidence=0.8047
Instance 5: Confidence=0.7897
tmp min: tensor(0.) tmp max: tensor(1.)
721 36 540 960
There are 15 prompts
current IoU is: 0.9479678869247437
Seok, iteration idx= 22 IoU = tensor(0.9480)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 4.3ms preprocess, 22.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9544
Instance 1: Confidence=0.9382
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.9165
Instance 4: Confidence=0.9129
tmp min: tensor(0.) tmp max: tensor(1.)
700 28 540 960
There are 16 prompts
current IoU is: 0.9503806829452515
Seok, iteration idx= 23 IoU = tensor(0.9504)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 2.7ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9328
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.9281
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8874
Instance 5: Confidence=0.8685
tmp min: tensor(0.) tmp max: tensor(1.)
678 12 540 960
There are 16 prompts
current IoU is: 0.9400008320808411
Seok, iteration idx= 24 IoU = tensor(0.9400)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.1ms
Speed: 3.4ms preprocess, 22.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 7
Instance 0: Confidence=0.9443
Instance 1: Confidence=0.9263
Instance 2: Confidence=0.9112
Instance 3: Confidence=0.8529
Instance 4: Confidence=0.7917
Instance 5: Confidence=0.5320
Instance 6: Confidence=0.4048
tmp min: tensor(0.) tmp max: tensor(1.)
691 52 540 960
There are 14 prompts
current IoU is: 0.9205098748207092
Seok, iteration idx= 25 IoU = tensor(0.9205)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 8
Instance 0: Confidence=0.9391
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9228
Instance 3: Confidence=0.8782
Instance 4: Confidence=0.6843
Instance 5: Confidence=0.5397
Instance 6: Confidence=0.5218
Instance 7: Confidence=0.3399
tmp min: tensor(0.) tmp max: tensor(1.)
639 52 540 960
There are 14 prompts
current IoU is: 0.9304460883140564
Seok, iteration idx= 26 IoU = tensor(0.9304)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.3ms preprocess, 22.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9437
Instance 1: Confidence=0.9314
Instance 2: Confidence=0.9091
Instance 3: Confidence=0.8747
Instance 4: Confidence=0.8331
tmp min: tensor(0.) tmp max: tensor(1.)
634 84 540 960
There are 17 prompts
current IoU is: 0.946799099445343
Seok, iteration idx= 27 IoU = tensor(0.9468)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9220
Instance 1: Confidence=0.9218
Instance 2: Confidence=0.9069
Instance 3: Confidence=0.9049
Instance 4: Confidence=0.9018
Instance 5: Confidence=0.8183
tmp min: tensor(0.) tmp max: tensor(1.)
609 48 540 960
There are 14 prompts
current IoU is: 0.9678401350975037
Seok, iteration idx= 28 IoU = tensor(0.9678)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.3ms preprocess, 22.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.8996
Instance 3: Confidence=0.8888
Instance 4: Confidence=0.8676
tmp min: tensor(0.) tmp max: tensor(1.)
550 40 540 960
There are 14 prompts
current IoU is: 0.9647716879844666
Seok, iteration idx= 29 IoU = tensor(0.9648)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.3ms preprocess, 23.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9476
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.8890
Instance 3: Confidence=0.8363
Instance 4: Confidence=0.8338
tmp min: tensor(0.) tmp max: tensor(1.)
505 16 540 960
There are 15 prompts
current IoU is: 0.9614267945289612
Seok, iteration idx= 30 IoU = tensor(0.9614)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9144
Instance 2: Confidence=0.9064
Instance 3: Confidence=0.9036
Instance 4: Confidence=0.8918
Instance 5: Confidence=0.8164
tmp min: tensor(0.) tmp max: tensor(1.)
437 24 540 960
There are 11 prompts
current IoU is: 0.9586910605430603
Seok, iteration idx= 31 IoU = tensor(0.9587)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set3_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set3_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:41<00:00,  1.31s/it]
Testing psnr 28.415960296988487 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set3_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:28<00:00,  1.13it/s]
Testing psnr 3.3448806405067444 (avg)
train: coarse segmentation in 00:09:23
train: finish (eps time 00:09:23 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set3_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set4/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 35.62it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set4 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set4
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set4_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.5ms
Speed: 2.7ms preprocess, 19.5ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.2ms
Speed: 1.2ms preprocess, 19.2ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.6ms
Speed: 1.2ms preprocess, 20.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.9ms
Speed: 1.2ms preprocess, 19.9ms inference, 0.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.2ms
Speed: 1.6ms preprocess, 20.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 1.4ms preprocess, 20.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 1.3ms preprocess, 20.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 1.2ms preprocess, 20.0ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.9ms
Speed: 1.2ms preprocess, 19.9ms inference, 3.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.8ms
Speed: 1.3ms preprocess, 19.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.1ms
Speed: 1.4ms preprocess, 20.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.7ms
Speed: 1.4ms preprocess, 19.7ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.2ms
Speed: 1.2ms preprocess, 20.2ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.9ms
Speed: 1.2ms preprocess, 19.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.3ms
Speed: 1.2ms preprocess, 20.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.8ms
Speed: 1.4ms preprocess, 19.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.6ms
Speed: 1.3ms preprocess, 20.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.4ms
Speed: 1.3ms preprocess, 19.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.1ms
Speed: 1.2ms preprocess, 20.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.7ms
Speed: 1.3ms preprocess, 19.7ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.6ms
Speed: 1.2ms preprocess, 19.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.5ms
Speed: 1.3ms preprocess, 19.5ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.1ms
Speed: 1.2ms preprocess, 19.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.7ms
Speed: 1.3ms preprocess, 19.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.1ms
Speed: 1.3ms preprocess, 20.1ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.9ms
Speed: 1.2ms preprocess, 19.9ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.2ms
Speed: 1.2ms preprocess, 20.2ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.2ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.4ms
Speed: 1.3ms preprocess, 19.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 10 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 10 persons, 21.7ms
Speed: 2.6ms preprocess, 21.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 31
view_order: [36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 1.2ms preprocess, 20.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9310
Instance 1: Confidence=0.9039
Instance 2: Confidence=0.8684
Instance 3: Confidence=0.8642
Instance 4: Confidence=0.8209
Instance 5: Confidence=0.6953
Selected instance: 5 (Confidence: 0.6953)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

608 260 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.1425328254699707
Seok, iteration idx= 1 IoU = tensor(0.1425)
SKIP, unacceptable sam prediction, IoU is tensor(0.1425)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.5ms
Speed: 1.7ms preprocess, 22.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 7
Instance 0: Confidence=0.9402
Instance 1: Confidence=0.9144
Instance 2: Confidence=0.9030
Instance 3: Confidence=0.8917
Instance 4: Confidence=0.8304
Instance 5: Confidence=0.7796
Instance 6: Confidence=0.4827
Selected instance: 1 (Confidence: 0.9144)
tmp min: tensor(0.) tmp max: tensor(1.)
625 252 540 960
There are 14 prompts
current IoU is: 0.17578795552253723
Seok, iteration idx= 2 IoU = tensor(0.1758)
SKIP, unacceptable sam prediction, IoU is tensor(0.1758)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.9ms
Speed: 3.0ms preprocess, 21.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9453
Instance 1: Confidence=0.9352
Instance 2: Confidence=0.9312
Instance 3: Confidence=0.8691
Instance 4: Confidence=0.4903
Selected instance: 1 (Confidence: 0.9352)
tmp min: tensor(0.) tmp max: tensor(1.)
637 260 540 960
There are 15 prompts
current IoU is: 0.16892147064208984
Seok, iteration idx= 3 IoU = tensor(0.1689)
SKIP, unacceptable sam prediction, IoU is tensor(0.1689)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 2.5ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9379
Instance 2: Confidence=0.9213
Instance 3: Confidence=0.9213
Instance 4: Confidence=0.8837
Selected instance: 1 (Confidence: 0.9379)
tmp min: tensor(0.) tmp max: tensor(1.)
612 268 540 960
There are 13 prompts
current IoU is: 0.19151172041893005
Seok, iteration idx= 4 IoU = tensor(0.1915)
SKIP, unacceptable sam prediction, IoU is tensor(0.1915)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.0ms
Speed: 2.4ms preprocess, 23.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 8
Instance 0: Confidence=0.9402
Instance 1: Confidence=0.9296
Instance 2: Confidence=0.9254
Instance 3: Confidence=0.9197
Instance 4: Confidence=0.8924
Instance 5: Confidence=0.5797
Instance 6: Confidence=0.4707
Instance 7: Confidence=0.2998
Selected instance: 0 (Confidence: 0.9402)
tmp min: tensor(0.) tmp max: tensor(1.)
624 264 540 960
There are 14 prompts
current IoU is: 0.202391117811203
Seok, iteration idx= 5 IoU = tensor(0.2024)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 3.0ms preprocess, 22.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9301
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.9115
Instance 4: Confidence=0.8082
Instance 5: Confidence=0.7248
Selected instance: 0 (Confidence: 0.9431)
tmp min: tensor(0.) tmp max: tensor(1.)
653 260 540 960
There are 13 prompts
current IoU is: 0.8610147833824158
Seok, iteration idx= 6 IoU = tensor(0.8610)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 2.9ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9404
Instance 2: Confidence=0.9285
Instance 3: Confidence=0.9185
Instance 4: Confidence=0.8826
Selected instance: 0 (Confidence: 0.9518)
tmp min: tensor(0.) tmp max: tensor(1.)
630 264 540 960
There are 14 prompts
current IoU is: 0.8185192942619324
Seok, iteration idx= 7 IoU = tensor(0.8185)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.9ms
Speed: 4.2ms preprocess, 21.9ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9306
Instance 2: Confidence=0.9102
Instance 3: Confidence=0.9030
Instance 4: Confidence=0.8677
Instance 5: Confidence=0.8433
Selected instance: 0 (Confidence: 0.9489)
tmp min: tensor(0.) tmp max: tensor(1.)
613 264 540 960
There are 15 prompts
current IoU is: 0.8191987872123718
Seok, iteration idx= 8 IoU = tensor(0.8192)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 1.4ms preprocess, 22.3ms inference, 3.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9367
Instance 2: Confidence=0.8905
Instance 3: Confidence=0.8844
Instance 4: Confidence=0.8646
Instance 5: Confidence=0.2912
Selected instance: 5 (Confidence: 0.2912)
tmp min: tensor(0.) tmp max: tensor(1.)
280 336 540 960
There are 19 prompts
current IoU is: 0.5894149541854858
Seok, iteration idx= 9 IoU = tensor(0.5894)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9527
Instance 1: Confidence=0.9436
Instance 2: Confidence=0.9006
Instance 3: Confidence=0.8998
Instance 4: Confidence=0.8845
Instance 5: Confidence=0.4642
Selected instance: 5 (Confidence: 0.4642)
tmp min: tensor(0.) tmp max: tensor(1.)
362 360 540 960
There are 18 prompts
current IoU is: 0.5673850178718567
Seok, iteration idx= 10 IoU = tensor(0.5674)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 8
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9309
Instance 2: Confidence=0.9081
Instance 3: Confidence=0.7502
Instance 4: Confidence=0.7004
Instance 5: Confidence=0.4914
Instance 6: Confidence=0.4399
Instance 7: Confidence=0.2941
Selected instance: 5 (Confidence: 0.4914)
tmp min: tensor(0.) tmp max: tensor(1.)
343 252 540 960
There are 19 prompts
current IoU is: 0.45651736855506897
Seok, iteration idx= 11 IoU = tensor(0.4565)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.3ms preprocess, 23.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9470
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.8950
Instance 4: Confidence=0.8500
Selected instance: 4 (Confidence: 0.8500)
tmp min: tensor(0.) tmp max: tensor(1.)
323 248 540 960
There are 14 prompts
current IoU is: 0.7434493899345398
Seok, iteration idx= 12 IoU = tensor(0.7434)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.8ms
Speed: 1.3ms preprocess, 21.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 7
Instance 0: Confidence=0.9433
Instance 1: Confidence=0.9295
Instance 2: Confidence=0.9015
Instance 3: Confidence=0.8754
Instance 4: Confidence=0.8475
Instance 5: Confidence=0.5789
Instance 6: Confidence=0.4633
Selected instance: 3 (Confidence: 0.8754)
tmp min: tensor(0.) tmp max: tensor(1.)
325 252 540 960
There are 11 prompts
current IoU is: 0.6999055743217468
Seok, iteration idx= 13 IoU = tensor(0.6999)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9409
Instance 1: Confidence=0.9153
Instance 2: Confidence=0.9146
Instance 3: Confidence=0.8973
Instance 4: Confidence=0.6037
Instance 5: Confidence=0.4515
Instance 6: Confidence=0.2713
Selected instance: 4 (Confidence: 0.6037)
tmp min: tensor(0.) tmp max: tensor(1.)
341 312 540 960
There are 12 prompts
current IoU is: 0.8423953056335449
Seok, iteration idx= 14 IoU = tensor(0.8424)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.3ms preprocess, 22.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9345
Instance 1: Confidence=0.9176
Instance 2: Confidence=0.9114
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8976
Selected instance: 2 (Confidence: 0.9114)
tmp min: tensor(0.) tmp max: tensor(1.)
494 96 540 960
There are 15 prompts
current IoU is: 0.004225924611091614
Seok, iteration idx= 15 IoU = tensor(0.0042)
SKIP, unacceptable sam prediction, IoU is tensor(0.0042)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9384
Instance 2: Confidence=0.9249
Instance 3: Confidence=0.9049
Instance 4: Confidence=0.8864
Selected instance: 4 (Confidence: 0.8864)
tmp min: tensor(0.) tmp max: tensor(1.)
500 128 540 960
There are 14 prompts
current IoU is: 0.012369172647595406
Seok, iteration idx= 16 IoU = tensor(0.0124)
SKIP, unacceptable sam prediction, IoU is tensor(0.0124)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9491
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9331
Instance 3: Confidence=0.9178
Instance 4: Confidence=0.9059
Instance 5: Confidence=0.8131
Selected instance: 0 (Confidence: 0.9491)
tmp min: tensor(0.) tmp max: tensor(1.)
620 288 540 960
There are 14 prompts
current IoU is: 0.8484559655189514
Seok, iteration idx= 17 IoU = tensor(0.8485)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9408
Instance 2: Confidence=0.9396
Instance 3: Confidence=0.9338
Instance 4: Confidence=0.9225
Instance 5: Confidence=0.4237
Selected instance: 2 (Confidence: 0.9396)
tmp min: tensor(0.) tmp max: tensor(1.)
582 284 540 960
There are 13 prompts
current IoU is: 0.8685490489006042
Seok, iteration idx= 18 IoU = tensor(0.8685)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.3ms preprocess, 23.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9320
Instance 1: Confidence=0.9259
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.9090
Instance 4: Confidence=0.9060
Selected instance: 1 (Confidence: 0.9259)
tmp min: tensor(0.) tmp max: tensor(1.)
582 312 540 960
There are 13 prompts
current IoU is: 0.9109050631523132
Seok, iteration idx= 19 IoU = tensor(0.9109)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.8ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9356
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9268
Instance 3: Confidence=0.9164
Instance 4: Confidence=0.8873
Instance 5: Confidence=0.8672
Selected instance: 0 (Confidence: 0.9356)
tmp min: tensor(0.) tmp max: tensor(1.)
559 300 540 960
There are 14 prompts
current IoU is: 0.8943745493888855
Seok, iteration idx= 20 IoU = tensor(0.8944)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.3ms preprocess, 22.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9388
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9012
Instance 3: Confidence=0.8933
Instance 4: Confidence=0.8737
Selected instance: 1 (Confidence: 0.9303)
tmp min: tensor(0.) tmp max: tensor(1.)
529 296 540 960
There are 13 prompts
current IoU is: 0.8702873587608337
Seok, iteration idx= 21 IoU = tensor(0.8703)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 7
Instance 0: Confidence=0.9264
Instance 1: Confidence=0.9138
Instance 2: Confidence=0.9107
Instance 3: Confidence=0.8424
Instance 4: Confidence=0.8102
Instance 5: Confidence=0.7175
Instance 6: Confidence=0.7047
Selected instance: 2 (Confidence: 0.9107)
tmp min: tensor(0.) tmp max: tensor(1.)
500 292 540 960
There are 14 prompts
current IoU is: 0.9087895750999451
Seok, iteration idx= 22 IoU = tensor(0.9088)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9346
Instance 1: Confidence=0.9336
Instance 2: Confidence=0.9319
Instance 3: Confidence=0.9087
Instance 4: Confidence=0.8680
Selected instance: 2 (Confidence: 0.9319)
tmp min: tensor(0.) tmp max: tensor(1.)
449 312 540 960
There are 15 prompts
current IoU is: 0.9376970529556274
Seok, iteration idx= 23 IoU = tensor(0.9377)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 7
Instance 0: Confidence=0.9481
Instance 1: Confidence=0.9315
Instance 2: Confidence=0.9225
Instance 3: Confidence=0.9042
Instance 4: Confidence=0.8958
Instance 5: Confidence=0.6956
Instance 6: Confidence=0.3838
Selected instance: 1 (Confidence: 0.9315)
tmp min: tensor(0.) tmp max: tensor(1.)
453 320 540 960
There are 13 prompts
current IoU is: 0.9035523533821106
Seok, iteration idx= 24 IoU = tensor(0.9036)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9402
Instance 2: Confidence=0.9388
Instance 3: Confidence=0.9054
Instance 4: Confidence=0.8651
Selected instance: 1 (Confidence: 0.9402)
tmp min: tensor(0.) tmp max: tensor(1.)
428 292 540 960
There are 15 prompts
current IoU is: 0.9228817224502563
Seok, iteration idx= 25 IoU = tensor(0.9229)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.3ms preprocess, 23.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9414
Instance 1: Confidence=0.9324
Instance 2: Confidence=0.9207
Instance 3: Confidence=0.9081
Instance 4: Confidence=0.9032
Instance 5: Confidence=0.6914
Selected instance: 1 (Confidence: 0.9324)
tmp min: tensor(0.) tmp max: tensor(1.)
378 312 540 960
There are 13 prompts
current IoU is: 0.93074631690979
Seok, iteration idx= 26 IoU = tensor(0.9307)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9473
Instance 2: Confidence=0.8913
Instance 3: Confidence=0.8832
Instance 4: Confidence=0.8511
Instance 5: Confidence=0.4380
Selected instance: 0 (Confidence: 0.9510)
tmp min: tensor(0.) tmp max: tensor(1.)
365 276 540 960
There are 14 prompts
current IoU is: 0.904874324798584
Seok, iteration idx= 27 IoU = tensor(0.9049)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.3ms preprocess, 23.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9522
Instance 1: Confidence=0.9410
Instance 2: Confidence=0.9127
Instance 3: Confidence=0.7607
Instance 4: Confidence=0.3358
Selected instance: 1 (Confidence: 0.9410)
tmp min: tensor(0.) tmp max: tensor(1.)
346 276 540 960
There are 13 prompts
current IoU is: 0.913496196269989
Seok, iteration idx= 28 IoU = tensor(0.9135)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.2ms
Speed: 1.3ms preprocess, 23.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 8
Instance 0: Confidence=0.9434
Instance 1: Confidence=0.9339
Instance 2: Confidence=0.9202
Instance 3: Confidence=0.8963
Instance 4: Confidence=0.8529
Instance 5: Confidence=0.8451
Instance 6: Confidence=0.3002
Instance 7: Confidence=0.2701
Selected instance: 1 (Confidence: 0.9339)
tmp min: tensor(0.) tmp max: tensor(1.)
325 320 540 960
There are 12 prompts
current IoU is: 0.9476760625839233
Seok, iteration idx= 29 IoU = tensor(0.9477)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9313
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8973
Instance 4: Confidence=0.5839
Instance 5: Confidence=0.4561
Selected instance: 5 (Confidence: 0.4561)
tmp min: tensor(0.) tmp max: tensor(1.)
308 300 540 960
There are 16 prompts
current IoU is: 0.9187896251678467
Seok, iteration idx= 30 IoU = tensor(0.9188)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.4ms
Speed: 2.9ms preprocess, 22.4ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 7
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9330
Instance 3: Confidence=0.5783
Instance 4: Confidence=0.4017
Instance 5: Confidence=0.3446
Instance 6: Confidence=0.2606
Selected instance: 5 (Confidence: 0.3446)
tmp min: tensor(0.) tmp max: tensor(1.)
290 316 540 960
There are 17 prompts
current IoU is: 0.9374321699142456
Seok, iteration idx= 31 IoU = tensor(0.9374)
Selected Instance Confidence List: [tensor(0.6370), tensor(0.3724, device='cpu'), tensor(0.4712, device='cpu'), tensor(0.4754, device='cpu'), tensor(0.4901, device='cpu'), tensor(0.4975, device='cpu'), tensor(0.8938, device='cpu'), tensor(0.8718, device='cpu'), tensor(0.8711, device='cpu'), tensor(0.4701, device='cpu'), tensor(0.5261, device='cpu'), tensor(0.4705, device='cpu'), tensor(0.7861, device='cpu'), tensor(0.7701, device='cpu'), tensor(0.7469, device='cpu'), tensor(0.3738, device='cpu'), tensor(0.3778, device='cpu'), tensor(0.8887, device='cpu'), tensor(0.8970, device='cpu'), tensor(0.9169, device='cpu'), tensor(0.9109, device='cpu'), tensor(0.8943, device='cpu'), tensor(0.9096, device='cpu'), tensor(0.9354, device='cpu'), tensor(0.9147, device='cpu'), tensor(0.9298, device='cpu'), tensor(0.9314, device='cpu'), tensor(0.9233, device='cpu'), tensor(0.9245, device='cpu'), tensor(0.9422, device='cpu'), tensor(0.7844, device='cpu'), tensor(0.7030, device='cpu')]
Sorted Confidence Order: [tensor(0.9422, device='cpu'), tensor(0.9245, device='cpu'), tensor(0.9233, device='cpu'), tensor(0.9314, device='cpu'), tensor(0.9298, device='cpu'), tensor(0.9147, device='cpu'), tensor(0.9354, device='cpu'), tensor(0.9096, device='cpu'), tensor(0.8943, device='cpu'), tensor(0.9109, device='cpu'), tensor(0.9169, device='cpu'), tensor(0.8970, device='cpu'), tensor(0.8887, device='cpu'), tensor(0.8711, device='cpu'), tensor(0.8718, device='cpu'), tensor(0.8938, device='cpu'), tensor(0.4975, device='cpu'), tensor(0.4901, device='cpu'), tensor(0.4754, device='cpu'), tensor(0.4712, device='cpu'), tensor(0.3724, device='cpu'), tensor(0.3778, device='cpu'), tensor(0.3738, device='cpu'), tensor(0.7469, device='cpu'), tensor(0.7701, device='cpu'), tensor(0.7861, device='cpu'), tensor(0.4705, device='cpu'), tensor(0.5261, device='cpu'), tensor(0.4701, device='cpu'), tensor(0.6370), tensor(0.7030, device='cpu'), tensor(0.7844, device='cpu')]
sorted_indices: [29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15, 14, 13, 12, 11, 10, 9, 0, 31, 30]
Initial view (highest confidence): 34
New training order: [33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15, 14, 13, 12, 11, 10, 9, 36, 35, 34]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.5ms
Speed: 1.5ms preprocess, 20.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 2.5ms preprocess, 22.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9522
Instance 1: Confidence=0.9410
Instance 2: Confidence=0.9127
Instance 3: Confidence=0.7607
Instance 4: Confidence=0.3358
tmp min: tensor(0.) tmp max: tensor(1.)
346 276 540 960
There are 13 prompts
current IoU is: 0.9458841681480408
Seok, iteration idx= 1 IoU = tensor(0.9459)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 2.9ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9473
Instance 2: Confidence=0.8913
Instance 3: Confidence=0.8832
Instance 4: Confidence=0.8511
Instance 5: Confidence=0.4380
tmp min: tensor(0.) tmp max: tensor(1.)
365 276 540 960
There are 14 prompts
current IoU is: 0.9390001893043518
Seok, iteration idx= 2 IoU = tensor(0.9390)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 2.8ms preprocess, 22.8ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 6
Instance 0: Confidence=0.9414
Instance 1: Confidence=0.9324
Instance 2: Confidence=0.9207
Instance 3: Confidence=0.9081
Instance 4: Confidence=0.9032
Instance 5: Confidence=0.6914
tmp min: tensor(0.) tmp max: tensor(1.)
378 312 540 960
There are 13 prompts
current IoU is: 0.9383339881896973
Seok, iteration idx= 3 IoU = tensor(0.9383)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 2.5ms preprocess, 22.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9402
Instance 2: Confidence=0.9388
Instance 3: Confidence=0.9054
Instance 4: Confidence=0.8651
tmp min: tensor(0.) tmp max: tensor(1.)
428 292 540 960
There are 15 prompts
current IoU is: 0.9517706632614136
Seok, iteration idx= 4 IoU = tensor(0.9518)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.5ms
Speed: 3.4ms preprocess, 22.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 7
Instance 0: Confidence=0.9481
Instance 1: Confidence=0.9315
Instance 2: Confidence=0.9225
Instance 3: Confidence=0.9042
Instance 4: Confidence=0.8958
Instance 5: Confidence=0.6956
Instance 6: Confidence=0.3838
tmp min: tensor(0.) tmp max: tensor(1.)
453 320 540 960
There are 13 prompts
current IoU is: 0.9145070910453796
Seok, iteration idx= 5 IoU = tensor(0.9145)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 2.6ms preprocess, 23.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9346
Instance 1: Confidence=0.9336
Instance 2: Confidence=0.9319
Instance 3: Confidence=0.9087
Instance 4: Confidence=0.8680
tmp min: tensor(0.) tmp max: tensor(1.)
449 312 540 960
There are 15 prompts
current IoU is: 0.9606144428253174
Seok, iteration idx= 6 IoU = tensor(0.9606)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.9ms
Speed: 2.8ms preprocess, 23.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9264
Instance 1: Confidence=0.9138
Instance 2: Confidence=0.9107
Instance 3: Confidence=0.8424
Instance 4: Confidence=0.8102
Instance 5: Confidence=0.7175
Instance 6: Confidence=0.7047
tmp min: tensor(0.) tmp max: tensor(1.)
500 292 540 960
There are 14 prompts
current IoU is: 0.9205776453018188
Seok, iteration idx= 7 IoU = tensor(0.9206)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 2.8ms preprocess, 22.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9388
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9012
Instance 3: Confidence=0.8933
Instance 4: Confidence=0.8737
tmp min: tensor(0.) tmp max: tensor(1.)
529 296 540 960
There are 13 prompts
current IoU is: 0.8875548243522644
Seok, iteration idx= 8 IoU = tensor(0.8876)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 2.5ms preprocess, 23.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9356
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9268
Instance 3: Confidence=0.9164
Instance 4: Confidence=0.8873
Instance 5: Confidence=0.8672
tmp min: tensor(0.) tmp max: tensor(1.)
559 300 540 960
There are 14 prompts
current IoU is: 0.9669054746627808
Seok, iteration idx= 9 IoU = tensor(0.9669)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9320
Instance 1: Confidence=0.9259
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.9090
Instance 4: Confidence=0.9060
tmp min: tensor(0.) tmp max: tensor(1.)
582 312 540 960
There are 13 prompts
current IoU is: 0.9554300904273987
Seok, iteration idx= 10 IoU = tensor(0.9554)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 1.3ms preprocess, 22.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9408
Instance 2: Confidence=0.9396
Instance 3: Confidence=0.9338
Instance 4: Confidence=0.9225
Instance 5: Confidence=0.4237
tmp min: tensor(0.) tmp max: tensor(1.)
582 284 540 960
There are 13 prompts
current IoU is: 0.9577874541282654
Seok, iteration idx= 11 IoU = tensor(0.9578)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9491
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9331
Instance 3: Confidence=0.9178
Instance 4: Confidence=0.9059
Instance 5: Confidence=0.8131
tmp min: tensor(0.) tmp max: tensor(1.)
620 288 540 960
There are 14 prompts
current IoU is: 0.9506700038909912
Seok, iteration idx= 12 IoU = tensor(0.9507)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 2.8ms preprocess, 23.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9306
Instance 2: Confidence=0.9102
Instance 3: Confidence=0.9030
Instance 4: Confidence=0.8677
Instance 5: Confidence=0.8433
tmp min: tensor(0.) tmp max: tensor(1.)
613 264 540 960
There are 15 prompts
current IoU is: 0.9536808133125305
Seok, iteration idx= 13 IoU = tensor(0.9537)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 3.2ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9404
Instance 2: Confidence=0.9285
Instance 3: Confidence=0.9185
Instance 4: Confidence=0.8826
tmp min: tensor(0.) tmp max: tensor(1.)
630 264 540 960
There are 14 prompts
current IoU is: 0.9496515989303589
Seok, iteration idx= 14 IoU = tensor(0.9497)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 3.4ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9301
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.9115
Instance 4: Confidence=0.8082
Instance 5: Confidence=0.7248
tmp min: tensor(0.) tmp max: tensor(1.)
653 260 540 960
There are 13 prompts
current IoU is: 0.9520930647850037
Seok, iteration idx= 15 IoU = tensor(0.9521)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.2ms
Speed: 2.7ms preprocess, 23.2ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 8
Instance 0: Confidence=0.9402
Instance 1: Confidence=0.9296
Instance 2: Confidence=0.9254
Instance 3: Confidence=0.9197
Instance 4: Confidence=0.8924
Instance 5: Confidence=0.5797
Instance 6: Confidence=0.4707
Instance 7: Confidence=0.2998
tmp min: tensor(0.) tmp max: tensor(1.)
624 264 540 960
There are 14 prompts
current IoU is: 0.9571651220321655
Seok, iteration idx= 16 IoU = tensor(0.9572)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9379
Instance 2: Confidence=0.9213
Instance 3: Confidence=0.9213
Instance 4: Confidence=0.8837
tmp min: tensor(0.) tmp max: tensor(1.)
612 268 540 960
There are 13 prompts
current IoU is: 0.9554461240768433
Seok, iteration idx= 17 IoU = tensor(0.9554)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.3ms preprocess, 23.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9453
Instance 1: Confidence=0.9352
Instance 2: Confidence=0.9312
Instance 3: Confidence=0.8691
Instance 4: Confidence=0.4903
tmp min: tensor(0.) tmp max: tensor(1.)
637 260 540 960
There are 15 prompts
current IoU is: 0.9427825808525085
Seok, iteration idx= 18 IoU = tensor(0.9428)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 1.3ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9402
Instance 1: Confidence=0.9144
Instance 2: Confidence=0.9030
Instance 3: Confidence=0.8917
Instance 4: Confidence=0.8304
Instance 5: Confidence=0.7796
Instance 6: Confidence=0.4827
tmp min: tensor(0.) tmp max: tensor(1.)
625 252 540 960
There are 14 prompts
current IoU is: 0.9040743112564087
Seok, iteration idx= 19 IoU = tensor(0.9041)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9310
Instance 1: Confidence=0.9039
Instance 2: Confidence=0.8684
Instance 3: Confidence=0.8642
Instance 4: Confidence=0.8209
Instance 5: Confidence=0.6953
tmp min: tensor(0.) tmp max: tensor(1.)
608 260 540 960
There are 16 prompts
current IoU is: 0.8588073253631592
Seok, iteration idx= 20 IoU = tensor(0.8588)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9384
Instance 2: Confidence=0.9249
Instance 3: Confidence=0.9049
Instance 4: Confidence=0.8864
tmp min: tensor(0.) tmp max: tensor(1.)
365 124 540 960
There are 13 prompts
current IoU is: 0.0008698632009327412
Seok, iteration idx= 21 IoU = tensor(0.0009)
SKIP, unacceptable sam prediction, IoU is tensor(0.0009)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 2.1ms preprocess, 24.2ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9345
Instance 1: Confidence=0.9176
Instance 2: Confidence=0.9114
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8976
tmp min: tensor(0.) tmp max: tensor(1.)
318 84 540 960
There are 18 prompts
current IoU is: 0.002065932145342231
Seok, iteration idx= 22 IoU = tensor(0.0021)
SKIP, unacceptable sam prediction, IoU is tensor(0.0021)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.5ms
Speed: 1.5ms preprocess, 22.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 7
Instance 0: Confidence=0.9409
Instance 1: Confidence=0.9153
Instance 2: Confidence=0.9146
Instance 3: Confidence=0.8973
Instance 4: Confidence=0.6037
Instance 5: Confidence=0.4515
Instance 6: Confidence=0.2713
tmp min: tensor(0.) tmp max: tensor(1.)
341 312 540 960
There are 12 prompts
current IoU is: 0.9158626198768616
Seok, iteration idx= 23 IoU = tensor(0.9159)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 7
Instance 0: Confidence=0.9433
Instance 1: Confidence=0.9295
Instance 2: Confidence=0.9015
Instance 3: Confidence=0.8754
Instance 4: Confidence=0.8475
Instance 5: Confidence=0.5789
Instance 6: Confidence=0.4633
tmp min: tensor(0.) tmp max: tensor(1.)
325 252 540 960
There are 11 prompts
current IoU is: 0.9046052694320679
Seok, iteration idx= 24 IoU = tensor(0.9046)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9470
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.8950
Instance 4: Confidence=0.8500
tmp min: tensor(0.) tmp max: tensor(1.)
323 248 540 960
There are 14 prompts
current IoU is: 0.840912938117981
Seok, iteration idx= 25 IoU = tensor(0.8409)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.3ms
Speed: 2.3ms preprocess, 23.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 8
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9309
Instance 2: Confidence=0.9081
Instance 3: Confidence=0.7502
Instance 4: Confidence=0.7004
Instance 5: Confidence=0.4914
Instance 6: Confidence=0.4399
Instance 7: Confidence=0.2941
tmp min: tensor(0.) tmp max: tensor(1.)
343 252 540 960
There are 19 prompts
current IoU is: 0.668128490447998
Seok, iteration idx= 26 IoU = tensor(0.6681)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 2.5ms preprocess, 23.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9527
Instance 1: Confidence=0.9436
Instance 2: Confidence=0.9006
Instance 3: Confidence=0.8998
Instance 4: Confidence=0.8845
Instance 5: Confidence=0.4642
tmp min: tensor(0.) tmp max: tensor(1.)
362 360 540 960
There are 18 prompts
current IoU is: 0.7179529666900635
Seok, iteration idx= 27 IoU = tensor(0.7180)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 2.6ms preprocess, 22.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9367
Instance 2: Confidence=0.8905
Instance 3: Confidence=0.8844
Instance 4: Confidence=0.8646
Instance 5: Confidence=0.2912
tmp min: tensor(0.) tmp max: tensor(1.)
280 336 540 960
There are 19 prompts
current IoU is: 0.7651103734970093
Seok, iteration idx= 28 IoU = tensor(0.7651)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 10 persons, 23.0ms
Speed: 3.2ms preprocess, 23.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 10
Instance 0: Confidence=0.9473
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.6370
Instance 4: Confidence=0.5932
Instance 5: Confidence=0.5777
Instance 6: Confidence=0.4581
Instance 7: Confidence=0.3354
Instance 8: Confidence=0.3136
Instance 9: Confidence=0.2909
tmp min: tensor(0.) tmp max: tensor(1.)
281 348 540 960
There are 14 prompts
current IoU is: 0.9125305414199829
Seok, iteration idx= 29 IoU = tensor(0.9125)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9330
Instance 3: Confidence=0.5783
Instance 4: Confidence=0.4017
Instance 5: Confidence=0.3446
Instance 6: Confidence=0.2606
tmp min: tensor(0.) tmp max: tensor(1.)
290 316 540 960
There are 17 prompts
current IoU is: 0.9313725233078003
Seok, iteration idx= 30 IoU = tensor(0.9314)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9313
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8973
Instance 4: Confidence=0.5839
Instance 5: Confidence=0.4561
tmp min: tensor(0.) tmp max: tensor(1.)
308 300 540 960
There are 16 prompts
current IoU is: 0.9245251417160034
Seok, iteration idx= 31 IoU = tensor(0.9245)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set4_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set4_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:40<00:00,  1.27s/it]
Testing psnr 27.89732500910759 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set4_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.17it/s]
Testing psnr 3.1327708065509796 (avg)
train: coarse segmentation in 00:03:43
train: finish (eps time 00:03:44 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set4_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set5/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 47.11it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set5 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set5
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set5_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.8ms
Speed: 3.2ms preprocess, 20.8ms inference, 3.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.7ms
Speed: 1.5ms preprocess, 21.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.8ms
Speed: 1.5ms preprocess, 21.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.6ms
Speed: 1.5ms preprocess, 21.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.1ms
Speed: 1.4ms preprocess, 21.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.3ms
Speed: 1.4ms preprocess, 21.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.7ms
Speed: 1.6ms preprocess, 21.7ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.3ms
Speed: 1.5ms preprocess, 21.3ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.6ms
Speed: 1.3ms preprocess, 21.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.4ms
Speed: 1.6ms preprocess, 20.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.8ms
Speed: 1.3ms preprocess, 20.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.0ms
Speed: 1.4ms preprocess, 22.0ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.8ms
Speed: 1.3ms preprocess, 21.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.8ms
Speed: 1.2ms preprocess, 20.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.8ms
Speed: 1.3ms preprocess, 20.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.8ms
Speed: 1.3ms preprocess, 20.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.4ms
Speed: 1.6ms preprocess, 21.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 1.5ms preprocess, 20.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.3ms
Speed: 1.4ms preprocess, 21.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.0ms
Speed: 1.4ms preprocess, 21.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 1.5ms preprocess, 20.7ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 1.5ms preprocess, 20.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.7ms
Speed: 1.5ms preprocess, 20.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.6ms
Speed: 1.2ms preprocess, 20.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.1ms
Speed: 1.4ms preprocess, 21.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.9ms
Speed: 1.5ms preprocess, 20.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.6ms
Speed: 1.4ms preprocess, 20.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.6ms
Speed: 1.4ms preprocess, 20.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.3ms
Speed: 3.3ms preprocess, 21.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 24
view_order: [29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.5ms
Speed: 1.2ms preprocess, 20.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 7
Instance 0: Confidence=0.9386
Instance 1: Confidence=0.9359
Instance 2: Confidence=0.9328
Instance 3: Confidence=0.9221
Instance 4: Confidence=0.8036
Instance 5: Confidence=0.7507
Instance 6: Confidence=0.2664
Selected instance: 2 (Confidence: 0.9328)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

612 316 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 14 prompts
current IoU is: 0.8904517292976379
Seok, iteration idx= 1 IoU = tensor(0.8905)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.6ms preprocess, 22.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9552
Instance 1: Confidence=0.9328
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.9105
Instance 4: Confidence=0.8768
Instance 5: Confidence=0.6113
Selected instance: 2 (Confidence: 0.9321)
tmp min: tensor(0.) tmp max: tensor(1.)
579 288 540 960
There are 12 prompts
current IoU is: 0.8798791170120239
Seok, iteration idx= 2 IoU = tensor(0.8799)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.7ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9494
Instance 1: Confidence=0.9387
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.8958
Instance 4: Confidence=0.8815
Selected instance: 3 (Confidence: 0.8958)
tmp min: tensor(0.) tmp max: tensor(1.)
545 296 540 960
There are 13 prompts
current IoU is: 0.867403507232666
Seok, iteration idx= 3 IoU = tensor(0.8674)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9337
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.8928
Instance 3: Confidence=0.7319
Instance 4: Confidence=0.6180
Instance 5: Confidence=0.4375
Selected instance: 2 (Confidence: 0.8928)
tmp min: tensor(0.) tmp max: tensor(1.)
398 364 540 960
There are 18 prompts
current IoU is: 0.8650961518287659
Seok, iteration idx= 4 IoU = tensor(0.8651)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 7
Instance 0: Confidence=0.9374
Instance 1: Confidence=0.9284
Instance 2: Confidence=0.9260
Instance 3: Confidence=0.9164
Instance 4: Confidence=0.9091
Instance 5: Confidence=0.5029
Instance 6: Confidence=0.2646
Selected instance: 2 (Confidence: 0.9260)
tmp min: tensor(0.) tmp max: tensor(1.)
435 328 540 960
There are 11 prompts
current IoU is: 0.8481616377830505
Seok, iteration idx= 5 IoU = tensor(0.8482)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 1.3ms preprocess, 22.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9348
Instance 1: Confidence=0.9341
Instance 2: Confidence=0.9295
Instance 3: Confidence=0.9290
Instance 4: Confidence=0.9118
Instance 5: Confidence=0.5306
Selected instance: 1 (Confidence: 0.9341)
tmp min: tensor(0.) tmp max: tensor(1.)
447 332 540 960
There are 12 prompts
current IoU is: 0.9306122660636902
Seok, iteration idx= 6 IoU = tensor(0.9306)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.3ms
Speed: 1.4ms preprocess, 22.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9330
Instance 2: Confidence=0.9322
Instance 3: Confidence=0.9308
Instance 4: Confidence=0.8590
Instance 5: Confidence=0.5721
Instance 6: Confidence=0.3880
Selected instance: 3 (Confidence: 0.9308)
tmp min: tensor(0.) tmp max: tensor(1.)
388 320 540 960
There are 14 prompts
current IoU is: 0.9344073534011841
Seok, iteration idx= 7 IoU = tensor(0.9344)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9482
Instance 1: Confidence=0.9339
Instance 2: Confidence=0.9185
Instance 3: Confidence=0.7674
Instance 4: Confidence=0.4578
Instance 5: Confidence=0.4412
Instance 6: Confidence=0.4175
Selected instance: 6 (Confidence: 0.4175)
tmp min: tensor(0.) tmp max: tensor(1.)
498 244 540 960
There are 12 prompts
current IoU is: 0.4823128581047058
Seok, iteration idx= 8 IoU = tensor(0.4823)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.4ms
Speed: 3.4ms preprocess, 22.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 4
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9331
Instance 2: Confidence=0.9069
Instance 3: Confidence=0.5795
Selected instance: 3 (Confidence: 0.5795)
tmp min: tensor(0.) tmp max: tensor(1.)
525 236 540 960
There are 17 prompts
current IoU is: 0.45135852694511414
Seok, iteration idx= 9 IoU = tensor(0.4514)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.4ms
Speed: 2.9ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 4
Instance 0: Confidence=0.9524
Instance 1: Confidence=0.9516
Instance 2: Confidence=0.9286
Instance 3: Confidence=0.8979
Selected instance: 3 (Confidence: 0.8979)
tmp min: tensor(0.) tmp max: tensor(1.)
628 312 540 960
There are 15 prompts
current IoU is: 0.25191816687583923
Seok, iteration idx= 10 IoU = tensor(0.2519)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 3.4ms preprocess, 22.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9476
Instance 2: Confidence=0.8963
Instance 3: Confidence=0.8785
Instance 4: Confidence=0.8033
Selected instance: 3 (Confidence: 0.8785)
tmp min: tensor(0.) tmp max: tensor(1.)
574 272 540 960
There are 15 prompts
current IoU is: 0.4155412018299103
Seok, iteration idx= 11 IoU = tensor(0.4155)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 3.1ms preprocess, 23.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 7
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.7916
Instance 4: Confidence=0.7327
Instance 5: Confidence=0.4687
Instance 6: Confidence=0.2725
Selected instance: 2 (Confidence: 0.9337)
tmp min: tensor(0.) tmp max: tensor(1.)
594 264 540 960
There are 14 prompts
current IoU is: 0.5883422493934631
Seok, iteration idx= 12 IoU = tensor(0.5883)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 2.8ms preprocess, 22.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9520
Instance 1: Confidence=0.9453
Instance 2: Confidence=0.9338
Instance 3: Confidence=0.8405
Instance 4: Confidence=0.7673
Selected instance: 2 (Confidence: 0.9338)
tmp min: tensor(0.) tmp max: tensor(1.)
618 264 540 960
There are 14 prompts
current IoU is: 0.6124676465988159
Seok, iteration idx= 13 IoU = tensor(0.6125)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.1ms
Speed: 2.5ms preprocess, 22.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 8
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9499
Instance 2: Confidence=0.9467
Instance 3: Confidence=0.8013
Instance 4: Confidence=0.4372
Instance 5: Confidence=0.3440
Instance 6: Confidence=0.3215
Instance 7: Confidence=0.2739
Selected instance: 0 (Confidence: 0.9521)
tmp min: tensor(0.) tmp max: tensor(1.)
597 264 540 960
There are 15 prompts
current IoU is: 0.5619028806686401
Seok, iteration idx= 14 IoU = tensor(0.5619)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 3.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9465
Instance 2: Confidence=0.9439
Instance 3: Confidence=0.8874
Instance 4: Confidence=0.6249
Instance 5: Confidence=0.2727
Selected instance: 2 (Confidence: 0.9439)
tmp min: tensor(0.) tmp max: tensor(1.)
578 264 540 960
There are 13 prompts
current IoU is: 0.55924391746521
Seok, iteration idx= 15 IoU = tensor(0.5592)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 3.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9385
Instance 3: Confidence=0.9341
Instance 4: Confidence=0.9008
Instance 5: Confidence=0.6692
Selected instance: 2 (Confidence: 0.9385)
tmp min: tensor(0.) tmp max: tensor(1.)
434 296 540 960
There are 16 prompts
current IoU is: 0.9061924815177917
Seok, iteration idx= 16 IoU = tensor(0.9062)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9584
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9329
Instance 3: Confidence=0.9113
Instance 4: Confidence=0.8125
Instance 5: Confidence=0.5363
Selected instance: 2 (Confidence: 0.9329)
tmp min: tensor(0.) tmp max: tensor(1.)
327 300 540 960
There are 14 prompts
current IoU is: 0.915924072265625
Seok, iteration idx= 17 IoU = tensor(0.9159)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9408
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9217
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.7804
Instance 5: Confidence=0.3248
Selected instance: 1 (Confidence: 0.9361)
tmp min: tensor(0.) tmp max: tensor(1.)
312 284 540 960
There are 13 prompts
current IoU is: 0.9006170630455017
Seok, iteration idx= 18 IoU = tensor(0.9006)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.3ms preprocess, 23.0ms inference, 3.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9463
Instance 1: Confidence=0.9379
Instance 2: Confidence=0.9269
Instance 3: Confidence=0.9177
Instance 4: Confidence=0.8096
Instance 5: Confidence=0.5529
Selected instance: 2 (Confidence: 0.9269)
tmp min: tensor(0.) tmp max: tensor(1.)
299 285 540 960
There are 13 prompts
current IoU is: 0.8946298956871033
Seok, iteration idx= 19 IoU = tensor(0.8946)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 3.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9490
Instance 1: Confidence=0.9483
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9231
Instance 4: Confidence=0.6808
Instance 5: Confidence=0.6357
Selected instance: 5 (Confidence: 0.6357)
tmp min: tensor(0.) tmp max: tensor(1.)
281 280 540 960
There are 16 prompts
current IoU is: 0.8990744352340698
Seok, iteration idx= 20 IoU = tensor(0.8991)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 1.6ms preprocess, 22.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9424
Instance 1: Confidence=0.9364
Instance 2: Confidence=0.9296
Instance 3: Confidence=0.9162
Instance 4: Confidence=0.6830
Instance 5: Confidence=0.6813
Selected instance: 5 (Confidence: 0.6813)
tmp min: tensor(0.) tmp max: tensor(1.)
290 288 540 960
There are 14 prompts
current IoU is: 0.8969103693962097
Seok, iteration idx= 21 IoU = tensor(0.8969)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 2.9ms preprocess, 22.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9605
Instance 1: Confidence=0.9404
Instance 2: Confidence=0.9341
Instance 3: Confidence=0.9266
Instance 4: Confidence=0.9189
Selected instance: 2 (Confidence: 0.9341)
tmp min: tensor(0.) tmp max: tensor(1.)
290 284 540 960
There are 15 prompts
current IoU is: 0.8635095953941345
Seok, iteration idx= 22 IoU = tensor(0.8635)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 2.4ms preprocess, 23.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9216
Instance 3: Confidence=0.9211
Instance 4: Confidence=0.9179
Selected instance: 1 (Confidence: 0.9307)
tmp min: tensor(0.) tmp max: tensor(1.)
301 304 540 960
There are 14 prompts
current IoU is: 0.8277016282081604
Seok, iteration idx= 23 IoU = tensor(0.8277)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 2.4ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9499
Instance 1: Confidence=0.9476
Instance 2: Confidence=0.9344
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.7513
Instance 5: Confidence=0.3441
Selected instance: 1 (Confidence: 0.9476)
tmp min: tensor(0.) tmp max: tensor(1.)
588 284 540 960
There are 13 prompts
current IoU is: 0.5093085765838623
Seok, iteration idx= 24 IoU = tensor(0.5093)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 4.3ms preprocess, 22.6ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9454
Instance 1: Confidence=0.9376
Instance 2: Confidence=0.9193
Instance 3: Confidence=0.8833
Instance 4: Confidence=0.8594
Instance 5: Confidence=0.7986
Selected instance: 1 (Confidence: 0.9376)
tmp min: tensor(0.) tmp max: tensor(1.)
555 284 540 960
There are 14 prompts
current IoU is: 0.500076413154602
Seok, iteration idx= 25 IoU = tensor(0.5001)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 2.8ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9414
Instance 1: Confidence=0.9300
Instance 2: Confidence=0.8414
Instance 3: Confidence=0.7600
Instance 4: Confidence=0.7093
Instance 5: Confidence=0.6956
Selected instance: 0 (Confidence: 0.9414)
tmp min: tensor(0.) tmp max: tensor(1.)
565 308 540 960
There are 13 prompts
current IoU is: 0.472825288772583
Seok, iteration idx= 26 IoU = tensor(0.4728)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 2.7ms preprocess, 23.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9378
Instance 1: Confidence=0.9341
Instance 2: Confidence=0.9259
Instance 3: Confidence=0.9210
Instance 4: Confidence=0.9059
Selected instance: 2 (Confidence: 0.9259)
tmp min: tensor(0.) tmp max: tensor(1.)
541 296 540 960
There are 14 prompts
current IoU is: 0.35798653960227966
Seok, iteration idx= 27 IoU = tensor(0.3580)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.1ms
Speed: 2.8ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9140
Instance 3: Confidence=0.9125
Instance 4: Confidence=0.8638
Instance 5: Confidence=0.7469
Selected instance: 3 (Confidence: 0.9125)
tmp min: tensor(0.) tmp max: tensor(1.)
655 276 540 960
There are 14 prompts
current IoU is: 0.2917676568031311
Seok, iteration idx= 28 IoU = tensor(0.2918)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 2.8ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9382
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9224
Instance 3: Confidence=0.9112
Instance 4: Confidence=0.8582
Instance 5: Confidence=0.4778
Instance 6: Confidence=0.3251
Selected instance: 4 (Confidence: 0.8582)
tmp min: tensor(0.) tmp max: tensor(1.)
664 268 540 960
There are 12 prompts
current IoU is: 0.49023717641830444
Seok, iteration idx= 29 IoU = tensor(0.4902)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 2.4ms preprocess, 22.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9496
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9297
Instance 3: Confidence=0.9274
Instance 4: Confidence=0.9144
Instance 5: Confidence=0.3458
Selected instance: 2 (Confidence: 0.9297)
tmp min: tensor(0.) tmp max: tensor(1.)
542 292 540 960
There are 16 prompts
current IoU is: 0.6932600140571594
Seok, iteration idx= 30 IoU = tensor(0.6933)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 2.2ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9542
Instance 1: Confidence=0.9425
Instance 2: Confidence=0.9398
Instance 3: Confidence=0.9328
Instance 4: Confidence=0.9250
Instance 5: Confidence=0.7913
Selected instance: 1 (Confidence: 0.9425)
tmp min: tensor(0.) tmp max: tensor(1.)
605 308 540 960
There are 15 prompts
current IoU is: 0.8117110729217529
Seok, iteration idx= 31 IoU = tensor(0.8117)
Selected Instance Confidence List: [tensor(0.9361), tensor(0.9074, device='cpu'), tensor(0.9008, device='cpu'), tensor(0.8787, device='cpu'), tensor(0.8762, device='cpu'), tensor(0.8793, device='cpu'), tensor(0.9320, device='cpu'), tensor(0.9330, device='cpu'), tensor(0.4564, device='cpu'), tensor(0.5026, device='cpu'), tensor(0.5103, device='cpu'), tensor(0.6007, device='cpu'), tensor(0.7265, device='cpu'), tensor(0.7410, device='cpu'), tensor(0.7180, device='cpu'), tensor(0.7131, device='cpu'), tensor(0.9191, device='cpu'), tensor(0.9227, device='cpu'), tensor(0.9148, device='cpu'), tensor(0.9075, device='cpu'), tensor(0.7937, device='cpu'), tensor(0.8107, device='cpu'), tensor(0.8917, device='cpu'), tensor(0.8689, device='cpu'), tensor(0.6846, device='cpu'), tensor(0.6751, device='cpu'), tensor(0.6603, device='cpu'), tensor(0.5851, device='cpu'), tensor(0.5452, device='cpu'), tensor(0.6374, device='cpu'), tensor(0.7878, device='cpu'), tensor(0.8640, device='cpu')]
Sorted Confidence Order: [tensor(0.9361), tensor(0.9074, device='cpu'), tensor(0.9008, device='cpu'), tensor(0.8787, device='cpu'), tensor(0.8762, device='cpu'), tensor(0.8793, device='cpu'), tensor(0.9320, device='cpu'), tensor(0.9330, device='cpu'), tensor(0.9191, device='cpu'), tensor(0.9227, device='cpu'), tensor(0.9148, device='cpu'), tensor(0.9075, device='cpu'), tensor(0.7937, device='cpu'), tensor(0.8107, device='cpu'), tensor(0.8917, device='cpu'), tensor(0.8689, device='cpu'), tensor(0.8640, device='cpu'), tensor(0.7878, device='cpu'), tensor(0.6374, device='cpu'), tensor(0.5452, device='cpu'), tensor(0.5851, device='cpu'), tensor(0.6603, device='cpu'), tensor(0.6751, device='cpu'), tensor(0.6846, device='cpu'), tensor(0.7131, device='cpu'), tensor(0.7180, device='cpu'), tensor(0.7410, device='cpu'), tensor(0.7265, device='cpu'), tensor(0.6007, device='cpu'), tensor(0.5103, device='cpu'), tensor(0.5026, device='cpu'), tensor(0.4564, device='cpu')]
sorted_indices: [0, 1, 2, 3, 4, 5, 6, 7, 16, 17, 18, 19, 20, 21, 22, 23, 31, 30, 29, 28, 27, 26, 25, 24, 15, 14, 13, 12, 11, 10, 9, 8]
Initial view (highest confidence): 1
New training order: [29, 30, 31, 32, 33, 34, 35, 36, 9, 10, 11, 12, 13, 14, 15, 16, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.3ms
Speed: 1.3ms preprocess, 20.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 7
Instance 0: Confidence=0.9386
Instance 1: Confidence=0.9359
Instance 2: Confidence=0.9328
Instance 3: Confidence=0.9221
Instance 4: Confidence=0.8036
Instance 5: Confidence=0.7507
Instance 6: Confidence=0.2664
tmp min: tensor(0.) tmp max: tensor(1.)
612 316 540 960
There are 14 prompts
current IoU is: 0.14486508071422577
Seok, iteration idx= 1 IoU = tensor(0.1449)
SKIP, unacceptable sam prediction, IoU is tensor(0.1449)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9552
Instance 1: Confidence=0.9328
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.9105
Instance 4: Confidence=0.8768
Instance 5: Confidence=0.6113
tmp min: tensor(0.) tmp max: tensor(1.)
579 288 540 960
There are 12 prompts
current IoU is: 0.243334099650383
Seok, iteration idx= 2 IoU = tensor(0.2433)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9494
Instance 1: Confidence=0.9387
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.8958
Instance 4: Confidence=0.8815
tmp min: tensor(0.) tmp max: tensor(1.)
545 296 540 960
There are 13 prompts
current IoU is: 0.39801454544067383
Seok, iteration idx= 3 IoU = tensor(0.3980)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9337
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.8928
Instance 3: Confidence=0.7319
Instance 4: Confidence=0.6180
Instance 5: Confidence=0.4375
tmp min: tensor(0.) tmp max: tensor(1.)
398 364 540 960
There are 18 prompts
current IoU is: 0.5252857208251953
Seok, iteration idx= 4 IoU = tensor(0.5253)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 7
Instance 0: Confidence=0.9374
Instance 1: Confidence=0.9284
Instance 2: Confidence=0.9260
Instance 3: Confidence=0.9164
Instance 4: Confidence=0.9091
Instance 5: Confidence=0.5029
Instance 6: Confidence=0.2646
tmp min: tensor(0.) tmp max: tensor(1.)
435 328 540 960
There are 11 prompts
current IoU is: 0.6841166615486145
Seok, iteration idx= 5 IoU = tensor(0.6841)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.1ms
Speed: 1.5ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9348
Instance 1: Confidence=0.9341
Instance 2: Confidence=0.9295
Instance 3: Confidence=0.9290
Instance 4: Confidence=0.9118
Instance 5: Confidence=0.5306
tmp min: tensor(0.) tmp max: tensor(1.)
447 332 540 960
There are 12 prompts
current IoU is: 0.7205386161804199
Seok, iteration idx= 6 IoU = tensor(0.7205)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9330
Instance 2: Confidence=0.9322
Instance 3: Confidence=0.9308
Instance 4: Confidence=0.8590
Instance 5: Confidence=0.5721
Instance 6: Confidence=0.3880
tmp min: tensor(0.) tmp max: tensor(1.)
388 320 540 960
There are 14 prompts
current IoU is: 0.7797881364822388
Seok, iteration idx= 7 IoU = tensor(0.7798)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 2.8ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9385
Instance 3: Confidence=0.9341
Instance 4: Confidence=0.9008
Instance 5: Confidence=0.6692
tmp min: tensor(0.) tmp max: tensor(1.)
434 296 540 960
There are 16 prompts
current IoU is: 0.8226161003112793
Seok, iteration idx= 8 IoU = tensor(0.8226)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9584
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9329
Instance 3: Confidence=0.9113
Instance 4: Confidence=0.8125
Instance 5: Confidence=0.5363
tmp min: tensor(0.) tmp max: tensor(1.)
327 300 540 960
There are 14 prompts
current IoU is: 0.8478391170501709
Seok, iteration idx= 9 IoU = tensor(0.8478)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.3ms preprocess, 23.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9408
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9217
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.7804
Instance 5: Confidence=0.3248
tmp min: tensor(0.) tmp max: tensor(1.)
312 284 540 960
There are 13 prompts
current IoU is: 0.8837090134620667
Seok, iteration idx= 10 IoU = tensor(0.8837)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 1.3ms preprocess, 22.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9463
Instance 1: Confidence=0.9379
Instance 2: Confidence=0.9269
Instance 3: Confidence=0.9177
Instance 4: Confidence=0.8096
Instance 5: Confidence=0.5529
tmp min: tensor(0.) tmp max: tensor(1.)
299 285 540 960
There are 13 prompts
current IoU is: 0.8887759447097778
Seok, iteration idx= 11 IoU = tensor(0.8888)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 1.3ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9490
Instance 1: Confidence=0.9483
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9231
Instance 4: Confidence=0.6808
Instance 5: Confidence=0.6357
tmp min: tensor(0.) tmp max: tensor(1.)
281 280 540 960
There are 16 prompts
current IoU is: 0.8996349573135376
Seok, iteration idx= 12 IoU = tensor(0.8996)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9424
Instance 1: Confidence=0.9364
Instance 2: Confidence=0.9296
Instance 3: Confidence=0.9162
Instance 4: Confidence=0.6830
Instance 5: Confidence=0.6813
tmp min: tensor(0.) tmp max: tensor(1.)
290 288 540 960
There are 14 prompts
current IoU is: 0.9063061475753784
Seok, iteration idx= 13 IoU = tensor(0.9063)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.6ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9605
Instance 1: Confidence=0.9404
Instance 2: Confidence=0.9341
Instance 3: Confidence=0.9266
Instance 4: Confidence=0.9189
tmp min: tensor(0.) tmp max: tensor(1.)
290 284 540 960
There are 15 prompts
current IoU is: 0.8862690925598145
Seok, iteration idx= 14 IoU = tensor(0.8863)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9216
Instance 3: Confidence=0.9211
Instance 4: Confidence=0.9179
tmp min: tensor(0.) tmp max: tensor(1.)
301 304 540 960
There are 14 prompts
current IoU is: 0.8577588796615601
Seok, iteration idx= 15 IoU = tensor(0.8578)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.7ms
Speed: 1.5ms preprocess, 21.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9542
Instance 1: Confidence=0.9425
Instance 2: Confidence=0.9398
Instance 3: Confidence=0.9328
Instance 4: Confidence=0.9250
Instance 5: Confidence=0.7913
tmp min: tensor(0.) tmp max: tensor(1.)
605 308 540 960
There are 15 prompts
current IoU is: 0.20586322247982025
Seok, iteration idx= 16 IoU = tensor(0.2059)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9496
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9297
Instance 3: Confidence=0.9274
Instance 4: Confidence=0.9144
Instance 5: Confidence=0.3458
tmp min: tensor(0.) tmp max: tensor(1.)
542 292 540 960
There are 16 prompts
current IoU is: 0.2599969208240509
Seok, iteration idx= 17 IoU = tensor(0.2600)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 7
Instance 0: Confidence=0.9382
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9224
Instance 3: Confidence=0.9112
Instance 4: Confidence=0.8582
Instance 5: Confidence=0.4778
Instance 6: Confidence=0.3251
tmp min: tensor(0.) tmp max: tensor(1.)
664 268 540 960
There are 12 prompts
current IoU is: 0.2851404547691345
Seok, iteration idx= 18 IoU = tensor(0.2851)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 2.6ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9140
Instance 3: Confidence=0.9125
Instance 4: Confidence=0.8638
Instance 5: Confidence=0.7469
tmp min: tensor(0.) tmp max: tensor(1.)
655 276 540 960
There are 14 prompts
current IoU is: 0.3145449757575989
Seok, iteration idx= 19 IoU = tensor(0.3145)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 2.8ms preprocess, 23.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 5
Instance 0: Confidence=0.9378
Instance 1: Confidence=0.9341
Instance 2: Confidence=0.9259
Instance 3: Confidence=0.9210
Instance 4: Confidence=0.9059
tmp min: tensor(0.) tmp max: tensor(1.)
649 272 540 960
There are 14 prompts
current IoU is: 0.2763311266899109
Seok, iteration idx= 20 IoU = tensor(0.2763)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 2.5ms preprocess, 24.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9414
Instance 1: Confidence=0.9300
Instance 2: Confidence=0.8414
Instance 3: Confidence=0.7600
Instance 4: Confidence=0.7093
Instance 5: Confidence=0.6956
tmp min: tensor(0.) tmp max: tensor(1.)
565 308 540 960
There are 13 prompts
current IoU is: 0.3479841649532318
Seok, iteration idx= 21 IoU = tensor(0.3480)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 2.6ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9454
Instance 1: Confidence=0.9376
Instance 2: Confidence=0.9193
Instance 3: Confidence=0.8833
Instance 4: Confidence=0.8594
Instance 5: Confidence=0.7986
tmp min: tensor(0.) tmp max: tensor(1.)
555 284 540 960
There are 14 prompts
current IoU is: 0.45180198550224304
Seok, iteration idx= 22 IoU = tensor(0.4518)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 5.3ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9499
Instance 1: Confidence=0.9476
Instance 2: Confidence=0.9344
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.7513
Instance 5: Confidence=0.3441
tmp min: tensor(0.) tmp max: tensor(1.)
588 284 540 960
There are 13 prompts
current IoU is: 0.5123104453086853
Seok, iteration idx= 23 IoU = tensor(0.5123)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 2.9ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9465
Instance 2: Confidence=0.9439
Instance 3: Confidence=0.8874
Instance 4: Confidence=0.6249
Instance 5: Confidence=0.2727
tmp min: tensor(0.) tmp max: tensor(1.)
578 264 540 960
There are 13 prompts
current IoU is: 0.6209677457809448
Seok, iteration idx= 24 IoU = tensor(0.6210)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.1ms
Speed: 3.5ms preprocess, 23.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 8
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9499
Instance 2: Confidence=0.9467
Instance 3: Confidence=0.8013
Instance 4: Confidence=0.4372
Instance 5: Confidence=0.3440
Instance 6: Confidence=0.3215
Instance 7: Confidence=0.2739
tmp min: tensor(0.) tmp max: tensor(1.)
597 264 540 960
There are 15 prompts
current IoU is: 0.6551091074943542
Seok, iteration idx= 25 IoU = tensor(0.6551)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 3.4ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9520
Instance 1: Confidence=0.9453
Instance 2: Confidence=0.9338
Instance 3: Confidence=0.8405
Instance 4: Confidence=0.7673
tmp min: tensor(0.) tmp max: tensor(1.)
618 264 540 960
There are 14 prompts
current IoU is: 0.7042720913887024
Seok, iteration idx= 26 IoU = tensor(0.7043)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.1ms
Speed: 2.8ms preprocess, 22.1ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 7
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.7916
Instance 4: Confidence=0.7327
Instance 5: Confidence=0.4687
Instance 6: Confidence=0.2725
tmp min: tensor(0.) tmp max: tensor(1.)
594 264 540 960
There are 14 prompts
current IoU is: 0.7493042945861816
Seok, iteration idx= 27 IoU = tensor(0.7493)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 3.0ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9476
Instance 2: Confidence=0.8963
Instance 3: Confidence=0.8785
Instance 4: Confidence=0.8033
tmp min: tensor(0.) tmp max: tensor(1.)
574 272 540 960
There are 15 prompts
current IoU is: 0.7453616857528687
Seok, iteration idx= 28 IoU = tensor(0.7454)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.2ms
Speed: 3.0ms preprocess, 23.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 4
Instance 0: Confidence=0.9524
Instance 1: Confidence=0.9516
Instance 2: Confidence=0.9286
Instance 3: Confidence=0.8979
tmp min: tensor(0.) tmp max: tensor(1.)
628 312 540 960
There are 15 prompts
current IoU is: 0.7632697820663452
Seok, iteration idx= 29 IoU = tensor(0.7633)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.0ms
Speed: 2.8ms preprocess, 24.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 4
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9331
Instance 2: Confidence=0.9069
Instance 3: Confidence=0.5795
tmp min: tensor(0.) tmp max: tensor(1.)
525 236 540 960
There are 17 prompts
current IoU is: 0.5471988320350647
Seok, iteration idx= 30 IoU = tensor(0.5472)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 1.3ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 7
Instance 0: Confidence=0.9482
Instance 1: Confidence=0.9339
Instance 2: Confidence=0.9185
Instance 3: Confidence=0.7674
Instance 4: Confidence=0.4578
Instance 5: Confidence=0.4412
Instance 6: Confidence=0.4175
tmp min: tensor(0.) tmp max: tensor(1.)
499 244 540 960
There are 17 prompts
current IoU is: 0.6038246750831604
Seok, iteration idx= 31 IoU = tensor(0.6038)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set5_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set5_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:41<00:00,  1.30s/it]
Testing psnr 27.85190373659134 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set5_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.17it/s]
Testing psnr 3.1195312831550837 (avg)
train: coarse segmentation in 00:07:17
train: finish (eps time 00:07:17 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set5_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set6/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 37.19it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set6 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set6
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set6_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.2ms
Speed: 3.2ms preprocess, 20.2ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.6ms
Speed: 1.4ms preprocess, 19.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.6ms
Speed: 1.6ms preprocess, 19.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.3ms
Speed: 1.5ms preprocess, 20.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.1ms
Speed: 1.4ms preprocess, 21.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.8ms
Speed: 1.4ms preprocess, 19.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.3ms
Speed: 1.4ms preprocess, 20.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.8ms
Speed: 1.2ms preprocess, 19.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.2ms
Speed: 1.2ms preprocess, 19.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.4ms
Speed: 1.2ms preprocess, 20.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.5ms
Speed: 1.5ms preprocess, 20.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.4ms
Speed: 1.4ms preprocess, 20.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.0ms
Speed: 1.4ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.7ms
Speed: 1.4ms preprocess, 20.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.8ms
Speed: 1.4ms preprocess, 20.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.3ms
Speed: 1.4ms preprocess, 19.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.8ms
Speed: 1.4ms preprocess, 19.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.4ms
Speed: 1.5ms preprocess, 20.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.4ms
Speed: 1.4ms preprocess, 20.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.8ms
Speed: 1.2ms preprocess, 19.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.4ms
Speed: 1.5ms preprocess, 19.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.0ms
Speed: 1.5ms preprocess, 20.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.3ms
Speed: 1.4ms preprocess, 19.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.1ms
Speed: 1.4ms preprocess, 20.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.6ms
Speed: 1.4ms preprocess, 20.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.0ms
Speed: 1.4ms preprocess, 21.0ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.6ms
Speed: 1.5ms preprocess, 20.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.5ms
Speed: 1.5ms preprocess, 21.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.1ms
Speed: 1.4ms preprocess, 20.1ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.3ms
Speed: 1.4ms preprocess, 20.3ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.1ms
Speed: 1.4ms preprocess, 20.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.9ms
Speed: 1.7ms preprocess, 21.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 13
view_order: [14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.3ms
Speed: 2.6ms preprocess, 21.3ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 3
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.9273
Instance 2: Confidence=0.8225
Selected instance: 0 (Confidence: 0.9384)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

365 112 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 1 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.6ms
Speed: 2.5ms preprocess, 23.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 3
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9196
Instance 2: Confidence=0.5705
Selected instance: 0 (Confidence: 0.9367)
tmp min: tensor(0.) tmp max: tensor(1.)
388 144 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 2 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 2
Instance 0: Confidence=0.9475
Instance 1: Confidence=0.8862
Selected instance: 0 (Confidence: 0.9475)
tmp min: tensor(0.) tmp max: tensor(1.)
754 32 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 3 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 2.9ms preprocess, 22.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 2
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9560
Selected instance: 0 (Confidence: 0.9594)
tmp min: tensor(0.) tmp max: tensor(1.)
645 32 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 4 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 3.7ms preprocess, 22.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9470
Selected instance: 0 (Confidence: 0.9592)
tmp min: tensor(0.) tmp max: tensor(1.)
619 72 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 5 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 3.6ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9518
Selected instance: 0 (Confidence: 0.9532)
tmp min: tensor(0.) tmp max: tensor(1.)
526 36 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 6 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 1.7ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9422
Selected instance: 0 (Confidence: 0.9519)
tmp min: tensor(0.) tmp max: tensor(1.)
400 28 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 7 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9603
Instance 1: Confidence=0.9454
Selected instance: 0 (Confidence: 0.9603)
tmp min: tensor(0.) tmp max: tensor(1.)
313 4 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 8 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9480
Selected instance: 0 (Confidence: 0.9626)
tmp min: tensor(0.) tmp max: tensor(1.)
202 16 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 9 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9662
Instance 1: Confidence=0.8877
Selected instance: 0 (Confidence: 0.9662)
tmp min: tensor(0.) tmp max: tensor(1.)
144 12 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 10 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.5ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9667
Instance 1: Confidence=0.9419
Selected instance: 0 (Confidence: 0.9667)
tmp min: tensor(0.) tmp max: tensor(1.)
128 0 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 11 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.4ms
Speed: 1.5ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9518
Selected instance: 0 (Confidence: 0.9593)
tmp min: tensor(0.) tmp max: tensor(1.)
668 0 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 12 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9573
Instance 1: Confidence=0.9542
Selected instance: 0 (Confidence: 0.9573)
tmp min: tensor(0.) tmp max: tensor(1.)
555 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 13 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 2.0ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9631
Instance 1: Confidence=0.9505
Selected instance: 0 (Confidence: 0.9631)
tmp min: tensor(0.) tmp max: tensor(1.)
452 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 14 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 1.4ms preprocess, 22.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9450
Selected instance: 1 (Confidence: 0.9450)
tmp min: tensor(0.) tmp max: tensor(1.)
154 128 540 960
There are 15 prompts
current IoU is: 0.00036000824184156954
Seok, iteration idx= 15 IoU = tensor(0.0004)
SKIP, unacceptable sam prediction, IoU is tensor(0.0004)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9604
Instance 1: Confidence=0.6440
Selected instance: 0 (Confidence: 0.9604)
tmp min: tensor(0.) tmp max: tensor(1.)
212 20 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 16 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.1ms
Speed: 3.2ms preprocess, 23.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 1
Instance 0: Confidence=0.9642
Selected instance: 0 (Confidence: 0.9642)
tmp min: tensor(0.) tmp max: tensor(1.)
147 32 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 17 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.3ms
Speed: 3.4ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 3
Instance 0: Confidence=0.9669
Instance 1: Confidence=0.4821
Instance 2: Confidence=0.4394
Selected instance: 2 (Confidence: 0.4394)
tmp min: tensor(0.) tmp max: tensor(1.)
293 152 540 960
There are 13 prompts
current IoU is: 0.39347410202026367
Seok, iteration idx= 18 IoU = tensor(0.3935)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 3.8ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9351
Instance 1: Confidence=0.9205
Selected instance: 0 (Confidence: 0.9351)
tmp min: tensor(0.) tmp max: tensor(1.)
574 100 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 19 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.5ms
Speed: 2.5ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 3
Instance 0: Confidence=0.9503
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.7235
Selected instance: 0 (Confidence: 0.9503)
tmp min: tensor(0.) tmp max: tensor(1.)
785 72 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 20 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 3.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 3
Instance 0: Confidence=0.9471
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.4658
Selected instance: 0 (Confidence: 0.9471)
tmp min: tensor(0.) tmp max: tensor(1.)
661 68 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 21 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 2.7ms preprocess, 22.7ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 2
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9457
Selected instance: 0 (Confidence: 0.9618)
tmp min: tensor(0.) tmp max: tensor(1.)
811 56 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 22 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 1.6ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9676
Instance 1: Confidence=0.9445
Selected instance: 0 (Confidence: 0.9676)
tmp min: tensor(0.) tmp max: tensor(1.)
840 36 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 23 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9700
Instance 1: Confidence=0.9385
Selected instance: 0 (Confidence: 0.9700)
tmp min: tensor(0.) tmp max: tensor(1.)
848 24 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 24 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 3
Instance 0: Confidence=0.9535
Instance 1: Confidence=0.8235
Instance 2: Confidence=0.5369
Selected instance: 0 (Confidence: 0.9535)
tmp min: tensor(0.) tmp max: tensor(1.)
810 12 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 25 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.9ms
Speed: 1.7ms preprocess, 21.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 3
Instance 0: Confidence=0.9589
Instance 1: Confidence=0.2834
Instance 2: Confidence=0.2770
Selected instance: 0 (Confidence: 0.9589)
tmp min: tensor(0.) tmp max: tensor(1.)
762 0 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 26 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 2
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9059
Selected instance: 0 (Confidence: 0.9652)
tmp min: tensor(0.) tmp max: tensor(1.)
50 0 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 27 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 25.5ms
Speed: 1.8ms preprocess, 25.5ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 2
Instance 0: Confidence=0.9586
Instance 1: Confidence=0.9416
Selected instance: 0 (Confidence: 0.9586)
tmp min: tensor(0.) tmp max: tensor(1.)
2 4 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 28 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 1.5ms preprocess, 22.1ms inference, 3.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 2
Instance 0: Confidence=0.9624
Instance 1: Confidence=0.9404
Selected instance: 0 (Confidence: 0.9624)
tmp min: tensor(0.) tmp max: tensor(1.)
2 0 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 29 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.8ms
Speed: 1.8ms preprocess, 22.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 3
Instance 0: Confidence=0.9538
Instance 1: Confidence=0.9460
Instance 2: Confidence=0.5105
Selected instance: 0 (Confidence: 0.9538)
tmp min: tensor(0.) tmp max: tensor(1.)
2 0 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 30 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 4
Instance 0: Confidence=0.9569
Instance 1: Confidence=0.9566
Instance 2: Confidence=0.8389
Instance 3: Confidence=0.3479
Selected instance: 3 (Confidence: 0.3479)
tmp min: tensor(0.) tmp max: tensor(1.)
597 144 540 960
There are 14 prompts
current IoU is: 0.6217538714408875
Seok, iteration idx= 31 IoU = tensor(0.6218)
Selected Instance Confidence List: [tensor(0.5010), tensor(0.3754, device='cpu'), tensor(0.3747, device='cpu'), tensor(0.3790, device='cpu'), tensor(0.3838, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3813, device='cpu'), tensor(0.3808, device='cpu'), tensor(0.3841, device='cpu'), tensor(0.3850, device='cpu'), tensor(0.3865, device='cpu'), tensor(0.3867, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3829, device='cpu'), tensor(0.3853, device='cpu'), tensor(0.3851, device='cpu'), tensor(0.3841, device='cpu'), tensor(0.3857, device='cpu'), tensor(0.4118, device='cpu'), tensor(0.3740, device='cpu'), tensor(0.3801, device='cpu'), tensor(0.3788, device='cpu'), tensor(0.3847, device='cpu'), tensor(0.3870, device='cpu'), tensor(0.3880, device='cpu'), tensor(0.3814, device='cpu'), tensor(0.3835, device='cpu'), tensor(0.3861, device='cpu'), tensor(0.3834, device='cpu'), tensor(0.3849, device='cpu'), tensor(0.3815, device='cpu'), tensor(0.5122, device='cpu')]
Sorted Confidence Order: [tensor(0.5122, device='cpu'), tensor(0.5010), tensor(0.3754, device='cpu'), tensor(0.3747, device='cpu'), tensor(0.3815, device='cpu'), tensor(0.3849, device='cpu'), tensor(0.3834, device='cpu'), tensor(0.3861, device='cpu'), tensor(0.4118, device='cpu'), tensor(0.3857, device='cpu'), tensor(0.3841, device='cpu'), tensor(0.3851, device='cpu'), tensor(0.3853, device='cpu'), tensor(0.3829, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3867, device='cpu'), tensor(0.3865, device='cpu'), tensor(0.3850, device='cpu'), tensor(0.3841, device='cpu'), tensor(0.3808, device='cpu'), tensor(0.3813, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3838, device='cpu'), tensor(0.3790, device='cpu'), tensor(0.3835, device='cpu'), tensor(0.3814, device='cpu'), tensor(0.3880, device='cpu'), tensor(0.3870, device='cpu'), tensor(0.3847, device='cpu'), tensor(0.3788, device='cpu'), tensor(0.3801, device='cpu'), tensor(0.3740, device='cpu')]
sorted_indices: [31, 0, 1, 2, 30, 29, 28, 27, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 26, 25, 24, 23, 22, 21, 20, 19]
Initial view (highest confidence): 36
New training order: [13, 14, 15, 16, 12, 11, 10, 9, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 4
Instance 0: Confidence=0.9441
Instance 1: Confidence=0.9413
Instance 2: Confidence=0.8401
Instance 3: Confidence=0.5010
tmp min: tensor(0.) tmp max: tensor(1.)
664 152 540 960
There are 11 prompts
current IoU is: 0.8168103694915771
Seok, iteration idx= 1 IoU = tensor(0.8168)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.8ms
Speed: 1.4ms preprocess, 21.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 3
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.9273
Instance 2: Confidence=0.8225
tmp min: tensor(0.) tmp max: tensor(1.)
365 112 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 2 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.6ms
Speed: 3.1ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 3
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9196
Instance 2: Confidence=0.5705
tmp min: tensor(0.) tmp max: tensor(1.)
388 144 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 3 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.3ms
Speed: 2.4ms preprocess, 22.3ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 3
Instance 0: Confidence=0.9538
Instance 1: Confidence=0.9460
Instance 2: Confidence=0.5105
tmp min: tensor(0.) tmp max: tensor(1.)
2 0 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 4 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 2.9ms preprocess, 22.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9624
Instance 1: Confidence=0.9404
tmp min: tensor(0.) tmp max: tensor(1.)
2 0 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 5 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9586
Instance 1: Confidence=0.9416
tmp min: tensor(0.) tmp max: tensor(1.)
2 4 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 6 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 1.6ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9059
tmp min: tensor(0.) tmp max: tensor(1.)
50 0 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 7 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 3
Instance 0: Confidence=0.9669
Instance 1: Confidence=0.4821
Instance 2: Confidence=0.4394
tmp min: tensor(0.) tmp max: tensor(1.)
293 152 540 960
There are 13 prompts
current IoU is: 0.4732052683830261
Seok, iteration idx= 8 IoU = tensor(0.4732)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.4ms
Speed: 1.7ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 1
Instance 0: Confidence=0.9642
tmp min: tensor(0.) tmp max: tensor(1.)
147 32 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 9 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9604
Instance 1: Confidence=0.6440
tmp min: tensor(0.) tmp max: tensor(1.)
212 20 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 10 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 1.4ms preprocess, 22.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9450
tmp min: tensor(0.) tmp max: tensor(1.)
154 128 540 960
There are 15 prompts
current IoU is: 0.00033335897023789585
Seok, iteration idx= 11 IoU = tensor(0.0003)
SKIP, unacceptable sam prediction, IoU is tensor(0.0003)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 3.4ms preprocess, 22.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9631
Instance 1: Confidence=0.9505
tmp min: tensor(0.) tmp max: tensor(1.)
452 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 12 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 3.2ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9573
Instance 1: Confidence=0.9542
tmp min: tensor(0.) tmp max: tensor(1.)
555 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 13 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9518
tmp min: tensor(0.) tmp max: tensor(1.)
668 0 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 14 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 2
Instance 0: Confidence=0.9667
Instance 1: Confidence=0.9419
tmp min: tensor(0.) tmp max: tensor(1.)
128 0 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 15 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 1.3ms preprocess, 22.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9662
Instance 1: Confidence=0.8877
tmp min: tensor(0.) tmp max: tensor(1.)
144 12 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 16 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 1.9ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9480
tmp min: tensor(0.) tmp max: tensor(1.)
202 16 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 17 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9603
Instance 1: Confidence=0.9454
tmp min: tensor(0.) tmp max: tensor(1.)
313 4 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 18 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 3.6ms preprocess, 22.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9422
tmp min: tensor(0.) tmp max: tensor(1.)
400 28 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 19 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 2.5ms preprocess, 23.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9518
tmp min: tensor(0.) tmp max: tensor(1.)
526 36 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 20 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 2.8ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9470
tmp min: tensor(0.) tmp max: tensor(1.)
619 72 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 21 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.8ms
Speed: 2.8ms preprocess, 24.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 2
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9560
tmp min: tensor(0.) tmp max: tensor(1.)
645 32 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 22 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.9ms
Speed: 1.5ms preprocess, 21.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9475
Instance 1: Confidence=0.8862
tmp min: tensor(0.) tmp max: tensor(1.)
754 32 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 23 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.7ms
Speed: 1.3ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 3
Instance 0: Confidence=0.9589
Instance 1: Confidence=0.2834
Instance 2: Confidence=0.2770
tmp min: tensor(0.) tmp max: tensor(1.)
762 0 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 24 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.6ms
Speed: 1.6ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 3
Instance 0: Confidence=0.9535
Instance 1: Confidence=0.8235
Instance 2: Confidence=0.5369
tmp min: tensor(0.) tmp max: tensor(1.)
810 12 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 25 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 2
Instance 0: Confidence=0.9700
Instance 1: Confidence=0.9385
tmp min: tensor(0.) tmp max: tensor(1.)
848 24 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 26 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 3.1ms preprocess, 22.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 2
Instance 0: Confidence=0.9676
Instance 1: Confidence=0.9445
tmp min: tensor(0.) tmp max: tensor(1.)
840 36 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 27 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 3.1ms preprocess, 22.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 2
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9457
tmp min: tensor(0.) tmp max: tensor(1.)
811 56 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 28 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.2ms
Speed: 2.6ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 3
Instance 0: Confidence=0.9471
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.4658
tmp min: tensor(0.) tmp max: tensor(1.)
661 68 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 29 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.5ms
Speed: 1.6ms preprocess, 22.5ms inference, 3.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 3
Instance 0: Confidence=0.9503
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.7235
tmp min: tensor(0.) tmp max: tensor(1.)
785 72 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 30 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 2
Instance 0: Confidence=0.9351
Instance 1: Confidence=0.9205
tmp min: tensor(0.) tmp max: tensor(1.)
574 100 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 31 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set6_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set6_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:38<00:00,  1.22s/it]
Testing psnr 29.24417570233345 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set6_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:26<00:00,  1.20it/s]
Testing psnr 2.8947769943624735 (avg)
train: coarse segmentation in 00:05:57
train: finish (eps time 00:05:58 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set6_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set7/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 46.97it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set7 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set7
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set7_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 2.8ms preprocess, 20.5ms inference, 3.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.3ms
Speed: 1.4ms preprocess, 20.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.4ms
Speed: 2.0ms preprocess, 20.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.8ms
Speed: 1.3ms preprocess, 20.8ms inference, 3.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.2ms
Speed: 1.3ms preprocess, 20.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.3ms
Speed: 1.3ms preprocess, 20.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.8ms
Speed: 1.4ms preprocess, 19.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.8ms
Speed: 1.9ms preprocess, 20.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.8ms
Speed: 1.5ms preprocess, 20.8ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.7ms
Speed: 1.7ms preprocess, 20.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.4ms
Speed: 1.5ms preprocess, 20.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.4ms
Speed: 1.5ms preprocess, 21.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.9ms
Speed: 1.4ms preprocess, 20.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.4ms
Speed: 1.4ms preprocess, 20.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.3ms
Speed: 1.4ms preprocess, 22.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.6ms
Speed: 1.5ms preprocess, 20.6ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.2ms
Speed: 1.5ms preprocess, 20.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.3ms
Speed: 1.5ms preprocess, 20.3ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.2ms
Speed: 1.4ms preprocess, 20.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.6ms preprocess, 20.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.3ms
Speed: 1.4ms preprocess, 20.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.9ms
Speed: 1.4ms preprocess, 20.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.3ms
Speed: 1.4ms preprocess, 20.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.2ms
Speed: 1.2ms preprocess, 20.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.1ms
Speed: 1.9ms preprocess, 21.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.3ms
Speed: 1.3ms preprocess, 20.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.6ms preprocess, 20.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.3ms
Speed: 1.3ms preprocess, 20.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.2ms
Speed: 2.9ms preprocess, 21.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 30
view_order: [35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 2.9ms preprocess, 22.2ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 2
Instance 0: Confidence=0.9563
Instance 1: Confidence=0.4461
Selected instance: 0 (Confidence: 0.9563)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

155 76 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 1 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 1.6ms preprocess, 23.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 2
Instance 0: Confidence=0.9536
Instance 1: Confidence=0.9447
Selected instance: 1 (Confidence: 0.9447)
tmp min: tensor(0.) tmp max: tensor(1.)
32 80 540 960
There are 14 prompts
current IoU is: 0.17142857611179352
Seok, iteration idx= 2 IoU = tensor(0.1714)
SKIP, unacceptable sam prediction, IoU is tensor(0.1714)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.0ms
Speed: 1.4ms preprocess, 22.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 3
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.3825
Selected instance: 1 (Confidence: 0.9503)
tmp min: tensor(0.) tmp max: tensor(1.)
24 72 540 960
There are 15 prompts
current IoU is: 0.17872898280620575
Seok, iteration idx= 3 IoU = tensor(0.1787)
SKIP, unacceptable sam prediction, IoU is tensor(0.1787)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.9ms
Speed: 1.6ms preprocess, 21.9ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 3
Instance 0: Confidence=0.9624
Instance 1: Confidence=0.9555
Instance 2: Confidence=0.6049
Selected instance: 1 (Confidence: 0.9555)
tmp min: tensor(0.) tmp max: tensor(1.)
43 64 540 960
There are 17 prompts
current IoU is: 0.1508672684431076
Seok, iteration idx= 4 IoU = tensor(0.1509)
SKIP, unacceptable sam prediction, IoU is tensor(0.1509)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.5ms
Speed: 2.7ms preprocess, 21.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9575
Selected instance: 1 (Confidence: 0.9575)
tmp min: tensor(0.) tmp max: tensor(1.)
44 68 540 960
There are 16 prompts
current IoU is: 0.15292802453041077
Seok, iteration idx= 5 IoU = tensor(0.1529)
SKIP, unacceptable sam prediction, IoU is tensor(0.1529)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 2.9ms preprocess, 23.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9701
Instance 1: Confidence=0.9441
Selected instance: 1 (Confidence: 0.9441)
tmp min: tensor(0.) tmp max: tensor(1.)
69 48 540 960
There are 14 prompts
current IoU is: 0.15191173553466797
Seok, iteration idx= 6 IoU = tensor(0.1519)
SKIP, unacceptable sam prediction, IoU is tensor(0.1519)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.2ms
Speed: 1.3ms preprocess, 23.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 3
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.6308
Selected instance: 1 (Confidence: 0.9446)
tmp min: tensor(0.) tmp max: tensor(1.)
140 68 540 960
There are 16 prompts
current IoU is: 0.14824429154396057
Seok, iteration idx= 7 IoU = tensor(0.1482)
SKIP, unacceptable sam prediction, IoU is tensor(0.1482)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.0ms
Speed: 1.4ms preprocess, 22.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9707
Instance 1: Confidence=0.9349
Selected instance: 1 (Confidence: 0.9349)
tmp min: tensor(0.) tmp max: tensor(1.)
165 60 540 960
There are 16 prompts
current IoU is: 0.15498241782188416
Seok, iteration idx= 8 IoU = tensor(0.1550)
SKIP, unacceptable sam prediction, IoU is tensor(0.1550)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9734
Instance 1: Confidence=0.9361
Selected instance: 1 (Confidence: 0.9361)
tmp min: tensor(0.) tmp max: tensor(1.)
187 72 540 960
There are 16 prompts
current IoU is: 0.15912877023220062
Seok, iteration idx= 9 IoU = tensor(0.1591)
SKIP, unacceptable sam prediction, IoU is tensor(0.1591)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 1
Instance 0: Confidence=0.9550
Selected instance: 0 (Confidence: 0.9550)
tmp min: tensor(0.) tmp max: tensor(1.)
184 64 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 10 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.9ms
Speed: 2.7ms preprocess, 22.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 1
Instance 0: Confidence=0.9572
Selected instance: 0 (Confidence: 0.9572)
tmp min: tensor(0.) tmp max: tensor(1.)
186 72 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 11 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.2ms
Speed: 2.4ms preprocess, 22.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 3
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.8823
Instance 2: Confidence=0.4506
Selected instance: 0 (Confidence: 0.9594)
tmp min: tensor(0.) tmp max: tensor(1.)
214 64 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 12 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 4.1ms preprocess, 22.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9674
Instance 1: Confidence=0.6939
Selected instance: 0 (Confidence: 0.9674)
tmp min: tensor(0.) tmp max: tensor(1.)
230 68 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 13 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 3.3ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9456
Instance 1: Confidence=0.8489
Selected instance: 0 (Confidence: 0.9456)
tmp min: tensor(0.) tmp max: tensor(1.)
268 80 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 14 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.5ms
Speed: 2.4ms preprocess, 23.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 3
Instance 0: Confidence=0.9496
Instance 1: Confidence=0.8183
Instance 2: Confidence=0.3549
Selected instance: 0 (Confidence: 0.9496)
tmp min: tensor(0.) tmp max: tensor(1.)
312 96 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 15 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.4ms
Speed: 1.3ms preprocess, 22.4ms inference, 3.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 3
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9284
Instance 2: Confidence=0.7120
Selected instance: 1 (Confidence: 0.9284)
tmp min: tensor(0.) tmp max: tensor(1.)
952 32 540 960
There are 14 prompts
current IoU is: 0.03957144170999527
Seok, iteration idx= 16 IoU = tensor(0.0396)
SKIP, unacceptable sam prediction, IoU is tensor(0.0396)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 3.3ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9430
Selected instance: 0 (Confidence: 0.9680)
tmp min: tensor(0.) tmp max: tensor(1.)
886 36 540 960
There are 12 prompts
current IoU is: 0.03463161736726761
Seok, iteration idx= 17 IoU = tensor(0.0346)
SKIP, unacceptable sam prediction, IoU is tensor(0.0346)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9740
Instance 1: Confidence=0.9374
Selected instance: 1 (Confidence: 0.9374)
tmp min: tensor(0.) tmp max: tensor(1.)
267 76 540 960
There are 17 prompts
current IoU is: 0.15998391807079315
Seok, iteration idx= 18 IoU = tensor(0.1600)
SKIP, unacceptable sam prediction, IoU is tensor(0.1600)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9647
Instance 1: Confidence=0.9377
Selected instance: 1 (Confidence: 0.9377)
tmp min: tensor(0.) tmp max: tensor(1.)
286 88 540 960
There are 14 prompts
current IoU is: 0.1586541086435318
Seok, iteration idx= 19 IoU = tensor(0.1587)
SKIP, unacceptable sam prediction, IoU is tensor(0.1587)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9654
Instance 1: Confidence=0.9447
Selected instance: 1 (Confidence: 0.9447)
tmp min: tensor(0.) tmp max: tensor(1.)
330 120 540 960
There are 14 prompts
current IoU is: 0.1577463001012802
Seok, iteration idx= 20 IoU = tensor(0.1577)
SKIP, unacceptable sam prediction, IoU is tensor(0.1577)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9613
Instance 1: Confidence=0.9350
Selected instance: 1 (Confidence: 0.9350)
tmp min: tensor(0.) tmp max: tensor(1.)
399 72 540 960
There are 15 prompts
current IoU is: 0.1594344824552536
Seok, iteration idx= 21 IoU = tensor(0.1594)
SKIP, unacceptable sam prediction, IoU is tensor(0.1594)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 1
Instance 0: Confidence=0.9570
Selected instance: 0 (Confidence: 0.9570)
tmp min: tensor(0.) tmp max: tensor(1.)
498 36 540 960
There are 14 prompts
current IoU is: 0.007401986047625542
Seok, iteration idx= 22 IoU = tensor(0.0074)
SKIP, unacceptable sam prediction, IoU is tensor(0.0074)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9596
Instance 1: Confidence=0.9353
Selected instance: 1 (Confidence: 0.9353)
tmp min: tensor(0.) tmp max: tensor(1.)
510 68 540 960
There are 16 prompts
current IoU is: 0.14542244374752045
Seok, iteration idx= 23 IoU = tensor(0.1454)
SKIP, unacceptable sam prediction, IoU is tensor(0.1454)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 2.6ms preprocess, 22.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9272
Selected instance: 1 (Confidence: 0.9272)
tmp min: tensor(0.) tmp max: tensor(1.)
550 80 540 960
There are 11 prompts
current IoU is: 0.135529026389122
Seok, iteration idx= 24 IoU = tensor(0.1355)
SKIP, unacceptable sam prediction, IoU is tensor(0.1355)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.0ms
Speed: 3.0ms preprocess, 22.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9309
Selected instance: 1 (Confidence: 0.9309)
tmp min: tensor(0.) tmp max: tensor(1.)
637 68 540 960
There are 12 prompts
current IoU is: 0.1465044915676117
Seok, iteration idx= 25 IoU = tensor(0.1465)
SKIP, unacceptable sam prediction, IoU is tensor(0.1465)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 3.2ms preprocess, 22.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 2
Instance 0: Confidence=0.9582
Instance 1: Confidence=0.9248
Selected instance: 1 (Confidence: 0.9248)
tmp min: tensor(0.) tmp max: tensor(1.)
713 44 540 960
There are 12 prompts
current IoU is: 0.14288419485092163
Seok, iteration idx= 26 IoU = tensor(0.1429)
SKIP, unacceptable sam prediction, IoU is tensor(0.1429)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9183
Selected instance: 1 (Confidence: 0.9183)
tmp min: tensor(0.) tmp max: tensor(1.)
720 80 540 960
There are 14 prompts
current IoU is: 0.12887653708457947
Seok, iteration idx= 27 IoU = tensor(0.1289)
SKIP, unacceptable sam prediction, IoU is tensor(0.1289)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 2
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9258
Selected instance: 1 (Confidence: 0.9258)
tmp min: tensor(0.) tmp max: tensor(1.)
777 52 540 960
There are 16 prompts
current IoU is: 0.11929433047771454
Seok, iteration idx= 28 IoU = tensor(0.1193)
SKIP, unacceptable sam prediction, IoU is tensor(0.1193)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 2
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9293
Selected instance: 1 (Confidence: 0.9293)
tmp min: tensor(0.) tmp max: tensor(1.)
806 64 540 960
There are 15 prompts
current IoU is: 0.11183235794305801
Seok, iteration idx= 29 IoU = tensor(0.1118)
SKIP, unacceptable sam prediction, IoU is tensor(0.1118)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 2
Instance 0: Confidence=0.9606
Instance 1: Confidence=0.9400
Selected instance: 1 (Confidence: 0.9400)
tmp min: tensor(0.) tmp max: tensor(1.)
820 124 540 960
There are 14 prompts
current IoU is: 0.09839366376399994
Seok, iteration idx= 30 IoU = tensor(0.0984)
SKIP, unacceptable sam prediction, IoU is tensor(0.0984)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 2
Instance 0: Confidence=0.9601
Instance 1: Confidence=0.8530
Selected instance: 1 (Confidence: 0.8530)
tmp min: tensor(0.) tmp max: tensor(1.)
924 96 540 960
There are 18 prompts
current IoU is: 0.27856406569480896
Seok, iteration idx= 31 IoU = tensor(0.2786)
Selected Instance Confidence List: [tensor(0.4511), tensor(0.3825, device='cpu'), tensor(0.4807, device='cpu'), tensor(0.4874, device='cpu'), tensor(0.4727, device='cpu'), tensor(0.4748, device='cpu'), tensor(0.4688, device='cpu'), tensor(0.4668, device='cpu'), tensor(0.4670, device='cpu'), tensor(0.4699, device='cpu'), tensor(0.3820, device='cpu'), tensor(0.3829, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3870, device='cpu'), tensor(0.3782, device='cpu'), tensor(0.3798, device='cpu'), tensor(0.3951, device='cpu'), tensor(0.4080, device='cpu'), tensor(0.4709, device='cpu'), tensor(0.4703, device='cpu'), tensor(0.4725, device='cpu'), tensor(0.4696, device='cpu'), tensor(0.3872, device='cpu'), tensor(0.4614, device='cpu'), tensor(0.4522, device='cpu'), tensor(0.4603, device='cpu'), tensor(0.4557, device='cpu'), tensor(0.4446, device='cpu'), tensor(0.4419, device='cpu'), tensor(0.4388, device='cpu'), tensor(0.4350, device='cpu'), tensor(0.5083, device='cpu')]
Sorted Confidence Order: [tensor(0.5083, device='cpu'), tensor(0.4511), tensor(0.3825, device='cpu'), tensor(0.3820, device='cpu'), tensor(0.3829, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3870, device='cpu'), tensor(0.3782, device='cpu'), tensor(0.3798, device='cpu'), tensor(0.3951, device='cpu'), tensor(0.4080, device='cpu'), tensor(0.4350, device='cpu'), tensor(0.4388, device='cpu'), tensor(0.4419, device='cpu'), tensor(0.4446, device='cpu'), tensor(0.4557, device='cpu'), tensor(0.4603, device='cpu'), tensor(0.4522, device='cpu'), tensor(0.4614, device='cpu'), tensor(0.3872, device='cpu'), tensor(0.4696, device='cpu'), tensor(0.4725, device='cpu'), tensor(0.4703, device='cpu'), tensor(0.4709, device='cpu'), tensor(0.4699, device='cpu'), tensor(0.4670, device='cpu'), tensor(0.4668, device='cpu'), tensor(0.4688, device='cpu'), tensor(0.4748, device='cpu'), tensor(0.4727, device='cpu'), tensor(0.4874, device='cpu'), tensor(0.4807, device='cpu')]
sorted_indices: [31, 0, 1, 10, 11, 12, 13, 14, 15, 16, 17, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 9, 8, 7, 6, 5, 4, 3, 2]
Initial view (highest confidence): 36
New training order: [34, 35, 36, 9, 10, 11, 12, 13, 14, 15, 16, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.0ms
Speed: 3.2ms preprocess, 23.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 4
Instance 0: Confidence=0.9627
Instance 1: Confidence=0.7309
Instance 2: Confidence=0.4819
Instance 3: Confidence=0.4511
tmp min: tensor(0.) tmp max: tensor(1.)
947 88 540 960
There are 17 prompts
current IoU is: 0.6730095148086548
Seok, iteration idx= 1 IoU = tensor(0.6730)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 1.7ms preprocess, 23.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 2
Instance 0: Confidence=0.9563
Instance 1: Confidence=0.4461
tmp min: tensor(0.) tmp max: tensor(1.)
155 76 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 2 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.7ms
Speed: 1.3ms preprocess, 23.7ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 1
Instance 0: Confidence=0.9550
tmp min: tensor(0.) tmp max: tensor(1.)
184 64 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 3 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 1
Instance 0: Confidence=0.9572
tmp min: tensor(0.) tmp max: tensor(1.)
186 72 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 4 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 3
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.8823
Instance 2: Confidence=0.4506
tmp min: tensor(0.) tmp max: tensor(1.)
214 64 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 5 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.1ms
Speed: 3.4ms preprocess, 24.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9674
Instance 1: Confidence=0.6939
tmp min: tensor(0.) tmp max: tensor(1.)
230 68 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 6 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 2.5ms preprocess, 22.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9456
Instance 1: Confidence=0.8489
tmp min: tensor(0.) tmp max: tensor(1.)
268 80 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 7 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.0ms
Speed: 2.4ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 3
Instance 0: Confidence=0.9496
Instance 1: Confidence=0.8183
Instance 2: Confidence=0.3549
tmp min: tensor(0.) tmp max: tensor(1.)
312 96 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 8 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.8ms
Speed: 3.4ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 3
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9284
Instance 2: Confidence=0.7120
tmp min: tensor(0.) tmp max: tensor(1.)
952 32 540 960
There are 14 prompts
current IoU is: 0.27616772055625916
Seok, iteration idx= 9 IoU = tensor(0.2762)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 2.8ms preprocess, 23.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9430
tmp min: tensor(0.) tmp max: tensor(1.)
886 36 540 960
There are 12 prompts
current IoU is: 0.5222901701927185
Seok, iteration idx= 10 IoU = tensor(0.5223)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 3.2ms preprocess, 22.2ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9606
Instance 1: Confidence=0.9400
tmp min: tensor(0.) tmp max: tensor(1.)
820 124 540 960
There are 14 prompts
current IoU is: 0.5678515434265137
Seok, iteration idx= 11 IoU = tensor(0.5679)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 1.3ms preprocess, 23.3ms inference, 3.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9293
tmp min: tensor(0.) tmp max: tensor(1.)
806 64 540 960
There are 15 prompts
current IoU is: 0.7122699618339539
Seok, iteration idx= 12 IoU = tensor(0.7123)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 1.8ms preprocess, 22.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9258
tmp min: tensor(0.) tmp max: tensor(1.)
777 52 540 960
There are 16 prompts
current IoU is: 0.8676099181175232
Seok, iteration idx= 13 IoU = tensor(0.8676)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 1.3ms preprocess, 23.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9183
tmp min: tensor(0.) tmp max: tensor(1.)
720 80 540 960
There are 14 prompts
current IoU is: 0.8726279139518738
Seok, iteration idx= 14 IoU = tensor(0.8726)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 2
Instance 0: Confidence=0.9582
Instance 1: Confidence=0.9248
tmp min: tensor(0.) tmp max: tensor(1.)
713 44 540 960
There are 12 prompts
current IoU is: 0.880203902721405
Seok, iteration idx= 15 IoU = tensor(0.8802)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 1.4ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9309
tmp min: tensor(0.) tmp max: tensor(1.)
637 68 540 960
There are 12 prompts
current IoU is: 0.8802136182785034
Seok, iteration idx= 16 IoU = tensor(0.8802)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 2.7ms preprocess, 23.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9272
tmp min: tensor(0.) tmp max: tensor(1.)
550 80 540 960
There are 11 prompts
current IoU is: 0.8407119512557983
Seok, iteration idx= 17 IoU = tensor(0.8407)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9596
Instance 1: Confidence=0.9353
tmp min: tensor(0.) tmp max: tensor(1.)
510 68 540 960
There are 16 prompts
current IoU is: 0.861077606678009
Seok, iteration idx= 18 IoU = tensor(0.8611)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 1
Instance 0: Confidence=0.9570
tmp min: tensor(0.) tmp max: tensor(1.)
498 36 540 960
There are 14 prompts
current IoU is: 0.004444199148565531
Seok, iteration idx= 19 IoU = tensor(0.0044)
SKIP, unacceptable sam prediction, IoU is tensor(0.0044)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 2.0ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9613
Instance 1: Confidence=0.9350
tmp min: tensor(0.) tmp max: tensor(1.)
399 72 540 960
There are 15 prompts
current IoU is: 0.7840210199356079
Seok, iteration idx= 20 IoU = tensor(0.7840)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.5ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9654
Instance 1: Confidence=0.9447
tmp min: tensor(0.) tmp max: tensor(1.)
330 120 540 960
There are 14 prompts
current IoU is: 0.8533341288566589
Seok, iteration idx= 21 IoU = tensor(0.8533)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 1.6ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 2
Instance 0: Confidence=0.9647
Instance 1: Confidence=0.9377
tmp min: tensor(0.) tmp max: tensor(1.)
286 88 540 960
There are 14 prompts
current IoU is: 0.8456670045852661
Seok, iteration idx= 22 IoU = tensor(0.8457)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.5ms preprocess, 22.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9740
Instance 1: Confidence=0.9374
tmp min: tensor(0.) tmp max: tensor(1.)
267 76 540 960
There are 17 prompts
current IoU is: 0.8813660740852356
Seok, iteration idx= 23 IoU = tensor(0.8814)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 1.8ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9734
Instance 1: Confidence=0.9361
tmp min: tensor(0.) tmp max: tensor(1.)
187 72 540 960
There are 16 prompts
current IoU is: 0.8842043280601501
Seok, iteration idx= 24 IoU = tensor(0.8842)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9707
Instance 1: Confidence=0.9349
tmp min: tensor(0.) tmp max: tensor(1.)
165 60 540 960
There are 16 prompts
current IoU is: 0.863556981086731
Seok, iteration idx= 25 IoU = tensor(0.8636)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.6ms
Speed: 1.3ms preprocess, 22.6ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 3
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.6308
tmp min: tensor(0.) tmp max: tensor(1.)
140 68 540 960
There are 16 prompts
current IoU is: 0.9104083776473999
Seok, iteration idx= 26 IoU = tensor(0.9104)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.3ms preprocess, 22.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 2
Instance 0: Confidence=0.9701
Instance 1: Confidence=0.9441
tmp min: tensor(0.) tmp max: tensor(1.)
69 48 540 960
There are 14 prompts
current IoU is: 0.9080435633659363
Seok, iteration idx= 27 IoU = tensor(0.9080)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 2.6ms preprocess, 23.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 2
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9575
tmp min: tensor(0.) tmp max: tensor(1.)
44 68 540 960
There are 16 prompts
current IoU is: 0.9216908812522888
Seok, iteration idx= 28 IoU = tensor(0.9217)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.0ms
Speed: 2.2ms preprocess, 23.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 3
Instance 0: Confidence=0.9624
Instance 1: Confidence=0.9555
Instance 2: Confidence=0.6049
tmp min: tensor(0.) tmp max: tensor(1.)
43 64 540 960
There are 17 prompts
current IoU is: 0.9269985556602478
Seok, iteration idx= 29 IoU = tensor(0.9270)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.4ms
Speed: 3.4ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 3
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.3825
tmp min: tensor(0.) tmp max: tensor(1.)
24 72 540 960
There are 15 prompts
current IoU is: 0.9152019023895264
Seok, iteration idx= 30 IoU = tensor(0.9152)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 3.2ms preprocess, 23.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 2
Instance 0: Confidence=0.9536
Instance 1: Confidence=0.9447
tmp min: tensor(0.) tmp max: tensor(1.)
32 80 540 960
There are 14 prompts
current IoU is: 0.9053025841712952
Seok, iteration idx= 31 IoU = tensor(0.9053)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set7_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set7_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.24s/it]
Testing psnr 29.035378023982048 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set7_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.18it/s]
Testing psnr 3.3902665972709656 (avg)
train: coarse segmentation in 00:05:51
train: finish (eps time 00:05:51 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set7_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set8/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 37.12it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set8 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set8
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set8_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.2ms
Speed: 2.7ms preprocess, 20.2ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.3ms
Speed: 1.2ms preprocess, 20.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.3ms
Speed: 1.3ms preprocess, 21.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.4ms
Speed: 1.6ms preprocess, 20.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.6ms
Speed: 1.3ms preprocess, 20.6ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.6ms
Speed: 1.5ms preprocess, 20.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.3ms
Speed: 1.6ms preprocess, 20.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.4ms
Speed: 1.5ms preprocess, 20.4ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.7ms
Speed: 1.5ms preprocess, 21.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.3ms
Speed: 1.5ms preprocess, 20.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.6ms
Speed: 1.9ms preprocess, 21.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.6ms
Speed: 1.4ms preprocess, 21.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.1ms
Speed: 1.7ms preprocess, 21.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.8ms
Speed: 1.2ms preprocess, 20.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.7ms
Speed: 2.4ms preprocess, 20.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.6ms preprocess, 20.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 1.6ms preprocess, 22.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.1ms
Speed: 1.5ms preprocess, 21.1ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.6ms
Speed: 1.4ms preprocess, 20.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.9ms
Speed: 1.7ms preprocess, 20.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.0ms
Speed: 1.2ms preprocess, 21.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.0ms
Speed: 1.3ms preprocess, 21.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.6ms preprocess, 23.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.3ms
Speed: 1.6ms preprocess, 21.3ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.6ms
Speed: 1.3ms preprocess, 20.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.9ms
Speed: 1.4ms preprocess, 19.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.1ms
Speed: 2.9ms preprocess, 21.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 15
view_order: [16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.0ms
Speed: 1.4ms preprocess, 20.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 1
Instance 0: Confidence=0.9438
Selected instance: 0 (Confidence: 0.9438)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

400 40 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 15 prompts
current IoU is: 0.049868885427713394
Seok, iteration idx= 1 IoU = tensor(0.0499)
SKIP, unacceptable sam prediction, IoU is tensor(0.0499)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 1
Instance 0: Confidence=0.9419
Selected instance: 0 (Confidence: 0.9419)
tmp min: tensor(0.) tmp max: tensor(1.)
375 52 540 960
There are 16 prompts
current IoU is: 0.04526907950639725
Seok, iteration idx= 2 IoU = tensor(0.0453)
SKIP, unacceptable sam prediction, IoU is tensor(0.0453)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 1.6ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 2
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.7583
Selected instance: 0 (Confidence: 0.9489)
tmp min: tensor(0.) tmp max: tensor(1.)
390 88 540 960
There are 16 prompts
current IoU is: 0.044370122253894806
Seok, iteration idx= 3 IoU = tensor(0.0444)
SKIP, unacceptable sam prediction, IoU is tensor(0.0444)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.0ms
Speed: 1.3ms preprocess, 22.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 2
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9110
Selected instance: 0 (Confidence: 0.9526)
tmp min: tensor(0.) tmp max: tensor(1.)
386 44 540 960
There are 15 prompts
current IoU is: 0.06555292010307312
Seok, iteration idx= 4 IoU = tensor(0.0656)
SKIP, unacceptable sam prediction, IoU is tensor(0.0656)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.5ms
Speed: 1.4ms preprocess, 21.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9398
Selected instance: 0 (Confidence: 0.9530)
tmp min: tensor(0.) tmp max: tensor(1.)
395 52 540 960
There are 15 prompts
current IoU is: 0.06195793300867081
Seok, iteration idx= 5 IoU = tensor(0.0620)
SKIP, unacceptable sam prediction, IoU is tensor(0.0620)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 2.7ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9348
Selected instance: 0 (Confidence: 0.9594)
tmp min: tensor(0.) tmp max: tensor(1.)
388 32 540 960
There are 16 prompts
current IoU is: 0.067965567111969
Seok, iteration idx= 6 IoU = tensor(0.0680)
SKIP, unacceptable sam prediction, IoU is tensor(0.0680)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 2.8ms preprocess, 22.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9411
Selected instance: 0 (Confidence: 0.9540)
tmp min: tensor(0.) tmp max: tensor(1.)
374 48 540 960
There are 14 prompts
current IoU is: 0.078379787504673
Seok, iteration idx= 7 IoU = tensor(0.0784)
SKIP, unacceptable sam prediction, IoU is tensor(0.0784)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 3.1ms preprocess, 22.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9531
Instance 1: Confidence=0.9502
Selected instance: 0 (Confidence: 0.9531)
tmp min: tensor(0.) tmp max: tensor(1.)
413 36 540 960
There are 14 prompts
current IoU is: 0.086327463388443
Seok, iteration idx= 8 IoU = tensor(0.0863)
SKIP, unacceptable sam prediction, IoU is tensor(0.0863)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.0ms
Speed: 1.4ms preprocess, 22.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9479
Selected instance: 1 (Confidence: 0.9479)
tmp min: tensor(0.) tmp max: tensor(1.)
442 16 540 960
There are 13 prompts
current IoU is: 0.090969517827034
Seok, iteration idx= 9 IoU = tensor(0.0910)
SKIP, unacceptable sam prediction, IoU is tensor(0.0910)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 3.1ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9527
Instance 1: Confidence=0.9453
Selected instance: 1 (Confidence: 0.9453)
tmp min: tensor(0.) tmp max: tensor(1.)
422 60 540 960
There are 17 prompts
current IoU is: 0.09249240159988403
Seok, iteration idx= 10 IoU = tensor(0.0925)
SKIP, unacceptable sam prediction, IoU is tensor(0.0925)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9330
Selected instance: 1 (Confidence: 0.9330)
tmp min: tensor(0.) tmp max: tensor(1.)
437 28 540 960
There are 16 prompts
current IoU is: 0.09761646389961243
Seok, iteration idx= 11 IoU = tensor(0.0976)
SKIP, unacceptable sam prediction, IoU is tensor(0.0976)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 1.5ms preprocess, 22.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9514
Instance 1: Confidence=0.9420
Selected instance: 1 (Confidence: 0.9420)
tmp min: tensor(0.) tmp max: tensor(1.)
448 44 540 960
There are 14 prompts
current IoU is: 0.0970502570271492
Seok, iteration idx= 12 IoU = tensor(0.0971)
SKIP, unacceptable sam prediction, IoU is tensor(0.0971)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 2.0ms preprocess, 22.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9259
Selected instance: 1 (Confidence: 0.9259)
tmp min: tensor(0.) tmp max: tensor(1.)
444 120 540 960
There are 15 prompts
current IoU is: 0.09208941459655762
Seok, iteration idx= 13 IoU = tensor(0.0921)
SKIP, unacceptable sam prediction, IoU is tensor(0.0921)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 3
Instance 0: Confidence=0.9418
Instance 1: Confidence=0.9212
Instance 2: Confidence=0.5274
Selected instance: 1 (Confidence: 0.9212)
tmp min: tensor(0.) tmp max: tensor(1.)
466 92 540 960
There are 15 prompts
current IoU is: 0.09982068091630936
Seok, iteration idx= 14 IoU = tensor(0.0998)
SKIP, unacceptable sam prediction, IoU is tensor(0.0998)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 3
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.2551
Selected instance: 1 (Confidence: 0.9302)
tmp min: tensor(0.) tmp max: tensor(1.)
469 92 540 960
There are 16 prompts
current IoU is: 0.09540709108114243
Seok, iteration idx= 15 IoU = tensor(0.0954)
SKIP, unacceptable sam prediction, IoU is tensor(0.0954)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 1.3ms preprocess, 22.1ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9257
Selected instance: 1 (Confidence: 0.9257)
tmp min: tensor(0.) tmp max: tensor(1.)
468 64 540 960
There are 16 prompts
current IoU is: 0.10268063098192215
Seok, iteration idx= 16 IoU = tensor(0.1027)
SKIP, unacceptable sam prediction, IoU is tensor(0.1027)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 2.9ms preprocess, 22.1ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9398
Instance 1: Confidence=0.8970
Selected instance: 0 (Confidence: 0.9398)
tmp min: tensor(0.) tmp max: tensor(1.)
463 76 540 960
There are 15 prompts
current IoU is: 0.022880125790834427
Seok, iteration idx= 17 IoU = tensor(0.0229)
SKIP, unacceptable sam prediction, IoU is tensor(0.0229)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.9ms
Speed: 2.9ms preprocess, 21.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9516
Instance 1: Confidence=0.8899
Selected instance: 0 (Confidence: 0.9516)
tmp min: tensor(0.) tmp max: tensor(1.)
454 56 540 960
There are 17 prompts
current IoU is: 0.02653936669230461
Seok, iteration idx= 18 IoU = tensor(0.0265)
SKIP, unacceptable sam prediction, IoU is tensor(0.0265)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.1ms
Speed: 3.1ms preprocess, 22.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 3
Instance 0: Confidence=0.9405
Instance 1: Confidence=0.9138
Instance 2: Confidence=0.4672
Selected instance: 0 (Confidence: 0.9405)
tmp min: tensor(0.) tmp max: tensor(1.)
449 44 540 960
There are 16 prompts
current IoU is: 0.02929951623082161
Seok, iteration idx= 19 IoU = tensor(0.0293)
SKIP, unacceptable sam prediction, IoU is tensor(0.0293)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.5ms
Speed: 2.7ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 3
Instance 0: Confidence=0.9450
Instance 1: Confidence=0.8929
Instance 2: Confidence=0.7195
Selected instance: 0 (Confidence: 0.9450)
tmp min: tensor(0.) tmp max: tensor(1.)
418 40 540 960
There are 16 prompts
current IoU is: 0.046247050166130066
Seok, iteration idx= 20 IoU = tensor(0.0462)
SKIP, unacceptable sam prediction, IoU is tensor(0.0462)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 3
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9083
Instance 2: Confidence=0.7298
Selected instance: 0 (Confidence: 0.9458)
tmp min: tensor(0.) tmp max: tensor(1.)
405 20 540 960
There are 19 prompts
current IoU is: 0.043923523277044296
Seok, iteration idx= 21 IoU = tensor(0.0439)
SKIP, unacceptable sam prediction, IoU is tensor(0.0439)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.3ms
Speed: 1.3ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 3
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.8985
Instance 2: Confidence=0.8365
Selected instance: 0 (Confidence: 0.9384)
tmp min: tensor(0.) tmp max: tensor(1.)
434 24 540 960
There are 19 prompts
current IoU is: 0.048057351261377335
Seok, iteration idx= 22 IoU = tensor(0.0481)
SKIP, unacceptable sam prediction, IoU is tensor(0.0481)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.8323
Selected instance: 0 (Confidence: 0.9477)
tmp min: tensor(0.) tmp max: tensor(1.)
397 20 540 960
There are 16 prompts
current IoU is: 0.04707817733287811
Seok, iteration idx= 23 IoU = tensor(0.0471)
SKIP, unacceptable sam prediction, IoU is tensor(0.0471)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.7016
Selected instance: 0 (Confidence: 0.9483)
tmp min: tensor(0.) tmp max: tensor(1.)
364 20 540 960
There are 15 prompts
current IoU is: 0.047049667686223984
Seok, iteration idx= 24 IoU = tensor(0.0470)
SKIP, unacceptable sam prediction, IoU is tensor(0.0470)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.3ms preprocess, 22.5ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9293
Instance 1: Confidence=0.9154
Selected instance: 0 (Confidence: 0.9293)
tmp min: tensor(0.) tmp max: tensor(1.)
503 48 540 960
There are 16 prompts
current IoU is: 0.0913679301738739
Seok, iteration idx= 25 IoU = tensor(0.0914)
SKIP, unacceptable sam prediction, IoU is tensor(0.0914)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 2
Instance 0: Confidence=0.9417
Instance 1: Confidence=0.9213
Selected instance: 0 (Confidence: 0.9417)
tmp min: tensor(0.) tmp max: tensor(1.)
503 52 540 960
There are 17 prompts
current IoU is: 0.07320886105298996
Seok, iteration idx= 26 IoU = tensor(0.0732)
SKIP, unacceptable sam prediction, IoU is tensor(0.0732)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.9ms
Speed: 3.0ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 3
Instance 0: Confidence=0.9340
Instance 1: Confidence=0.9279
Instance 2: Confidence=0.8775
Selected instance: 0 (Confidence: 0.9340)
tmp min: tensor(0.) tmp max: tensor(1.)
502 40 540 960
There are 16 prompts
current IoU is: 0.06068415567278862
Seok, iteration idx= 27 IoU = tensor(0.0607)
SKIP, unacceptable sam prediction, IoU is tensor(0.0607)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.4ms
Speed: 2.9ms preprocess, 22.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 3
Instance 0: Confidence=0.9416
Instance 1: Confidence=0.9159
Instance 2: Confidence=0.5724
Selected instance: 0 (Confidence: 0.9416)
tmp min: tensor(0.) tmp max: tensor(1.)
513 40 540 960
There are 19 prompts
current IoU is: 0.051192931830883026
Seok, iteration idx= 28 IoU = tensor(0.0512)
SKIP, unacceptable sam prediction, IoU is tensor(0.0512)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.3ms
Speed: 2.6ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 3
Instance 0: Confidence=0.9417
Instance 1: Confidence=0.9193
Instance 2: Confidence=0.8251
Selected instance: 0 (Confidence: 0.9417)
tmp min: tensor(0.) tmp max: tensor(1.)
516 48 540 960
There are 17 prompts
current IoU is: 0.05040418356657028
Seok, iteration idx= 29 IoU = tensor(0.0504)
SKIP, unacceptable sam prediction, IoU is tensor(0.0504)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.9ms
Speed: 2.5ms preprocess, 22.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 3
Instance 0: Confidence=0.9349
Instance 1: Confidence=0.9199
Instance 2: Confidence=0.8269
Selected instance: 0 (Confidence: 0.9349)
tmp min: tensor(0.) tmp max: tensor(1.)
532 60 540 960
There are 19 prompts
current IoU is: 0.04501388967037201
Seok, iteration idx= 30 IoU = tensor(0.0450)
SKIP, unacceptable sam prediction, IoU is tensor(0.0450)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.1ms
Speed: 1.3ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 3
Instance 0: Confidence=0.8907
Instance 1: Confidence=0.8869
Instance 2: Confidence=0.8282
Selected instance: 0 (Confidence: 0.8907)
tmp min: tensor(0.) tmp max: tensor(1.)
526 80 540 960
There are 16 prompts
current IoU is: 0.06055107340216637
Seok, iteration idx= 31 IoU = tensor(0.0606)
SKIP, unacceptable sam prediction, IoU is tensor(0.0606)
Selected Instance Confidence List: [tensor(0.3985), tensor(0.4074, device='cpu'), tensor(0.4039, device='cpu'), tensor(0.4062, device='cpu'), tensor(0.4204, device='cpu'), tensor(0.4184, device='cpu'), tensor(0.4245, device='cpu'), tensor(0.4286, device='cpu'), tensor(0.4330, device='cpu'), tensor(0.4337, device='cpu'), tensor(0.4336, device='cpu'), tensor(0.4318, device='cpu'), tensor(0.4350, device='cpu'), tensor(0.4256, device='cpu'), tensor(0.4284, device='cpu'), tensor(0.4293, device='cpu'), tensor(0.4319, device='cpu'), tensor(0.3896, device='cpu'), tensor(0.3966, device='cpu'), tensor(0.3938, device='cpu'), tensor(0.4058, device='cpu'), tensor(0.4047, device='cpu'), tensor(0.4042, device='cpu'), tensor(0.4073, device='cpu'), tensor(0.4076, device='cpu'), tensor(0.4266, device='cpu'), tensor(0.4206, device='cpu'), tensor(0.4100, device='cpu'), tensor(0.4074, device='cpu'), tensor(0.4069, device='cpu'), tensor(0.4010, device='cpu'), tensor(0.3926, device='cpu')]
Sorted Confidence Order: [tensor(0.4350, device='cpu'), tensor(0.4318, device='cpu'), tensor(0.4336, device='cpu'), tensor(0.4337, device='cpu'), tensor(0.4330, device='cpu'), tensor(0.4286, device='cpu'), tensor(0.4245, device='cpu'), tensor(0.4184, device='cpu'), tensor(0.4204, device='cpu'), tensor(0.4062, device='cpu'), tensor(0.4039, device='cpu'), tensor(0.4074, device='cpu'), tensor(0.4076, device='cpu'), tensor(0.4073, device='cpu'), tensor(0.4042, device='cpu'), tensor(0.4047, device='cpu'), tensor(0.4058, device='cpu'), tensor(0.3938, device='cpu'), tensor(0.3966, device='cpu'), tensor(0.3896, device='cpu'), tensor(0.3985), tensor(0.3926, device='cpu'), tensor(0.4010, device='cpu'), tensor(0.4069, device='cpu'), tensor(0.4074, device='cpu'), tensor(0.4100, device='cpu'), tensor(0.4206, device='cpu'), tensor(0.4266, device='cpu'), tensor(0.4319, device='cpu'), tensor(0.4293, device='cpu'), tensor(0.4284, device='cpu'), tensor(0.4256, device='cpu')]
sorted_indices: [12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 24, 23, 22, 21, 20, 19, 18, 17, 0, 31, 30, 29, 28, 27, 26, 25, 16, 15, 14, 13]
Initial view (highest confidence): 13
New training order: [32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15, 14, 13, 12, 11, 10, 9, 36, 35, 34, 33]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.4ms
Speed: 1.3ms preprocess, 19.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 1.3ms preprocess, 22.6ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 2
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9330
tmp min: tensor(0.) tmp max: tensor(1.)
437 28 540 960
There are 16 prompts
current IoU is: 0.7958675026893616
Seok, iteration idx= 1 IoU = tensor(0.7959)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 2
Instance 0: Confidence=0.9527
Instance 1: Confidence=0.9453
tmp min: tensor(0.) tmp max: tensor(1.)
422 60 540 960
There are 17 prompts
current IoU is: 0.7714329361915588
Seok, iteration idx= 2 IoU = tensor(0.7714)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 2
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9479
tmp min: tensor(0.) tmp max: tensor(1.)
442 16 540 960
There are 13 prompts
current IoU is: 0.8728219866752625
Seok, iteration idx= 3 IoU = tensor(0.8728)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 2
Instance 0: Confidence=0.9531
Instance 1: Confidence=0.9502
tmp min: tensor(0.) tmp max: tensor(1.)
413 36 540 960
There are 14 prompts
current IoU is: 0.8769589066505432
Seok, iteration idx= 4 IoU = tensor(0.8770)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.3ms preprocess, 22.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9411
tmp min: tensor(0.) tmp max: tensor(1.)
374 48 540 960
There are 14 prompts
current IoU is: 0.8865634799003601
Seok, iteration idx= 5 IoU = tensor(0.8866)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9348
tmp min: tensor(0.) tmp max: tensor(1.)
388 32 540 960
There are 16 prompts
current IoU is: 0.8986481428146362
Seok, iteration idx= 6 IoU = tensor(0.8986)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.3ms preprocess, 22.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9398
tmp min: tensor(0.) tmp max: tensor(1.)
395 52 540 960
There are 15 prompts
current IoU is: 0.8784552812576294
Seok, iteration idx= 7 IoU = tensor(0.8785)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9110
tmp min: tensor(0.) tmp max: tensor(1.)
386 44 540 960
There are 15 prompts
current IoU is: 0.8851457834243774
Seok, iteration idx= 8 IoU = tensor(0.8851)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.4ms
Speed: 1.4ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.7583
tmp min: tensor(0.) tmp max: tensor(1.)
390 88 540 960
There are 16 prompts
current IoU is: 0.87545245885849
Seok, iteration idx= 9 IoU = tensor(0.8755)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.1ms
Speed: 2.8ms preprocess, 22.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 1
Instance 0: Confidence=0.9419
tmp min: tensor(0.) tmp max: tensor(1.)
375 52 540 960
There are 16 prompts
current IoU is: 0.8816090226173401
Seok, iteration idx= 10 IoU = tensor(0.8816)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 1
Instance 0: Confidence=0.9438
tmp min: tensor(0.) tmp max: tensor(1.)
400 40 540 960
There are 15 prompts
current IoU is: 0.8538408279418945
Seok, iteration idx= 11 IoU = tensor(0.8538)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 1.3ms preprocess, 22.3ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.7016
tmp min: tensor(0.) tmp max: tensor(1.)
364 20 540 960
There are 15 prompts
current IoU is: 0.8492922782897949
Seok, iteration idx= 12 IoU = tensor(0.8493)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.0ms
Speed: 1.3ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.8323
tmp min: tensor(0.) tmp max: tensor(1.)
397 20 540 960
There are 16 prompts
current IoU is: 0.9073120951652527
Seok, iteration idx= 13 IoU = tensor(0.9073)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.1ms
Speed: 1.6ms preprocess, 23.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 3
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.8985
Instance 2: Confidence=0.8365
tmp min: tensor(0.) tmp max: tensor(1.)
434 24 540 960
There are 19 prompts
current IoU is: 0.8869494199752808
Seok, iteration idx= 14 IoU = tensor(0.8869)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.6ms
Speed: 1.3ms preprocess, 22.6ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 3
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9083
Instance 2: Confidence=0.7298
tmp min: tensor(0.) tmp max: tensor(1.)
405 20 540 960
There are 19 prompts
current IoU is: 0.8916006684303284
Seok, iteration idx= 15 IoU = tensor(0.8916)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.0ms
Speed: 1.8ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 3
Instance 0: Confidence=0.9450
Instance 1: Confidence=0.8929
Instance 2: Confidence=0.7195
tmp min: tensor(0.) tmp max: tensor(1.)
418 40 540 960
There are 16 prompts
current IoU is: 0.9096968770027161
Seok, iteration idx= 16 IoU = tensor(0.9097)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 3
Instance 0: Confidence=0.9405
Instance 1: Confidence=0.9138
Instance 2: Confidence=0.4672
tmp min: tensor(0.) tmp max: tensor(1.)
449 44 540 960
There are 16 prompts
current IoU is: 0.8774511218070984
Seok, iteration idx= 17 IoU = tensor(0.8775)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9516
Instance 1: Confidence=0.8899
tmp min: tensor(0.) tmp max: tensor(1.)
454 56 540 960
There are 17 prompts
current IoU is: 0.8922282457351685
Seok, iteration idx= 18 IoU = tensor(0.8922)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9398
Instance 1: Confidence=0.8970
tmp min: tensor(0.) tmp max: tensor(1.)
463 76 540 960
There are 15 prompts
current IoU is: 0.895179271697998
Seok, iteration idx= 19 IoU = tensor(0.8952)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.9ms
Speed: 1.3ms preprocess, 23.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 4
Instance 0: Confidence=0.8856
Instance 1: Confidence=0.8280
Instance 2: Confidence=0.5240
Instance 3: Confidence=0.3985
tmp min: tensor(0.) tmp max: tensor(1.)
519 120 540 960
There are 16 prompts
current IoU is: 0.4395209550857544
Seok, iteration idx= 20 IoU = tensor(0.4395)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 3
Instance 0: Confidence=0.8907
Instance 1: Confidence=0.8869
Instance 2: Confidence=0.8282
tmp min: tensor(0.) tmp max: tensor(1.)
526 80 540 960
There are 16 prompts
current IoU is: 0.7197074890136719
Seok, iteration idx= 21 IoU = tensor(0.7197)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.1ms
Speed: 1.3ms preprocess, 22.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 3
Instance 0: Confidence=0.9349
Instance 1: Confidence=0.9199
Instance 2: Confidence=0.8269
tmp min: tensor(0.) tmp max: tensor(1.)
532 60 540 960
There are 19 prompts
current IoU is: 0.6684545278549194
Seok, iteration idx= 22 IoU = tensor(0.6685)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 3
Instance 0: Confidence=0.9417
Instance 1: Confidence=0.9193
Instance 2: Confidence=0.8251
tmp min: tensor(0.) tmp max: tensor(1.)
516 48 540 960
There are 17 prompts
current IoU is: 0.8426877856254578
Seok, iteration idx= 23 IoU = tensor(0.8427)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.5ms
Speed: 1.6ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 3
Instance 0: Confidence=0.9416
Instance 1: Confidence=0.9159
Instance 2: Confidence=0.5724
tmp min: tensor(0.) tmp max: tensor(1.)
513 40 540 960
There are 19 prompts
current IoU is: 0.8760945796966553
Seok, iteration idx= 24 IoU = tensor(0.8761)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.0ms
Speed: 1.7ms preprocess, 23.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 3
Instance 0: Confidence=0.9340
Instance 1: Confidence=0.9279
Instance 2: Confidence=0.8775
tmp min: tensor(0.) tmp max: tensor(1.)
502 40 540 960
There are 16 prompts
current IoU is: 0.8294239640235901
Seok, iteration idx= 25 IoU = tensor(0.8294)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 2.7ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 2
Instance 0: Confidence=0.9417
Instance 1: Confidence=0.9213
tmp min: tensor(0.) tmp max: tensor(1.)
503 52 540 960
There are 17 prompts
current IoU is: 0.8703092932701111
Seok, iteration idx= 26 IoU = tensor(0.8703)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 2
Instance 0: Confidence=0.9293
Instance 1: Confidence=0.9154
tmp min: tensor(0.) tmp max: tensor(1.)
503 48 540 960
There are 16 prompts
current IoU is: 0.8940759301185608
Seok, iteration idx= 27 IoU = tensor(0.8941)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 2
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9257
tmp min: tensor(0.) tmp max: tensor(1.)
468 64 540 960
There are 16 prompts
current IoU is: 0.6640820503234863
Seok, iteration idx= 28 IoU = tensor(0.6641)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.4ms
Speed: 1.3ms preprocess, 23.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 3
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.2551
tmp min: tensor(0.) tmp max: tensor(1.)
469 92 540 960
There are 16 prompts
current IoU is: 0.914372980594635
Seok, iteration idx= 29 IoU = tensor(0.9144)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.9ms
Speed: 1.6ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 3
Instance 0: Confidence=0.9418
Instance 1: Confidence=0.9212
Instance 2: Confidence=0.5274
tmp min: tensor(0.) tmp max: tensor(1.)
466 92 540 960
There are 15 prompts
current IoU is: 0.9175617098808289
Seok, iteration idx= 30 IoU = tensor(0.9176)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 2
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9259
tmp min: tensor(0.) tmp max: tensor(1.)
444 120 540 960
There are 15 prompts
current IoU is: 0.9089915156364441
Seok, iteration idx= 31 IoU = tensor(0.9090)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set8_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set8_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.25s/it]
Testing psnr 28.60439032316208 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set8_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:28<00:00,  1.13it/s]
Testing psnr 3.6796456295996904 (avg)
train: coarse segmentation in 00:03:52
train: finish (eps time 00:03:52 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set8_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set9/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 32.68it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set9 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set9
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set9_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.9ms
Speed: 3.0ms preprocess, 20.9ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.4ms
Speed: 1.2ms preprocess, 20.4ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.4ms
Speed: 1.3ms preprocess, 19.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.0ms
Speed: 1.5ms preprocess, 20.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.7ms
Speed: 1.4ms preprocess, 20.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 1.4ms preprocess, 20.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 1.5ms preprocess, 20.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.8ms
Speed: 1.5ms preprocess, 21.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 1.5ms preprocess, 20.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.6ms
Speed: 1.2ms preprocess, 19.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.8ms
Speed: 1.3ms preprocess, 19.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.1ms
Speed: 1.9ms preprocess, 20.1ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 1.5ms preprocess, 20.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.1ms
Speed: 1.5ms preprocess, 20.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.0ms
Speed: 1.4ms preprocess, 20.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.5ms
Speed: 1.4ms preprocess, 19.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.8ms
Speed: 1.4ms preprocess, 19.8ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.8ms
Speed: 1.5ms preprocess, 19.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 1.5ms preprocess, 20.2ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 1.5ms preprocess, 20.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.1ms
Speed: 1.5ms preprocess, 20.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.1ms
Speed: 1.2ms preprocess, 20.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.6ms
Speed: 1.2ms preprocess, 19.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.7ms
Speed: 1.2ms preprocess, 19.7ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.1ms
Speed: 1.3ms preprocess, 20.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.6ms
Speed: 1.5ms preprocess, 20.6ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 1.5ms preprocess, 20.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.1ms
Speed: 1.4ms preprocess, 20.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.9ms
Speed: 1.4ms preprocess, 19.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.2ms
Speed: 1.4ms preprocess, 20.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.1ms
Speed: 1.2ms preprocess, 20.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.3ms
Speed: 1.7ms preprocess, 21.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9530
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.8797
Instance 4: Confidence=0.8281
Instance 5: Confidence=0.7251
Selected instance: 0 (Confidence: 0.9532)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

748 56 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.7905985713005066
Seok, iteration idx= 1 IoU = tensor(0.7906)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.9ms
Speed: 1.4ms preprocess, 21.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 4
Instance 0: Confidence=0.9523
Instance 1: Confidence=0.9468
Instance 2: Confidence=0.9161
Instance 3: Confidence=0.8821
Selected instance: 1 (Confidence: 0.9468)
tmp min: tensor(0.) tmp max: tensor(1.)
691 80 540 960
There are 16 prompts
current IoU is: 0.8328107595443726
Seok, iteration idx= 2 IoU = tensor(0.8328)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9327
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9102
Instance 3: Confidence=0.8415
Instance 4: Confidence=0.7714
Selected instance: 1 (Confidence: 0.9307)
tmp min: tensor(0.) tmp max: tensor(1.)
648 112 540 960
There are 14 prompts
current IoU is: 0.8957518935203552
Seok, iteration idx= 3 IoU = tensor(0.8958)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.6ms preprocess, 22.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9506
Instance 2: Confidence=0.8723
Instance 3: Confidence=0.8416
Instance 4: Confidence=0.8138
Instance 5: Confidence=0.3145
Selected instance: 3 (Confidence: 0.8416)
tmp min: tensor(0.) tmp max: tensor(1.)
345 88 540 960
There are 15 prompts
current IoU is: 0.5412130355834961
Seok, iteration idx= 4 IoU = tensor(0.5412)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.1ms
Speed: 1.4ms preprocess, 22.1ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 6
Instance 0: Confidence=0.9543
Instance 1: Confidence=0.9481
Instance 2: Confidence=0.8723
Instance 3: Confidence=0.8448
Instance 4: Confidence=0.8141
Instance 5: Confidence=0.7543
Selected instance: 2 (Confidence: 0.8723)
tmp min: tensor(0.) tmp max: tensor(1.)
320 92 540 960
There are 15 prompts
current IoU is: 0.5790924429893494
Seok, iteration idx= 5 IoU = tensor(0.5791)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 8
Instance 0: Confidence=0.9574
Instance 1: Confidence=0.9518
Instance 2: Confidence=0.8906
Instance 3: Confidence=0.8743
Instance 4: Confidence=0.6790
Instance 5: Confidence=0.4519
Instance 6: Confidence=0.3982
Instance 7: Confidence=0.2843
Selected instance: 3 (Confidence: 0.8743)
tmp min: tensor(0.) tmp max: tensor(1.)
354 124 540 960
There are 15 prompts
current IoU is: 0.7164844870567322
Seok, iteration idx= 6 IoU = tensor(0.7165)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 1.4ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9355
Instance 2: Confidence=0.9115
Instance 3: Confidence=0.8830
Instance 4: Confidence=0.7381
Instance 5: Confidence=0.7063
Selected instance: 3 (Confidence: 0.8830)
tmp min: tensor(0.) tmp max: tensor(1.)
398 80 540 960
There are 18 prompts
current IoU is: 0.8013558387756348
Seok, iteration idx= 7 IoU = tensor(0.8014)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 1.3ms preprocess, 22.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9499
Instance 1: Confidence=0.9225
Instance 2: Confidence=0.9120
Instance 3: Confidence=0.9019
Instance 4: Confidence=0.8923
Selected instance: 3 (Confidence: 0.9019)
tmp min: tensor(0.) tmp max: tensor(1.)
602 64 540 960
There are 15 prompts
current IoU is: 0.0040465351194143295
Seok, iteration idx= 8 IoU = tensor(0.0040)
SKIP, unacceptable sam prediction, IoU is tensor(0.0040)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 2.3ms preprocess, 23.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9663
Instance 1: Confidence=0.9506
Instance 2: Confidence=0.9380
Instance 3: Confidence=0.8953
Instance 4: Confidence=0.8884
Instance 5: Confidence=0.6212
Selected instance: 5 (Confidence: 0.6212)
tmp min: tensor(0.) tmp max: tensor(1.)
514 128 540 960
There are 14 prompts
current IoU is: 0.5013140439987183
Seok, iteration idx= 9 IoU = tensor(0.5013)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 2.6ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9406
Instance 2: Confidence=0.8957
Instance 3: Confidence=0.8788
Instance 4: Confidence=0.6792
Instance 5: Confidence=0.2540
Selected instance: 3 (Confidence: 0.8788)
tmp min: tensor(0.) tmp max: tensor(1.)
499 84 540 960
There are 15 prompts
current IoU is: 0.7232693433761597
Seok, iteration idx= 10 IoU = tensor(0.7233)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 3.4ms preprocess, 23.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9677
Instance 1: Confidence=0.9541
Instance 2: Confidence=0.9076
Instance 3: Confidence=0.8270
Instance 4: Confidence=0.6917
Selected instance: 4 (Confidence: 0.6917)
tmp min: tensor(0.) tmp max: tensor(1.)
567 72 540 960
There are 15 prompts
current IoU is: 0.7904452085494995
Seok, iteration idx= 11 IoU = tensor(0.7904)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.8ms
Speed: 2.8ms preprocess, 21.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9664
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.8923
Instance 3: Confidence=0.6204
Instance 4: Confidence=0.4815
Instance 5: Confidence=0.4394
Selected instance: 5 (Confidence: 0.4394)
tmp min: tensor(0.) tmp max: tensor(1.)
621 52 540 960
There are 13 prompts
current IoU is: 0.3260042369365692
Seok, iteration idx= 12 IoU = tensor(0.3260)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 2.8ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9655
Instance 1: Confidence=0.9527
Instance 2: Confidence=0.9136
Instance 3: Confidence=0.8798
Instance 4: Confidence=0.8149
Instance 5: Confidence=0.6837
Selected instance: 5 (Confidence: 0.6837)
tmp min: tensor(0.) tmp max: tensor(1.)
610 92 540 960
There are 13 prompts
current IoU is: 0.38204488158226013
Seok, iteration idx= 13 IoU = tensor(0.3820)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 2.8ms preprocess, 23.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9565
Instance 1: Confidence=0.9201
Instance 2: Confidence=0.9047
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.8364
Instance 5: Confidence=0.4276
Instance 6: Confidence=0.3358
Selected instance: 4 (Confidence: 0.8364)
tmp min: tensor(0.) tmp max: tensor(1.)
654 60 540 960
There are 18 prompts
current IoU is: 0.7637692093849182
Seok, iteration idx= 14 IoU = tensor(0.7638)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 2.8ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9601
Instance 1: Confidence=0.9222
Instance 2: Confidence=0.9087
Instance 3: Confidence=0.8744
Instance 4: Confidence=0.7555
Selected instance: 4 (Confidence: 0.7555)
tmp min: tensor(0.) tmp max: tensor(1.)
658 100 540 960
There are 16 prompts
current IoU is: 0.7397186756134033
Seok, iteration idx= 15 IoU = tensor(0.7397)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 3.0ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 7
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9223
Instance 2: Confidence=0.9203
Instance 3: Confidence=0.8729
Instance 4: Confidence=0.7752
Instance 5: Confidence=0.6791
Instance 6: Confidence=0.3599
Selected instance: 3 (Confidence: 0.8729)
tmp min: tensor(0.) tmp max: tensor(1.)
663 140 540 960
There are 15 prompts
current IoU is: 0.7534037232398987
Seok, iteration idx= 16 IoU = tensor(0.7534)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 2.3ms preprocess, 23.4ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9394
Instance 1: Confidence=0.9324
Instance 2: Confidence=0.9258
Instance 3: Confidence=0.9160
Instance 4: Confidence=0.9043
Selected instance: 2 (Confidence: 0.9258)
tmp min: tensor(0.) tmp max: tensor(1.)
721 112 540 960
There are 17 prompts
current IoU is: 0.8699374198913574
Seok, iteration idx= 17 IoU = tensor(0.8699)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.3ms
Speed: 2.8ms preprocess, 22.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 7
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9479
Instance 2: Confidence=0.9307
Instance 3: Confidence=0.9156
Instance 4: Confidence=0.8290
Instance 5: Confidence=0.7404
Instance 6: Confidence=0.3328
Selected instance: 2 (Confidence: 0.9307)
tmp min: tensor(0.) tmp max: tensor(1.)
730 108 540 960
There are 15 prompts
current IoU is: 0.9078506827354431
Seok, iteration idx= 18 IoU = tensor(0.9079)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 2.6ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9400
Instance 2: Confidence=0.9397
Instance 3: Confidence=0.8820
Instance 4: Confidence=0.8574
Instance 5: Confidence=0.5968
Instance 6: Confidence=0.3960
Selected instance: 1 (Confidence: 0.9400)
tmp min: tensor(0.) tmp max: tensor(1.)
768 88 540 960
There are 16 prompts
current IoU is: 0.9168413877487183
Seok, iteration idx= 19 IoU = tensor(0.9168)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 2.5ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 7
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9180
Instance 3: Confidence=0.8806
Instance 4: Confidence=0.7796
Instance 5: Confidence=0.4945
Instance 6: Confidence=0.4307
Selected instance: 2 (Confidence: 0.9180)
tmp min: tensor(0.) tmp max: tensor(1.)
224 96 540 960
There are 14 prompts
current IoU is: 0.7576576471328735
Seok, iteration idx= 20 IoU = tensor(0.7577)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.1ms
Speed: 2.7ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9511
Instance 2: Confidence=0.9189
Instance 3: Confidence=0.8933
Instance 4: Confidence=0.8605
Instance 5: Confidence=0.8161
Selected instance: 2 (Confidence: 0.9189)
tmp min: tensor(0.) tmp max: tensor(1.)
210 84 540 960
There are 17 prompts
current IoU is: 0.8358685970306396
Seok, iteration idx= 21 IoU = tensor(0.8359)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 3.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9659
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.9025
Instance 4: Confidence=0.8976
Instance 5: Confidence=0.8199
Selected instance: 4 (Confidence: 0.8976)
tmp min: tensor(0.) tmp max: tensor(1.)
210 76 540 960
There are 14 prompts
current IoU is: 0.858552098274231
Seok, iteration idx= 22 IoU = tensor(0.8586)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 7
Instance 0: Confidence=0.9650
Instance 1: Confidence=0.9498
Instance 2: Confidence=0.9253
Instance 3: Confidence=0.8752
Instance 4: Confidence=0.6702
Instance 5: Confidence=0.4329
Instance 6: Confidence=0.3059
Selected instance: 5 (Confidence: 0.4329)
tmp min: tensor(0.) tmp max: tensor(1.)
175 124 540 960
There are 13 prompts
current IoU is: 0.3043666183948517
Seok, iteration idx= 23 IoU = tensor(0.3044)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 8
Instance 0: Confidence=0.9547
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9168
Instance 3: Confidence=0.9027
Instance 4: Confidence=0.7627
Instance 5: Confidence=0.3927
Instance 6: Confidence=0.3073
Instance 7: Confidence=0.2968
Selected instance: 7 (Confidence: 0.2968)
tmp min: tensor(0.) tmp max: tensor(1.)
228 68 540 960
current IoU is: 0.629808247089386
Seok, iteration idx= 24 IoU = tensor(0.6298)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.3ms preprocess, 23.0ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9214
Instance 2: Confidence=0.9091
Instance 3: Confidence=0.8954
Instance 4: Confidence=0.8457
Instance 5: Confidence=0.6131
Selected instance: 4 (Confidence: 0.8457)
tmp min: tensor(0.) tmp max: tensor(1.)
255 72 540 960
There are 19 prompts
current IoU is: 0.8449055552482605
Seok, iteration idx= 25 IoU = tensor(0.8449)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.9ms preprocess, 23.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9614
Instance 1: Confidence=0.9360
Instance 2: Confidence=0.9196
Instance 3: Confidence=0.8601
Instance 4: Confidence=0.8506
Instance 5: Confidence=0.4255
Selected instance: 4 (Confidence: 0.8506)
tmp min: tensor(0.) tmp max: tensor(1.)
247 68 540 960
There are 14 prompts
current IoU is: 0.8285492062568665
Seok, iteration idx= 26 IoU = tensor(0.8285)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 7
Instance 0: Confidence=0.9614
Instance 1: Confidence=0.9443
Instance 2: Confidence=0.9363
Instance 3: Confidence=0.7233
Instance 4: Confidence=0.5203
Instance 5: Confidence=0.3875
Instance 6: Confidence=0.3196
Selected instance: 5 (Confidence: 0.3875)
tmp min: tensor(0.) tmp max: tensor(1.)
251 76 540 960
There are 13 prompts
current IoU is: 0.46708643436431885
Seok, iteration idx= 27 IoU = tensor(0.4671)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 1.3ms preprocess, 22.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9562
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.9215
Instance 3: Confidence=0.8554
Instance 4: Confidence=0.7123
Selected instance: 2 (Confidence: 0.9215)
tmp min: tensor(0.) tmp max: tensor(1.)
788 68 540 960
There are 15 prompts
current IoU is: 0.9202180504798889
Seok, iteration idx= 28 IoU = tensor(0.9202)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9559
Instance 1: Confidence=0.9326
Instance 2: Confidence=0.9255
Instance 3: Confidence=0.8958
Instance 4: Confidence=0.8174
Instance 5: Confidence=0.2734
Selected instance: 2 (Confidence: 0.9255)
tmp min: tensor(0.) tmp max: tensor(1.)
793 64 540 960
There are 15 prompts
current IoU is: 0.9117567539215088
Seok, iteration idx= 29 IoU = tensor(0.9118)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9356
Instance 2: Confidence=0.9105
Instance 3: Confidence=0.8693
Instance 4: Confidence=0.7860
Instance 5: Confidence=0.4345
Instance 6: Confidence=0.2986
Selected instance: 2 (Confidence: 0.9105)
tmp min: tensor(0.) tmp max: tensor(1.)
791 52 540 960
There are 15 prompts
current IoU is: 0.9234649538993835
Seok, iteration idx= 30 IoU = tensor(0.9235)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9608
Instance 1: Confidence=0.9245
Instance 2: Confidence=0.9014
Instance 3: Confidence=0.8902
Instance 4: Confidence=0.8448
Selected instance: 1 (Confidence: 0.9245)
tmp min: tensor(0.) tmp max: tensor(1.)
791 48 540 960
There are 18 prompts
current IoU is: 0.8646923899650574
Seok, iteration idx= 31 IoU = tensor(0.8647)
Selected Instance Confidence List: [tensor(0.9250), tensor(0.8556, device='cpu'), tensor(0.8784, device='cpu'), tensor(0.9097, device='cpu'), tensor(0.6614, device='cpu'), tensor(0.6964, device='cpu'), tensor(0.7796, device='cpu'), tensor(0.8340, device='cpu'), tensor(0.3800, device='cpu'), tensor(0.5493, device='cpu'), tensor(0.7855, device='cpu'), tensor(0.7509, device='cpu'), tensor(0.3867, device='cpu'), tensor(0.5027, device='cpu'), tensor(0.7928, device='cpu'), tensor(0.7461, device='cpu'), tensor(0.8012, device='cpu'), tensor(0.8923, device='cpu'), tensor(0.9170, device='cpu'), tensor(0.9261, device='cpu'), tensor(0.8218, device='cpu'), tensor(0.8691, device='cpu'), tensor(0.8742, device='cpu'), tensor(0.3860, device='cpu'), tensor(0.5001, device='cpu'), tensor(0.8452, device='cpu'), tensor(0.8374, device='cpu'), tensor(0.4353, device='cpu'), tensor(0.9207, device='cpu'), tensor(0.9172, device='cpu'), tensor(0.9183, device='cpu'), tensor(0.8886, device='cpu')]
Sorted Confidence Order: [tensor(0.9261, device='cpu'), tensor(0.9170, device='cpu'), tensor(0.8923, device='cpu'), tensor(0.9207, device='cpu'), tensor(0.9172, device='cpu'), tensor(0.9183, device='cpu'), tensor(0.8886, device='cpu'), tensor(0.9250), tensor(0.8556, device='cpu'), tensor(0.8784, device='cpu'), tensor(0.9097, device='cpu'), tensor(0.8012, device='cpu'), tensor(0.7461, device='cpu'), tensor(0.7928, device='cpu'), tensor(0.5027, device='cpu'), tensor(0.3867, device='cpu'), tensor(0.7509, device='cpu'), tensor(0.7855, device='cpu'), tensor(0.5493, device='cpu'), tensor(0.3800, device='cpu'), tensor(0.8340, device='cpu'), tensor(0.7796, device='cpu'), tensor(0.6964, device='cpu'), tensor(0.6614, device='cpu'), tensor(0.4353, device='cpu'), tensor(0.8374, device='cpu'), tensor(0.8452, device='cpu'), tensor(0.5001, device='cpu'), tensor(0.3860, device='cpu'), tensor(0.8742, device='cpu'), tensor(0.8691, device='cpu'), tensor(0.8218, device='cpu')]
sorted_indices: [19, 18, 17, 28, 29, 30, 31, 0, 1, 2, 3, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 27, 26, 25, 24, 23, 22, 21, 20]
Initial view (highest confidence): 24
New training order: [36, 35, 34, 9, 10, 11, 12, 13, 14, 15, 16, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 7
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9479
Instance 2: Confidence=0.9307
Instance 3: Confidence=0.9156
Instance 4: Confidence=0.8290
Instance 5: Confidence=0.7404
Instance 6: Confidence=0.3328
tmp min: tensor(0.) tmp max: tensor(1.)
730 108 540 960
There are 15 prompts
current IoU is: 0.9302433133125305
Seok, iteration idx= 1 IoU = tensor(0.9302)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.6ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 5
Instance 0: Confidence=0.9394
Instance 1: Confidence=0.9324
Instance 2: Confidence=0.9258
Instance 3: Confidence=0.9160
Instance 4: Confidence=0.9043
tmp min: tensor(0.) tmp max: tensor(1.)
721 112 540 960
There are 17 prompts
current IoU is: 0.9189319610595703
Seok, iteration idx= 2 IoU = tensor(0.9189)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.3ms preprocess, 23.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9562
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.9215
Instance 3: Confidence=0.8554
Instance 4: Confidence=0.7123
tmp min: tensor(0.) tmp max: tensor(1.)
788 68 540 960
There are 15 prompts
current IoU is: 0.9295807480812073
Seok, iteration idx= 3 IoU = tensor(0.9296)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.9ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9559
Instance 1: Confidence=0.9326
Instance 2: Confidence=0.9255
Instance 3: Confidence=0.8958
Instance 4: Confidence=0.8174
Instance 5: Confidence=0.2734
tmp min: tensor(0.) tmp max: tensor(1.)
793 64 540 960
There are 15 prompts
current IoU is: 0.9449290037155151
Seok, iteration idx= 4 IoU = tensor(0.9449)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.1ms
Speed: 1.4ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9356
Instance 2: Confidence=0.9105
Instance 3: Confidence=0.8693
Instance 4: Confidence=0.7860
Instance 5: Confidence=0.4345
Instance 6: Confidence=0.2986
tmp min: tensor(0.) tmp max: tensor(1.)
791 52 540 960
There are 15 prompts
current IoU is: 0.9297317862510681
Seok, iteration idx= 5 IoU = tensor(0.9297)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9608
Instance 1: Confidence=0.9245
Instance 2: Confidence=0.9014
Instance 3: Confidence=0.8902
Instance 4: Confidence=0.8448
tmp min: tensor(0.) tmp max: tensor(1.)
791 48 540 960
There are 18 prompts
current IoU is: 0.8892242908477783
Seok, iteration idx= 6 IoU = tensor(0.8892)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 8
Instance 0: Confidence=0.9628
Instance 1: Confidence=0.9444
Instance 2: Confidence=0.9268
Instance 3: Confidence=0.9250
Instance 4: Confidence=0.9162
Instance 5: Confidence=0.8189
Instance 6: Confidence=0.3158
Instance 7: Confidence=0.2605
tmp min: tensor(0.) tmp max: tensor(1.)
763 52 540 960
There are 18 prompts
current IoU is: 0.9393588900566101
Seok, iteration idx= 7 IoU = tensor(0.9394)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9530
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.8797
Instance 4: Confidence=0.8281
Instance 5: Confidence=0.7251
tmp min: tensor(0.) tmp max: tensor(1.)
748 56 540 960
There are 16 prompts
current IoU is: 0.9546933174133301
Seok, iteration idx= 8 IoU = tensor(0.9547)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 4
Instance 0: Confidence=0.9523
Instance 1: Confidence=0.9468
Instance 2: Confidence=0.9161
Instance 3: Confidence=0.8821
tmp min: tensor(0.) tmp max: tensor(1.)
691 80 540 960
There are 16 prompts
current IoU is: 0.9289186596870422
Seok, iteration idx= 9 IoU = tensor(0.9289)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 3.7ms preprocess, 22.8ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9327
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9102
Instance 3: Confidence=0.8415
Instance 4: Confidence=0.7714
tmp min: tensor(0.) tmp max: tensor(1.)
648 112 540 960
There are 14 prompts
current IoU is: 0.9216086864471436
Seok, iteration idx= 10 IoU = tensor(0.9216)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 1.7ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9223
Instance 2: Confidence=0.9203
Instance 3: Confidence=0.8729
Instance 4: Confidence=0.7752
Instance 5: Confidence=0.6791
Instance 6: Confidence=0.3599
tmp min: tensor(0.) tmp max: tensor(1.)
663 140 540 960
There are 15 prompts
current IoU is: 0.7919244766235352
Seok, iteration idx= 11 IoU = tensor(0.7919)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9601
Instance 1: Confidence=0.9222
Instance 2: Confidence=0.9087
Instance 3: Confidence=0.8744
Instance 4: Confidence=0.7555
tmp min: tensor(0.) tmp max: tensor(1.)
658 100 540 960
There are 16 prompts
current IoU is: 0.8415757417678833
Seok, iteration idx= 12 IoU = tensor(0.8416)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 7
Instance 0: Confidence=0.9565
Instance 1: Confidence=0.9201
Instance 2: Confidence=0.9047
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.8364
Instance 5: Confidence=0.4276
Instance 6: Confidence=0.3358
tmp min: tensor(0.) tmp max: tensor(1.)
654 60 540 960
There are 18 prompts
current IoU is: 0.8404094576835632
Seok, iteration idx= 13 IoU = tensor(0.8404)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.3ms preprocess, 23.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9655
Instance 1: Confidence=0.9527
Instance 2: Confidence=0.9136
Instance 3: Confidence=0.8798
Instance 4: Confidence=0.8149
Instance 5: Confidence=0.6837
tmp min: tensor(0.) tmp max: tensor(1.)
610 92 540 960
There are 13 prompts
current IoU is: 0.692307710647583
Seok, iteration idx= 14 IoU = tensor(0.6923)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9664
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.8923
Instance 3: Confidence=0.6204
Instance 4: Confidence=0.4815
Instance 5: Confidence=0.4394
tmp min: tensor(0.) tmp max: tensor(1.)
621 52 540 960
There are 13 prompts
current IoU is: 0.8007928729057312
Seok, iteration idx= 15 IoU = tensor(0.8008)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 2.4ms preprocess, 23.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9677
Instance 1: Confidence=0.9541
Instance 2: Confidence=0.9076
Instance 3: Confidence=0.8270
Instance 4: Confidence=0.6917
tmp min: tensor(0.) tmp max: tensor(1.)
567 72 540 960
There are 15 prompts
current IoU is: 0.9274600744247437
Seok, iteration idx= 16 IoU = tensor(0.9275)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 3.4ms preprocess, 22.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9406
Instance 2: Confidence=0.8957
Instance 3: Confidence=0.8788
Instance 4: Confidence=0.6792
Instance 5: Confidence=0.2540
tmp min: tensor(0.) tmp max: tensor(1.)
499 84 540 960
There are 15 prompts
current IoU is: 0.8434300422668457
Seok, iteration idx= 17 IoU = tensor(0.8434)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 3.6ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9663
Instance 1: Confidence=0.9506
Instance 2: Confidence=0.9380
Instance 3: Confidence=0.8953
Instance 4: Confidence=0.8884
Instance 5: Confidence=0.6212
tmp min: tensor(0.) tmp max: tensor(1.)
514 128 540 960
There are 14 prompts
current IoU is: 0.8259477019309998
Seok, iteration idx= 18 IoU = tensor(0.8259)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 2.8ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9499
Instance 1: Confidence=0.9225
Instance 2: Confidence=0.9120
Instance 3: Confidence=0.9019
Instance 4: Confidence=0.8923
tmp min: tensor(0.) tmp max: tensor(1.)
702 32 540 960
There are 15 prompts
current IoU is: 0.001527136075310409
Seok, iteration idx= 19 IoU = tensor(0.0015)
SKIP, unacceptable sam prediction, IoU is tensor(0.0015)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 3.0ms preprocess, 23.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9355
Instance 2: Confidence=0.9115
Instance 3: Confidence=0.8830
Instance 4: Confidence=0.7381
Instance 5: Confidence=0.7063
tmp min: tensor(0.) tmp max: tensor(1.)
398 80 540 960
There are 18 prompts
current IoU is: 0.8681464195251465
Seok, iteration idx= 20 IoU = tensor(0.8681)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.9ms
Speed: 3.2ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 8
Instance 0: Confidence=0.9574
Instance 1: Confidence=0.9518
Instance 2: Confidence=0.8906
Instance 3: Confidence=0.8743
Instance 4: Confidence=0.6790
Instance 5: Confidence=0.4519
Instance 6: Confidence=0.3982
Instance 7: Confidence=0.2843
tmp min: tensor(0.) tmp max: tensor(1.)
354 124 540 960
There are 15 prompts
current IoU is: 0.8914324641227722
Seok, iteration idx= 21 IoU = tensor(0.8914)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 2.7ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9543
Instance 1: Confidence=0.9481
Instance 2: Confidence=0.8723
Instance 3: Confidence=0.8448
Instance 4: Confidence=0.8141
Instance 5: Confidence=0.7543
tmp min: tensor(0.) tmp max: tensor(1.)
320 92 540 960
There are 15 prompts
current IoU is: 0.9048710465431213
Seok, iteration idx= 22 IoU = tensor(0.9049)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 2.3ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9506
Instance 2: Confidence=0.8723
Instance 3: Confidence=0.8416
Instance 4: Confidence=0.8138
Instance 5: Confidence=0.3145
tmp min: tensor(0.) tmp max: tensor(1.)
345 88 540 960
There are 15 prompts
current IoU is: 0.7311233878135681
Seok, iteration idx= 23 IoU = tensor(0.7311)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 7
Instance 0: Confidence=0.9614
Instance 1: Confidence=0.9443
Instance 2: Confidence=0.9363
Instance 3: Confidence=0.7233
Instance 4: Confidence=0.5203
Instance 5: Confidence=0.3875
Instance 6: Confidence=0.3196
tmp min: tensor(0.) tmp max: tensor(1.)
251 76 540 960
There are 13 prompts
current IoU is: 0.5392221212387085
Seok, iteration idx= 24 IoU = tensor(0.5392)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9614
Instance 1: Confidence=0.9360
Instance 2: Confidence=0.9196
Instance 3: Confidence=0.8601
Instance 4: Confidence=0.8506
Instance 5: Confidence=0.4255
tmp min: tensor(0.) tmp max: tensor(1.)
247 68 540 960
There are 14 prompts
current IoU is: 0.8821384310722351
Seok, iteration idx= 25 IoU = tensor(0.8821)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9214
Instance 2: Confidence=0.9091
Instance 3: Confidence=0.8954
Instance 4: Confidence=0.8457
Instance 5: Confidence=0.6131
tmp min: tensor(0.) tmp max: tensor(1.)
255 72 540 960
There are 19 prompts
current IoU is: 0.8494631052017212
Seok, iteration idx= 26 IoU = tensor(0.8495)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.4ms
Speed: 1.9ms preprocess, 22.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 8
Instance 0: Confidence=0.9547
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9168
Instance 3: Confidence=0.9027
Instance 4: Confidence=0.7627
Instance 5: Confidence=0.3927
Instance 6: Confidence=0.3073
Instance 7: Confidence=0.2968
tmp min: tensor(0.) tmp max: tensor(1.)
228 68 540 960
current IoU is: 0.729494571685791
Seok, iteration idx= 27 IoU = tensor(0.7295)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.4ms
Speed: 1.7ms preprocess, 24.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 7
Instance 0: Confidence=0.9650
Instance 1: Confidence=0.9498
Instance 2: Confidence=0.9253
Instance 3: Confidence=0.8752
Instance 4: Confidence=0.6702
Instance 5: Confidence=0.4329
Instance 6: Confidence=0.3059
tmp min: tensor(0.) tmp max: tensor(1.)
175 124 540 960
There are 13 prompts
current IoU is: 0.3582834303379059
Seok, iteration idx= 28 IoU = tensor(0.3583)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9659
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.9025
Instance 4: Confidence=0.8976
Instance 5: Confidence=0.8199
tmp min: tensor(0.) tmp max: tensor(1.)
210 76 540 960
There are 14 prompts
current IoU is: 0.8967267870903015
Seok, iteration idx= 29 IoU = tensor(0.8967)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.7ms
Speed: 1.5ms preprocess, 24.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9511
Instance 2: Confidence=0.9189
Instance 3: Confidence=0.8933
Instance 4: Confidence=0.8605
Instance 5: Confidence=0.8161
tmp min: tensor(0.) tmp max: tensor(1.)
210 84 540 960
There are 17 prompts
current IoU is: 0.8903360962867737
Seok, iteration idx= 30 IoU = tensor(0.8903)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 7
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9180
Instance 3: Confidence=0.8806
Instance 4: Confidence=0.7796
Instance 5: Confidence=0.4945
Instance 6: Confidence=0.4307
tmp min: tensor(0.) tmp max: tensor(1.)
224 96 540 960
There are 14 prompts
current IoU is: 0.8401255011558533
Seok, iteration idx= 31 IoU = tensor(0.8401)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set9_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set9_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.24s/it]
Testing psnr 27.14804768562317 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set9_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:28<00:00,  1.14it/s]
Testing psnr 3.0103711877018213 (avg)
train: coarse segmentation in 00:03:39
train: finish (eps time 00:03:39 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set9_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set10/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 43.56it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set10 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set10
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set10_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.1ms
Speed: 2.4ms preprocess, 21.1ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.1ms
Speed: 1.2ms preprocess, 20.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.1ms
Speed: 1.5ms preprocess, 22.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.4ms
Speed: 1.2ms preprocess, 21.4ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.3ms
Speed: 1.5ms preprocess, 21.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.0ms
Speed: 1.5ms preprocess, 22.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.0ms
Speed: 1.5ms preprocess, 20.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.6ms
Speed: 1.4ms preprocess, 21.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.9ms
Speed: 2.1ms preprocess, 20.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.0ms
Speed: 1.2ms preprocess, 21.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.3ms
Speed: 1.3ms preprocess, 21.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 21.1ms
Speed: 1.3ms preprocess, 21.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.0ms
Speed: 1.3ms preprocess, 21.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.7ms
Speed: 1.3ms preprocess, 20.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.3ms
Speed: 1.2ms preprocess, 20.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 1.2ms preprocess, 20.3ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.0ms
Speed: 1.4ms preprocess, 21.0ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.0ms
Speed: 1.5ms preprocess, 21.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.9ms
Speed: 1.5ms preprocess, 20.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.1ms
Speed: 1.5ms preprocess, 21.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.9ms
Speed: 1.4ms preprocess, 20.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.0ms
Speed: 1.5ms preprocess, 21.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.5ms
Speed: 1.6ms preprocess, 21.5ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.4ms
Speed: 1.5ms preprocess, 20.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.8ms
Speed: 1.4ms preprocess, 20.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.7ms
Speed: 1.8ms preprocess, 21.7ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 1.5ms preprocess, 20.7ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.5ms
Speed: 1.5ms preprocess, 21.5ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.1ms
Speed: 1.3ms preprocess, 21.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.7ms
Speed: 1.2ms preprocess, 20.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 23.7ms
Speed: 14.8ms preprocess, 23.7ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 22.9ms
Speed: 4.1ms preprocess, 22.9ms inference, 3.4ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 1.2ms preprocess, 20.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9428
Instance 1: Confidence=0.9198
Instance 2: Confidence=0.8951
Instance 3: Confidence=0.8149
Instance 4: Confidence=0.7098
Instance 5: Confidence=0.4333
Selected instance: 4 (Confidence: 0.7098)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

381 80 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 13 prompts
current IoU is: 0.26824501156806946
Seok, iteration idx= 1 IoU = tensor(0.2682)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.9ms
Speed: 1.5ms preprocess, 20.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 8
Instance 0: Confidence=0.9484
Instance 1: Confidence=0.9271
Instance 2: Confidence=0.9025
Instance 3: Confidence=0.7065
Instance 4: Confidence=0.5530
Instance 5: Confidence=0.4350
Instance 6: Confidence=0.2934
Instance 7: Confidence=0.2923
Selected instance: 2 (Confidence: 0.9025)
tmp min: tensor(0.) tmp max: tensor(1.)
340 80 540 960
There are 17 prompts
current IoU is: 0.0024289623834192753
Seok, iteration idx= 2 IoU = tensor(0.0024)
SKIP, unacceptable sam prediction, IoU is tensor(0.0024)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.0ms
Speed: 1.4ms preprocess, 22.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9401
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.7368
Instance 4: Confidence=0.3522
Selected instance: 4 (Confidence: 0.3522)
tmp min: tensor(0.) tmp max: tensor(1.)
435 132 540 960
There are 11 prompts
current IoU is: 0.18957054615020752
Seok, iteration idx= 3 IoU = tensor(0.1896)
SKIP, unacceptable sam prediction, IoU is tensor(0.1896)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.9ms
Speed: 1.4ms preprocess, 21.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9338
Instance 1: Confidence=0.9123
Instance 2: Confidence=0.8407
Instance 3: Confidence=0.4946
Instance 4: Confidence=0.4087
Instance 5: Confidence=0.3586
Selected instance: 0 (Confidence: 0.9338)
tmp min: tensor(0.) tmp max: tensor(1.)
620 32 540 960
There are 14 prompts
current IoU is: 0.1650758683681488
Seok, iteration idx= 4 IoU = tensor(0.1651)
SKIP, unacceptable sam prediction, IoU is tensor(0.1651)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.0ms
Speed: 1.4ms preprocess, 22.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.8207
Instance 3: Confidence=0.7721
Instance 4: Confidence=0.7155
Selected instance: 1 (Confidence: 0.9302)
tmp min: tensor(0.) tmp max: tensor(1.)
551 40 540 960
There are 13 prompts
current IoU is: 0.16976219415664673
Seok, iteration idx= 5 IoU = tensor(0.1698)
SKIP, unacceptable sam prediction, IoU is tensor(0.1698)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 1.9ms preprocess, 22.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9373
Instance 1: Confidence=0.9227
Instance 2: Confidence=0.8916
Instance 3: Confidence=0.8082
Instance 4: Confidence=0.3235
Selected instance: 1 (Confidence: 0.9227)
tmp min: tensor(0.) tmp max: tensor(1.)
542 76 540 960
There are 14 prompts
current IoU is: 0.1543988138437271
Seok, iteration idx= 6 IoU = tensor(0.1544)
SKIP, unacceptable sam prediction, IoU is tensor(0.1544)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.0ms
Speed: 2.7ms preprocess, 22.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9313
Instance 1: Confidence=0.8929
Instance 2: Confidence=0.8629
Instance 3: Confidence=0.8365
Instance 4: Confidence=0.7943
Instance 5: Confidence=0.7689
Instance 6: Confidence=0.3691
Selected instance: 0 (Confidence: 0.9313)
tmp min: tensor(0.) tmp max: tensor(1.)
500 36 540 960
There are 16 prompts
current IoU is: 0.1256491243839264
Seok, iteration idx= 7 IoU = tensor(0.1256)
SKIP, unacceptable sam prediction, IoU is tensor(0.1256)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 2.7ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9403
Instance 1: Confidence=0.9039
Instance 2: Confidence=0.8857
Instance 3: Confidence=0.8587
Instance 4: Confidence=0.7733
Selected instance: 0 (Confidence: 0.9403)
tmp min: tensor(0.) tmp max: tensor(1.)
433 36 540 960
There are 13 prompts
current IoU is: 0.12338584661483765
Seok, iteration idx= 8 IoU = tensor(0.1234)
SKIP, unacceptable sam prediction, IoU is tensor(0.1234)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.0ms
Speed: 2.5ms preprocess, 23.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 8
Instance 0: Confidence=0.9461
Instance 1: Confidence=0.9275
Instance 2: Confidence=0.9187
Instance 3: Confidence=0.7332
Instance 4: Confidence=0.5451
Instance 5: Confidence=0.3224
Instance 6: Confidence=0.3072
Instance 7: Confidence=0.2709
Selected instance: 0 (Confidence: 0.9461)
tmp min: tensor(0.) tmp max: tensor(1.)
385 12 540 960
There are 12 prompts
current IoU is: 0.1425509750843048
Seok, iteration idx= 9 IoU = tensor(0.1426)
SKIP, unacceptable sam prediction, IoU is tensor(0.1426)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 2.6ms preprocess, 22.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9400
Instance 2: Confidence=0.8922
Instance 3: Confidence=0.7839
Instance 4: Confidence=0.7346
Instance 5: Confidence=0.6675
Selected instance: 0 (Confidence: 0.9510)
tmp min: tensor(0.) tmp max: tensor(1.)
323 20 540 960
There are 15 prompts
current IoU is: 0.1612984985113144
Seok, iteration idx= 10 IoU = tensor(0.1613)
SKIP, unacceptable sam prediction, IoU is tensor(0.1613)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.8ms
Speed: 1.3ms preprocess, 21.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9128
Instance 2: Confidence=0.8616
Instance 3: Confidence=0.7378
Instance 4: Confidence=0.4551
Selected instance: 1 (Confidence: 0.9128)
tmp min: tensor(0.) tmp max: tensor(1.)
308 12 540 960
There are 15 prompts
current IoU is: 0.1857670098543167
Seok, iteration idx= 11 IoU = tensor(0.1858)
SKIP, unacceptable sam prediction, IoU is tensor(0.1858)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.8ms
Speed: 1.6ms preprocess, 21.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9553
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.8795
Instance 3: Confidence=0.5983
Instance 4: Confidence=0.4742
Selected instance: 1 (Confidence: 0.9348)
tmp min: tensor(0.) tmp max: tensor(1.)
296 0 540 960
There are 13 prompts
current IoU is: 0.2330058068037033
Seok, iteration idx= 12 IoU = tensor(0.2330)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.7ms
Speed: 1.5ms preprocess, 20.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 8
Instance 0: Confidence=0.9589
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.8897
Instance 3: Confidence=0.8221
Instance 4: Confidence=0.7976
Instance 5: Confidence=0.7491
Instance 6: Confidence=0.3801
Instance 7: Confidence=0.2839
Selected instance: 1 (Confidence: 0.9509)
tmp min: tensor(0.) tmp max: tensor(1.)
270 44 540 960
There are 15 prompts
current IoU is: 0.8555818796157837
Seok, iteration idx= 13 IoU = tensor(0.8556)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 1.4ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9545
Instance 1: Confidence=0.9200
Instance 2: Confidence=0.8959
Instance 3: Confidence=0.8240
Instance 4: Confidence=0.8171
Instance 5: Confidence=0.3278
Selected instance: 1 (Confidence: 0.9200)
tmp min: tensor(0.) tmp max: tensor(1.)
257 16 540 960
There are 17 prompts
current IoU is: 0.8941087126731873
Seok, iteration idx= 14 IoU = tensor(0.8941)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9534
Instance 1: Confidence=0.9170
Instance 2: Confidence=0.9081
Instance 3: Confidence=0.7840
Instance 4: Confidence=0.7586
Selected instance: 2 (Confidence: 0.9081)
tmp min: tensor(0.) tmp max: tensor(1.)
262 36 540 960
There are 17 prompts
current IoU is: 0.9061517715454102
Seok, iteration idx= 15 IoU = tensor(0.9062)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.8ms
Speed: 1.7ms preprocess, 21.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9128
Instance 2: Confidence=0.9021
Instance 3: Confidence=0.7538
Instance 4: Confidence=0.6958
Instance 5: Confidence=0.4477
Selected instance: 1 (Confidence: 0.9128)
tmp min: tensor(0.) tmp max: tensor(1.)
266 120 540 960
There are 17 prompts
current IoU is: 0.877936065196991
Seok, iteration idx= 16 IoU = tensor(0.8779)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9349
Instance 2: Confidence=0.8948
Instance 3: Confidence=0.8225
Instance 4: Confidence=0.7823
Selected instance: 2 (Confidence: 0.8948)
tmp min: tensor(0.) tmp max: tensor(1.)
269 92 540 960
There are 17 prompts
current IoU is: 0.8430646657943726
Seok, iteration idx= 17 IoU = tensor(0.8431)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9343
Instance 1: Confidence=0.9156
Instance 2: Confidence=0.8866
Instance 3: Confidence=0.8747
Instance 4: Confidence=0.7347
Instance 5: Confidence=0.5717
Selected instance: 2 (Confidence: 0.8866)
tmp min: tensor(0.) tmp max: tensor(1.)
264 100 540 960
There are 17 prompts
current IoU is: 0.8724250197410583
Seok, iteration idx= 18 IoU = tensor(0.8724)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9327
Instance 2: Confidence=0.8889
Instance 3: Confidence=0.8410
Instance 4: Confidence=0.7670
Instance 5: Confidence=0.3930
Instance 6: Confidence=0.3173
Selected instance: 3 (Confidence: 0.8410)
tmp min: tensor(0.) tmp max: tensor(1.)
271 68 540 960
There are 14 prompts
current IoU is: 0.8201779723167419
Seok, iteration idx= 19 IoU = tensor(0.8202)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9357
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.8987
Instance 3: Confidence=0.8981
Instance 4: Confidence=0.8441
Instance 5: Confidence=0.7465
Selected instance: 3 (Confidence: 0.8981)
tmp min: tensor(0.) tmp max: tensor(1.)
635 92 540 960
There are 19 prompts
current IoU is: 0.5539770126342773
Seok, iteration idx= 20 IoU = tensor(0.5540)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9505
Instance 1: Confidence=0.9323
Instance 2: Confidence=0.8850
Instance 3: Confidence=0.8476
Instance 4: Confidence=0.6034
Instance 5: Confidence=0.3047
Selected instance: 3 (Confidence: 0.8476)
tmp min: tensor(0.) tmp max: tensor(1.)
663 64 540 960
There are 17 prompts
current IoU is: 0.788164496421814
Seok, iteration idx= 21 IoU = tensor(0.7882)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 7
Instance 0: Confidence=0.9535
Instance 1: Confidence=0.9077
Instance 2: Confidence=0.8941
Instance 3: Confidence=0.7788
Instance 4: Confidence=0.7653
Instance 5: Confidence=0.6566
Instance 6: Confidence=0.4216
Selected instance: 2 (Confidence: 0.8941)
tmp min: tensor(0.) tmp max: tensor(1.)
687 52 540 960
There are 17 prompts
current IoU is: 0.8085649013519287
Seok, iteration idx= 22 IoU = tensor(0.8086)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.0ms
Speed: 1.6ms preprocess, 22.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 7
Instance 0: Confidence=0.9425
Instance 1: Confidence=0.9028
Instance 2: Confidence=0.8830
Instance 3: Confidence=0.8673
Instance 4: Confidence=0.8513
Instance 5: Confidence=0.6991
Instance 6: Confidence=0.4623
Selected instance: 3 (Confidence: 0.8673)
tmp min: tensor(0.) tmp max: tensor(1.)
659 48 540 960
There are 16 prompts
current IoU is: 0.8543128967285156
Seok, iteration idx= 23 IoU = tensor(0.8543)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9449
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9027
Instance 3: Confidence=0.8698
Instance 4: Confidence=0.7552
Instance 5: Confidence=0.5370
Selected instance: 3 (Confidence: 0.8698)
tmp min: tensor(0.) tmp max: tensor(1.)
668 28 540 960
There are 18 prompts
current IoU is: 0.8825750350952148
Seok, iteration idx= 24 IoU = tensor(0.8826)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.7ms preprocess, 22.2ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9103
Instance 2: Confidence=0.9077
Instance 3: Confidence=0.8864
Instance 4: Confidence=0.3265
Selected instance: 2 (Confidence: 0.9077)
tmp min: tensor(0.) tmp max: tensor(1.)
688 20 540 960
There are 15 prompts
current IoU is: 0.8976802229881287
Seok, iteration idx= 25 IoU = tensor(0.8977)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9350
Instance 1: Confidence=0.9340
Instance 2: Confidence=0.8964
Instance 3: Confidence=0.8023
Instance 4: Confidence=0.4329
Selected instance: 1 (Confidence: 0.9340)
tmp min: tensor(0.) tmp max: tensor(1.)
649 12 540 960
There are 16 prompts
current IoU is: 0.9124778509140015
Seok, iteration idx= 26 IoU = tensor(0.9125)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 4
Instance 0: Confidence=0.9348
Instance 1: Confidence=0.9073
Instance 2: Confidence=0.9057
Instance 3: Confidence=0.7642
Selected instance: 0 (Confidence: 0.9348)
tmp min: tensor(0.) tmp max: tensor(1.)
606 0 540 960
There are 15 prompts
current IoU is: 0.916346549987793
Seok, iteration idx= 27 IoU = tensor(0.9163)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 3.0ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9387
Instance 1: Confidence=0.9300
Instance 2: Confidence=0.9169
Instance 3: Confidence=0.6203
Instance 4: Confidence=0.5186
Instance 5: Confidence=0.2775
Selected instance: 3 (Confidence: 0.6203)
tmp min: tensor(0.) tmp max: tensor(1.)
294 52 540 960
There are 12 prompts
current IoU is: 0.2735006511211395
Seok, iteration idx= 28 IoU = tensor(0.2735)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.5ms
Speed: 2.4ms preprocess, 22.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 8
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9200
Instance 2: Confidence=0.9052
Instance 3: Confidence=0.5757
Instance 4: Confidence=0.3700
Instance 5: Confidence=0.3422
Instance 6: Confidence=0.3060
Instance 7: Confidence=0.2816
Selected instance: 5 (Confidence: 0.3422)
tmp min: tensor(0.) tmp max: tensor(1.)
293 56 540 960
There are 11 prompts
current IoU is: 0.3589009642601013
Seok, iteration idx= 29 IoU = tensor(0.3589)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 2.6ms preprocess, 22.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9051
Instance 2: Confidence=0.9033
Instance 3: Confidence=0.8099
Instance 4: Confidence=0.2907
Selected instance: 2 (Confidence: 0.9033)
tmp min: tensor(0.) tmp max: tensor(1.)
325 20 540 960
There are 15 prompts
current IoU is: 0.03874887898564339
Seok, iteration idx= 30 IoU = tensor(0.0387)
SKIP, unacceptable sam prediction, IoU is tensor(0.0387)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 1.3ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9487
Instance 1: Confidence=0.9292
Instance 2: Confidence=0.8816
Instance 3: Confidence=0.8691
Instance 4: Confidence=0.7868
Instance 5: Confidence=0.2647
Selected instance: 4 (Confidence: 0.7868)
tmp min: tensor(0.) tmp max: tensor(1.)
354 84 540 960
There are 17 prompts
current IoU is: 0.7194471955299377
Seok, iteration idx= 31 IoU = tensor(0.7194)
Exception on /_dash-update-component [POST]
Traceback (most recent call last):
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/flask/app.py", line 2073, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/flask/app.py", line 1518, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/flask/app.py", line 1516, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/flask/app.py", line 1502, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/dash/dash.py", line 1261, in dispatch
    ctx.run(
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/dash/_callback.py", line 440, in add_context
    output_value = func(*func_args, **func_kwargs)  # %% callback invoked %%
  File "/home/lab/SA3D_YOLO/lib/gui.py", line 516, in start_training
    distance = compute_pose_distance(poses[prev_idx], poses[candidate])
IndexError: index 32 is out of bounds for dimension 0 with size 32
ERROR:lib.gui:Exception on /_dash-update-component [POST]
Traceback (most recent call last):
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/flask/app.py", line 2073, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/flask/app.py", line 1518, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/flask/app.py", line 1516, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/flask/app.py", line 1502, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/dash/dash.py", line 1261, in dispatch
    ctx.run(
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/dash/_callback.py", line 440, in add_context
    output_value = func(*func_args, **func_kwargs)  # %% callback invoked %%
  File "/home/lab/SA3D_YOLO/lib/gui.py", line 516, in start_training
    distance = compute_pose_distance(poses[prev_idx], poses[candidate])
IndexError: index 32 is out of bounds for dimension 0 with size 32
train: coarse segmentation in 00:23:07
train: finish (eps time 00:23:07 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set10_unbounded/coarse_segmentation_gui.tar[0m
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 699, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 230, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 211, in __init__
    super(_open_file, self).__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: './logs/nerf_unbounded/dcvgo_Set10_unbounded/coarse_segmentation_gui.tar'
^C
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set11/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 34.15it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set11 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set11
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set11_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 2.8ms preprocess, 20.0ms inference, 2.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.1ms
Speed: 1.4ms preprocess, 20.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 1.6ms preprocess, 20.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 1.5ms preprocess, 20.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.0ms
Speed: 1.4ms preprocess, 20.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.2ms
Speed: 1.5ms preprocess, 20.2ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.8ms
Speed: 1.5ms preprocess, 20.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.6ms
Speed: 1.5ms preprocess, 20.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.3ms
Speed: 1.4ms preprocess, 20.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.1ms
Speed: 1.4ms preprocess, 20.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 20.7ms
Speed: 1.4ms preprocess, 20.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 1.6ms preprocess, 20.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.2ms
Speed: 1.6ms preprocess, 20.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.1ms
Speed: 1.5ms preprocess, 20.1ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.8ms
Speed: 1.4ms preprocess, 19.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.1ms
Speed: 1.5ms preprocess, 20.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.6ms preprocess, 20.4ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.5ms preprocess, 20.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 1.4ms preprocess, 20.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.9ms
Speed: 1.4ms preprocess, 19.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.2ms
Speed: 1.5ms preprocess, 20.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.4ms
Speed: 1.5ms preprocess, 20.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.0ms
Speed: 1.5ms preprocess, 21.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.1ms
Speed: 1.4ms preprocess, 20.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.4ms
Speed: 1.5ms preprocess, 20.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.1ms
Speed: 1.4ms preprocess, 20.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.8ms
Speed: 1.4ms preprocess, 20.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.0ms
Speed: 1.6ms preprocess, 20.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.0ms
Speed: 1.5ms preprocess, 20.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.0ms
Speed: 1.4ms preprocess, 20.0ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 21.8ms
Speed: 1.7ms preprocess, 21.8ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 10
view_order: [11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 1.6ms preprocess, 20.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9456
Instance 2: Confidence=0.9313
Instance 3: Confidence=0.8808
Instance 4: Confidence=0.8715
Instance 5: Confidence=0.8483
Selected instance: 4 (Confidence: 0.8715)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

356 52 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 17 prompts
current IoU is: 0.45528659224510193
Seok, iteration idx= 1 IoU = tensor(0.4553)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.1ms
Speed: 2.8ms preprocess, 22.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 7
Instance 0: Confidence=0.9597
Instance 1: Confidence=0.9420
Instance 2: Confidence=0.9354
Instance 3: Confidence=0.8429
Instance 4: Confidence=0.8336
Instance 5: Confidence=0.6522
Instance 6: Confidence=0.4532
Selected instance: 3 (Confidence: 0.8429)
tmp min: tensor(0.) tmp max: tensor(1.)
392 64 540 960
There are 15 prompts
current IoU is: 0.6901842355728149
Seok, iteration idx= 2 IoU = tensor(0.6902)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 2.1ms preprocess, 23.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9577
Instance 1: Confidence=0.9560
Instance 2: Confidence=0.9503
Instance 3: Confidence=0.8193
Instance 4: Confidence=0.7426
Selected instance: 4 (Confidence: 0.7426)
tmp min: tensor(0.) tmp max: tensor(1.)
431 80 540 960
There are 13 prompts
current IoU is: 0.7235557436943054
Seok, iteration idx= 3 IoU = tensor(0.7236)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.0ms
Speed: 1.4ms preprocess, 22.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9427
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9067
Instance 4: Confidence=0.8978
Instance 5: Confidence=0.6321
Selected instance: 5 (Confidence: 0.6321)
tmp min: tensor(0.) tmp max: tensor(1.)
446 132 540 960
There are 11 prompts
current IoU is: 0.6595607399940491
Seok, iteration idx= 4 IoU = tensor(0.6596)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.6ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9471
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.9224
Instance 4: Confidence=0.8923
Selected instance: 3 (Confidence: 0.9224)
tmp min: tensor(0.) tmp max: tensor(1.)
623 128 540 960
There are 15 prompts
current IoU is: 0.0014735679142177105
Seok, iteration idx= 5 IoU = tensor(0.0015)
SKIP, unacceptable sam prediction, IoU is tensor(0.0015)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.6ms
Speed: 1.4ms preprocess, 21.6ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9479
Instance 2: Confidence=0.9416
Instance 3: Confidence=0.8988
Instance 4: Confidence=0.8421
Selected instance: 1 (Confidence: 0.9479)
tmp min: tensor(0.) tmp max: tensor(1.)
516 0 540 960
There are 14 prompts
current IoU is: 0.33877572417259216
Seok, iteration idx= 6 IoU = tensor(0.3388)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.0ms
Speed: 1.3ms preprocess, 22.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9253
Instance 2: Confidence=0.8717
Instance 3: Confidence=0.8405
Instance 4: Confidence=0.5369
Instance 5: Confidence=0.3214
Instance 6: Confidence=0.2665
Selected instance: 0 (Confidence: 0.9526)
tmp min: tensor(0.) tmp max: tensor(1.)
452 0 540 960
There are 13 prompts
current IoU is: 0.751240611076355
Seok, iteration idx= 7 IoU = tensor(0.7512)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9245
Instance 2: Confidence=0.9200
Instance 3: Confidence=0.7033
Instance 4: Confidence=0.6931
Selected instance: 0 (Confidence: 0.9519)
tmp min: tensor(0.) tmp max: tensor(1.)
419 40 540 960
There are 14 prompts
current IoU is: 0.8649808168411255
Seok, iteration idx= 8 IoU = tensor(0.8650)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9556
Instance 1: Confidence=0.9451
Instance 2: Confidence=0.9042
Instance 3: Confidence=0.7678
Instance 4: Confidence=0.6133
Instance 5: Confidence=0.3890
Selected instance: 0 (Confidence: 0.9556)
tmp min: tensor(0.) tmp max: tensor(1.)
304 0 540 960
There are 14 prompts
current IoU is: 0.8164830803871155
Seok, iteration idx= 9 IoU = tensor(0.8165)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9671
Instance 1: Confidence=0.9570
Instance 2: Confidence=0.9262
Instance 3: Confidence=0.8464
Instance 4: Confidence=0.6664
Selected instance: 1 (Confidence: 0.9570)
tmp min: tensor(0.) tmp max: tensor(1.)
224 4 540 960
There are 15 prompts
current IoU is: 0.8967941403388977
Seok, iteration idx= 10 IoU = tensor(0.8968)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9659
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9171
Instance 3: Confidence=0.8072
Instance 4: Confidence=0.7156
Instance 5: Confidence=0.4521
Instance 6: Confidence=0.3306
Selected instance: 1 (Confidence: 0.9437)
tmp min: tensor(0.) tmp max: tensor(1.)
137 0 540 960
There are 16 prompts
current IoU is: 0.9366470575332642
Seok, iteration idx= 11 IoU = tensor(0.9366)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 7
Instance 0: Confidence=0.9631
Instance 1: Confidence=0.9326
Instance 2: Confidence=0.9224
Instance 3: Confidence=0.8920
Instance 4: Confidence=0.8891
Instance 5: Confidence=0.5450
Instance 6: Confidence=0.4295
Selected instance: 1 (Confidence: 0.9326)
tmp min: tensor(0.) tmp max: tensor(1.)
84 0 540 960
There are 13 prompts
current IoU is: 0.9228258728981018
Seok, iteration idx= 12 IoU = tensor(0.9228)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.8ms
Speed: 1.7ms preprocess, 24.8ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9710
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9314
Instance 3: Confidence=0.9307
Instance 4: Confidence=0.7829
Instance 5: Confidence=0.5400
Selected instance: 3 (Confidence: 0.9307)
tmp min: tensor(0.) tmp max: tensor(1.)
75 0 540 960
There are 17 prompts
current IoU is: 0.924895167350769
Seok, iteration idx= 13 IoU = tensor(0.9249)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 8
Instance 0: Confidence=0.9684
Instance 1: Confidence=0.9498
Instance 2: Confidence=0.9438
Instance 3: Confidence=0.8761
Instance 4: Confidence=0.7452
Instance 5: Confidence=0.5554
Instance 6: Confidence=0.4846
Instance 7: Confidence=0.4124
Selected instance: 1 (Confidence: 0.9498)
tmp min: tensor(0.) tmp max: tensor(1.)
88 0 540 960
There are 17 prompts
current IoU is: 0.8973110318183899
Seok, iteration idx= 14 IoU = tensor(0.8973)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 1.3ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 7
Instance 0: Confidence=0.9550
Instance 1: Confidence=0.9468
Instance 2: Confidence=0.9211
Instance 3: Confidence=0.8658
Instance 4: Confidence=0.3527
Instance 5: Confidence=0.3313
Instance 6: Confidence=0.2660
Selected instance: 2 (Confidence: 0.9211)
tmp min: tensor(0.) tmp max: tensor(1.)
108 36 540 960
There are 14 prompts
current IoU is: 0.8718819618225098
Seok, iteration idx= 15 IoU = tensor(0.8719)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9542
Instance 1: Confidence=0.9452
Instance 2: Confidence=0.8901
Instance 3: Confidence=0.8789
Instance 4: Confidence=0.8606
Instance 5: Confidence=0.7636
Selected instance: 2 (Confidence: 0.8901)
tmp min: tensor(0.) tmp max: tensor(1.)
123 12 540 960
There are 17 prompts
current IoU is: 0.9098089337348938
Seok, iteration idx= 16 IoU = tensor(0.9098)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.5ms
Speed: 1.4ms preprocess, 21.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9487
Instance 1: Confidence=0.9423
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.8932
Instance 4: Confidence=0.8345
Instance 5: Confidence=0.7952
Selected instance: 3 (Confidence: 0.8932)
tmp min: tensor(0.) tmp max: tensor(1.)
158 32 540 960
There are 16 prompts
current IoU is: 0.8503239154815674
Seok, iteration idx= 17 IoU = tensor(0.8503)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.9ms
Speed: 1.5ms preprocess, 24.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9577
Instance 1: Confidence=0.9502
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8409
Instance 4: Confidence=0.8097
Selected instance: 0 (Confidence: 0.9577)
tmp min: tensor(0.) tmp max: tensor(1.)
211 104 540 960
There are 15 prompts
current IoU is: 0.009074486792087555
Seok, iteration idx= 18 IoU = tensor(0.0091)
SKIP, unacceptable sam prediction, IoU is tensor(0.0091)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9568
Instance 1: Confidence=0.9337
Instance 2: Confidence=0.9183
Instance 3: Confidence=0.9098
Instance 4: Confidence=0.7857
Instance 5: Confidence=0.4356
Instance 6: Confidence=0.2723
Selected instance: 4 (Confidence: 0.7857)
tmp min: tensor(0.) tmp max: tensor(1.)
242 92 540 960
There are 18 prompts
current IoU is: 0.5919803977012634
Seok, iteration idx= 19 IoU = tensor(0.5920)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 7
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9389
Instance 2: Confidence=0.9162
Instance 3: Confidence=0.9079
Instance 4: Confidence=0.8868
Instance 5: Confidence=0.5165
Instance 6: Confidence=0.4232
Selected instance: 4 (Confidence: 0.8868)
tmp min: tensor(0.) tmp max: tensor(1.)
238 100 540 960
There are 19 prompts
current IoU is: 0.7849916219711304
Seok, iteration idx= 20 IoU = tensor(0.7850)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.6ms
Speed: 2.1ms preprocess, 22.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 7
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9321
Instance 2: Confidence=0.9290
Instance 3: Confidence=0.9221
Instance 4: Confidence=0.8640
Instance 5: Confidence=0.7488
Instance 6: Confidence=0.3407
Selected instance: 4 (Confidence: 0.8640)
tmp min: tensor(0.) tmp max: tensor(1.)
258 64 540 960
There are 14 prompts
current IoU is: 0.872442901134491
Seok, iteration idx= 21 IoU = tensor(0.8724)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9415
Instance 1: Confidence=0.9146
Instance 2: Confidence=0.9040
Instance 3: Confidence=0.8978
Instance 4: Confidence=0.8853
Instance 5: Confidence=0.3458
Selected instance: 2 (Confidence: 0.9040)
tmp min: tensor(0.) tmp max: tensor(1.)
746 68 540 960
There are 15 prompts
current IoU is: 0.8262750506401062
Seok, iteration idx= 22 IoU = tensor(0.8263)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.7ms
Speed: 1.3ms preprocess, 23.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 8
Instance 0: Confidence=0.9570
Instance 1: Confidence=0.9254
Instance 2: Confidence=0.9230
Instance 3: Confidence=0.9228
Instance 4: Confidence=0.9172
Instance 5: Confidence=0.5296
Instance 6: Confidence=0.4528
Instance 7: Confidence=0.3554
Selected instance: 2 (Confidence: 0.9230)
tmp min: tensor(0.) tmp max: tensor(1.)
779 32 540 960
There are 15 prompts
current IoU is: 0.8575019240379333
Seok, iteration idx= 23 IoU = tensor(0.8575)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 2.7ms preprocess, 22.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9401
Instance 1: Confidence=0.9391
Instance 2: Confidence=0.9293
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9041
Instance 5: Confidence=0.8093
Selected instance: 0 (Confidence: 0.9401)
tmp min: tensor(0.) tmp max: tensor(1.)
806 16 540 960
There are 17 prompts
current IoU is: 0.8833460807800293
Seok, iteration idx= 24 IoU = tensor(0.8833)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9441
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9204
Instance 3: Confidence=0.8937
Instance 4: Confidence=0.8811
Instance 5: Confidence=0.6694
Selected instance: 1 (Confidence: 0.9429)
tmp min: tensor(0.) tmp max: tensor(1.)
764 8 540 960
There are 16 prompts
current IoU is: 0.8734316825866699
Seok, iteration idx= 25 IoU = tensor(0.8734)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 4
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9497
Instance 2: Confidence=0.9269
Instance 3: Confidence=0.9004
Selected instance: 1 (Confidence: 0.9497)
tmp min: tensor(0.) tmp max: tensor(1.)
738 0 540 960
There are 16 prompts
current IoU is: 0.8435949683189392
Seok, iteration idx= 26 IoU = tensor(0.8436)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.8ms
Speed: 1.3ms preprocess, 23.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 8
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9354
Instance 2: Confidence=0.9341
Instance 3: Confidence=0.8591
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.6447
Instance 6: Confidence=0.4165
Instance 7: Confidence=0.2997
Selected instance: 1 (Confidence: 0.9354)
tmp min: tensor(0.) tmp max: tensor(1.)
705 0 540 960
There are 15 prompts
current IoU is: 0.7747942209243774
Seok, iteration idx= 27 IoU = tensor(0.7748)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 2.4ms preprocess, 22.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9518
Instance 2: Confidence=0.9162
Instance 3: Confidence=0.8995
Instance 4: Confidence=0.8007
Instance 5: Confidence=0.7572
Selected instance: 0 (Confidence: 0.9593)
tmp min: tensor(0.) tmp max: tensor(1.)
640 0 540 960
There are 17 prompts
current IoU is: 0.8846150040626526
Seok, iteration idx= 28 IoU = tensor(0.8846)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9464
Instance 1: Confidence=0.9412
Instance 2: Confidence=0.9307
Instance 3: Confidence=0.8961
Instance 4: Confidence=0.8483
Selected instance: 0 (Confidence: 0.9464)
tmp min: tensor(0.) tmp max: tensor(1.)
550 0 540 960
There are 16 prompts
current IoU is: 0.9269853830337524
Seok, iteration idx= 29 IoU = tensor(0.9270)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9355
Instance 1: Confidence=0.9264
Instance 2: Confidence=0.9218
Instance 3: Confidence=0.8835
Instance 4: Confidence=0.8732
Instance 5: Confidence=0.7672
Instance 6: Confidence=0.3035
Selected instance: 5 (Confidence: 0.7672)
tmp min: tensor(0.) tmp max: tensor(1.)
292 52 540 960
There are 16 prompts
current IoU is: 0.7960159182548523
Seok, iteration idx= 30 IoU = tensor(0.7960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 1.7ms preprocess, 22.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9406
Instance 2: Confidence=0.9377
Instance 3: Confidence=0.8722
Instance 4: Confidence=0.2874
Selected instance: 0 (Confidence: 0.9435)
tmp min: tensor(0.) tmp max: tensor(1.)
295 48 540 960
There are 17 prompts
current IoU is: 0.0018205749802291393
Seok, iteration idx= 31 IoU = tensor(0.0018)
SKIP, unacceptable sam prediction, IoU is tensor(0.0018)
Selected Instance Confidence List: [tensor(0.8262), tensor(0.6218, device='cpu'), tensor(0.7513, device='cpu'), tensor(0.7312, device='cpu'), tensor(0.6486, device='cpu'), tensor(0.3788, device='cpu'), tensor(0.5824, device='cpu'), tensor(0.8318, device='cpu'), tensor(0.8998, device='cpu'), tensor(0.8721, device='cpu'), tensor(0.9209, device='cpu'), tensor(0.9395, device='cpu'), tensor(0.9268, device='cpu'), tensor(0.9272, device='cpu'), tensor(0.9183, device='cpu'), tensor(0.8916, device='cpu'), tensor(0.9019, device='cpu'), tensor(0.8675, device='cpu'), tensor(0.3885, device='cpu'), tensor(0.6695, device='cpu'), tensor(0.8257, device='cpu'), tensor(0.8690, device='cpu'), tensor(0.8574, device='cpu'), tensor(0.8837, device='cpu'), tensor(0.9061, device='cpu'), tensor(0.9012, device='cpu'), tensor(0.8860, device='cpu'), tensor(0.8390, device='cpu'), tensor(0.9145, device='cpu'), tensor(0.9348, device='cpu'), tensor(0.7845, device='cpu'), tensor(0.3785, device='cpu')]
Sorted Confidence Order: [tensor(0.9395, device='cpu'), tensor(0.9209, device='cpu'), tensor(0.9268, device='cpu'), tensor(0.9272, device='cpu'), tensor(0.9183, device='cpu'), tensor(0.8916, device='cpu'), tensor(0.9019, device='cpu'), tensor(0.8675, device='cpu'), tensor(0.3885, device='cpu'), tensor(0.6695, device='cpu'), tensor(0.8257, device='cpu'), tensor(0.8690, device='cpu'), tensor(0.7845, device='cpu'), tensor(0.3785, device='cpu'), tensor(0.8262), tensor(0.6218, device='cpu'), tensor(0.7513, device='cpu'), tensor(0.7312, device='cpu'), tensor(0.6486, device='cpu'), tensor(0.3788, device='cpu'), tensor(0.8574, device='cpu'), tensor(0.8837, device='cpu'), tensor(0.9061, device='cpu'), tensor(0.9012, device='cpu'), tensor(0.8860, device='cpu'), tensor(0.8390, device='cpu'), tensor(0.9145, device='cpu'), tensor(0.9348, device='cpu'), tensor(0.5824, device='cpu'), tensor(0.8318, device='cpu'), tensor(0.8998, device='cpu'), tensor(0.8721, device='cpu')]
sorted_indices: [11, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 30, 31, 0, 1, 2, 3, 4, 5, 22, 23, 24, 25, 26, 27, 28, 29, 6, 7, 8, 9]
Initial view (highest confidence): 12
New training order: [26, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 9, 10, 11, 12, 13, 14, 15, 16, 1, 2, 3, 4, 5, 6, 7, 8, 21, 22, 23, 24]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.6ms
Speed: 1.3ms preprocess, 20.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9671
Instance 1: Confidence=0.9570
Instance 2: Confidence=0.9262
Instance 3: Confidence=0.8464
Instance 4: Confidence=0.6664
tmp min: tensor(0.) tmp max: tensor(1.)
224 4 540 960
There are 15 prompts
current IoU is: 0.9517465829849243
Seok, iteration idx= 1 IoU = tensor(0.9517)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.1ms
Speed: 1.5ms preprocess, 22.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 7
Instance 0: Confidence=0.9631
Instance 1: Confidence=0.9326
Instance 2: Confidence=0.9224
Instance 3: Confidence=0.8920
Instance 4: Confidence=0.8891
Instance 5: Confidence=0.5450
Instance 6: Confidence=0.4295
tmp min: tensor(0.) tmp max: tensor(1.)
84 0 540 960
There are 13 prompts
current IoU is: 0.9658254384994507
Seok, iteration idx= 2 IoU = tensor(0.9658)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 6
Instance 0: Confidence=0.9710
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9314
Instance 3: Confidence=0.9307
Instance 4: Confidence=0.7829
Instance 5: Confidence=0.5400
tmp min: tensor(0.) tmp max: tensor(1.)
75 0 540 960
There are 17 prompts
current IoU is: 0.9653307795524597
Seok, iteration idx= 3 IoU = tensor(0.9653)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.6ms
Speed: 1.3ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 8
Instance 0: Confidence=0.9684
Instance 1: Confidence=0.9498
Instance 2: Confidence=0.9438
Instance 3: Confidence=0.8761
Instance 4: Confidence=0.7452
Instance 5: Confidence=0.5554
Instance 6: Confidence=0.4846
Instance 7: Confidence=0.4124
tmp min: tensor(0.) tmp max: tensor(1.)
88 0 540 960
There are 17 prompts
current IoU is: 0.9458925724029541
Seok, iteration idx= 4 IoU = tensor(0.9459)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 7
Instance 0: Confidence=0.9550
Instance 1: Confidence=0.9468
Instance 2: Confidence=0.9211
Instance 3: Confidence=0.8658
Instance 4: Confidence=0.3527
Instance 5: Confidence=0.3313
Instance 6: Confidence=0.2660
tmp min: tensor(0.) tmp max: tensor(1.)
108 36 540 960
There are 14 prompts
current IoU is: 0.926306962966919
Seok, iteration idx= 5 IoU = tensor(0.9263)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9542
Instance 1: Confidence=0.9452
Instance 2: Confidence=0.8901
Instance 3: Confidence=0.8789
Instance 4: Confidence=0.8606
Instance 5: Confidence=0.7636
tmp min: tensor(0.) tmp max: tensor(1.)
123 12 540 960
There are 17 prompts
current IoU is: 0.9314444661140442
Seok, iteration idx= 6 IoU = tensor(0.9314)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9487
Instance 1: Confidence=0.9423
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.8932
Instance 4: Confidence=0.8345
Instance 5: Confidence=0.7952
tmp min: tensor(0.) tmp max: tensor(1.)
158 32 540 960
There are 16 prompts
current IoU is: 0.8572626113891602
Seok, iteration idx= 7 IoU = tensor(0.8573)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.0ms
Speed: 1.8ms preprocess, 22.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9577
Instance 1: Confidence=0.9502
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8409
Instance 4: Confidence=0.8097
tmp min: tensor(0.) tmp max: tensor(1.)
211 104 540 960
There are 15 prompts
current IoU is: 0.0108799384906888
Seok, iteration idx= 8 IoU = tensor(0.0109)
SKIP, unacceptable sam prediction, IoU is tensor(0.0109)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 7
Instance 0: Confidence=0.9568
Instance 1: Confidence=0.9337
Instance 2: Confidence=0.9183
Instance 3: Confidence=0.9098
Instance 4: Confidence=0.7857
Instance 5: Confidence=0.4356
Instance 6: Confidence=0.2723
tmp min: tensor(0.) tmp max: tensor(1.)
242 92 540 960
There are 18 prompts
current IoU is: 0.8408816456794739
Seok, iteration idx= 9 IoU = tensor(0.8409)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 7
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9389
Instance 2: Confidence=0.9162
Instance 3: Confidence=0.9079
Instance 4: Confidence=0.8868
Instance 5: Confidence=0.5165
Instance 6: Confidence=0.4232
tmp min: tensor(0.) tmp max: tensor(1.)
238 100 540 960
There are 19 prompts
current IoU is: 0.8425139784812927
Seok, iteration idx= 10 IoU = tensor(0.8425)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.5ms
Speed: 1.3ms preprocess, 22.5ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9321
Instance 2: Confidence=0.9290
Instance 3: Confidence=0.9221
Instance 4: Confidence=0.8640
Instance 5: Confidence=0.7488
Instance 6: Confidence=0.3407
tmp min: tensor(0.) tmp max: tensor(1.)
258 64 540 960
There are 14 prompts
current IoU is: 0.892858624458313
Seok, iteration idx= 11 IoU = tensor(0.8929)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 7
Instance 0: Confidence=0.9355
Instance 1: Confidence=0.9264
Instance 2: Confidence=0.9218
Instance 3: Confidence=0.8835
Instance 4: Confidence=0.8732
Instance 5: Confidence=0.7672
Instance 6: Confidence=0.3035
tmp min: tensor(0.) tmp max: tensor(1.)
292 52 540 960
There are 16 prompts
current IoU is: 0.8653497695922852
Seok, iteration idx= 12 IoU = tensor(0.8653)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9406
Instance 2: Confidence=0.9377
Instance 3: Confidence=0.8722
Instance 4: Confidence=0.2874
tmp min: tensor(0.) tmp max: tensor(1.)
295 48 540 960
There are 17 prompts
current IoU is: 0.0017461235402151942
Seok, iteration idx= 13 IoU = tensor(0.0017)
SKIP, unacceptable sam prediction, IoU is tensor(0.0017)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 9
Instance 0: Confidence=0.9466
Instance 1: Confidence=0.9334
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.8262
Instance 4: Confidence=0.6424
Instance 5: Confidence=0.5983
Instance 6: Confidence=0.5834
Instance 7: Confidence=0.2999
Instance 8: Confidence=0.2600
tmp min: tensor(0.) tmp max: tensor(1.)
338 48 540 960
There are 16 prompts
current IoU is: 0.8822585344314575
Seok, iteration idx= 14 IoU = tensor(0.8823)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9456
Instance 2: Confidence=0.9313
Instance 3: Confidence=0.8808
Instance 4: Confidence=0.8715
Instance 5: Confidence=0.8483
tmp min: tensor(0.) tmp max: tensor(1.)
356 52 540 960
There are 17 prompts
current IoU is: 0.8669276833534241
Seok, iteration idx= 15 IoU = tensor(0.8669)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 7
Instance 0: Confidence=0.9597
Instance 1: Confidence=0.9420
Instance 2: Confidence=0.9354
Instance 3: Confidence=0.8429
Instance 4: Confidence=0.8336
Instance 5: Confidence=0.6522
Instance 6: Confidence=0.4532
tmp min: tensor(0.) tmp max: tensor(1.)
392 64 540 960
There are 15 prompts
current IoU is: 0.9072388410568237
Seok, iteration idx= 16 IoU = tensor(0.9072)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9577
Instance 1: Confidence=0.9560
Instance 2: Confidence=0.9503
Instance 3: Confidence=0.8193
Instance 4: Confidence=0.7426
tmp min: tensor(0.) tmp max: tensor(1.)
431 80 540 960
There are 13 prompts
current IoU is: 0.8236666917800903
Seok, iteration idx= 17 IoU = tensor(0.8237)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9427
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9067
Instance 4: Confidence=0.8978
Instance 5: Confidence=0.6321
tmp min: tensor(0.) tmp max: tensor(1.)
446 132 540 960
There are 11 prompts
current IoU is: 0.6131072044372559
Seok, iteration idx= 18 IoU = tensor(0.6131)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9471
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.9224
Instance 4: Confidence=0.8923
tmp min: tensor(0.) tmp max: tensor(1.)
623 128 540 960
There are 15 prompts
current IoU is: 0.0009149967809207737
Seok, iteration idx= 19 IoU = tensor(0.0009)
SKIP, unacceptable sam prediction, IoU is tensor(0.0009)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9415
Instance 1: Confidence=0.9146
Instance 2: Confidence=0.9040
Instance 3: Confidence=0.8978
Instance 4: Confidence=0.8853
Instance 5: Confidence=0.3458
tmp min: tensor(0.) tmp max: tensor(1.)
746 68 540 960
There are 15 prompts
current IoU is: 0.9336628317832947
Seok, iteration idx= 20 IoU = tensor(0.9337)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 8
Instance 0: Confidence=0.9570
Instance 1: Confidence=0.9254
Instance 2: Confidence=0.9230
Instance 3: Confidence=0.9228
Instance 4: Confidence=0.9172
Instance 5: Confidence=0.5296
Instance 6: Confidence=0.4528
Instance 7: Confidence=0.3554
tmp min: tensor(0.) tmp max: tensor(1.)
779 32 540 960
There are 15 prompts
current IoU is: 0.932590663433075
Seok, iteration idx= 21 IoU = tensor(0.9326)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9401
Instance 1: Confidence=0.9391
Instance 2: Confidence=0.9293
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9041
Instance 5: Confidence=0.8093
tmp min: tensor(0.) tmp max: tensor(1.)
806 16 540 960
There are 17 prompts
current IoU is: 0.9432626366615295
Seok, iteration idx= 22 IoU = tensor(0.9433)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.7ms preprocess, 23.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9441
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9204
Instance 3: Confidence=0.8937
Instance 4: Confidence=0.8811
Instance 5: Confidence=0.6694
tmp min: tensor(0.) tmp max: tensor(1.)
764 8 540 960
There are 16 prompts
current IoU is: 0.9152519702911377
Seok, iteration idx= 23 IoU = tensor(0.9153)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 4
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9497
Instance 2: Confidence=0.9269
Instance 3: Confidence=0.9004
tmp min: tensor(0.) tmp max: tensor(1.)
738 0 540 960
There are 16 prompts
current IoU is: 0.8767547011375427
Seok, iteration idx= 24 IoU = tensor(0.8768)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.0ms
Speed: 1.3ms preprocess, 23.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 8
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9354
Instance 2: Confidence=0.9341
Instance 3: Confidence=0.8591
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.6447
Instance 6: Confidence=0.4165
Instance 7: Confidence=0.2997
tmp min: tensor(0.) tmp max: tensor(1.)
705 0 540 960
There are 15 prompts
current IoU is: 0.8459179997444153
Seok, iteration idx= 25 IoU = tensor(0.8459)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.9ms
Speed: 1.5ms preprocess, 21.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9518
Instance 2: Confidence=0.9162
Instance 3: Confidence=0.8995
Instance 4: Confidence=0.8007
Instance 5: Confidence=0.7572
tmp min: tensor(0.) tmp max: tensor(1.)
640 0 540 960
There are 17 prompts
current IoU is: 0.894462525844574
Seok, iteration idx= 26 IoU = tensor(0.8945)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9464
Instance 1: Confidence=0.9412
Instance 2: Confidence=0.9307
Instance 3: Confidence=0.8961
Instance 4: Confidence=0.8483
tmp min: tensor(0.) tmp max: tensor(1.)
550 0 540 960
There are 16 prompts
current IoU is: 0.9379491806030273
Seok, iteration idx= 27 IoU = tensor(0.9379)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9479
Instance 2: Confidence=0.9416
Instance 3: Confidence=0.8988
Instance 4: Confidence=0.8421
tmp min: tensor(0.) tmp max: tensor(1.)
516 0 540 960
There are 14 prompts
current IoU is: 0.853367030620575
Seok, iteration idx= 28 IoU = tensor(0.8534)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.0ms
Speed: 1.5ms preprocess, 22.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9253
Instance 2: Confidence=0.8717
Instance 3: Confidence=0.8405
Instance 4: Confidence=0.5369
Instance 5: Confidence=0.3214
Instance 6: Confidence=0.2665
tmp min: tensor(0.) tmp max: tensor(1.)
452 0 540 960
There are 13 prompts
current IoU is: 0.9054062962532043
Seok, iteration idx= 29 IoU = tensor(0.9054)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.3ms preprocess, 22.4ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9245
Instance 2: Confidence=0.9200
Instance 3: Confidence=0.7033
Instance 4: Confidence=0.6931
tmp min: tensor(0.) tmp max: tensor(1.)
419 40 540 960
There are 14 prompts
current IoU is: 0.9102416038513184
Seok, iteration idx= 30 IoU = tensor(0.9102)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9556
Instance 1: Confidence=0.9451
Instance 2: Confidence=0.9042
Instance 3: Confidence=0.7678
Instance 4: Confidence=0.6133
Instance 5: Confidence=0.3890
tmp min: tensor(0.) tmp max: tensor(1.)
304 0 540 960
There are 14 prompts
current IoU is: 0.9054960012435913
Seok, iteration idx= 31 IoU = tensor(0.9055)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set11_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set11_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:40<00:00,  1.27s/it]
Testing psnr 26.62242643535137 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set11_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:28<00:00,  1.14it/s]
Testing psnr 3.773770062252879 (avg)
train: coarse segmentation in 00:04:22
train: finish (eps time 00:04:22 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set11_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set12/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 42.12it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set12 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set12
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set12_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 2.7ms preprocess, 20.2ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.2ms preprocess, 20.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 1.5ms preprocess, 20.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.7ms
Speed: 1.4ms preprocess, 19.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 1.5ms preprocess, 20.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.4ms preprocess, 20.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.3ms
Speed: 1.4ms preprocess, 19.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.1ms
Speed: 1.5ms preprocess, 21.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.9ms
Speed: 1.5ms preprocess, 19.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 1.4ms preprocess, 20.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 1.4ms preprocess, 20.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.8ms
Speed: 1.4ms preprocess, 19.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.4ms
Speed: 1.4ms preprocess, 19.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.6ms
Speed: 1.6ms preprocess, 19.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.9ms
Speed: 1.5ms preprocess, 19.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.9ms
Speed: 1.4ms preprocess, 19.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.9ms
Speed: 1.4ms preprocess, 19.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.7ms
Speed: 1.4ms preprocess, 19.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.9ms
Speed: 1.2ms preprocess, 19.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.6ms
Speed: 1.3ms preprocess, 19.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.6ms
Speed: 1.4ms preprocess, 20.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.3ms
Speed: 1.3ms preprocess, 20.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.7ms
Speed: 1.2ms preprocess, 20.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 1.8ms preprocess, 20.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.9ms
Speed: 1.2ms preprocess, 19.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 1.3ms preprocess, 20.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.6ms
Speed: 1.3ms preprocess, 20.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 1.4ms preprocess, 20.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.6ms
Speed: 2.9ms preprocess, 21.6ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 20
view_order: [25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.3ms
Speed: 1.4ms preprocess, 20.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 4
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.8929
Instance 3: Confidence=0.7493
Selected instance: 3 (Confidence: 0.7493)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

509 76 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 17 prompts
current IoU is: 0.004984662402421236
Seok, iteration idx= 1 IoU = tensor(0.0050)
SKIP, unacceptable sam prediction, IoU is tensor(0.0050)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 1.7ms preprocess, 22.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9285
Instance 1: Confidence=0.8933
Instance 2: Confidence=0.8802
Instance 3: Confidence=0.7548
Instance 4: Confidence=0.6740
Instance 5: Confidence=0.4509
Selected instance: 0 (Confidence: 0.9285)
tmp min: tensor(0.) tmp max: tensor(1.)
487 4 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 2 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 4.6ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9410
Instance 1: Confidence=0.9132
Instance 2: Confidence=0.8935
Instance 3: Confidence=0.8732
Instance 4: Confidence=0.5436
Selected instance: 2 (Confidence: 0.8935)
tmp min: tensor(0.) tmp max: tensor(1.)
678 76 540 960
There are 15 prompts
current IoU is: 0.5260087847709656
Seok, iteration idx= 3 IoU = tensor(0.5260)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 1.4ms preprocess, 22.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9265
Instance 1: Confidence=0.9139
Instance 2: Confidence=0.8982
Instance 3: Confidence=0.8130
Instance 4: Confidence=0.7903
Selected instance: 2 (Confidence: 0.8982)
tmp min: tensor(0.) tmp max: tensor(1.)
794 52 540 960
There are 15 prompts
current IoU is: 0.8298026919364929
Seok, iteration idx= 4 IoU = tensor(0.8298)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 1.4ms preprocess, 22.1ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9261
Instance 2: Confidence=0.9165
Instance 3: Confidence=0.8297
Instance 4: Confidence=0.7494
Selected instance: 2 (Confidence: 0.9165)
tmp min: tensor(0.) tmp max: tensor(1.)
836 88 540 960
There are 14 prompts
current IoU is: 0.8999999761581421
Seok, iteration idx= 5 IoU = tensor(0.9000)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9550
Instance 1: Confidence=0.9480
Instance 2: Confidence=0.9431
Instance 3: Confidence=0.9207
Instance 4: Confidence=0.5784
Selected instance: 3 (Confidence: 0.9207)
tmp min: tensor(0.) tmp max: tensor(1.)
943 60 540 960
There are 14 prompts
current IoU is: 0.8669390678405762
Seok, iteration idx= 6 IoU = tensor(0.8669)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 4
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.8809
Selected instance: 0 (Confidence: 0.9460)
tmp min: tensor(0.) tmp max: tensor(1.)
214 0 540 960
There are 17 prompts
current IoU is: 0.0
Seok, iteration idx= 7 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.3ms preprocess, 22.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9471
Instance 2: Confidence=0.9431
Instance 3: Confidence=0.6623
Instance 4: Confidence=0.2560
Selected instance: 0 (Confidence: 0.9621)
tmp min: tensor(0.) tmp max: tensor(1.)
202 88 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 8 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.6ms
Speed: 1.3ms preprocess, 21.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9649
Instance 1: Confidence=0.9461
Instance 2: Confidence=0.9441
Instance 3: Confidence=0.8727
Instance 4: Confidence=0.7388
Instance 5: Confidence=0.3397
Selected instance: 0 (Confidence: 0.9649)
tmp min: tensor(0.) tmp max: tensor(1.)
166 56 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 9 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.3ms preprocess, 22.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9661
Instance 1: Confidence=0.9528
Instance 2: Confidence=0.9436
Instance 3: Confidence=0.9059
Instance 4: Confidence=0.7484
Selected instance: 0 (Confidence: 0.9661)
tmp min: tensor(0.) tmp max: tensor(1.)
146 68 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 10 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 3.0ms preprocess, 22.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9573
Instance 1: Confidence=0.9485
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.9090
Instance 4: Confidence=0.9048
Selected instance: 0 (Confidence: 0.9573)
tmp min: tensor(0.) tmp max: tensor(1.)
139 28 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 11 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 2.8ms preprocess, 22.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9406
Instance 3: Confidence=0.9326
Instance 4: Confidence=0.8584
Selected instance: 0 (Confidence: 0.9621)
tmp min: tensor(0.) tmp max: tensor(1.)
331 108 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 12 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 2.4ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9605
Instance 1: Confidence=0.9523
Instance 2: Confidence=0.9335
Instance 3: Confidence=0.9316
Instance 4: Confidence=0.8775
Selected instance: 0 (Confidence: 0.9605)
tmp min: tensor(0.) tmp max: tensor(1.)
59 40 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 13 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 2.9ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9609
Instance 1: Confidence=0.9444
Instance 2: Confidence=0.9416
Instance 3: Confidence=0.9373
Instance 4: Confidence=0.9147
Selected instance: 0 (Confidence: 0.9609)
tmp min: tensor(0.) tmp max: tensor(1.)
9 36 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 14 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 2.6ms preprocess, 22.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9470
Instance 1: Confidence=0.9424
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9360
Instance 4: Confidence=0.9339
Selected instance: 0 (Confidence: 0.9470)
tmp min: tensor(0.) tmp max: tensor(1.)
2 36 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 15 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 2.2ms preprocess, 22.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9436
Instance 3: Confidence=0.9424
Instance 4: Confidence=0.9320
Selected instance: 0 (Confidence: 0.9521)
tmp min: tensor(0.) tmp max: tensor(1.)
776 24 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 16 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9525
Instance 2: Confidence=0.9508
Instance 3: Confidence=0.9356
Instance 4: Confidence=0.9341
Selected instance: 2 (Confidence: 0.9508)
tmp min: tensor(0.) tmp max: tensor(1.)
25 40 540 960
There are 15 prompts
current IoU is: 0.00018650801212061197
Seok, iteration idx= 17 IoU = tensor(0.0002)
SKIP, unacceptable sam prediction, IoU is tensor(0.0002)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 1.6ms preprocess, 22.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9560
Instance 1: Confidence=0.9556
Instance 2: Confidence=0.9446
Instance 3: Confidence=0.9356
Instance 4: Confidence=0.9297
Selected instance: 0 (Confidence: 0.9560)
tmp min: tensor(0.) tmp max: tensor(1.)
15 40 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 18 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9584
Instance 1: Confidence=0.9531
Instance 2: Confidence=0.9364
Instance 3: Confidence=0.9357
Instance 4: Confidence=0.8459
Selected instance: 1 (Confidence: 0.9531)
tmp min: tensor(0.) tmp max: tensor(1.)
17 56 540 960
There are 13 prompts
current IoU is: 0.002067777095362544
Seok, iteration idx= 19 IoU = tensor(0.0021)
SKIP, unacceptable sam prediction, IoU is tensor(0.0021)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.3ms
Speed: 1.4ms preprocess, 24.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 5
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9486
Instance 2: Confidence=0.9481
Instance 3: Confidence=0.9425
Instance 4: Confidence=0.9152
Selected instance: 0 (Confidence: 0.9610)
tmp min: tensor(0.) tmp max: tensor(1.)
154 16 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 20 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.7ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9641
Instance 1: Confidence=0.9486
Instance 2: Confidence=0.9464
Instance 3: Confidence=0.9459
Instance 4: Confidence=0.9247
Selected instance: 0 (Confidence: 0.9641)
tmp min: tensor(0.) tmp max: tensor(1.)
645 68 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 21 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.9499
Instance 3: Confidence=0.9484
Instance 4: Confidence=0.9239
Selected instance: 0 (Confidence: 0.9539)
tmp min: tensor(0.) tmp max: tensor(1.)
818 56 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 22 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9541
Instance 1: Confidence=0.9507
Instance 2: Confidence=0.9499
Instance 3: Confidence=0.9434
Instance 4: Confidence=0.9244
Selected instance: 0 (Confidence: 0.9541)
tmp min: tensor(0.) tmp max: tensor(1.)
622 56 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 23 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 1.5ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9393
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.9061
Selected instance: 0 (Confidence: 0.9515)
tmp min: tensor(0.) tmp max: tensor(1.)
869 56 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 24 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.3ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9574
Instance 1: Confidence=0.9514
Instance 2: Confidence=0.9313
Instance 3: Confidence=0.9223
Instance 4: Confidence=0.9072
Selected instance: 0 (Confidence: 0.9574)
tmp min: tensor(0.) tmp max: tensor(1.)
892 56 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 25 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 1.4ms preprocess, 22.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9655
Instance 1: Confidence=0.9410
Instance 2: Confidence=0.9096
Instance 3: Confidence=0.9021
Instance 4: Confidence=0.8728
Selected instance: 0 (Confidence: 0.9655)
tmp min: tensor(0.) tmp max: tensor(1.)
867 80 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 26 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 1.6ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9578
Instance 1: Confidence=0.9251
Instance 2: Confidence=0.8965
Instance 3: Confidence=0.8850
Instance 4: Confidence=0.8000
Instance 5: Confidence=0.6041
Selected instance: 0 (Confidence: 0.9578)
tmp min: tensor(0.) tmp max: tensor(1.)
846 104 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 27 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 2.3ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9413
Instance 3: Confidence=0.9286
Instance 4: Confidence=0.8911
Instance 5: Confidence=0.8629
Selected instance: 4 (Confidence: 0.8911)
tmp min: tensor(0.) tmp max: tensor(1.)
65 76 540 960
There are 13 prompts
current IoU is: 0.6935443878173828
Seok, iteration idx= 28 IoU = tensor(0.6935)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.1ms
Speed: 2.7ms preprocess, 22.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9563
Instance 1: Confidence=0.9416
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.9166
Instance 4: Confidence=0.6422
Instance 5: Confidence=0.3537
Instance 6: Confidence=0.3190
Selected instance: 1 (Confidence: 0.9416)
tmp min: tensor(0.) tmp max: tensor(1.)
118 76 540 960
There are 14 prompts
current IoU is: 0.021221842616796494
Seok, iteration idx= 29 IoU = tensor(0.0212)
SKIP, unacceptable sam prediction, IoU is tensor(0.0212)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.0ms
Speed: 2.8ms preprocess, 25.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9407
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9287
Instance 3: Confidence=0.9253
Instance 4: Confidence=0.5503
Instance 5: Confidence=0.4910
Selected instance: 5 (Confidence: 0.4910)
tmp min: tensor(0.) tmp max: tensor(1.)
215 140 540 960
There are 15 prompts
current IoU is: 0.5762224197387695
Seok, iteration idx= 30 IoU = tensor(0.5762)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 2.4ms preprocess, 22.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9480
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.9271
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9137
Instance 5: Confidence=0.4320
Selected instance: 4 (Confidence: 0.9137)
tmp min: tensor(0.) tmp max: tensor(1.)
308 72 540 960
There are 13 prompts
current IoU is: 0.7753598690032959
Seok, iteration idx= 31 IoU = tensor(0.7754)
Selected Instance Confidence List: [tensor(0.8831), tensor(0.3760, device='cpu'), tensor(0.3714, device='cpu'), tensor(0.6730, device='cpu'), tensor(0.8572, device='cpu'), tensor(0.9066, device='cpu'), tensor(0.8885, device='cpu'), tensor(0.3784, device='cpu'), tensor(0.3848, device='cpu'), tensor(0.3860, device='cpu'), tensor(0.3864, device='cpu'), tensor(0.3829, device='cpu'), tensor(0.3848, device='cpu'), tensor(0.3842, device='cpu'), tensor(0.3843, device='cpu'), tensor(0.3788, device='cpu'), tensor(0.3808, device='cpu'), tensor(0.3822, device='cpu'), tensor(0.3824, device='cpu'), tensor(0.3834, device='cpu'), tensor(0.3844, device='cpu'), tensor(0.3857, device='cpu'), tensor(0.3815, device='cpu'), tensor(0.3816, device='cpu'), tensor(0.3806, device='cpu'), tensor(0.3830, device='cpu'), tensor(0.3862, device='cpu'), tensor(0.3831, device='cpu'), tensor(0.7726, device='cpu'), tensor(0.3894, device='cpu'), tensor(0.5421, device='cpu'), tensor(0.8307, device='cpu')]
Sorted Confidence Order: [tensor(0.9066, device='cpu'), tensor(0.8572, device='cpu'), tensor(0.6730, device='cpu'), tensor(0.3714, device='cpu'), tensor(0.3760, device='cpu'), tensor(0.8831), tensor(0.8307, device='cpu'), tensor(0.5421, device='cpu'), tensor(0.3894, device='cpu'), tensor(0.7726, device='cpu'), tensor(0.3834, device='cpu'), tensor(0.3824, device='cpu'), tensor(0.3822, device='cpu'), tensor(0.3808, device='cpu'), tensor(0.3788, device='cpu'), tensor(0.3843, device='cpu'), tensor(0.3842, device='cpu'), tensor(0.3848, device='cpu'), tensor(0.3831, device='cpu'), tensor(0.3862, device='cpu'), tensor(0.3830, device='cpu'), tensor(0.3806, device='cpu'), tensor(0.3816, device='cpu'), tensor(0.3815, device='cpu'), tensor(0.3857, device='cpu'), tensor(0.3844, device='cpu'), tensor(0.3829, device='cpu'), tensor(0.3864, device='cpu'), tensor(0.3860, device='cpu'), tensor(0.3848, device='cpu'), tensor(0.3784, device='cpu'), tensor(0.8885, device='cpu')]
sorted_indices: [5, 4, 3, 2, 1, 0, 31, 30, 29, 28, 19, 18, 17, 16, 15, 14, 13, 12, 27, 26, 25, 24, 23, 22, 21, 20, 11, 10, 9, 8, 7, 6]
Initial view (highest confidence): 6
New training order: [30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15, 14, 13, 12, 11, 10, 9, 36, 35, 34, 33, 32, 31]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.9ms
Speed: 1.5ms preprocess, 20.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9265
Instance 1: Confidence=0.9139
Instance 2: Confidence=0.8982
Instance 3: Confidence=0.8130
Instance 4: Confidence=0.7903
tmp min: tensor(0.) tmp max: tensor(1.)
794 52 540 960
There are 15 prompts
current IoU is: 0.8751461505889893
Seok, iteration idx= 1 IoU = tensor(0.8751)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 5
Instance 0: Confidence=0.9410
Instance 1: Confidence=0.9132
Instance 2: Confidence=0.8935
Instance 3: Confidence=0.8732
Instance 4: Confidence=0.5436
tmp min: tensor(0.) tmp max: tensor(1.)
678 76 540 960
There are 15 prompts
current IoU is: 0.8040109276771545
Seok, iteration idx= 2 IoU = tensor(0.8040)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 6
Instance 0: Confidence=0.9285
Instance 1: Confidence=0.8933
Instance 2: Confidence=0.8802
Instance 3: Confidence=0.7548
Instance 4: Confidence=0.6740
Instance 5: Confidence=0.4509
tmp min: tensor(0.) tmp max: tensor(1.)
487 4 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 3 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.7ms
Speed: 1.6ms preprocess, 22.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 4
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.8929
Instance 3: Confidence=0.7493
tmp min: tensor(0.) tmp max: tensor(1.)
464 52 540 960
There are 13 prompts
current IoU is: 0.003999384585767984
Seok, iteration idx= 4 IoU = tensor(0.0040)
SKIP, unacceptable sam prediction, IoU is tensor(0.0040)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 7
Instance 0: Confidence=0.9241
Instance 1: Confidence=0.9137
Instance 2: Confidence=0.8986
Instance 3: Confidence=0.8831
Instance 4: Confidence=0.8546
Instance 5: Confidence=0.7726
Instance 6: Confidence=0.2917
tmp min: tensor(0.) tmp max: tensor(1.)
431 92 540 960
There are 12 prompts
current IoU is: 0.8704240322113037
Seok, iteration idx= 5 IoU = tensor(0.8704)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9480
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.9271
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9137
Instance 5: Confidence=0.4320
tmp min: tensor(0.) tmp max: tensor(1.)
308 72 540 960
There are 13 prompts
current IoU is: 0.8305144309997559
Seok, iteration idx= 6 IoU = tensor(0.8305)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 3.4ms preprocess, 24.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9407
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9287
Instance 3: Confidence=0.9253
Instance 4: Confidence=0.5503
Instance 5: Confidence=0.4910
tmp min: tensor(0.) tmp max: tensor(1.)
215 140 540 960
There are 15 prompts
current IoU is: 0.5951169729232788
Seok, iteration idx= 7 IoU = tensor(0.5951)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9563
Instance 1: Confidence=0.9416
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.9166
Instance 4: Confidence=0.6422
Instance 5: Confidence=0.3537
Instance 6: Confidence=0.3190
tmp min: tensor(0.) tmp max: tensor(1.)
118 76 540 960
There are 14 prompts
current IoU is: 0.022288627922534943
Seok, iteration idx= 8 IoU = tensor(0.0223)
SKIP, unacceptable sam prediction, IoU is tensor(0.0223)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9413
Instance 3: Confidence=0.9286
Instance 4: Confidence=0.8911
Instance 5: Confidence=0.8629
tmp min: tensor(0.) tmp max: tensor(1.)
65 76 540 960
There are 13 prompts
current IoU is: 0.7884806394577026
Seok, iteration idx= 9 IoU = tensor(0.7885)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9584
Instance 1: Confidence=0.9531
Instance 2: Confidence=0.9364
Instance 3: Confidence=0.9357
Instance 4: Confidence=0.8459
tmp min: tensor(0.) tmp max: tensor(1.)
17 56 540 960
There are 13 prompts
current IoU is: 0.001225972082465887
Seok, iteration idx= 10 IoU = tensor(0.0012)
SKIP, unacceptable sam prediction, IoU is tensor(0.0012)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9560
Instance 1: Confidence=0.9556
Instance 2: Confidence=0.9446
Instance 3: Confidence=0.9356
Instance 4: Confidence=0.9297
tmp min: tensor(0.) tmp max: tensor(1.)
15 40 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 11 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9525
Instance 2: Confidence=0.9508
Instance 3: Confidence=0.9356
Instance 4: Confidence=0.9341
tmp min: tensor(0.) tmp max: tensor(1.)
813 12 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 12 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 2.7ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9436
Instance 3: Confidence=0.9424
Instance 4: Confidence=0.9320
tmp min: tensor(0.) tmp max: tensor(1.)
776 24 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 13 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 3.2ms preprocess, 22.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9470
Instance 1: Confidence=0.9424
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9360
Instance 4: Confidence=0.9339
tmp min: tensor(0.) tmp max: tensor(1.)
2 36 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 14 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 2.5ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9609
Instance 1: Confidence=0.9444
Instance 2: Confidence=0.9416
Instance 3: Confidence=0.9373
Instance 4: Confidence=0.9147
tmp min: tensor(0.) tmp max: tensor(1.)
9 36 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 15 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 2.3ms preprocess, 22.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9605
Instance 1: Confidence=0.9523
Instance 2: Confidence=0.9335
Instance 3: Confidence=0.9316
Instance 4: Confidence=0.8775
tmp min: tensor(0.) tmp max: tensor(1.)
59 40 540 960
There are 15 prompts
current IoU is: 0.00847611017525196
Seok, iteration idx= 16 IoU = tensor(0.0085)
SKIP, unacceptable sam prediction, IoU is tensor(0.0085)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 2.4ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9406
Instance 3: Confidence=0.9326
Instance 4: Confidence=0.8584
tmp min: tensor(0.) tmp max: tensor(1.)
114 56 540 960
There are 13 prompts
current IoU is: 0.009234242141246796
Seok, iteration idx= 17 IoU = tensor(0.0092)
SKIP, unacceptable sam prediction, IoU is tensor(0.0092)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 3.0ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9578
Instance 1: Confidence=0.9251
Instance 2: Confidence=0.8965
Instance 3: Confidence=0.8850
Instance 4: Confidence=0.8000
Instance 5: Confidence=0.6041
tmp min: tensor(0.) tmp max: tensor(1.)
846 104 540 960
There are 16 prompts
current IoU is: 0.0033722829539328814
Seok, iteration idx= 18 IoU = tensor(0.0034)
SKIP, unacceptable sam prediction, IoU is tensor(0.0034)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.3ms
Speed: 2.6ms preprocess, 24.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9655
Instance 1: Confidence=0.9410
Instance 2: Confidence=0.9096
Instance 3: Confidence=0.9021
Instance 4: Confidence=0.8728
tmp min: tensor(0.) tmp max: tensor(1.)
867 80 540 960
There are 16 prompts
current IoU is: 0.002602578140795231
Seok, iteration idx= 19 IoU = tensor(0.0026)
SKIP, unacceptable sam prediction, IoU is tensor(0.0026)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 3.0ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 5
Instance 0: Confidence=0.9574
Instance 1: Confidence=0.9514
Instance 2: Confidence=0.9313
Instance 3: Confidence=0.9223
Instance 4: Confidence=0.9072
tmp min: tensor(0.) tmp max: tensor(1.)
892 56 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 20 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 3.3ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9393
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.9061
tmp min: tensor(0.) tmp max: tensor(1.)
869 56 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 21 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 2.4ms preprocess, 23.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9541
Instance 1: Confidence=0.9507
Instance 2: Confidence=0.9499
Instance 3: Confidence=0.9434
Instance 4: Confidence=0.9244
tmp min: tensor(0.) tmp max: tensor(1.)
850 56 540 960
There are 14 prompts
current IoU is: 7.080314389895648e-05
Seok, iteration idx= 22 IoU = tensor(7.0803e-05)
SKIP, unacceptable sam prediction, IoU is tensor(7.0803e-05)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 2.7ms preprocess, 23.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.9499
Instance 3: Confidence=0.9484
Instance 4: Confidence=0.9239
tmp min: tensor(0.) tmp max: tensor(1.)
818 56 540 960
There are 14 prompts
current IoU is: 0.00013366839266382158
Seok, iteration idx= 23 IoU = tensor(0.0001)
SKIP, unacceptable sam prediction, IoU is tensor(0.0001)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9641
Instance 1: Confidence=0.9486
Instance 2: Confidence=0.9464
Instance 3: Confidence=0.9459
Instance 4: Confidence=0.9247
tmp min: tensor(0.) tmp max: tensor(1.)
645 68 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 24 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.3ms preprocess, 22.2ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9486
Instance 2: Confidence=0.9481
Instance 3: Confidence=0.9425
Instance 4: Confidence=0.9152
tmp min: tensor(0.) tmp max: tensor(1.)
154 16 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 25 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9573
Instance 1: Confidence=0.9485
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.9090
Instance 4: Confidence=0.9048
tmp min: tensor(0.) tmp max: tensor(1.)
139 28 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 26 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9661
Instance 1: Confidence=0.9528
Instance 2: Confidence=0.9436
Instance 3: Confidence=0.9059
Instance 4: Confidence=0.7484
tmp min: tensor(0.) tmp max: tensor(1.)
146 68 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 27 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9649
Instance 1: Confidence=0.9461
Instance 2: Confidence=0.9441
Instance 3: Confidence=0.8727
Instance 4: Confidence=0.7388
Instance 5: Confidence=0.3397
tmp min: tensor(0.) tmp max: tensor(1.)
166 56 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 28 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.6ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9471
Instance 2: Confidence=0.9431
Instance 3: Confidence=0.6623
Instance 4: Confidence=0.2560
tmp min: tensor(0.) tmp max: tensor(1.)
202 88 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 29 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 4
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.8809
tmp min: tensor(0.) tmp max: tensor(1.)
214 0 540 960
There are 17 prompts
current IoU is: 0.0
Seok, iteration idx= 30 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9550
Instance 1: Confidence=0.9480
Instance 2: Confidence=0.9431
Instance 3: Confidence=0.9207
Instance 4: Confidence=0.5784
tmp min: tensor(0.) tmp max: tensor(1.)
943 60 540 960
There are 14 prompts
current IoU is: 0.8511475920677185
Seok, iteration idx= 31 IoU = tensor(0.8511)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set12_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set12_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:41<00:00,  1.29s/it]
Testing psnr 27.958649694919586 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set12_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:26<00:00,  1.20it/s]
Testing psnr 3.0520109506323934 (avg)
train: coarse segmentation in 00:04:14
train: finish (eps time 00:04:14 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set12_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set13/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 48.40it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set13 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set13
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set13_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 21.2ms
Speed: 2.8ms preprocess, 21.2ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 21.0ms
Speed: 1.2ms preprocess, 21.0ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 21.2ms
Speed: 1.5ms preprocess, 21.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.9ms
Speed: 1.4ms preprocess, 20.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.2ms
Speed: 1.3ms preprocess, 21.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.2ms
Speed: 1.3ms preprocess, 20.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.9ms
Speed: 1.2ms preprocess, 20.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.4ms
Speed: 1.5ms preprocess, 20.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.6ms
Speed: 1.4ms preprocess, 20.6ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.6ms
Speed: 1.5ms preprocess, 20.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.6ms
Speed: 1.8ms preprocess, 20.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 30.3ms
Speed: 1.4ms preprocess, 30.3ms inference, 3.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.9ms
Speed: 1.4ms preprocess, 20.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.6ms
Speed: 1.3ms preprocess, 20.6ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.7ms
Speed: 1.5ms preprocess, 20.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.0ms
Speed: 1.4ms preprocess, 21.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.9ms
Speed: 1.4ms preprocess, 20.9ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.5ms
Speed: 1.9ms preprocess, 20.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.6ms
Speed: 1.4ms preprocess, 20.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.0ms
Speed: 1.5ms preprocess, 21.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.1ms
Speed: 1.5ms preprocess, 21.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.0ms
Speed: 1.5ms preprocess, 21.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.8ms
Speed: 1.5ms preprocess, 19.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.6ms
Speed: 1.4ms preprocess, 20.6ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.6ms
Speed: 1.4ms preprocess, 21.6ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.4ms
Speed: 1.4ms preprocess, 21.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.8ms
Speed: 1.5ms preprocess, 20.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.7ms
Speed: 1.5ms preprocess, 20.7ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.8ms
Speed: 1.7ms preprocess, 21.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 25
view_order: [30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 2.1ms preprocess, 20.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9473
Instance 1: Confidence=0.9204
Instance 2: Confidence=0.9187
Instance 3: Confidence=0.9093
Instance 4: Confidence=0.7686
Selected instance: 4 (Confidence: 0.7686)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

425 60 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.7064907550811768
Seok, iteration idx= 1 IoU = tensor(0.7065)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.3ms
Speed: 2.5ms preprocess, 23.3ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 4
Instance 0: Confidence=0.9493
Instance 1: Confidence=0.9198
Instance 2: Confidence=0.9132
Instance 3: Confidence=0.8117
Selected instance: 2 (Confidence: 0.9132)
tmp min: tensor(0.) tmp max: tensor(1.)
484 84 540 960
There are 16 prompts
current IoU is: 0.01818680390715599
Seok, iteration idx= 2 IoU = tensor(0.0182)
SKIP, unacceptable sam prediction, IoU is tensor(0.0182)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9467
Instance 1: Confidence=0.9218
Instance 2: Confidence=0.9005
Instance 3: Confidence=0.8803
Instance 4: Confidence=0.8561
Selected instance: 4 (Confidence: 0.8561)
tmp min: tensor(0.) tmp max: tensor(1.)
579 132 540 960
There are 15 prompts
current IoU is: 0.6752519607543945
Seok, iteration idx= 3 IoU = tensor(0.6753)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.6ms preprocess, 22.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9544
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9241
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.7200
Selected instance: 3 (Confidence: 0.9219)
tmp min: tensor(0.) tmp max: tensor(1.)
713 116 540 960
There are 16 prompts
current IoU is: 0.7715027332305908
Seok, iteration idx= 4 IoU = tensor(0.7715)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.0ms
Speed: 1.6ms preprocess, 22.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9280
Instance 2: Confidence=0.9266
Instance 3: Confidence=0.9235
Instance 4: Confidence=0.7901
Selected instance: 3 (Confidence: 0.9235)
tmp min: tensor(0.) tmp max: tensor(1.)
759 116 540 960
There are 14 prompts
current IoU is: 0.8391264081001282
Seok, iteration idx= 5 IoU = tensor(0.8391)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9459
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9226
Instance 3: Confidence=0.9140
Instance 4: Confidence=0.6220
Selected instance: 3 (Confidence: 0.9140)
tmp min: tensor(0.) tmp max: tensor(1.)
827 104 540 960
There are 14 prompts
current IoU is: 0.8050089478492737
Seok, iteration idx= 6 IoU = tensor(0.8050)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.1ms
Speed: 1.4ms preprocess, 22.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 1
Instance 0: Confidence=0.9169
Selected instance: 0 (Confidence: 0.9169)
tmp min: tensor(0.) tmp max: tensor(1.)
200 88 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 7 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.1ms
Speed: 2.8ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 1
Instance 0: Confidence=0.9297
Selected instance: 0 (Confidence: 0.9297)
tmp min: tensor(0.) tmp max: tensor(1.)
208 76 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 8 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 1
Instance 0: Confidence=0.9227
Selected instance: 0 (Confidence: 0.9227)
tmp min: tensor(0.) tmp max: tensor(1.)
220 68 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 9 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.8ms
Speed: 1.8ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 1
Instance 0: Confidence=0.9274
Selected instance: 0 (Confidence: 0.9274)
tmp min: tensor(0.) tmp max: tensor(1.)
226 68 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 10 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.6ms
Speed: 3.2ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 1
Instance 0: Confidence=0.9171
Selected instance: 0 (Confidence: 0.9171)
tmp min: tensor(0.) tmp max: tensor(1.)
239 48 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 11 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.3ms
Speed: 3.1ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 1
Instance 0: Confidence=0.9199
Selected instance: 0 (Confidence: 0.9199)
tmp min: tensor(0.) tmp max: tensor(1.)
296 60 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 12 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 1.3ms preprocess, 22.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9370
Instance 1: Confidence=0.9239
Selected instance: 0 (Confidence: 0.9370)
tmp min: tensor(0.) tmp max: tensor(1.)
2 100 540 960
There are 19 prompts
current IoU is: 0.0
Seok, iteration idx= 13 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9040
Selected instance: 0 (Confidence: 0.9483)
tmp min: tensor(0.) tmp max: tensor(1.)
48 116 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 14 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 4
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9207
Instance 2: Confidence=0.8929
Instance 3: Confidence=0.5436
Selected instance: 0 (Confidence: 0.9460)
tmp min: tensor(0.) tmp max: tensor(1.)
929 16 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 15 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 3
Instance 0: Confidence=0.9560
Instance 1: Confidence=0.8635
Instance 2: Confidence=0.7620
Selected instance: 0 (Confidence: 0.9560)
tmp min: tensor(0.) tmp max: tensor(1.)
922 4 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 16 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9567
Instance 1: Confidence=0.7969
Selected instance: 0 (Confidence: 0.9567)
tmp min: tensor(0.) tmp max: tensor(1.)
881 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 17 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.1ms
Speed: 2.7ms preprocess, 23.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 3
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.7888
Instance 2: Confidence=0.4837
Selected instance: 0 (Confidence: 0.9593)
tmp min: tensor(0.) tmp max: tensor(1.)
848 0 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 18 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.9ms
Speed: 2.6ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 4
Instance 0: Confidence=0.9485
Instance 1: Confidence=0.7439
Instance 2: Confidence=0.5048
Instance 3: Confidence=0.2655
Selected instance: 0 (Confidence: 0.9485)
tmp min: tensor(0.) tmp max: tensor(1.)
754 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 19 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 3.1ms preprocess, 22.9ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9561
Instance 1: Confidence=0.6777
Selected instance: 0 (Confidence: 0.9561)
tmp min: tensor(0.) tmp max: tensor(1.)
691 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 20 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9415
Instance 1: Confidence=0.7778
Selected instance: 0 (Confidence: 0.9415)
tmp min: tensor(0.) tmp max: tensor(1.)
611 12 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 21 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.6ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 2
Instance 0: Confidence=0.9420
Instance 1: Confidence=0.8016
Selected instance: 0 (Confidence: 0.9420)
tmp min: tensor(0.) tmp max: tensor(1.)
535 56 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 22 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 1.5ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9039
Selected instance: 0 (Confidence: 0.9435)
tmp min: tensor(0.) tmp max: tensor(1.)
158 100 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 23 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9440
Instance 1: Confidence=0.9201
Selected instance: 0 (Confidence: 0.9440)
tmp min: tensor(0.) tmp max: tensor(1.)
198 120 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 24 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.9ms
Speed: 1.3ms preprocess, 21.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9452
Instance 1: Confidence=0.9129
Selected instance: 0 (Confidence: 0.9452)
tmp min: tensor(0.) tmp max: tensor(1.)
259 148 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 25 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.1ms
Speed: 1.3ms preprocess, 23.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 3
Instance 0: Confidence=0.9407
Instance 1: Confidence=0.9229
Instance 2: Confidence=0.9179
Selected instance: 0 (Confidence: 0.9407)
tmp min: tensor(0.) tmp max: tensor(1.)
371 96 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 26 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.1ms
Speed: 2.7ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 3
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9345
Instance 2: Confidence=0.9300
Selected instance: 0 (Confidence: 0.9447)
tmp min: tensor(0.) tmp max: tensor(1.)
79 92 540 960
There are 17 prompts
current IoU is: 0.00022206184803508222
Seok, iteration idx= 27 IoU = tensor(0.0002)
SKIP, unacceptable sam prediction, IoU is tensor(0.0002)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.9ms
Speed: 2.9ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 4
Instance 0: Confidence=0.9410
Instance 1: Confidence=0.9318
Instance 2: Confidence=0.9127
Instance 3: Confidence=0.5230
Selected instance: 3 (Confidence: 0.5230)
tmp min: tensor(0.) tmp max: tensor(1.)
2 235 540 960
There are 11 prompts
current IoU is: 0.7196110486984253
Seok, iteration idx= 28 IoU = tensor(0.7196)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.6ms
Speed: 2.4ms preprocess, 22.6ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 4
Instance 0: Confidence=0.9267
Instance 1: Confidence=0.9262
Instance 2: Confidence=0.9231
Instance 3: Confidence=0.4524
Selected instance: 1 (Confidence: 0.9262)
tmp min: tensor(0.) tmp max: tensor(1.)
40 80 540 960
There are 15 prompts
current IoU is: 0.838729739189148
Seok, iteration idx= 29 IoU = tensor(0.8387)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.4ms
Speed: 3.2ms preprocess, 22.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 4
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9273
Instance 2: Confidence=0.9198
Instance 3: Confidence=0.7961
Selected instance: 1 (Confidence: 0.9273)
tmp min: tensor(0.) tmp max: tensor(1.)
168 76 540 960
There are 16 prompts
current IoU is: 0.8905187249183655
Seok, iteration idx= 30 IoU = tensor(0.8905)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 2.3ms preprocess, 23.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9217
Instance 2: Confidence=0.9215
Instance 3: Confidence=0.9189
Instance 4: Confidence=0.8922
Selected instance: 3 (Confidence: 0.9189)
tmp min: tensor(0.) tmp max: tensor(1.)
284 52 540 960
There are 17 prompts
current IoU is: 0.8876686692237854
Seok, iteration idx= 31 IoU = tensor(0.8877)
Selected Instance Confidence List: [tensor(0.9109), tensor(0.7313, device='cpu'), tensor(0.3797, device='cpu'), tensor(0.7476, device='cpu'), tensor(0.8317, device='cpu'), tensor(0.8729, device='cpu'), tensor(0.8486, device='cpu'), tensor(0.3667, device='cpu'), tensor(0.3719, device='cpu'), tensor(0.3691, device='cpu'), tensor(0.3710, device='cpu'), tensor(0.3668, device='cpu'), tensor(0.3680, device='cpu'), tensor(0.3748, device='cpu'), tensor(0.3793, device='cpu'), tensor(0.3784, device='cpu'), tensor(0.3824, device='cpu'), tensor(0.3827, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3794, device='cpu'), tensor(0.3824, device='cpu'), tensor(0.3766, device='cpu'), tensor(0.3768, device='cpu'), tensor(0.3774, device='cpu'), tensor(0.3776, device='cpu'), tensor(0.3781, device='cpu'), tensor(0.3763, device='cpu'), tensor(0.3780, device='cpu'), tensor(0.6410, device='cpu'), tensor(0.8737, device='cpu'), tensor(0.9052, device='cpu'), tensor(0.9002, device='cpu')]
Sorted Confidence Order: [tensor(0.9109), tensor(0.9002, device='cpu'), tensor(0.9052, device='cpu'), tensor(0.8737, device='cpu'), tensor(0.6410, device='cpu'), tensor(0.3780, device='cpu'), tensor(0.3763, device='cpu'), tensor(0.3781, device='cpu'), tensor(0.3776, device='cpu'), tensor(0.3774, device='cpu'), tensor(0.3793, device='cpu'), tensor(0.3748, device='cpu'), tensor(0.3680, device='cpu'), tensor(0.3668, device='cpu'), tensor(0.3710, device='cpu'), tensor(0.3691, device='cpu'), tensor(0.3719, device='cpu'), tensor(0.3667, device='cpu'), tensor(0.3768, device='cpu'), tensor(0.3766, device='cpu'), tensor(0.3824, device='cpu'), tensor(0.3794, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3827, device='cpu'), tensor(0.3824, device='cpu'), tensor(0.3784, device='cpu'), tensor(0.8486, device='cpu'), tensor(0.8729, device='cpu'), tensor(0.8317, device='cpu'), tensor(0.7476, device='cpu'), tensor(0.3797, device='cpu'), tensor(0.7313, device='cpu')]
sorted_indices: [0, 31, 30, 29, 28, 27, 26, 25, 24, 23, 14, 13, 12, 11, 10, 9, 8, 7, 22, 21, 20, 19, 18, 17, 16, 15, 6, 5, 4, 3, 2, 1]
Initial view (highest confidence): 1
New training order: [30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15, 14, 13, 12, 11, 10, 9, 36, 35, 34, 33, 32, 31]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.1ms
Speed: 1.3ms preprocess, 20.1ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 2.1ms preprocess, 22.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9217
Instance 2: Confidence=0.9215
Instance 3: Confidence=0.9189
Instance 4: Confidence=0.8922
tmp min: tensor(0.) tmp max: tensor(1.)
284 52 540 960
There are 17 prompts
current IoU is: 0.05116058886051178
Seok, iteration idx= 1 IoU = tensor(0.0512)
SKIP, unacceptable sam prediction, IoU is tensor(0.0512)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 4
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9273
Instance 2: Confidence=0.9198
Instance 3: Confidence=0.7961
tmp min: tensor(0.) tmp max: tensor(1.)
168 76 540 960
There are 16 prompts
current IoU is: 0.0485503263771534
Seok, iteration idx= 2 IoU = tensor(0.0486)
SKIP, unacceptable sam prediction, IoU is tensor(0.0486)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.7ms
Speed: 1.8ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 4
Instance 0: Confidence=0.9267
Instance 1: Confidence=0.9262
Instance 2: Confidence=0.9231
Instance 3: Confidence=0.4524
tmp min: tensor(0.) tmp max: tensor(1.)
40 80 540 960
There are 15 prompts
current IoU is: 0.0456312894821167
Seok, iteration idx= 3 IoU = tensor(0.0456)
SKIP, unacceptable sam prediction, IoU is tensor(0.0456)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.0ms
Speed: 1.6ms preprocess, 23.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 4
Instance 0: Confidence=0.9410
Instance 1: Confidence=0.9318
Instance 2: Confidence=0.9127
Instance 3: Confidence=0.5230
tmp min: tensor(0.) tmp max: tensor(1.)
119 80 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 4 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.4ms
Speed: 1.6ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 3
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9345
Instance 2: Confidence=0.9300
tmp min: tensor(0.) tmp max: tensor(1.)
79 92 540 960
There are 17 prompts
current IoU is: 0.0
Seok, iteration idx= 5 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 3
Instance 0: Confidence=0.9407
Instance 1: Confidence=0.9229
Instance 2: Confidence=0.9179
tmp min: tensor(0.) tmp max: tensor(1.)
371 96 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 6 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.3ms
Speed: 1.4ms preprocess, 24.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9452
Instance 1: Confidence=0.9129
tmp min: tensor(0.) tmp max: tensor(1.)
259 148 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 7 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9440
Instance 1: Confidence=0.9201
tmp min: tensor(0.) tmp max: tensor(1.)
198 120 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 8 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9039
tmp min: tensor(0.) tmp max: tensor(1.)
158 100 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 9 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 3.1ms preprocess, 23.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9040
tmp min: tensor(0.) tmp max: tensor(1.)
48 116 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 10 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.8ms
Speed: 2.6ms preprocess, 24.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9370
Instance 1: Confidence=0.9239
tmp min: tensor(0.) tmp max: tensor(1.)
2 100 540 960
There are 19 prompts
current IoU is: 0.0
Seok, iteration idx= 11 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 1
Instance 0: Confidence=0.9199
tmp min: tensor(0.) tmp max: tensor(1.)
296 60 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 12 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 1
Instance 0: Confidence=0.9171
tmp min: tensor(0.) tmp max: tensor(1.)
239 48 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 13 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 1
Instance 0: Confidence=0.9274
tmp min: tensor(0.) tmp max: tensor(1.)
226 68 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 14 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 1
Instance 0: Confidence=0.9227
tmp min: tensor(0.) tmp max: tensor(1.)
220 68 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 15 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.1ms
Speed: 1.4ms preprocess, 22.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 1
Instance 0: Confidence=0.9297
tmp min: tensor(0.) tmp max: tensor(1.)
208 76 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 16 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 1
Instance 0: Confidence=0.9169
tmp min: tensor(0.) tmp max: tensor(1.)
200 88 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 17 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9420
Instance 1: Confidence=0.8016
tmp min: tensor(0.) tmp max: tensor(1.)
535 56 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 18 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 3.2ms preprocess, 23.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9415
Instance 1: Confidence=0.7778
tmp min: tensor(0.) tmp max: tensor(1.)
611 12 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 19 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 3.0ms preprocess, 23.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9561
Instance 1: Confidence=0.6777
tmp min: tensor(0.) tmp max: tensor(1.)
691 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 20 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.1ms
Speed: 3.1ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 4
Instance 0: Confidence=0.9485
Instance 1: Confidence=0.7439
Instance 2: Confidence=0.5048
Instance 3: Confidence=0.2655
tmp min: tensor(0.) tmp max: tensor(1.)
754 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 21 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 3
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.7888
Instance 2: Confidence=0.4837
tmp min: tensor(0.) tmp max: tensor(1.)
848 0 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 22 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9567
Instance 1: Confidence=0.7969
tmp min: tensor(0.) tmp max: tensor(1.)
881 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 23 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.3ms
Speed: 2.9ms preprocess, 22.3ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 3
Instance 0: Confidence=0.9560
Instance 1: Confidence=0.8635
Instance 2: Confidence=0.7620
tmp min: tensor(0.) tmp max: tensor(1.)
922 4 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 24 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 4
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9207
Instance 2: Confidence=0.8929
Instance 3: Confidence=0.5436
tmp min: tensor(0.) tmp max: tensor(1.)
929 16 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 25 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 1.3ms preprocess, 22.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9459
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9226
Instance 3: Confidence=0.9140
Instance 4: Confidence=0.6220
tmp min: tensor(0.) tmp max: tensor(1.)
827 104 540 960
There are 14 prompts
current IoU is: 0.10646622627973557
Seok, iteration idx= 26 IoU = tensor(0.1065)
SKIP, unacceptable sam prediction, IoU is tensor(0.1065)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.6ms
Speed: 1.3ms preprocess, 21.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9280
Instance 2: Confidence=0.9266
Instance 3: Confidence=0.9235
Instance 4: Confidence=0.7901
tmp min: tensor(0.) tmp max: tensor(1.)
759 116 540 960
There are 14 prompts
current IoU is: 0.16729500889778137
Seok, iteration idx= 27 IoU = tensor(0.1673)
SKIP, unacceptable sam prediction, IoU is tensor(0.1673)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 2.5ms preprocess, 23.3ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9544
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9241
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.7200
tmp min: tensor(0.) tmp max: tensor(1.)
713 116 540 960
There are 16 prompts
current IoU is: 0.1582213044166565
Seok, iteration idx= 28 IoU = tensor(0.1582)
SKIP, unacceptable sam prediction, IoU is tensor(0.1582)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 3.1ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9467
Instance 1: Confidence=0.9218
Instance 2: Confidence=0.9005
Instance 3: Confidence=0.8803
Instance 4: Confidence=0.8561
tmp min: tensor(0.) tmp max: tensor(1.)
579 132 540 960
There are 15 prompts
current IoU is: 0.15678368508815765
Seok, iteration idx= 29 IoU = tensor(0.1568)
SKIP, unacceptable sam prediction, IoU is tensor(0.1568)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.2ms
Speed: 2.7ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 4
Instance 0: Confidence=0.9493
Instance 1: Confidence=0.9198
Instance 2: Confidence=0.9132
Instance 3: Confidence=0.8117
tmp min: tensor(0.) tmp max: tensor(1.)
484 84 540 960
There are 16 prompts
current IoU is: 0.00037903914926573634
Seok, iteration idx= 30 IoU = tensor(0.0004)
SKIP, unacceptable sam prediction, IoU is tensor(0.0004)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 2.6ms preprocess, 23.3ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9473
Instance 1: Confidence=0.9204
Instance 2: Confidence=0.9187
Instance 3: Confidence=0.9093
Instance 4: Confidence=0.7686
tmp min: tensor(0.) tmp max: tensor(1.)
425 60 540 960
There are 16 prompts
current IoU is: 0.01399631705135107
Seok, iteration idx= 31 IoU = tensor(0.0140)
SKIP, unacceptable sam prediction, IoU is tensor(0.0140)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set13_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set13_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.23s/it]
Testing psnr 29.09909889101982 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set13_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:26<00:00,  1.21it/s]
Testing psnr 3.5317240189760923 (avg)
train: coarse segmentation in 00:04:17
train: finish (eps time 00:04:18 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set13_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
