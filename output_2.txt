Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set1/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 36.31it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set1 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set1
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set1_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.7ms
Speed: 2.8ms preprocess, 19.7ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.5ms
Speed: 1.2ms preprocess, 19.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.3ms
Speed: 1.5ms preprocess, 19.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.5ms
Speed: 1.2ms preprocess, 19.5ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.2ms
Speed: 1.8ms preprocess, 19.2ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.9ms
Speed: 1.2ms preprocess, 19.9ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.5ms
Speed: 1.2ms preprocess, 19.5ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.8ms
Speed: 1.2ms preprocess, 19.8ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.2ms
Speed: 1.2ms preprocess, 19.2ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.5ms
Speed: 1.2ms preprocess, 19.5ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.0ms
Speed: 1.4ms preprocess, 21.0ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.6ms
Speed: 1.2ms preprocess, 19.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.9ms
Speed: 1.2ms preprocess, 19.9ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.7ms
Speed: 16.5ms preprocess, 21.7ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 20
view_order: [25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 3.4ms preprocess, 20.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9656
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8572
Instance 5: Confidence=0.7074
Selected instance: 1 (Confidence: 0.9446)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

722 44 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 15 prompts
current IoU is: 0.8208006024360657
Seok, iteration idx= 1 IoU = tensor(0.8208)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.3ms preprocess, 23.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9558
Instance 1: Confidence=0.9384
Instance 2: Confidence=0.9350
Instance 3: Confidence=0.9330
Instance 4: Confidence=0.8556
Instance 5: Confidence=0.8479
Selected instance: 3 (Confidence: 0.9330)
tmp min: tensor(0.) tmp max: tensor(1.)
754 52 540 960
There are 14 prompts
current IoU is: 0.8603760600090027
Seok, iteration idx= 2 IoU = tensor(0.8604)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.4ms
Speed: 1.5ms preprocess, 21.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9492
Instance 1: Confidence=0.9473
Instance 2: Confidence=0.8976
Instance 3: Confidence=0.8878
Instance 4: Confidence=0.7385
Selected instance: 3 (Confidence: 0.8878)
tmp min: tensor(0.) tmp max: tensor(1.)
851 32 540 960
There are 17 prompts
current IoU is: 0.9087631702423096
Seok, iteration idx= 3 IoU = tensor(0.9088)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9493
Instance 1: Confidence=0.9481
Instance 2: Confidence=0.9454
Instance 3: Confidence=0.8710
Instance 4: Confidence=0.5295
Instance 5: Confidence=0.5013
Selected instance: 3 (Confidence: 0.8710)
tmp min: tensor(0.) tmp max: tensor(1.)
911 8 540 960
There are 16 prompts
current IoU is: 0.8196905851364136
Seok, iteration idx= 4 IoU = tensor(0.8197)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.0ms
Speed: 1.3ms preprocess, 22.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9719
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9354
Instance 3: Confidence=0.8589
Instance 4: Confidence=0.5243
Selected instance: 4 (Confidence: 0.5243)
tmp min: tensor(0.) tmp max: tensor(1.)
927 84 540 960
There are 16 prompts
current IoU is: 0.6370881795883179
Seok, iteration idx= 5 IoU = tensor(0.6371)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9585
Instance 2: Confidence=0.9417
Instance 3: Confidence=0.9039
Instance 4: Confidence=0.8364
Instance 5: Confidence=0.4622
Selected instance: 4 (Confidence: 0.8364)
tmp min: tensor(0.) tmp max: tensor(1.)
911 12 540 960
There are 18 prompts
current IoU is: 0.7824453711509705
Seok, iteration idx= 6 IoU = tensor(0.7824)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 2.8ms preprocess, 22.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9523
Instance 2: Confidence=0.9520
Instance 3: Confidence=0.8925
Instance 4: Confidence=0.6584
Selected instance: 0 (Confidence: 0.9581)
tmp min: tensor(0.) tmp max: tensor(1.)
895 24 540 960
There are 15 prompts
current IoU is: 0.8864212036132812
Seok, iteration idx= 7 IoU = tensor(0.8864)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.4ms
Speed: 2.6ms preprocess, 22.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9462
Instance 2: Confidence=0.9264
Instance 3: Confidence=0.8582
Instance 4: Confidence=0.8035
Instance 5: Confidence=0.7958
Instance 6: Confidence=0.3784
Selected instance: 2 (Confidence: 0.9264)
tmp min: tensor(0.) tmp max: tensor(1.)
821 96 540 960
There are 13 prompts
current IoU is: 0.8133343458175659
Seok, iteration idx= 8 IoU = tensor(0.8133)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.6ms
Speed: 2.9ms preprocess, 20.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 4
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9397
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.9188
Selected instance: 0 (Confidence: 0.9626)
tmp min: tensor(0.) tmp max: tensor(1.)
852 48 540 960
There are 15 prompts
current IoU is: 0.942462146282196
Seok, iteration idx= 9 IoU = tensor(0.9425)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.9ms
Speed: 2.8ms preprocess, 21.9ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 4
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9233
Instance 2: Confidence=0.8993
Instance 3: Confidence=0.7667
Selected instance: 0 (Confidence: 0.9555)
tmp min: tensor(0.) tmp max: tensor(1.)
828 36 540 960
There are 13 prompts
current IoU is: 0.9594439268112183
Seok, iteration idx= 10 IoU = tensor(0.9594)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.5ms
Speed: 1.4ms preprocess, 21.5ms inference, 4.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9608
Instance 1: Confidence=0.9321
Instance 2: Confidence=0.9267
Instance 3: Confidence=0.6191
Instance 4: Confidence=0.4317
Instance 5: Confidence=0.4099
Selected instance: 0 (Confidence: 0.9608)
tmp min: tensor(0.) tmp max: tensor(1.)
856 4 540 960
There are 14 prompts
current IoU is: 0.9702309966087341
Seok, iteration idx= 11 IoU = tensor(0.9702)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.4ms
Speed: 1.4ms preprocess, 20.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9405
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9210
Instance 5: Confidence=0.9140
Selected instance: 5 (Confidence: 0.9140)
tmp min: tensor(0.) tmp max: tensor(1.)
307 92 540 960
There are 14 prompts
current IoU is: 0.643008828163147
Seok, iteration idx= 12 IoU = tensor(0.6430)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.1ms
Speed: 1.4ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9598
Instance 1: Confidence=0.9502
Instance 2: Confidence=0.9318
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9104
Instance 5: Confidence=0.8862
Selected instance: 4 (Confidence: 0.9104)
tmp min: tensor(0.) tmp max: tensor(1.)
325 80 540 960
There are 17 prompts
current IoU is: 0.7827048301696777
Seok, iteration idx= 13 IoU = tensor(0.7827)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.8ms
Speed: 1.3ms preprocess, 21.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.9447
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.7582
Instance 5: Confidence=0.7479
Instance 6: Confidence=0.3858
Selected instance: 5 (Confidence: 0.7479)
tmp min: tensor(0.) tmp max: tensor(1.)
356 72 540 960
There are 14 prompts
current IoU is: 0.7210961580276489
Seok, iteration idx= 14 IoU = tensor(0.7211)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.5ms
Speed: 1.3ms preprocess, 22.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 7
Instance 0: Confidence=0.9569
Instance 1: Confidence=0.9488
Instance 2: Confidence=0.9424
Instance 3: Confidence=0.9368
Instance 4: Confidence=0.3790
Instance 5: Confidence=0.3706
Instance 6: Confidence=0.3087
Selected instance: 4 (Confidence: 0.3790)
tmp min: tensor(0.) tmp max: tensor(1.)
360 72 540 960
current IoU is: 0.5076817870140076
Seok, iteration idx= 15 IoU = tensor(0.5077)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.1ms
Speed: 1.9ms preprocess, 21.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9515
Instance 2: Confidence=0.9465
Instance 3: Confidence=0.9285
Instance 4: Confidence=0.5979
Selected instance: 4 (Confidence: 0.5979)
tmp min: tensor(0.) tmp max: tensor(1.)
384 56 540 960
There are 12 prompts
current IoU is: 0.27004334330558777
Seok, iteration idx= 16 IoU = tensor(0.2700)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9450
Instance 2: Confidence=0.9402
Instance 3: Confidence=0.9285
Instance 4: Confidence=0.6814
Selected instance: 2 (Confidence: 0.9402)
tmp min: tensor(0.) tmp max: tensor(1.)
451 44 540 960
There are 18 prompts
current IoU is: 0.018622295930981636
Seok, iteration idx= 17 IoU = tensor(0.0186)
SKIP, unacceptable sam prediction, IoU is tensor(0.0186)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.6ms
Speed: 1.4ms preprocess, 20.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 8
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9512
Instance 2: Confidence=0.9320
Instance 3: Confidence=0.9235
Instance 4: Confidence=0.8462
Instance 5: Confidence=0.5823
Instance 6: Confidence=0.4505
Instance 7: Confidence=0.2670
Selected instance: 5 (Confidence: 0.5823)
tmp min: tensor(0.) tmp max: tensor(1.)
480 96 540 960
There are 15 prompts
current IoU is: 0.536347508430481
Seok, iteration idx= 18 IoU = tensor(0.5363)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 1.3ms preprocess, 23.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9517
Instance 2: Confidence=0.9480
Instance 3: Confidence=0.9387
Instance 4: Confidence=0.9152
Instance 5: Confidence=0.5453
Instance 6: Confidence=0.3526
Selected instance: 6 (Confidence: 0.3526)
tmp min: tensor(0.) tmp max: tensor(1.)
486 56 540 960
There are 16 prompts
current IoU is: 0.7972304821014404
Seok, iteration idx= 19 IoU = tensor(0.7972)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 2.1ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9603
Instance 1: Confidence=0.9415
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9376
Instance 4: Confidence=0.7264
Instance 5: Confidence=0.3404
Selected instance: 0 (Confidence: 0.9603)
tmp min: tensor(0.) tmp max: tensor(1.)
778 0 540 960
There are 17 prompts
current IoU is: 0.9596093893051147
Seok, iteration idx= 20 IoU = tensor(0.9596)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 2.6ms preprocess, 22.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9516
Instance 1: Confidence=0.9497
Instance 2: Confidence=0.9427
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.3692
Selected instance: 1 (Confidence: 0.9497)
tmp min: tensor(0.) tmp max: tensor(1.)
699 0 540 960
There are 15 prompts
current IoU is: 0.9317023754119873
Seok, iteration idx= 21 IoU = tensor(0.9317)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.2ms
Speed: 3.3ms preprocess, 22.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 4
Instance 0: Confidence=0.9620
Instance 1: Confidence=0.9516
Instance 2: Confidence=0.9441
Instance 3: Confidence=0.8590
Selected instance: 2 (Confidence: 0.9441)
tmp min: tensor(0.) tmp max: tensor(1.)
612 0 540 960
There are 13 prompts
current IoU is: 0.9571266770362854
Seok, iteration idx= 22 IoU = tensor(0.9571)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.2ms
Speed: 1.3ms preprocess, 23.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 4
Instance 0: Confidence=0.9596
Instance 1: Confidence=0.9460
Instance 2: Confidence=0.9159
Instance 3: Confidence=0.3852
Selected instance: 2 (Confidence: 0.9159)
tmp min: tensor(0.) tmp max: tensor(1.)
512 0 540 960
There are 13 prompts
current IoU is: 0.9303915500640869
Seok, iteration idx= 23 IoU = tensor(0.9304)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9604
Instance 1: Confidence=0.9048
Instance 2: Confidence=0.8323
Instance 3: Confidence=0.7273
Instance 4: Confidence=0.5794
Instance 5: Confidence=0.3322
Selected instance: 1 (Confidence: 0.9048)
tmp min: tensor(0.) tmp max: tensor(1.)
386 0 540 960
There are 14 prompts
current IoU is: 0.9544128179550171
Seok, iteration idx= 24 IoU = tensor(0.9544)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 1.2ms preprocess, 22.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9554
Instance 2: Confidence=0.9503
Instance 3: Confidence=0.9088
Instance 4: Confidence=0.2799
Instance 5: Confidence=0.2793
Selected instance: 2 (Confidence: 0.9503)
tmp min: tensor(0.) tmp max: tensor(1.)
321 0 540 960
There are 14 prompts
current IoU is: 0.8653962016105652
Seok, iteration idx= 25 IoU = tensor(0.8654)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9443
Instance 1: Confidence=0.9402
Instance 2: Confidence=0.9050
Instance 3: Confidence=0.8995
Instance 4: Confidence=0.8411
Instance 5: Confidence=0.8070
Selected instance: 1 (Confidence: 0.9402)
tmp min: tensor(0.) tmp max: tensor(1.)
282 12 540 960
There are 16 prompts
current IoU is: 0.8935471177101135
Seok, iteration idx= 26 IoU = tensor(0.8935)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9572
Instance 1: Confidence=0.9524
Instance 2: Confidence=0.9424
Instance 3: Confidence=0.9414
Instance 4: Confidence=0.8698
Selected instance: 3 (Confidence: 0.9414)
tmp min: tensor(0.) tmp max: tensor(1.)
252 64 540 960
There are 13 prompts
current IoU is: 0.9355279207229614
Seok, iteration idx= 27 IoU = tensor(0.9355)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.7ms
Speed: 1.3ms preprocess, 23.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 7
Instance 0: Confidence=0.9549
Instance 1: Confidence=0.9432
Instance 2: Confidence=0.9343
Instance 3: Confidence=0.9288
Instance 4: Confidence=0.8839
Instance 5: Confidence=0.5460
Instance 6: Confidence=0.2770
Selected instance: 5 (Confidence: 0.5460)
tmp min: tensor(0.) tmp max: tensor(1.)
534 72 540 960
There are 14 prompts
current IoU is: 0.8168140649795532
Seok, iteration idx= 28 IoU = tensor(0.8168)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.9376
Instance 2: Confidence=0.9306
Instance 3: Confidence=0.8279
Instance 4: Confidence=0.7871
Instance 5: Confidence=0.3723
Instance 6: Confidence=0.2568
Selected instance: 0 (Confidence: 0.9384)
tmp min: tensor(0.) tmp max: tensor(1.)
536 76 540 960
There are 15 prompts
current IoU is: 0.005738571286201477
Seok, iteration idx= 29 IoU = tensor(0.0057)
SKIP, unacceptable sam prediction, IoU is tensor(0.0057)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 3.0ms preprocess, 22.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9439
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9349
Instance 3: Confidence=0.8851
Instance 4: Confidence=0.5107
Selected instance: 1 (Confidence: 0.9353)
tmp min: tensor(0.) tmp max: tensor(1.)
546 108 540 960
There are 13 prompts
current IoU is: 0.007685428950935602
Seok, iteration idx= 30 IoU = tensor(0.0077)
SKIP, unacceptable sam prediction, IoU is tensor(0.0077)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 3.2ms preprocess, 22.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9620
Instance 1: Confidence=0.9385
Instance 2: Confidence=0.9375
Instance 3: Confidence=0.9245
Instance 4: Confidence=0.8593
Selected instance: 3 (Confidence: 0.9245)
tmp min: tensor(0.) tmp max: tensor(1.)
632 64 540 960
There are 16 prompts
current IoU is: 0.863879919052124
Seok, iteration idx= 31 IoU = tensor(0.8639)
Selected Instance Confidence List: [tensor(0.9375), tensor(0.8703, device='cpu'), tensor(0.8894, device='cpu'), tensor(0.9004, device='cpu'), tensor(0.8402, device='cpu'), tensor(0.5920, device='cpu'), tensor(0.8040, device='cpu'), tensor(0.9151, device='cpu'), tensor(0.8585, device='cpu'), tensor(0.9505, device='cpu'), tensor(0.9579, device='cpu'), tensor(0.9665, device='cpu'), tensor(0.7514, device='cpu'), tensor(0.8338, device='cpu'), tensor(0.7318, device='cpu'), tensor(0.4562, device='cpu'), tensor(0.4012, device='cpu'), tensor(0.3872, device='cpu'), tensor(0.5547, device='cpu'), tensor(0.6949, device='cpu'), tensor(0.9599, device='cpu'), tensor(0.9389, device='cpu'), tensor(0.9519, device='cpu'), tensor(0.9246, device='cpu'), tensor(0.9345, device='cpu'), tensor(0.8994, device='cpu'), tensor(0.9122, device='cpu'), tensor(0.9379, device='cpu'), tensor(0.7085, device='cpu'), tensor(0.3788, device='cpu'), tensor(0.3787, device='cpu'), tensor(0.8881, device='cpu')]
Sorted Confidence Order: [tensor(0.9665, device='cpu'), tensor(0.9579, device='cpu'), tensor(0.9505, device='cpu'), tensor(0.9599, device='cpu'), tensor(0.9389, device='cpu'), tensor(0.9519, device='cpu'), tensor(0.9246, device='cpu'), tensor(0.9345, device='cpu'), tensor(0.8994, device='cpu'), tensor(0.9122, device='cpu'), tensor(0.9379, device='cpu'), tensor(0.8585, device='cpu'), tensor(0.9151, device='cpu'), tensor(0.8040, device='cpu'), tensor(0.5920, device='cpu'), tensor(0.8402, device='cpu'), tensor(0.9004, device='cpu'), tensor(0.8894, device='cpu'), tensor(0.8703, device='cpu'), tensor(0.9375), tensor(0.8881, device='cpu'), tensor(0.3787, device='cpu'), tensor(0.3788, device='cpu'), tensor(0.7085, device='cpu'), tensor(0.6949, device='cpu'), tensor(0.5547, device='cpu'), tensor(0.3872, device='cpu'), tensor(0.4012, device='cpu'), tensor(0.4562, device='cpu'), tensor(0.7318, device='cpu'), tensor(0.8338, device='cpu'), tensor(0.7514, device='cpu')]
sorted_indices: [11, 10, 9, 20, 21, 22, 23, 24, 25, 26, 27, 8, 7, 6, 5, 4, 3, 2, 1, 0, 31, 30, 29, 28, 19, 18, 17, 16, 15, 14, 13, 12]
Initial view (highest confidence): 12
New training order: [36, 35, 34, 9, 10, 11, 12, 13, 14, 15, 16, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.1ms
Speed: 1.4ms preprocess, 20.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.4ms
Speed: 1.4ms preprocess, 21.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 4
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9233
Instance 2: Confidence=0.8993
Instance 3: Confidence=0.7667
tmp min: tensor(0.) tmp max: tensor(1.)
828 36 540 960
There are 13 prompts
current IoU is: 0.9651390314102173
Seok, iteration idx= 1 IoU = tensor(0.9651)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.0ms
Speed: 1.3ms preprocess, 22.0ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 4
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9397
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.9188
tmp min: tensor(0.) tmp max: tensor(1.)
852 48 540 960
There are 15 prompts
current IoU is: 0.9663742184638977
Seok, iteration idx= 2 IoU = tensor(0.9664)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.9ms
Speed: 1.3ms preprocess, 24.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 6
Instance 0: Confidence=0.9603
Instance 1: Confidence=0.9415
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9376
Instance 4: Confidence=0.7264
Instance 5: Confidence=0.3404
tmp min: tensor(0.) tmp max: tensor(1.)
778 0 540 960
There are 17 prompts
current IoU is: 0.9715586304664612
Seok, iteration idx= 3 IoU = tensor(0.9716)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9516
Instance 1: Confidence=0.9497
Instance 2: Confidence=0.9427
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.3692
tmp min: tensor(0.) tmp max: tensor(1.)
699 0 540 960
There are 15 prompts
current IoU is: 0.954921543598175
Seok, iteration idx= 4 IoU = tensor(0.9549)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.2ms
Speed: 1.3ms preprocess, 23.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 4
Instance 0: Confidence=0.9620
Instance 1: Confidence=0.9516
Instance 2: Confidence=0.9441
Instance 3: Confidence=0.8590
tmp min: tensor(0.) tmp max: tensor(1.)
612 0 540 960
There are 13 prompts
current IoU is: 0.9503459930419922
Seok, iteration idx= 5 IoU = tensor(0.9503)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 4
Instance 0: Confidence=0.9596
Instance 1: Confidence=0.9460
Instance 2: Confidence=0.9159
Instance 3: Confidence=0.3852
tmp min: tensor(0.) tmp max: tensor(1.)
512 0 540 960
There are 13 prompts
current IoU is: 0.9513161182403564
Seok, iteration idx= 6 IoU = tensor(0.9513)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.7ms preprocess, 23.6ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9604
Instance 1: Confidence=0.9048
Instance 2: Confidence=0.8323
Instance 3: Confidence=0.7273
Instance 4: Confidence=0.5794
Instance 5: Confidence=0.3322
tmp min: tensor(0.) tmp max: tensor(1.)
386 0 540 960
There are 14 prompts
current IoU is: 0.955720067024231
Seok, iteration idx= 7 IoU = tensor(0.9557)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 2.4ms preprocess, 22.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9554
Instance 2: Confidence=0.9503
Instance 3: Confidence=0.9088
Instance 4: Confidence=0.2799
Instance 5: Confidence=0.2793
tmp min: tensor(0.) tmp max: tensor(1.)
321 0 540 960
There are 14 prompts
current IoU is: 0.9129833579063416
Seok, iteration idx= 8 IoU = tensor(0.9130)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 2.4ms preprocess, 22.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9443
Instance 1: Confidence=0.9402
Instance 2: Confidence=0.9050
Instance 3: Confidence=0.8995
Instance 4: Confidence=0.8411
Instance 5: Confidence=0.8070
tmp min: tensor(0.) tmp max: tensor(1.)
282 12 540 960
There are 16 prompts
current IoU is: 0.931164562702179
Seok, iteration idx= 9 IoU = tensor(0.9312)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 3.1ms preprocess, 23.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9572
Instance 1: Confidence=0.9524
Instance 2: Confidence=0.9424
Instance 3: Confidence=0.9414
Instance 4: Confidence=0.8698
tmp min: tensor(0.) tmp max: tensor(1.)
252 64 540 960
There are 13 prompts
current IoU is: 0.9407363533973694
Seok, iteration idx= 10 IoU = tensor(0.9407)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 4.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9462
Instance 2: Confidence=0.9264
Instance 3: Confidence=0.8582
Instance 4: Confidence=0.8035
Instance 5: Confidence=0.7958
Instance 6: Confidence=0.3784
tmp min: tensor(0.) tmp max: tensor(1.)
821 96 540 960
There are 13 prompts
current IoU is: 0.9383867979049683
Seok, iteration idx= 11 IoU = tensor(0.9384)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9523
Instance 2: Confidence=0.9520
Instance 3: Confidence=0.8925
Instance 4: Confidence=0.6584
tmp min: tensor(0.) tmp max: tensor(1.)
895 24 540 960
There are 15 prompts
current IoU is: 0.9305030107498169
Seok, iteration idx= 12 IoU = tensor(0.9305)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.3ms preprocess, 23.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9585
Instance 2: Confidence=0.9417
Instance 3: Confidence=0.9039
Instance 4: Confidence=0.8364
Instance 5: Confidence=0.4622
tmp min: tensor(0.) tmp max: tensor(1.)
911 12 540 960
There are 18 prompts
current IoU is: 0.8169721961021423
Seok, iteration idx= 13 IoU = tensor(0.8170)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9719
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9354
Instance 3: Confidence=0.8589
Instance 4: Confidence=0.5243
tmp min: tensor(0.) tmp max: tensor(1.)
927 84 540 960
There are 16 prompts
current IoU is: 0.6324852108955383
Seok, iteration idx= 14 IoU = tensor(0.6325)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9493
Instance 1: Confidence=0.9481
Instance 2: Confidence=0.9454
Instance 3: Confidence=0.8710
Instance 4: Confidence=0.5295
Instance 5: Confidence=0.5013
tmp min: tensor(0.) tmp max: tensor(1.)
911 8 540 960
There are 16 prompts
current IoU is: 0.8009690642356873
Seok, iteration idx= 15 IoU = tensor(0.8010)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.6ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9492
Instance 1: Confidence=0.9473
Instance 2: Confidence=0.8976
Instance 3: Confidence=0.8878
Instance 4: Confidence=0.7385
tmp min: tensor(0.) tmp max: tensor(1.)
851 32 540 960
There are 17 prompts
current IoU is: 0.8695328831672668
Seok, iteration idx= 16 IoU = tensor(0.8695)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.4ms
Speed: 1.4ms preprocess, 21.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9558
Instance 1: Confidence=0.9384
Instance 2: Confidence=0.9350
Instance 3: Confidence=0.9330
Instance 4: Confidence=0.8556
Instance 5: Confidence=0.8479
tmp min: tensor(0.) tmp max: tensor(1.)
754 52 540 960
There are 14 prompts
current IoU is: 0.906808078289032
Seok, iteration idx= 17 IoU = tensor(0.9068)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 2.0ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9656
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8572
Instance 5: Confidence=0.7074
tmp min: tensor(0.) tmp max: tensor(1.)
722 44 540 960
There are 15 prompts
current IoU is: 0.8914187550544739
Seok, iteration idx= 18 IoU = tensor(0.8914)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.5ms
Speed: 1.3ms preprocess, 23.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 8
Instance 0: Confidence=0.9529
Instance 1: Confidence=0.9375
Instance 2: Confidence=0.9180
Instance 3: Confidence=0.9101
Instance 4: Confidence=0.8697
Instance 5: Confidence=0.7282
Instance 6: Confidence=0.3680
Instance 7: Confidence=0.3032
tmp min: tensor(0.) tmp max: tensor(1.)
689 68 540 960
There are 14 prompts
current IoU is: 0.8923954367637634
Seok, iteration idx= 19 IoU = tensor(0.8924)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.7ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 5
Instance 0: Confidence=0.9620
Instance 1: Confidence=0.9385
Instance 2: Confidence=0.9375
Instance 3: Confidence=0.9245
Instance 4: Confidence=0.8593
tmp min: tensor(0.) tmp max: tensor(1.)
632 64 540 960
There are 16 prompts
current IoU is: 0.8723044991493225
Seok, iteration idx= 20 IoU = tensor(0.8723)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 2.2ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9439
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9349
Instance 3: Confidence=0.8851
Instance 4: Confidence=0.5107
tmp min: tensor(0.) tmp max: tensor(1.)
546 108 540 960
There are 13 prompts
current IoU is: 0.008045227266848087
Seok, iteration idx= 21 IoU = tensor(0.0080)
SKIP, unacceptable sam prediction, IoU is tensor(0.0080)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.0ms
Speed: 1.6ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 7
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.9376
Instance 2: Confidence=0.9306
Instance 3: Confidence=0.8279
Instance 4: Confidence=0.7871
Instance 5: Confidence=0.3723
Instance 6: Confidence=0.2568
tmp min: tensor(0.) tmp max: tensor(1.)
536 76 540 960
There are 15 prompts
current IoU is: 0.005870165769010782
Seok, iteration idx= 22 IoU = tensor(0.0059)
SKIP, unacceptable sam prediction, IoU is tensor(0.0059)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.1ms
Speed: 1.4ms preprocess, 22.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 7
Instance 0: Confidence=0.9549
Instance 1: Confidence=0.9432
Instance 2: Confidence=0.9343
Instance 3: Confidence=0.9288
Instance 4: Confidence=0.8839
Instance 5: Confidence=0.5460
Instance 6: Confidence=0.2770
tmp min: tensor(0.) tmp max: tensor(1.)
534 72 540 960
There are 14 prompts
current IoU is: 0.8205839395523071
Seok, iteration idx= 23 IoU = tensor(0.8206)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.9ms
Speed: 2.7ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 7
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9517
Instance 2: Confidence=0.9480
Instance 3: Confidence=0.9387
Instance 4: Confidence=0.9152
Instance 5: Confidence=0.5453
Instance 6: Confidence=0.3526
tmp min: tensor(0.) tmp max: tensor(1.)
486 56 540 960
There are 16 prompts
current IoU is: 0.7984757423400879
Seok, iteration idx= 24 IoU = tensor(0.7985)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.4ms
Speed: 2.9ms preprocess, 22.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 8
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9512
Instance 2: Confidence=0.9320
Instance 3: Confidence=0.9235
Instance 4: Confidence=0.8462
Instance 5: Confidence=0.5823
Instance 6: Confidence=0.4505
Instance 7: Confidence=0.2670
tmp min: tensor(0.) tmp max: tensor(1.)
480 96 540 960
There are 15 prompts
current IoU is: 0.6916505098342896
Seok, iteration idx= 25 IoU = tensor(0.6917)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 3.4ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9450
Instance 2: Confidence=0.9402
Instance 3: Confidence=0.9285
Instance 4: Confidence=0.6814
tmp min: tensor(0.) tmp max: tensor(1.)
451 44 540 960
There are 18 prompts
current IoU is: 0.01822151057422161
Seok, iteration idx= 26 IoU = tensor(0.0182)
SKIP, unacceptable sam prediction, IoU is tensor(0.0182)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.9ms
Speed: 3.6ms preprocess, 24.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9515
Instance 2: Confidence=0.9465
Instance 3: Confidence=0.9285
Instance 4: Confidence=0.5979
tmp min: tensor(0.) tmp max: tensor(1.)
384 56 540 960
There are 12 prompts
current IoU is: 0.34274327754974365
Seok, iteration idx= 27 IoU = tensor(0.3427)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 2.8ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 7
Instance 0: Confidence=0.9569
Instance 1: Confidence=0.9488
Instance 2: Confidence=0.9424
Instance 3: Confidence=0.9368
Instance 4: Confidence=0.3790
Instance 5: Confidence=0.3706
Instance 6: Confidence=0.3087
tmp min: tensor(0.) tmp max: tensor(1.)
360 72 540 960
There are 17 prompts
current IoU is: 0.6052173972129822
Seok, iteration idx= 28 IoU = tensor(0.6052)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 3.0ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.9447
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.7582
Instance 5: Confidence=0.7479
Instance 6: Confidence=0.3858
tmp min: tensor(0.) tmp max: tensor(1.)
356 72 540 960
There are 14 prompts
current IoU is: 0.8193040490150452
Seok, iteration idx= 29 IoU = tensor(0.8193)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 4.0ms preprocess, 22.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9598
Instance 1: Confidence=0.9502
Instance 2: Confidence=0.9318
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9104
Instance 5: Confidence=0.8862
tmp min: tensor(0.) tmp max: tensor(1.)
325 80 540 960
There are 17 prompts
current IoU is: 0.8815659880638123
Seok, iteration idx= 30 IoU = tensor(0.8816)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 3.0ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9405
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9210
Instance 5: Confidence=0.9140
tmp min: tensor(0.) tmp max: tensor(1.)
307 92 540 960
There are 14 prompts
current IoU is: 0.7865062952041626
Seok, iteration idx= 31 IoU = tensor(0.7865)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set1_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set1_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:40<00:00,  1.26s/it]
Testing psnr 28.20988915860653 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set1_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.16it/s]
Testing psnr 3.5437235422432423 (avg)
train: coarse segmentation in 00:04:14
train: finish (eps time 00:04:14 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set1_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set2/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 34.81it/s]
Loaded image data (540, 960, 3, 32) [        540         960      752.26]
Loaded ./data/360_v2/Set2 1.2440621357132549 85.66757164363565
UserWarning: Optimal rotation is not uniquely or poorly defined for the given sets of vectors.
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960      752.26] ./data/360_v2/Set2
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.2539947867393494
original far 19.433752059936523
NEAR FAR 0 2.2590632
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.0105, -0.9112, -0.8033])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7333, 0.8326, 0.9405])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set2_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 2.5ms preprocess, 20.0ms inference, 3.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 1.3ms preprocess, 20.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.8ms
Speed: 1.2ms preprocess, 19.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.6ms
Speed: 1.4ms preprocess, 20.6ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.1ms
Speed: 1.2ms preprocess, 20.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.8ms
Speed: 1.2ms preprocess, 19.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.8ms
Speed: 1.3ms preprocess, 19.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.2ms
Speed: 1.2ms preprocess, 19.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.1ms
Speed: 1.6ms preprocess, 19.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.3ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.7ms
Speed: 1.3ms preprocess, 19.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.6ms
Speed: 1.3ms preprocess, 19.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.5ms
Speed: 1.3ms preprocess, 19.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.3ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.5ms
Speed: 1.2ms preprocess, 19.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.9ms
Speed: 1.7ms preprocess, 20.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 2.1ms preprocess, 20.7ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9300
Instance 3: Confidence=0.8918
Instance 4: Confidence=0.8458
Instance 5: Confidence=0.3819
Selected instance: 0 (Confidence: 0.9431)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

290 88 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 14 prompts
current IoU is: 0.8526139855384827
Seok, iteration idx= 1 IoU = tensor(0.8526)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.7ms
Speed: 1.5ms preprocess, 20.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 5
Instance 0: Confidence=0.9629
Instance 1: Confidence=0.9472
Instance 2: Confidence=0.9233
Instance 3: Confidence=0.8755
Instance 4: Confidence=0.7944
Selected instance: 1 (Confidence: 0.9472)
tmp min: tensor(0.) tmp max: tensor(1.)
309 100 540 960
There are 16 prompts
current IoU is: 0.8327968120574951
Seok, iteration idx= 2 IoU = tensor(0.8328)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.6ms
Speed: 1.4ms preprocess, 20.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.8868
Instance 4: Confidence=0.7933
Selected instance: 2 (Confidence: 0.9337)
tmp min: tensor(0.) tmp max: tensor(1.)
311 140 540 960
There are 14 prompts
current IoU is: 0.8751415014266968
Seok, iteration idx= 3 IoU = tensor(0.8751)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 3.7ms preprocess, 22.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9409
Instance 3: Confidence=0.9232
Instance 4: Confidence=0.7056
Instance 5: Confidence=0.5562
Selected instance: 4 (Confidence: 0.7056)
tmp min: tensor(0.) tmp max: tensor(1.)
629 52 540 960
There are 15 prompts
current IoU is: 0.12728361785411835
Seok, iteration idx= 4 IoU = tensor(0.1273)
SKIP, unacceptable sam prediction, IoU is tensor(0.1273)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 2.6ms preprocess, 22.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9383
Instance 3: Confidence=0.8695
Instance 4: Confidence=0.6814
Selected instance: 1 (Confidence: 0.9575)
tmp min: tensor(0.) tmp max: tensor(1.)
615 0 540 960
There are 16 prompts
current IoU is: 0.005318058654665947
Seok, iteration idx= 5 IoU = tensor(0.0053)
SKIP, unacceptable sam prediction, IoU is tensor(0.0053)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 3.0ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9612
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8944
Instance 4: Confidence=0.5440
Instance 5: Confidence=0.3031
Selected instance: 4 (Confidence: 0.5440)
tmp min: tensor(0.) tmp max: tensor(1.)
630 112 540 960
There are 14 prompts
current IoU is: 0.2384769469499588
Seok, iteration idx= 6 IoU = tensor(0.2385)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9577
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.8692
Instance 4: Confidence=0.8435
Instance 5: Confidence=0.2911
Selected instance: 2 (Confidence: 0.9104)
tmp min: tensor(0.) tmp max: tensor(1.)
650 76 540 960
There are 14 prompts
current IoU is: 0.49926695227622986
Seok, iteration idx= 7 IoU = tensor(0.4993)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9609
Instance 2: Confidence=0.9381
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9067
Instance 5: Confidence=0.8774
Selected instance: 2 (Confidence: 0.9381)
tmp min: tensor(0.) tmp max: tensor(1.)
631 72 540 960
There are 15 prompts
current IoU is: 0.6255934834480286
Seok, iteration idx= 8 IoU = tensor(0.6256)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9636
Instance 1: Confidence=0.9628
Instance 2: Confidence=0.9492
Instance 3: Confidence=0.9315
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.3011
Selected instance: 3 (Confidence: 0.9315)
tmp min: tensor(0.) tmp max: tensor(1.)
632 44 540 960
There are 17 prompts
current IoU is: 0.7647550702095032
Seok, iteration idx= 9 IoU = tensor(0.7648)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 7
Instance 0: Confidence=0.9600
Instance 1: Confidence=0.9489
Instance 2: Confidence=0.9429
Instance 3: Confidence=0.9350
Instance 4: Confidence=0.7563
Instance 5: Confidence=0.5645
Instance 6: Confidence=0.3526
Selected instance: 2 (Confidence: 0.9429)
tmp min: tensor(0.) tmp max: tensor(1.)
595 56 540 960
There are 12 prompts
current IoU is: 0.8783931136131287
Seok, iteration idx= 10 IoU = tensor(0.8784)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9504
Instance 3: Confidence=0.7410
Instance 4: Confidence=0.5533
Instance 5: Confidence=0.5528
Instance 6: Confidence=0.3753
Selected instance: 2 (Confidence: 0.9504)
tmp min: tensor(0.) tmp max: tensor(1.)
610 44 540 960
There are 14 prompts
current IoU is: 0.9329765439033508
Seok, iteration idx= 11 IoU = tensor(0.9330)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 1.6ms preprocess, 23.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9540
Instance 2: Confidence=0.9500
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9019
Instance 5: Confidence=0.7190
Selected instance: 2 (Confidence: 0.9500)
tmp min: tensor(0.) tmp max: tensor(1.)
595 20 540 960
There are 17 prompts
current IoU is: 0.8964059352874756
Seok, iteration idx= 12 IoU = tensor(0.8964)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9389
Instance 3: Confidence=0.9388
Instance 4: Confidence=0.9250
Selected instance: 3 (Confidence: 0.9388)
tmp min: tensor(0.) tmp max: tensor(1.)
526 64 540 960
There are 13 prompts
current IoU is: 0.8946842551231384
Seok, iteration idx= 13 IoU = tensor(0.8947)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9248
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9204
Instance 5: Confidence=0.5236
Instance 6: Confidence=0.2980
Selected instance: 4 (Confidence: 0.9204)
tmp min: tensor(0.) tmp max: tensor(1.)
495 32 540 960
There are 15 prompts
current IoU is: 0.9444519281387329
Seok, iteration idx= 14 IoU = tensor(0.9445)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.9090
Instance 5: Confidence=0.8731
Selected instance: 3 (Confidence: 0.9271)
tmp min: tensor(0.) tmp max: tensor(1.)
462 48 540 960
There are 14 prompts
current IoU is: 0.9388165473937988
Seok, iteration idx= 15 IoU = tensor(0.9388)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9339
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9057
Instance 5: Confidence=0.8295
Selected instance: 1 (Confidence: 0.9353)
tmp min: tensor(0.) tmp max: tensor(1.)
401 132 540 960
There are 15 prompts
current IoU is: 0.94197016954422
Seok, iteration idx= 16 IoU = tensor(0.9420)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.7ms
Speed: 1.4ms preprocess, 24.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9287
Instance 4: Confidence=0.9237
Selected instance: 3 (Confidence: 0.9287)
tmp min: tensor(0.) tmp max: tensor(1.)
364 96 540 960
There are 15 prompts
current IoU is: 0.8195483088493347
Seok, iteration idx= 17 IoU = tensor(0.8195)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9501
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9253
Instance 3: Confidence=0.9167
Instance 4: Confidence=0.9130
Instance 5: Confidence=0.7570
Selected instance: 4 (Confidence: 0.9130)
tmp min: tensor(0.) tmp max: tensor(1.)
338 100 540 960
There are 15 prompts
current IoU is: 0.9347127079963684
Seok, iteration idx= 18 IoU = tensor(0.9347)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 3.1ms preprocess, 23.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9468
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9173
Instance 3: Confidence=0.9139
Instance 4: Confidence=0.9082
Instance 5: Confidence=0.8839
Selected instance: 3 (Confidence: 0.9139)
tmp min: tensor(0.) tmp max: tensor(1.)
329 68 540 960
There are 19 prompts
current IoU is: 0.9288631081581116
Seok, iteration idx= 19 IoU = tensor(0.9289)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 2.7ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9123
Instance 4: Confidence=0.8140
Instance 5: Confidence=0.7047
Selected instance: 4 (Confidence: 0.8140)
tmp min: tensor(0.) tmp max: tensor(1.)
535 112 540 960
There are 15 prompts
current IoU is: 0.7209793925285339
Seok, iteration idx= 20 IoU = tensor(0.7210)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 3.7ms preprocess, 22.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9382
Instance 3: Confidence=0.9325
Instance 4: Confidence=0.8753
Selected instance: 4 (Confidence: 0.8753)
tmp min: tensor(0.) tmp max: tensor(1.)
557 92 540 960
There are 15 prompts
current IoU is: 0.8513485193252563
Seok, iteration idx= 21 IoU = tensor(0.8513)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 2.8ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9564
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9442
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.9084
Selected instance: 4 (Confidence: 0.9084)
tmp min: tensor(0.) tmp max: tensor(1.)
652 68 540 960
There are 16 prompts
current IoU is: 0.0005996327381581068
Seok, iteration idx= 22 IoU = tensor(0.0006)
SKIP, unacceptable sam prediction, IoU is tensor(0.0006)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.1ms
Speed: 1.4ms preprocess, 25.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9426
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9157
Instance 4: Confidence=0.8987
Instance 5: Confidence=0.8984
Selected instance: 3 (Confidence: 0.9157)
tmp min: tensor(0.) tmp max: tensor(1.)
573 84 540 960
There are 16 prompts
current IoU is: 0.770370364189148
Seok, iteration idx= 23 IoU = tensor(0.7704)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9580
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9340
Instance 3: Confidence=0.9104
Instance 4: Confidence=0.8875
Selected instance: 4 (Confidence: 0.8875)
tmp min: tensor(0.) tmp max: tensor(1.)
594 68 540 960
There are 16 prompts
current IoU is: 0.9161774516105652
Seok, iteration idx= 24 IoU = tensor(0.9162)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 1.7ms preprocess, 22.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9439
Instance 2: Confidence=0.9419
Instance 3: Confidence=0.9107
Instance 4: Confidence=0.8744
Instance 5: Confidence=0.8606
Selected instance: 4 (Confidence: 0.8744)
tmp min: tensor(0.) tmp max: tensor(1.)
632 64 540 960
There are 14 prompts
current IoU is: 0.9218865633010864
Seok, iteration idx= 25 IoU = tensor(0.9219)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.6ms preprocess, 23.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9461
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9423
Instance 3: Confidence=0.8899
Instance 4: Confidence=0.8821
Instance 5: Confidence=0.8120
Selected instance: 5 (Confidence: 0.8120)
tmp min: tensor(0.) tmp max: tensor(1.)
621 108 540 960
There are 17 prompts
current IoU is: 0.8987046480178833
Seok, iteration idx= 26 IoU = tensor(0.8987)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9428
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.8651
Instance 4: Confidence=0.8009
Instance 5: Confidence=0.6158
Selected instance: 5 (Confidence: 0.6158)
tmp min: tensor(0.) tmp max: tensor(1.)
612 104 540 960
current IoU is: 0.6987648010253906
Seok, iteration idx= 27 IoU = tensor(0.6988)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.6ms preprocess, 22.9ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9324
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9186
Instance 3: Confidence=0.9152
Instance 4: Confidence=0.9005
Instance 5: Confidence=0.7954
Selected instance: 0 (Confidence: 0.9324)
tmp min: tensor(0.) tmp max: tensor(1.)
308 56 540 960
There are 17 prompts
current IoU is: 0.8803057670593262
Seok, iteration idx= 28 IoU = tensor(0.8803)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9442
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8480
Instance 4: Confidence=0.7411
Instance 5: Confidence=0.4972
Instance 6: Confidence=0.3251
Selected instance: 0 (Confidence: 0.9442)
tmp min: tensor(0.) tmp max: tensor(1.)
279 60 540 960
There are 15 prompts
current IoU is: 0.9248584508895874
Seok, iteration idx= 29 IoU = tensor(0.9249)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9406
Instance 1: Confidence=0.9192
Instance 2: Confidence=0.8926
Instance 3: Confidence=0.8394
Instance 4: Confidence=0.4365
Instance 5: Confidence=0.4170
Instance 6: Confidence=0.3318
Selected instance: 0 (Confidence: 0.9406)
tmp min: tensor(0.) tmp max: tensor(1.)
285 52 540 960
There are 14 prompts
current IoU is: 0.9342060089111328
Seok, iteration idx= 30 IoU = tensor(0.9342)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 7
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9065
Instance 2: Confidence=0.7635
Instance 3: Confidence=0.5051
Instance 4: Confidence=0.4478
Instance 5: Confidence=0.4426
Instance 6: Confidence=0.2696
Selected instance: 0 (Confidence: 0.9539)
tmp min: tensor(0.) tmp max: tensor(1.)
276 52 540 960
There are 14 prompts
current IoU is: 0.9352561831474304
Seok, iteration idx= 31 IoU = tensor(0.9353)
Selected Instance Confidence List: [tensor(0.9249), tensor(0.8888, device='cpu'), tensor(0.8786, device='cpu'), tensor(0.8985, device='cpu'), tensor(0.3850, device='cpu'), tensor(0.3862, device='cpu'), tensor(0.3972, device='cpu'), tensor(0.6637, device='cpu'), tensor(0.7506, device='cpu'), tensor(0.8315, device='cpu'), tensor(0.9042, device='cpu'), tensor(0.9400, device='cpu'), tensor(0.9179, device='cpu'), tensor(0.9123, device='cpu'), tensor(0.9348, device='cpu'), tensor(0.9341, device='cpu'), tensor(0.9393, device='cpu'), tensor(0.8632, device='cpu'), tensor(0.9260, device='cpu'), tensor(0.9229, device='cpu'), tensor(0.7582, device='cpu'), tensor(0.8609, device='cpu'), tensor(0.3826, device='cpu'), tensor(0.8285, device='cpu'), tensor(0.9047, device='cpu'), tensor(0.9029, device='cpu'), tensor(0.8640, device='cpu'), tensor(0.6656, device='cpu'), tensor(0.9011, device='cpu'), tensor(0.9326, device='cpu'), tensor(0.9367, device='cpu'), tensor(0.9427, device='cpu')]
Sorted Confidence Order: [tensor(0.9427, device='cpu'), tensor(0.9367, device='cpu'), tensor(0.9326, device='cpu'), tensor(0.9011, device='cpu'), tensor(0.9229, device='cpu'), tensor(0.9260, device='cpu'), tensor(0.8632, device='cpu'), tensor(0.9393, device='cpu'), tensor(0.9341, device='cpu'), tensor(0.9348, device='cpu'), tensor(0.9123, device='cpu'), tensor(0.9179, device='cpu'), tensor(0.9400, device='cpu'), tensor(0.9042, device='cpu'), tensor(0.8315, device='cpu'), tensor(0.7506, device='cpu'), tensor(0.6637, device='cpu'), tensor(0.3972, device='cpu'), tensor(0.3862, device='cpu'), tensor(0.3850, device='cpu'), tensor(0.6656, device='cpu'), tensor(0.8640, device='cpu'), tensor(0.9029, device='cpu'), tensor(0.9047, device='cpu'), tensor(0.8285, device='cpu'), tensor(0.3826, device='cpu'), tensor(0.8609, device='cpu'), tensor(0.7582, device='cpu'), tensor(0.8985, device='cpu'), tensor(0.8786, device='cpu'), tensor(0.8888, device='cpu'), tensor(0.9249)]
sorted_indices: [31, 30, 29, 28, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 27, 26, 25, 24, 23, 22, 21, 20, 3, 2, 1, 0]
Initial view (highest confidence): 36
New training order: [12, 11, 10, 9, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15, 14, 13]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.5ms
Speed: 3.1ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 7
Instance 0: Confidence=0.9406
Instance 1: Confidence=0.9192
Instance 2: Confidence=0.8926
Instance 3: Confidence=0.8394
Instance 4: Confidence=0.4365
Instance 5: Confidence=0.4170
Instance 6: Confidence=0.3318
tmp min: tensor(0.) tmp max: tensor(1.)
285 52 540 960
There are 14 prompts
current IoU is: 0.9460747241973877
Seok, iteration idx= 1 IoU = tensor(0.9461)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 2.5ms preprocess, 23.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 7
Instance 0: Confidence=0.9442
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8480
Instance 4: Confidence=0.7411
Instance 5: Confidence=0.4972
Instance 6: Confidence=0.3251
tmp min: tensor(0.) tmp max: tensor(1.)
279 60 540 960
There are 15 prompts
current IoU is: 0.9355489015579224
Seok, iteration idx= 2 IoU = tensor(0.9355)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 4.4ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 6
Instance 0: Confidence=0.9324
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9186
Instance 3: Confidence=0.9152
Instance 4: Confidence=0.9005
Instance 5: Confidence=0.7954
tmp min: tensor(0.) tmp max: tensor(1.)
308 56 540 960
There are 17 prompts
current IoU is: 0.8979024887084961
Seok, iteration idx= 3 IoU = tensor(0.8979)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 3.0ms preprocess, 22.3ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9468
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9173
Instance 3: Confidence=0.9139
Instance 4: Confidence=0.9082
Instance 5: Confidence=0.8839
tmp min: tensor(0.) tmp max: tensor(1.)
329 68 540 960
There are 19 prompts
current IoU is: 0.9323098659515381
Seok, iteration idx= 4 IoU = tensor(0.9323)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.6ms preprocess, 24.3ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 6
Instance 0: Confidence=0.9501
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9253
Instance 3: Confidence=0.9167
Instance 4: Confidence=0.9130
Instance 5: Confidence=0.7570
tmp min: tensor(0.) tmp max: tensor(1.)
338 100 540 960
There are 15 prompts
current IoU is: 0.9450145959854126
Seok, iteration idx= 5 IoU = tensor(0.9450)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.7ms preprocess, 23.3ms inference, 3.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9287
Instance 4: Confidence=0.9237
tmp min: tensor(0.) tmp max: tensor(1.)
364 96 540 960
There are 15 prompts
current IoU is: 0.8904068470001221
Seok, iteration idx= 6 IoU = tensor(0.8904)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 3.8ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9339
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9057
Instance 5: Confidence=0.8295
tmp min: tensor(0.) tmp max: tensor(1.)
401 132 540 960
There are 15 prompts
current IoU is: 0.9674756526947021
Seok, iteration idx= 7 IoU = tensor(0.9675)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 3.1ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.9090
Instance 5: Confidence=0.8731
tmp min: tensor(0.) tmp max: tensor(1.)
462 48 540 960
There are 14 prompts
current IoU is: 0.9606007933616638
Seok, iteration idx= 8 IoU = tensor(0.9606)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 4.8ms preprocess, 23.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9248
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9204
Instance 5: Confidence=0.5236
Instance 6: Confidence=0.2980
tmp min: tensor(0.) tmp max: tensor(1.)
495 32 540 960
There are 15 prompts
current IoU is: 0.9584828615188599
Seok, iteration idx= 9 IoU = tensor(0.9585)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9389
Instance 3: Confidence=0.9388
Instance 4: Confidence=0.9250
tmp min: tensor(0.) tmp max: tensor(1.)
526 64 540 960
There are 13 prompts
current IoU is: 0.9628238081932068
Seok, iteration idx= 10 IoU = tensor(0.9628)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.7ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9540
Instance 2: Confidence=0.9500
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9019
Instance 5: Confidence=0.7190
tmp min: tensor(0.) tmp max: tensor(1.)
595 20 540 960
There are 17 prompts
current IoU is: 0.9662737846374512
Seok, iteration idx= 11 IoU = tensor(0.9663)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 7
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9504
Instance 3: Confidence=0.7410
Instance 4: Confidence=0.5533
Instance 5: Confidence=0.5528
Instance 6: Confidence=0.3753
tmp min: tensor(0.) tmp max: tensor(1.)
610 44 540 960
There are 14 prompts
current IoU is: 0.9612378478050232
Seok, iteration idx= 12 IoU = tensor(0.9612)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.2ms
Speed: 2.1ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 7
Instance 0: Confidence=0.9600
Instance 1: Confidence=0.9489
Instance 2: Confidence=0.9429
Instance 3: Confidence=0.9350
Instance 4: Confidence=0.7563
Instance 5: Confidence=0.5645
Instance 6: Confidence=0.3526
tmp min: tensor(0.) tmp max: tensor(1.)
595 56 540 960
There are 12 prompts
current IoU is: 0.9641461372375488
Seok, iteration idx= 13 IoU = tensor(0.9641)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 1.6ms preprocess, 24.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9636
Instance 1: Confidence=0.9628
Instance 2: Confidence=0.9492
Instance 3: Confidence=0.9315
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.3011
tmp min: tensor(0.) tmp max: tensor(1.)
632 44 540 960
There are 17 prompts
current IoU is: 0.927475094795227
Seok, iteration idx= 14 IoU = tensor(0.9275)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.6ms preprocess, 22.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9609
Instance 2: Confidence=0.9381
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9067
Instance 5: Confidence=0.8774
tmp min: tensor(0.) tmp max: tensor(1.)
631 72 540 960
There are 15 prompts
current IoU is: 0.9193793535232544
Seok, iteration idx= 15 IoU = tensor(0.9194)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9577
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.8692
Instance 4: Confidence=0.8435
Instance 5: Confidence=0.2911
tmp min: tensor(0.) tmp max: tensor(1.)
650 76 540 960
There are 14 prompts
current IoU is: 0.8917424082756042
Seok, iteration idx= 16 IoU = tensor(0.8917)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 1.6ms preprocess, 22.7ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9612
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8944
Instance 4: Confidence=0.5440
Instance 5: Confidence=0.3031
tmp min: tensor(0.) tmp max: tensor(1.)
630 112 540 960
There are 14 prompts
current IoU is: 0.5405723452568054
Seok, iteration idx= 17 IoU = tensor(0.5406)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.6ms preprocess, 24.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9383
Instance 3: Confidence=0.8695
Instance 4: Confidence=0.6814
tmp min: tensor(0.) tmp max: tensor(1.)
615 0 540 960
There are 16 prompts
current IoU is: 0.0014875979395583272
Seok, iteration idx= 18 IoU = tensor(0.0015)
SKIP, unacceptable sam prediction, IoU is tensor(0.0015)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 2.7ms preprocess, 22.4ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9409
Instance 3: Confidence=0.9232
Instance 4: Confidence=0.7056
Instance 5: Confidence=0.5562
tmp min: tensor(0.) tmp max: tensor(1.)
629 52 540 960
There are 15 prompts
current IoU is: 0.22867991030216217
Seok, iteration idx= 19 IoU = tensor(0.2287)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 3.3ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9428
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.8651
Instance 4: Confidence=0.8009
Instance 5: Confidence=0.6158
tmp min: tensor(0.) tmp max: tensor(1.)
612 104 540 960
current IoU is: 0.8084083795547485
Seok, iteration idx= 20 IoU = tensor(0.8084)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 2.7ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9461
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9423
Instance 3: Confidence=0.8899
Instance 4: Confidence=0.8821
Instance 5: Confidence=0.8120
tmp min: tensor(0.) tmp max: tensor(1.)
621 108 540 960
There are 17 prompts
current IoU is: 0.9076412320137024
Seok, iteration idx= 21 IoU = tensor(0.9076)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 3.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9439
Instance 2: Confidence=0.9419
Instance 3: Confidence=0.9107
Instance 4: Confidence=0.8744
Instance 5: Confidence=0.8606
tmp min: tensor(0.) tmp max: tensor(1.)
632 64 540 960
There are 14 prompts
current IoU is: 0.9256232976913452
Seok, iteration idx= 22 IoU = tensor(0.9256)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.4ms
Speed: 1.7ms preprocess, 24.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9580
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9340
Instance 3: Confidence=0.9104
Instance 4: Confidence=0.8875
tmp min: tensor(0.) tmp max: tensor(1.)
594 68 540 960
There are 16 prompts
current IoU is: 0.9445544481277466
Seok, iteration idx= 23 IoU = tensor(0.9446)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9426
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9157
Instance 4: Confidence=0.8987
Instance 5: Confidence=0.8984
tmp min: tensor(0.) tmp max: tensor(1.)
573 84 540 960
There are 16 prompts
current IoU is: 0.893219530582428
Seok, iteration idx= 24 IoU = tensor(0.8932)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 2.7ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9564
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9442
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.9084
tmp min: tensor(0.) tmp max: tensor(1.)
823 32 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 25 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9382
Instance 3: Confidence=0.9325
Instance 4: Confidence=0.8753
tmp min: tensor(0.) tmp max: tensor(1.)
557 92 540 960
There are 15 prompts
current IoU is: 0.8782509565353394
Seok, iteration idx= 26 IoU = tensor(0.8783)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 2.2ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9123
Instance 4: Confidence=0.8140
Instance 5: Confidence=0.7047
tmp min: tensor(0.) tmp max: tensor(1.)
535 112 540 960
There are 15 prompts
current IoU is: 0.8951821327209473
Seok, iteration idx= 27 IoU = tensor(0.8952)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 1.5ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.8868
Instance 4: Confidence=0.7933
tmp min: tensor(0.) tmp max: tensor(1.)
311 140 540 960
There are 14 prompts
current IoU is: 0.8963663578033447
Seok, iteration idx= 28 IoU = tensor(0.8964)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 2.3ms preprocess, 23.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9629
Instance 1: Confidence=0.9472
Instance 2: Confidence=0.9233
Instance 3: Confidence=0.8755
Instance 4: Confidence=0.7944
tmp min: tensor(0.) tmp max: tensor(1.)
309 100 540 960
There are 16 prompts
current IoU is: 0.9069727659225464
Seok, iteration idx= 29 IoU = tensor(0.9070)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9300
Instance 3: Confidence=0.8918
Instance 4: Confidence=0.8458
Instance 5: Confidence=0.3819
tmp min: tensor(0.) tmp max: tensor(1.)
290 88 540 960
There are 14 prompts
current IoU is: 0.9201416373252869
Seok, iteration idx= 30 IoU = tensor(0.9201)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 8
Instance 0: Confidence=0.9377
Instance 1: Confidence=0.9249
Instance 2: Confidence=0.9153
Instance 3: Confidence=0.7253
Instance 4: Confidence=0.7085
Instance 5: Confidence=0.4352
Instance 6: Confidence=0.3452
Instance 7: Confidence=0.2772
tmp min: tensor(0.) tmp max: tensor(1.)
271 68 540 960
There are 14 prompts
current IoU is: 0.9248425364494324
Seok, iteration idx= 31 IoU = tensor(0.9248)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set2_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set2_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.25s/it]
Testing psnr 28.1736521422863 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set2_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.16it/s]
Testing psnr 3.2194792106747627 (avg)
train: coarse segmentation in 00:03:54
train: finish (eps time 00:03:55 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set2_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set3/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 34.90it/s]
Loaded image data (540, 960, 3, 32) [        540         960      752.34]
Loaded ./data/360_v2/Set3 1.7761290072006928 55.6629549596001
UserWarning: Optimal rotation is not uniquely or poorly defined for the given sets of vectors.
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960      752.34] ./data/360_v2/Set3
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.36282292306423186
original far 12.634090423583984
NEAR FAR 0 2.2571032
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-0.9373, -0.8730, -0.7720])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.6911, 0.7554, 0.8564])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set3_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 2.7ms preprocess, 20.5ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.8ms
Speed: 1.2ms preprocess, 19.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.7ms
Speed: 1.2ms preprocess, 19.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.7ms
Speed: 1.3ms preprocess, 19.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 2.1ms preprocess, 20.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.9ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.6ms
Speed: 1.3ms preprocess, 19.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.8ms
Speed: 1.4ms preprocess, 19.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.4ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.7ms
Speed: 1.6ms preprocess, 18.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.4ms preprocess, 19.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.1ms
Speed: 1.4ms preprocess, 19.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.4ms
Speed: 1.5ms preprocess, 19.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.5ms
Speed: 3.1ms preprocess, 20.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.0ms
Speed: 1.4ms preprocess, 22.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9418
Instance 2: Confidence=0.9238
Instance 3: Confidence=0.9103
Instance 4: Confidence=0.8137
Instance 5: Confidence=0.3678
Selected instance: 0 (Confidence: 0.9555)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

659 48 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 14 prompts
current IoU is: 0.847601592540741
Seok, iteration idx= 1 IoU = tensor(0.8476)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9432
Instance 1: Confidence=0.9382
Instance 2: Confidence=0.9229
Instance 3: Confidence=0.9166
Instance 4: Confidence=0.8470
Instance 5: Confidence=0.8422
Selected instance: 0 (Confidence: 0.9432)
tmp min: tensor(0.) tmp max: tensor(1.)
611 80 540 960
There are 14 prompts
current IoU is: 0.8133299350738525
Seok, iteration idx= 2 IoU = tensor(0.8133)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9398
Instance 1: Confidence=0.9287
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.8930
Instance 4: Confidence=0.8873
Selected instance: 1 (Confidence: 0.9287)
tmp min: tensor(0.) tmp max: tensor(1.)
567 116 540 960
There are 15 prompts
current IoU is: 0.8929214477539062
Seok, iteration idx= 3 IoU = tensor(0.8929)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 7
Instance 0: Confidence=0.9443
Instance 1: Confidence=0.9263
Instance 2: Confidence=0.9112
Instance 3: Confidence=0.8529
Instance 4: Confidence=0.7917
Instance 5: Confidence=0.5320
Instance 6: Confidence=0.4048
Selected instance: 4 (Confidence: 0.7917)
tmp min: tensor(0.) tmp max: tensor(1.)
369 84 540 960
There are 17 prompts
current IoU is: 0.36800000071525574
Seok, iteration idx= 4 IoU = tensor(0.3680)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 25.1ms
Speed: 1.6ms preprocess, 25.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 8
Instance 0: Confidence=0.9391
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9228
Instance 3: Confidence=0.8782
Instance 4: Confidence=0.6843
Instance 5: Confidence=0.5397
Instance 6: Confidence=0.5218
Instance 7: Confidence=0.3399
Selected instance: 6 (Confidence: 0.5218)
tmp min: tensor(0.) tmp max: tensor(1.)
372 92 540 960
There are 15 prompts
current IoU is: 0.7222076654434204
Seok, iteration idx= 5 IoU = tensor(0.7222)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.6ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9437
Instance 1: Confidence=0.9314
Instance 2: Confidence=0.9091
Instance 3: Confidence=0.8747
Instance 4: Confidence=0.8331
Selected instance: 0 (Confidence: 0.9437)
tmp min: tensor(0.) tmp max: tensor(1.)
404 84 540 960
There are 14 prompts
current IoU is: 0.0015738606452941895
Seok, iteration idx= 6 IoU = tensor(0.0016)
SKIP, unacceptable sam prediction, IoU is tensor(0.0016)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9220
Instance 1: Confidence=0.9218
Instance 2: Confidence=0.9069
Instance 3: Confidence=0.9049
Instance 4: Confidence=0.9018
Instance 5: Confidence=0.8183
Selected instance: 0 (Confidence: 0.9220)
tmp min: tensor(0.) tmp max: tensor(1.)
449 80 540 960
There are 16 prompts
current IoU is: 0.5706283450126648
Seok, iteration idx= 7 IoU = tensor(0.5706)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.8996
Instance 3: Confidence=0.8888
Instance 4: Confidence=0.8676
Selected instance: 4 (Confidence: 0.8676)
tmp min: tensor(0.) tmp max: tensor(1.)
495 92 540 960
There are 18 prompts
current IoU is: 0.6865621209144592
Seok, iteration idx= 8 IoU = tensor(0.6866)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 2.7ms preprocess, 22.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9476
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.8890
Instance 3: Confidence=0.8363
Instance 4: Confidence=0.8338
Selected instance: 3 (Confidence: 0.8363)
tmp min: tensor(0.) tmp max: tensor(1.)
374 40 540 960
There are 19 prompts
current IoU is: 0.01150442473590374
Seok, iteration idx= 9 IoU = tensor(0.0115)
SKIP, unacceptable sam prediction, IoU is tensor(0.0115)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9144
Instance 2: Confidence=0.9064
Instance 3: Confidence=0.9036
Instance 4: Confidence=0.8918
Instance 5: Confidence=0.8164
Selected instance: 3 (Confidence: 0.9036)
tmp min: tensor(0.) tmp max: tensor(1.)
541 84 540 960
There are 17 prompts
current IoU is: 0.7650391459465027
Seok, iteration idx= 10 IoU = tensor(0.7650)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9670
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9256
Instance 3: Confidence=0.8502
Instance 4: Confidence=0.8407
Instance 5: Confidence=0.5675
Instance 6: Confidence=0.2603
Selected instance: 2 (Confidence: 0.9256)
tmp min: tensor(0.) tmp max: tensor(1.)
612 72 540 960
There are 14 prompts
current IoU is: 0.8118207454681396
Seok, iteration idx= 11 IoU = tensor(0.8118)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9585
Instance 1: Confidence=0.9275
Instance 2: Confidence=0.9113
Instance 3: Confidence=0.9041
Instance 4: Confidence=0.8095
Selected instance: 3 (Confidence: 0.9041)
tmp min: tensor(0.) tmp max: tensor(1.)
660 52 540 960
There are 16 prompts
current IoU is: 0.7504433393478394
Seok, iteration idx= 12 IoU = tensor(0.7504)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 4
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9405
Instance 2: Confidence=0.9168
Instance 3: Confidence=0.8296
Selected instance: 1 (Confidence: 0.9405)
tmp min: tensor(0.) tmp max: tensor(1.)
614 28 540 960
There are 13 prompts
current IoU is: 0.0010452094720676541
Seok, iteration idx= 13 IoU = tensor(0.0010)
SKIP, unacceptable sam prediction, IoU is tensor(0.0010)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 3.3ms preprocess, 24.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9529
Instance 1: Confidence=0.9514
Instance 2: Confidence=0.9135
Instance 3: Confidence=0.9119
Instance 4: Confidence=0.3781
Selected instance: 2 (Confidence: 0.9135)
tmp min: tensor(0.) tmp max: tensor(1.)
679 52 540 960
There are 16 prompts
current IoU is: 0.010650856420397758
Seok, iteration idx= 14 IoU = tensor(0.0107)
SKIP, unacceptable sam prediction, IoU is tensor(0.0107)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 2.7ms preprocess, 22.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9456
Instance 1: Confidence=0.9262
Instance 2: Confidence=0.8959
Instance 3: Confidence=0.8348
Instance 4: Confidence=0.6141
Instance 5: Confidence=0.3271
Selected instance: 5 (Confidence: 0.3271)
tmp min: tensor(0.) tmp max: tensor(1.)
722 116 540 960
There are 17 prompts
current IoU is: 0.26965856552124023
Seok, iteration idx= 15 IoU = tensor(0.2697)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 3.7ms preprocess, 22.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9397
Instance 2: Confidence=0.9054
Instance 3: Confidence=0.8999
Instance 4: Confidence=0.8815
Instance 5: Confidence=0.8617
Selected instance: 4 (Confidence: 0.8815)
tmp min: tensor(0.) tmp max: tensor(1.)
676 136 540 960
There are 17 prompts
current IoU is: 0.8186269402503967
Seok, iteration idx= 16 IoU = tensor(0.8186)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 2.8ms preprocess, 22.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9502
Instance 1: Confidence=0.9332
Instance 2: Confidence=0.9264
Instance 3: Confidence=0.9254
Instance 4: Confidence=0.9229
Instance 5: Confidence=0.5863
Selected instance: 3 (Confidence: 0.9254)
tmp min: tensor(0.) tmp max: tensor(1.)
725 108 540 960
There are 15 prompts
current IoU is: 0.8825161457061768
Seok, iteration idx= 17 IoU = tensor(0.8825)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.1ms
Speed: 3.2ms preprocess, 21.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9502
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9259
Instance 3: Confidence=0.9246
Instance 4: Confidence=0.7572
Selected instance: 2 (Confidence: 0.9259)
tmp min: tensor(0.) tmp max: tensor(1.)
727 104 540 960
There are 15 prompts
current IoU is: 0.886905312538147
Seok, iteration idx= 18 IoU = tensor(0.8869)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 2.8ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9451
Instance 2: Confidence=0.9205
Instance 3: Confidence=0.8957
Instance 4: Confidence=0.7199
Instance 5: Confidence=0.6674
Instance 6: Confidence=0.4065
Selected instance: 2 (Confidence: 0.9205)
tmp min: tensor(0.) tmp max: tensor(1.)
762 84 540 960
There are 16 prompts
current IoU is: 0.8976671099662781
Seok, iteration idx= 19 IoU = tensor(0.8977)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 3.1ms preprocess, 22.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9306
Instance 1: Confidence=0.9305
Instance 2: Confidence=0.9199
Instance 3: Confidence=0.9194
Instance 4: Confidence=0.9074
Instance 5: Confidence=0.8918
Selected instance: 5 (Confidence: 0.8918)
tmp min: tensor(0.) tmp max: tensor(1.)
253 104 540 960
current IoU is: 0.8785305619239807
Seok, iteration idx= 20 IoU = tensor(0.8785)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 3.0ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9305
Instance 1: Confidence=0.9276
Instance 2: Confidence=0.9191
Instance 3: Confidence=0.8996
Instance 4: Confidence=0.8552
Instance 5: Confidence=0.8230
Selected instance: 4 (Confidence: 0.8552)
tmp min: tensor(0.) tmp max: tensor(1.)
250 88 540 960
There are 18 prompts
current IoU is: 0.8731090426445007
Seok, iteration idx= 21 IoU = tensor(0.8731)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.2ms
Speed: 2.5ms preprocess, 23.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 8
Instance 0: Confidence=0.9374
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9352
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.5537
Instance 5: Confidence=0.3907
Instance 6: Confidence=0.3726
Instance 7: Confidence=0.3383
Selected instance: 6 (Confidence: 0.3726)
tmp min: tensor(0.) tmp max: tensor(1.)
254 84 540 960
current IoU is: 0.6888695955276489
Seok, iteration idx= 22 IoU = tensor(0.6889)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 3.0ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9308
Instance 2: Confidence=0.9301
Instance 3: Confidence=0.9154
Instance 4: Confidence=0.8041
Selected instance: 0 (Confidence: 0.9489)
tmp min: tensor(0.) tmp max: tensor(1.)
245 32 540 960
There are 16 prompts
current IoU is: 0.0007102833478711545
Seok, iteration idx= 23 IoU = tensor(0.0007)
SKIP, unacceptable sam prediction, IoU is tensor(0.0007)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 2.7ms preprocess, 23.6ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9390
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9113
Instance 3: Confidence=0.9079
Instance 4: Confidence=0.8845
Selected instance: 2 (Confidence: 0.9113)
tmp min: tensor(0.) tmp max: tensor(1.)
234 12 540 960
There are 18 prompts
current IoU is: 0.009762494824826717
Seok, iteration idx= 24 IoU = tensor(0.0098)
SKIP, unacceptable sam prediction, IoU is tensor(0.0098)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 2.8ms preprocess, 22.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9429
Instance 1: Confidence=0.9358
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.8998
Instance 4: Confidence=0.8047
Instance 5: Confidence=0.7897
Selected instance: 5 (Confidence: 0.7897)
tmp min: tensor(0.) tmp max: tensor(1.)
323 76 540 960
There are 16 prompts
current IoU is: 0.6315957307815552
Seok, iteration idx= 25 IoU = tensor(0.6316)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.5ms
Speed: 1.4ms preprocess, 25.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9544
Instance 1: Confidence=0.9382
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.9165
Instance 4: Confidence=0.9129
Selected instance: 4 (Confidence: 0.9129)
tmp min: tensor(0.) tmp max: tensor(1.)
306 68 540 960
There are 16 prompts
current IoU is: 0.8471084833145142
Seok, iteration idx= 26 IoU = tensor(0.8471)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9328
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.9281
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8874
Instance 5: Confidence=0.8685
Selected instance: 3 (Confidence: 0.9028)
tmp min: tensor(0.) tmp max: tensor(1.)
310 72 540 960
There are 15 prompts
current IoU is: 0.8479031920433044
Seok, iteration idx= 27 IoU = tensor(0.8479)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 1.6ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 7
Instance 0: Confidence=0.9433
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.9262
Instance 3: Confidence=0.9099
Instance 4: Confidence=0.9046
Instance 5: Confidence=0.7494
Instance 6: Confidence=0.2752
Selected instance: 2 (Confidence: 0.9262)
tmp min: tensor(0.) tmp max: tensor(1.)
768 64 540 960
There are 14 prompts
current IoU is: 0.9219565391540527
Seok, iteration idx= 28 IoU = tensor(0.9220)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.8ms
Speed: 1.8ms preprocess, 24.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9436
Instance 2: Confidence=0.9257
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9060
Instance 5: Confidence=0.4599
Selected instance: 3 (Confidence: 0.9181)
tmp min: tensor(0.) tmp max: tensor(1.)
760 60 540 960
There are 15 prompts
current IoU is: 0.9147548079490662
Seok, iteration idx= 29 IoU = tensor(0.9148)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9418
Instance 2: Confidence=0.9267
Instance 3: Confidence=0.9179
Instance 4: Confidence=0.8670
Selected instance: 3 (Confidence: 0.9179)
tmp min: tensor(0.) tmp max: tensor(1.)
755 44 540 960
There are 16 prompts
current IoU is: 0.9097270369529724
Seok, iteration idx= 30 IoU = tensor(0.9097)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 1.6ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9559
Instance 1: Confidence=0.9546
Instance 2: Confidence=0.9364
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.8237
Instance 5: Confidence=0.3776
Selected instance: 2 (Confidence: 0.9364)
tmp min: tensor(0.) tmp max: tensor(1.)
738 44 540 960
There are 14 prompts
current IoU is: 0.9515880942344666
Seok, iteration idx= 31 IoU = tensor(0.9516)
Selected Instance Confidence List: [tensor(0.9216), tensor(0.8908, device='cpu'), tensor(0.8653, device='cpu'), tensor(0.9072, device='cpu'), tensor(0.5375, device='cpu'), tensor(0.6421, device='cpu'), tensor(0.3784, device='cpu'), tensor(0.7112, device='cpu'), tensor(0.7590, device='cpu'), tensor(0.3804, device='cpu'), tensor(0.8205, device='cpu'), tensor(0.8574, device='cpu'), tensor(0.8119, device='cpu'), tensor(0.3847, device='cpu'), tensor(0.3812, device='cpu'), tensor(0.3854, device='cpu'), tensor(0.8438, device='cpu'), tensor(0.8997, device='cpu'), tensor(0.9025, device='cpu'), tensor(0.9068, device='cpu'), tensor(0.8839, device='cpu'), tensor(0.8659, device='cpu'), tensor(0.5624, device='cpu'), tensor(0.3800, device='cpu'), tensor(0.3756, device='cpu'), tensor(0.6948, device='cpu'), tensor(0.8734, device='cpu'), tensor(0.8699, device='cpu'), tensor(0.9236, device='cpu'), tensor(0.9161, device='cpu'), tensor(0.9130, device='cpu'), tensor(0.9455, device='cpu')]
Sorted Confidence Order: [tensor(0.9455, device='cpu'), tensor(0.9130, device='cpu'), tensor(0.9161, device='cpu'), tensor(0.9236, device='cpu'), tensor(0.9068, device='cpu'), tensor(0.9025, device='cpu'), tensor(0.8997, device='cpu'), tensor(0.8438, device='cpu'), tensor(0.3854, device='cpu'), tensor(0.3812, device='cpu'), tensor(0.3847, device='cpu'), tensor(0.8119, device='cpu'), tensor(0.8574, device='cpu'), tensor(0.8205, device='cpu'), tensor(0.3804, device='cpu'), tensor(0.7590, device='cpu'), tensor(0.7112, device='cpu'), tensor(0.3784, device='cpu'), tensor(0.6421, device='cpu'), tensor(0.5375, device='cpu'), tensor(0.8699, device='cpu'), tensor(0.8734, device='cpu'), tensor(0.6948, device='cpu'), tensor(0.3756, device='cpu'), tensor(0.3800, device='cpu'), tensor(0.5624, device='cpu'), tensor(0.8659, device='cpu'), tensor(0.8839, device='cpu'), tensor(0.9072, device='cpu'), tensor(0.8653, device='cpu'), tensor(0.8908, device='cpu'), tensor(0.9216)]
sorted_indices: [31, 30, 29, 28, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 27, 26, 25, 24, 23, 22, 21, 20, 3, 2, 1, 0]
Initial view (highest confidence): 36
New training order: [12, 11, 10, 9, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15, 14, 13]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.7ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9418
Instance 2: Confidence=0.9267
Instance 3: Confidence=0.9179
Instance 4: Confidence=0.8670
tmp min: tensor(0.) tmp max: tensor(1.)
755 44 540 960
There are 16 prompts
current IoU is: 0.9342585802078247
Seok, iteration idx= 1 IoU = tensor(0.9343)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.6ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9436
Instance 2: Confidence=0.9257
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9060
Instance 5: Confidence=0.4599
tmp min: tensor(0.) tmp max: tensor(1.)
760 60 540 960
There are 15 prompts
current IoU is: 0.9172573685646057
Seok, iteration idx= 2 IoU = tensor(0.9173)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 7
Instance 0: Confidence=0.9433
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.9262
Instance 3: Confidence=0.9099
Instance 4: Confidence=0.9046
Instance 5: Confidence=0.7494
Instance 6: Confidence=0.2752
tmp min: tensor(0.) tmp max: tensor(1.)
768 64 540 960
There are 14 prompts
current IoU is: 0.9158583879470825
Seok, iteration idx= 3 IoU = tensor(0.9159)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 3.2ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 7
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9451
Instance 2: Confidence=0.9205
Instance 3: Confidence=0.8957
Instance 4: Confidence=0.7199
Instance 5: Confidence=0.6674
Instance 6: Confidence=0.4065
tmp min: tensor(0.) tmp max: tensor(1.)
762 84 540 960
There are 16 prompts
current IoU is: 0.9327396750450134
Seok, iteration idx= 4 IoU = tensor(0.9327)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.6ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9502
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9259
Instance 3: Confidence=0.9246
Instance 4: Confidence=0.7572
tmp min: tensor(0.) tmp max: tensor(1.)
727 104 540 960
There are 15 prompts
current IoU is: 0.9199961423873901
Seok, iteration idx= 5 IoU = tensor(0.9200)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9502
Instance 1: Confidence=0.9332
Instance 2: Confidence=0.9264
Instance 3: Confidence=0.9254
Instance 4: Confidence=0.9229
Instance 5: Confidence=0.5863
tmp min: tensor(0.) tmp max: tensor(1.)
725 108 540 960
There are 15 prompts
current IoU is: 0.9400734901428223
Seok, iteration idx= 6 IoU = tensor(0.9401)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9397
Instance 2: Confidence=0.9054
Instance 3: Confidence=0.8999
Instance 4: Confidence=0.8815
Instance 5: Confidence=0.8617
tmp min: tensor(0.) tmp max: tensor(1.)
676 136 540 960
There are 17 prompts
current IoU is: 0.878167450428009
Seok, iteration idx= 7 IoU = tensor(0.8782)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9456
Instance 1: Confidence=0.9262
Instance 2: Confidence=0.8959
Instance 3: Confidence=0.8348
Instance 4: Confidence=0.6141
Instance 5: Confidence=0.3271
tmp min: tensor(0.) tmp max: tensor(1.)
722 116 540 960
There are 17 prompts
current IoU is: 0.4813201427459717
Seok, iteration idx= 8 IoU = tensor(0.4813)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9529
Instance 1: Confidence=0.9514
Instance 2: Confidence=0.9135
Instance 3: Confidence=0.9119
Instance 4: Confidence=0.3781
tmp min: tensor(0.) tmp max: tensor(1.)
679 52 540 960
There are 16 prompts
current IoU is: 0.00882018730044365
Seok, iteration idx= 9 IoU = tensor(0.0088)
SKIP, unacceptable sam prediction, IoU is tensor(0.0088)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 4
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9405
Instance 2: Confidence=0.9168
Instance 3: Confidence=0.8296
tmp min: tensor(0.) tmp max: tensor(1.)
614 28 540 960
There are 13 prompts
current IoU is: 0.00027563871117308736
Seok, iteration idx= 10 IoU = tensor(0.0003)
SKIP, unacceptable sam prediction, IoU is tensor(0.0003)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 1.6ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9585
Instance 1: Confidence=0.9275
Instance 2: Confidence=0.9113
Instance 3: Confidence=0.9041
Instance 4: Confidence=0.8095
tmp min: tensor(0.) tmp max: tensor(1.)
660 52 540 960
There are 16 prompts
current IoU is: 0.7804014682769775
Seok, iteration idx= 11 IoU = tensor(0.7804)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 1.6ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 7
Instance 0: Confidence=0.9670
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9256
Instance 3: Confidence=0.8502
Instance 4: Confidence=0.8407
Instance 5: Confidence=0.5675
Instance 6: Confidence=0.2603
tmp min: tensor(0.) tmp max: tensor(1.)
612 72 540 960
There are 14 prompts
current IoU is: 0.8717381954193115
Seok, iteration idx= 12 IoU = tensor(0.8717)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 2.4ms preprocess, 22.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9144
Instance 2: Confidence=0.9064
Instance 3: Confidence=0.9036
Instance 4: Confidence=0.8918
Instance 5: Confidence=0.8164
tmp min: tensor(0.) tmp max: tensor(1.)
541 84 540 960
There are 17 prompts
current IoU is: 0.8280573487281799
Seok, iteration idx= 13 IoU = tensor(0.8281)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 2.6ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9476
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.8890
Instance 3: Confidence=0.8363
Instance 4: Confidence=0.8338
tmp min: tensor(0.) tmp max: tensor(1.)
505 16 540 960
There are 15 prompts
current IoU is: 0.002410345943644643
Seok, iteration idx= 14 IoU = tensor(0.0024)
SKIP, unacceptable sam prediction, IoU is tensor(0.0024)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 2.6ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.8996
Instance 3: Confidence=0.8888
Instance 4: Confidence=0.8676
tmp min: tensor(0.) tmp max: tensor(1.)
495 92 540 960
There are 18 prompts
current IoU is: 0.7946428656578064
Seok, iteration idx= 15 IoU = tensor(0.7946)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 2.8ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9220
Instance 1: Confidence=0.9218
Instance 2: Confidence=0.9069
Instance 3: Confidence=0.9049
Instance 4: Confidence=0.9018
Instance 5: Confidence=0.8183
tmp min: tensor(0.) tmp max: tensor(1.)
449 80 540 960
There are 16 prompts
current IoU is: 0.8856743574142456
Seok, iteration idx= 16 IoU = tensor(0.8857)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 2.8ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9437
Instance 1: Confidence=0.9314
Instance 2: Confidence=0.9091
Instance 3: Confidence=0.8747
Instance 4: Confidence=0.8331
tmp min: tensor(0.) tmp max: tensor(1.)
404 84 540 960
There are 14 prompts
current IoU is: 0.0013754847459495068
Seok, iteration idx= 17 IoU = tensor(0.0014)
SKIP, unacceptable sam prediction, IoU is tensor(0.0014)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.3ms
Speed: 3.2ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 8
Instance 0: Confidence=0.9391
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9228
Instance 3: Confidence=0.8782
Instance 4: Confidence=0.6843
Instance 5: Confidence=0.5397
Instance 6: Confidence=0.5218
Instance 7: Confidence=0.3399
tmp min: tensor(0.) tmp max: tensor(1.)
372 92 540 960
There are 15 prompts
current IoU is: 0.7154231667518616
Seok, iteration idx= 18 IoU = tensor(0.7154)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.7ms
Speed: 3.0ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9443
Instance 1: Confidence=0.9263
Instance 2: Confidence=0.9112
Instance 3: Confidence=0.8529
Instance 4: Confidence=0.7917
Instance 5: Confidence=0.5320
Instance 6: Confidence=0.4048
tmp min: tensor(0.) tmp max: tensor(1.)
369 84 540 960
There are 17 prompts
current IoU is: 0.8559735417366028
Seok, iteration idx= 19 IoU = tensor(0.8560)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 2.8ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9328
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.9281
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8874
Instance 5: Confidence=0.8685
tmp min: tensor(0.) tmp max: tensor(1.)
310 72 540 960
There are 15 prompts
current IoU is: 0.8497134447097778
Seok, iteration idx= 20 IoU = tensor(0.8497)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 2.7ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9544
Instance 1: Confidence=0.9382
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.9165
Instance 4: Confidence=0.9129
tmp min: tensor(0.) tmp max: tensor(1.)
306 68 540 960
There are 16 prompts
current IoU is: 0.8587903380393982
Seok, iteration idx= 21 IoU = tensor(0.8588)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 3.3ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9429
Instance 1: Confidence=0.9358
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.8998
Instance 4: Confidence=0.8047
Instance 5: Confidence=0.7897
tmp min: tensor(0.) tmp max: tensor(1.)
323 76 540 960
There are 16 prompts
current IoU is: 0.8319664001464844
Seok, iteration idx= 22 IoU = tensor(0.8320)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 3.2ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9390
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9113
Instance 3: Confidence=0.9079
Instance 4: Confidence=0.8845
tmp min: tensor(0.) tmp max: tensor(1.)
234 12 540 960
There are 18 prompts
current IoU is: 0.0095742866396904
Seok, iteration idx= 23 IoU = tensor(0.0096)
SKIP, unacceptable sam prediction, IoU is tensor(0.0096)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9308
Instance 2: Confidence=0.9301
Instance 3: Confidence=0.9154
Instance 4: Confidence=0.8041
tmp min: tensor(0.) tmp max: tensor(1.)
245 32 540 960
There are 16 prompts
current IoU is: 0.0007106454577296972
Seok, iteration idx= 24 IoU = tensor(0.0007)
SKIP, unacceptable sam prediction, IoU is tensor(0.0007)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.8ms
Speed: 1.6ms preprocess, 21.8ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 8
Instance 0: Confidence=0.9374
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9352
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.5537
Instance 5: Confidence=0.3907
Instance 6: Confidence=0.3726
Instance 7: Confidence=0.3383
tmp min: tensor(0.) tmp max: tensor(1.)
254 84 540 960
current IoU is: 0.7853982448577881
Seok, iteration idx= 25 IoU = tensor(0.7854)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.6ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9305
Instance 1: Confidence=0.9276
Instance 2: Confidence=0.9191
Instance 3: Confidence=0.8996
Instance 4: Confidence=0.8552
Instance 5: Confidence=0.8230
tmp min: tensor(0.) tmp max: tensor(1.)
250 88 540 960
There are 18 prompts
current IoU is: 0.8850876092910767
Seok, iteration idx= 26 IoU = tensor(0.8851)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9306
Instance 1: Confidence=0.9305
Instance 2: Confidence=0.9199
Instance 3: Confidence=0.9194
Instance 4: Confidence=0.9074
Instance 5: Confidence=0.8918
tmp min: tensor(0.) tmp max: tensor(1.)
253 104 540 960
current IoU is: 0.9088286757469177
Seok, iteration idx= 27 IoU = tensor(0.9088)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9398
Instance 1: Confidence=0.9287
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.8930
Instance 4: Confidence=0.8873
tmp min: tensor(0.) tmp max: tensor(1.)
567 116 540 960
There are 15 prompts
current IoU is: 0.9560984969139099
Seok, iteration idx= 28 IoU = tensor(0.9561)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 1.4ms preprocess, 24.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9432
Instance 1: Confidence=0.9382
Instance 2: Confidence=0.9229
Instance 3: Confidence=0.9166
Instance 4: Confidence=0.8470
Instance 5: Confidence=0.8422
tmp min: tensor(0.) tmp max: tensor(1.)
611 80 540 960
There are 14 prompts
current IoU is: 0.9564984440803528
Seok, iteration idx= 29 IoU = tensor(0.9565)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9418
Instance 2: Confidence=0.9238
Instance 3: Confidence=0.9103
Instance 4: Confidence=0.8137
Instance 5: Confidence=0.3678
tmp min: tensor(0.) tmp max: tensor(1.)
659 48 540 960
There are 14 prompts
current IoU is: 0.9280585646629333
Seok, iteration idx= 30 IoU = tensor(0.9281)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.4ms
Speed: 1.5ms preprocess, 24.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 8
Instance 0: Confidence=0.9478
Instance 1: Confidence=0.9216
Instance 2: Confidence=0.9111
Instance 3: Confidence=0.8634
Instance 4: Confidence=0.7675
Instance 5: Confidence=0.6778
Instance 6: Confidence=0.3866
Instance 7: Confidence=0.3368
tmp min: tensor(0.) tmp max: tensor(1.)
695 52 540 960
There are 14 prompts
current IoU is: 0.9602424502372742
Seok, iteration idx= 31 IoU = tensor(0.9602)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set3_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set3_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:40<00:00,  1.27s/it]
Testing psnr 28.415960296988487 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set3_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.15it/s]
Testing psnr 3.229493573307991 (avg)
train: coarse segmentation in 00:05:55
train: finish (eps time 00:05:55 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set3_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1001, in load_tensor
    wrap_storage=restore_location(storage, location),
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 175, in default_restore_location
    result = fn(storage, location)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 157, in _cuda_deserialize
    return obj.cuda(device)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/_utils.py", line 78, in _cuda
    return torch._UntypedStorage(self.size(), device=torch.device('cuda')).copy_(self, non_blocking)
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set4/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 46.20it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set4 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set4
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set4_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.7ms
Speed: 2.7ms preprocess, 19.7ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.2ms
Speed: 1.3ms preprocess, 19.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.5ms
Speed: 1.3ms preprocess, 18.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.5ms
Speed: 2.3ms preprocess, 18.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.0ms
Speed: 1.5ms preprocess, 19.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.5ms preprocess, 18.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.5ms preprocess, 18.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.3ms
Speed: 1.6ms preprocess, 19.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 2.3ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.2ms
Speed: 1.4ms preprocess, 19.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.5ms
Speed: 1.2ms preprocess, 18.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.5ms preprocess, 18.9ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.0ms
Speed: 1.4ms preprocess, 19.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.4ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.3ms
Speed: 1.3ms preprocess, 19.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.5ms
Speed: 1.2ms preprocess, 18.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.5ms
Speed: 1.2ms preprocess, 19.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 10 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 10 persons, 20.4ms
Speed: 3.0ms preprocess, 20.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 31
view_order: [36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.4ms
Speed: 1.6ms preprocess, 20.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9310
Instance 1: Confidence=0.9039
Instance 2: Confidence=0.8684
Instance 3: Confidence=0.8642
Instance 4: Confidence=0.8209
Instance 5: Confidence=0.6953
Selected instance: 3 (Confidence: 0.8642)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

521 92 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.35201966762542725
Seok, iteration idx= 1 IoU = tensor(0.3520)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 1.7ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 7
Instance 0: Confidence=0.9402
Instance 1: Confidence=0.9144
Instance 2: Confidence=0.9030
Instance 3: Confidence=0.8917
Instance 4: Confidence=0.8304
Instance 5: Confidence=0.7796
Instance 6: Confidence=0.4827
Selected instance: 4 (Confidence: 0.8304)
tmp min: tensor(0.) tmp max: tensor(1.)
538 76 540 960
There are 15 prompts
current IoU is: 0.6945730447769165
Seok, iteration idx= 2 IoU = tensor(0.6946)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9453
Instance 1: Confidence=0.9352
Instance 2: Confidence=0.9312
Instance 3: Confidence=0.8691
Instance 4: Confidence=0.4903
Selected instance: 4 (Confidence: 0.4903)
tmp min: tensor(0.) tmp max: tensor(1.)
609 116 540 960
There are 15 prompts
current IoU is: 0.3900355100631714
Seok, iteration idx= 3 IoU = tensor(0.3900)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9379
Instance 2: Confidence=0.9213
Instance 3: Confidence=0.9213
Instance 4: Confidence=0.8837
Selected instance: 4 (Confidence: 0.8837)
tmp min: tensor(0.) tmp max: tensor(1.)
568 64 540 960
There are 16 prompts
current IoU is: 0.46526357531547546
Seok, iteration idx= 4 IoU = tensor(0.4653)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.1ms
Speed: 1.6ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 8
Instance 0: Confidence=0.9402
Instance 1: Confidence=0.9296
Instance 2: Confidence=0.9254
Instance 3: Confidence=0.9197
Instance 4: Confidence=0.8924
Instance 5: Confidence=0.5797
Instance 6: Confidence=0.4707
Instance 7: Confidence=0.2998
Selected instance: 3 (Confidence: 0.9197)
tmp min: tensor(0.) tmp max: tensor(1.)
582 44 540 960
There are 14 prompts
current IoU is: 0.8285274505615234
Seok, iteration idx= 5 IoU = tensor(0.8285)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9301
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.9115
Instance 4: Confidence=0.8082
Instance 5: Confidence=0.7248
Selected instance: 3 (Confidence: 0.9115)
tmp min: tensor(0.) tmp max: tensor(1.)
620 40 540 960
There are 16 prompts
current IoU is: 0.8682152628898621
Seok, iteration idx= 6 IoU = tensor(0.8682)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.7ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9404
Instance 2: Confidence=0.9285
Instance 3: Confidence=0.9185
Instance 4: Confidence=0.8826
Selected instance: 2 (Confidence: 0.9285)
tmp min: tensor(0.) tmp max: tensor(1.)
615 32 540 960
There are 17 prompts
current IoU is: 0.8996966481208801
Seok, iteration idx= 7 IoU = tensor(0.8997)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.9ms
Speed: 3.2ms preprocess, 21.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9306
Instance 2: Confidence=0.9102
Instance 3: Confidence=0.9030
Instance 4: Confidence=0.8677
Instance 5: Confidence=0.8433
Selected instance: 3 (Confidence: 0.9030)
tmp min: tensor(0.) tmp max: tensor(1.)
607 24 540 960
There are 17 prompts
current IoU is: 0.8998106122016907
Seok, iteration idx= 8 IoU = tensor(0.8998)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.1ms
Speed: 3.1ms preprocess, 22.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9367
Instance 2: Confidence=0.8905
Instance 3: Confidence=0.8844
Instance 4: Confidence=0.8646
Instance 5: Confidence=0.2912
Selected instance: 1 (Confidence: 0.9367)
tmp min: tensor(0.) tmp max: tensor(1.)
341 20 540 960
There are 15 prompts
current IoU is: 0.8618297576904297
Seok, iteration idx= 9 IoU = tensor(0.8618)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 3.1ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9527
Instance 1: Confidence=0.9436
Instance 2: Confidence=0.9006
Instance 3: Confidence=0.8998
Instance 4: Confidence=0.8845
Instance 5: Confidence=0.4642
Selected instance: 0 (Confidence: 0.9527)
tmp min: tensor(0.) tmp max: tensor(1.)
305 20 540 960
There are 18 prompts
current IoU is: 0.9131662249565125
Seok, iteration idx= 10 IoU = tensor(0.9132)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.2ms
Speed: 2.5ms preprocess, 23.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 8
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9309
Instance 2: Confidence=0.9081
Instance 3: Confidence=0.7502
Instance 4: Confidence=0.7004
Instance 5: Confidence=0.4914
Instance 6: Confidence=0.4399
Instance 7: Confidence=0.2941
Selected instance: 1 (Confidence: 0.9309)
tmp min: tensor(0.) tmp max: tensor(1.)
293 16 540 960
There are 14 prompts
current IoU is: 0.9382239580154419
Seok, iteration idx= 11 IoU = tensor(0.9382)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9470
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.8950
Instance 4: Confidence=0.8500
Selected instance: 0 (Confidence: 0.9497)
tmp min: tensor(0.) tmp max: tensor(1.)
273 20 540 960
There are 16 prompts
current IoU is: 0.9460291862487793
Seok, iteration idx= 12 IoU = tensor(0.9460)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 7
Instance 0: Confidence=0.9433
Instance 1: Confidence=0.9295
Instance 2: Confidence=0.9015
Instance 3: Confidence=0.8754
Instance 4: Confidence=0.8475
Instance 5: Confidence=0.5789
Instance 6: Confidence=0.4633
Selected instance: 1 (Confidence: 0.9295)
tmp min: tensor(0.) tmp max: tensor(1.)
271 36 540 960
There are 16 prompts
current IoU is: 0.8836755156517029
Seok, iteration idx= 13 IoU = tensor(0.8837)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9409
Instance 1: Confidence=0.9153
Instance 2: Confidence=0.9146
Instance 3: Confidence=0.8973
Instance 4: Confidence=0.6037
Instance 5: Confidence=0.4515
Instance 6: Confidence=0.2713
Selected instance: 3 (Confidence: 0.8973)
tmp min: tensor(0.) tmp max: tensor(1.)
288 56 540 960
There are 17 prompts
current IoU is: 0.8963329792022705
Seok, iteration idx= 14 IoU = tensor(0.8963)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9345
Instance 1: Confidence=0.9176
Instance 2: Confidence=0.9114
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8976
Selected instance: 3 (Confidence: 0.9028)
tmp min: tensor(0.) tmp max: tensor(1.)
295 76 540 960
There are 18 prompts
current IoU is: 0.8724257946014404
Seok, iteration idx= 15 IoU = tensor(0.8724)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.7ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9384
Instance 2: Confidence=0.9249
Instance 3: Confidence=0.9049
Instance 4: Confidence=0.8864
Selected instance: 3 (Confidence: 0.9049)
tmp min: tensor(0.) tmp max: tensor(1.)
304 116 540 960
There are 18 prompts
current IoU is: 0.8858028054237366
Seok, iteration idx= 16 IoU = tensor(0.8858)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.7ms preprocess, 23.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9491
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9331
Instance 3: Confidence=0.9178
Instance 4: Confidence=0.9059
Instance 5: Confidence=0.8131
Selected instance: 2 (Confidence: 0.9331)
tmp min: tensor(0.) tmp max: tensor(1.)
644 56 540 960
current IoU is: 0.844146728515625
Seok, iteration idx= 17 IoU = tensor(0.8441)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9408
Instance 2: Confidence=0.9396
Instance 3: Confidence=0.9338
Instance 4: Confidence=0.9225
Instance 5: Confidence=0.4237
Selected instance: 4 (Confidence: 0.9225)
tmp min: tensor(0.) tmp max: tensor(1.)
617 56 540 960
There are 19 prompts
current IoU is: 0.8005983233451843
Seok, iteration idx= 18 IoU = tensor(0.8006)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.7ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9320
Instance 1: Confidence=0.9259
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.9090
Instance 4: Confidence=0.9060
Selected instance: 2 (Confidence: 0.9172)
tmp min: tensor(0.) tmp max: tensor(1.)
628 88 540 960
There are 16 prompts
current IoU is: 0.9088641405105591
Seok, iteration idx= 19 IoU = tensor(0.9089)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.0ms
Speed: 1.6ms preprocess, 25.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9356
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9268
Instance 3: Confidence=0.9164
Instance 4: Confidence=0.8873
Instance 5: Confidence=0.8672
Selected instance: 1 (Confidence: 0.9303)
tmp min: tensor(0.) tmp max: tensor(1.)
652 48 540 960
There are 16 prompts
current IoU is: 0.9259828925132751
Seok, iteration idx= 20 IoU = tensor(0.9260)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9388
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9012
Instance 3: Confidence=0.8933
Instance 4: Confidence=0.8737
Selected instance: 3 (Confidence: 0.8933)
tmp min: tensor(0.) tmp max: tensor(1.)
643 44 540 960
There are 14 prompts
current IoU is: 0.8325631022453308
Seok, iteration idx= 21 IoU = tensor(0.8326)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 1.8ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 7
Instance 0: Confidence=0.9264
Instance 1: Confidence=0.9138
Instance 2: Confidence=0.9107
Instance 3: Confidence=0.8424
Instance 4: Confidence=0.8102
Instance 5: Confidence=0.7175
Instance 6: Confidence=0.7047
Selected instance: 6 (Confidence: 0.7047)
tmp min: tensor(0.) tmp max: tensor(1.)
640 16 540 960
There are 17 prompts
current IoU is: 0.9350568056106567
Seok, iteration idx= 22 IoU = tensor(0.9351)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.6ms preprocess, 23.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9346
Instance 1: Confidence=0.9336
Instance 2: Confidence=0.9319
Instance 3: Confidence=0.9087
Instance 4: Confidence=0.8680
Selected instance: 3 (Confidence: 0.9087)
tmp min: tensor(0.) tmp max: tensor(1.)
611 28 540 960
There are 17 prompts
current IoU is: 0.931795060634613
Seok, iteration idx= 23 IoU = tensor(0.9318)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.7ms
Speed: 3.7ms preprocess, 22.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 7
Instance 0: Confidence=0.9481
Instance 1: Confidence=0.9315
Instance 2: Confidence=0.9225
Instance 3: Confidence=0.9042
Instance 4: Confidence=0.8958
Instance 5: Confidence=0.6956
Instance 6: Confidence=0.3838
Selected instance: 2 (Confidence: 0.9225)
tmp min: tensor(0.) tmp max: tensor(1.)
648 4 540 960
There are 13 prompts
current IoU is: 0.9381417632102966
Seok, iteration idx= 24 IoU = tensor(0.9381)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 3.7ms preprocess, 22.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9402
Instance 2: Confidence=0.9388
Instance 3: Confidence=0.9054
Instance 4: Confidence=0.8651
Selected instance: 0 (Confidence: 0.9447)
tmp min: tensor(0.) tmp max: tensor(1.)
624 0 540 960
There are 13 prompts
current IoU is: 0.9566999673843384
Seok, iteration idx= 25 IoU = tensor(0.9567)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 2.8ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9414
Instance 1: Confidence=0.9324
Instance 2: Confidence=0.9207
Instance 3: Confidence=0.9081
Instance 4: Confidence=0.9032
Instance 5: Confidence=0.6914
Selected instance: 0 (Confidence: 0.9414)
tmp min: tensor(0.) tmp max: tensor(1.)
568 28 540 960
There are 15 prompts
current IoU is: 0.9634142518043518
Seok, iteration idx= 26 IoU = tensor(0.9634)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 3.3ms preprocess, 23.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9473
Instance 2: Confidence=0.8913
Instance 3: Confidence=0.8832
Instance 4: Confidence=0.8511
Instance 5: Confidence=0.4380
Selected instance: 1 (Confidence: 0.9473)
tmp min: tensor(0.) tmp max: tensor(1.)
536 0 540 960
There are 14 prompts
current IoU is: 0.9558262825012207
Seok, iteration idx= 27 IoU = tensor(0.9558)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 3.0ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9522
Instance 1: Confidence=0.9410
Instance 2: Confidence=0.9127
Instance 3: Confidence=0.7607
Instance 4: Confidence=0.3358
Selected instance: 0 (Confidence: 0.9522)
tmp min: tensor(0.) tmp max: tensor(1.)
507 12 540 960
There are 14 prompts
current IoU is: 0.9600403308868408
Seok, iteration idx= 28 IoU = tensor(0.9600)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.0ms
Speed: 2.8ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 8
Instance 0: Confidence=0.9434
Instance 1: Confidence=0.9339
Instance 2: Confidence=0.9202
Instance 3: Confidence=0.8963
Instance 4: Confidence=0.8529
Instance 5: Confidence=0.8451
Instance 6: Confidence=0.3002
Instance 7: Confidence=0.2701
Selected instance: 0 (Confidence: 0.9434)
tmp min: tensor(0.) tmp max: tensor(1.)
439 100 540 960
There are 14 prompts
current IoU is: 0.956944465637207
Seok, iteration idx= 29 IoU = tensor(0.9569)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 3.0ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9313
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8973
Instance 4: Confidence=0.5839
Instance 5: Confidence=0.4561
Selected instance: 0 (Confidence: 0.9555)
tmp min: tensor(0.) tmp max: tensor(1.)
400 64 540 960
There are 15 prompts
current IoU is: 0.9584091901779175
Seok, iteration idx= 30 IoU = tensor(0.9584)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.6ms
Speed: 3.1ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 7
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9330
Instance 3: Confidence=0.5783
Instance 4: Confidence=0.4017
Instance 5: Confidence=0.3446
Instance 6: Confidence=0.2606
Selected instance: 0 (Confidence: 0.9621)
tmp min: tensor(0.) tmp max: tensor(1.)
369 68 540 960
There are 15 prompts
current IoU is: 0.960709273815155
Seok, iteration idx= 31 IoU = tensor(0.9607)
Selected Instance Confidence List: [tensor(0.9353), tensor(0.5569, device='cpu'), tensor(0.7489, device='cpu'), tensor(0.4301, device='cpu'), tensor(0.6327, device='cpu'), tensor(0.8650, device='cpu'), tensor(0.8855, device='cpu'), tensor(0.9112, device='cpu'), tensor(0.9011, device='cpu'), tensor(0.8918, device='cpu'), tensor(0.9290, device='cpu'), tensor(0.9353, device='cpu'), tensor(0.9475, device='cpu'), tensor(0.9020, device='cpu'), tensor(0.8967, device='cpu'), tensor(0.8846, device='cpu'), tensor(0.8934, device='cpu'), tensor(0.8797, device='cpu'), tensor(0.8493, device='cpu'), tensor(0.9122, device='cpu'), tensor(0.9277, device='cpu'), tensor(0.8569, device='cpu'), tensor(0.8429, device='cpu'), tensor(0.9226, device='cpu'), tensor(0.9319, device='cpu'), tensor(0.9519, device='cpu'), tensor(0.9546, device='cpu'), tensor(0.9524, device='cpu'), tensor(0.9569, device='cpu'), tensor(0.9515, device='cpu'), tensor(0.9572, device='cpu'), tensor(0.9613, device='cpu')]
Sorted Confidence Order: [tensor(0.9613, device='cpu'), tensor(0.9572, device='cpu'), tensor(0.9353), tensor(0.8918, device='cpu'), tensor(0.9290, device='cpu'), tensor(0.9353, device='cpu'), tensor(0.9475, device='cpu'), tensor(0.9020, device='cpu'), tensor(0.8967, device='cpu'), tensor(0.8846, device='cpu'), tensor(0.8934, device='cpu'), tensor(0.9515, device='cpu'), tensor(0.9569, device='cpu'), tensor(0.9524, device='cpu'), tensor(0.9546, device='cpu'), tensor(0.9519, device='cpu'), tensor(0.9319, device='cpu'), tensor(0.9226, device='cpu'), tensor(0.8429, device='cpu'), tensor(0.8569, device='cpu'), tensor(0.9277, device='cpu'), tensor(0.9122, device='cpu'), tensor(0.8493, device='cpu'), tensor(0.8797, device='cpu'), tensor(0.9011, device='cpu'), tensor(0.9112, device='cpu'), tensor(0.8855, device='cpu'), tensor(0.8650, device='cpu'), tensor(0.6327, device='cpu'), tensor(0.4301, device='cpu'), tensor(0.7489, device='cpu'), tensor(0.5569, device='cpu')]
sorted_indices: [31, 30, 0, 9, 10, 11, 12, 13, 14, 15, 16, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 8, 7, 6, 5, 4, 3, 2, 1]
Initial view (highest confidence): 36
New training order: [35, 34, 36, 9, 10, 11, 12, 13, 14, 15, 16, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.0ms
Speed: 1.5ms preprocess, 20.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 3.4ms preprocess, 23.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9313
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8973
Instance 4: Confidence=0.5839
Instance 5: Confidence=0.4561
tmp min: tensor(0.) tmp max: tensor(1.)
400 64 540 960
There are 15 prompts
current IoU is: 0.9597472548484802
Seok, iteration idx= 1 IoU = tensor(0.9597)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 10 persons, 22.6ms
Speed: 3.2ms preprocess, 22.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 10
Instance 0: Confidence=0.9473
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.6370
Instance 4: Confidence=0.5932
Instance 5: Confidence=0.5777
Instance 6: Confidence=0.4581
Instance 7: Confidence=0.3354
Instance 8: Confidence=0.3136
Instance 9: Confidence=0.2909
tmp min: tensor(0.) tmp max: tensor(1.)
362 32 540 960
There are 14 prompts
current IoU is: 0.9656070470809937
Seok, iteration idx= 2 IoU = tensor(0.9656)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 3.2ms preprocess, 22.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 6
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9367
Instance 2: Confidence=0.8905
Instance 3: Confidence=0.8844
Instance 4: Confidence=0.8646
Instance 5: Confidence=0.2912
tmp min: tensor(0.) tmp max: tensor(1.)
341 20 540 960
There are 15 prompts
current IoU is: 0.9488208293914795
Seok, iteration idx= 3 IoU = tensor(0.9488)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.5ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9527
Instance 1: Confidence=0.9436
Instance 2: Confidence=0.9006
Instance 3: Confidence=0.8998
Instance 4: Confidence=0.8845
Instance 5: Confidence=0.4642
tmp min: tensor(0.) tmp max: tensor(1.)
305 20 540 960
There are 18 prompts
current IoU is: 0.9601780772209167
Seok, iteration idx= 4 IoU = tensor(0.9602)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 8
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9309
Instance 2: Confidence=0.9081
Instance 3: Confidence=0.7502
Instance 4: Confidence=0.7004
Instance 5: Confidence=0.4914
Instance 6: Confidence=0.4399
Instance 7: Confidence=0.2941
tmp min: tensor(0.) tmp max: tensor(1.)
293 16 540 960
There are 14 prompts
current IoU is: 0.9590851068496704
Seok, iteration idx= 5 IoU = tensor(0.9591)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9470
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.8950
Instance 4: Confidence=0.8500
tmp min: tensor(0.) tmp max: tensor(1.)
273 20 540 960
There are 16 prompts
current IoU is: 0.9624286890029907
Seok, iteration idx= 6 IoU = tensor(0.9624)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9433
Instance 1: Confidence=0.9295
Instance 2: Confidence=0.9015
Instance 3: Confidence=0.8754
Instance 4: Confidence=0.8475
Instance 5: Confidence=0.5789
Instance 6: Confidence=0.4633
tmp min: tensor(0.) tmp max: tensor(1.)
271 36 540 960
There are 16 prompts
current IoU is: 0.9533659815788269
Seok, iteration idx= 7 IoU = tensor(0.9534)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 2.0ms preprocess, 22.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9409
Instance 1: Confidence=0.9153
Instance 2: Confidence=0.9146
Instance 3: Confidence=0.8973
Instance 4: Confidence=0.6037
Instance 5: Confidence=0.4515
Instance 6: Confidence=0.2713
tmp min: tensor(0.) tmp max: tensor(1.)
288 56 540 960
There are 17 prompts
current IoU is: 0.9329074621200562
Seok, iteration idx= 8 IoU = tensor(0.9329)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 2.4ms preprocess, 22.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9345
Instance 1: Confidence=0.9176
Instance 2: Confidence=0.9114
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8976
tmp min: tensor(0.) tmp max: tensor(1.)
295 76 540 960
There are 18 prompts
current IoU is: 0.912574827671051
Seok, iteration idx= 9 IoU = tensor(0.9126)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9384
Instance 2: Confidence=0.9249
Instance 3: Confidence=0.9049
Instance 4: Confidence=0.8864
tmp min: tensor(0.) tmp max: tensor(1.)
304 116 540 960
There are 18 prompts
current IoU is: 0.901922345161438
Seok, iteration idx= 10 IoU = tensor(0.9019)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 8
Instance 0: Confidence=0.9434
Instance 1: Confidence=0.9339
Instance 2: Confidence=0.9202
Instance 3: Confidence=0.8963
Instance 4: Confidence=0.8529
Instance 5: Confidence=0.8451
Instance 6: Confidence=0.3002
Instance 7: Confidence=0.2701
tmp min: tensor(0.) tmp max: tensor(1.)
439 100 540 960
There are 14 prompts
current IoU is: 0.9583078622817993
Seok, iteration idx= 11 IoU = tensor(0.9583)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9522
Instance 1: Confidence=0.9410
Instance 2: Confidence=0.9127
Instance 3: Confidence=0.7607
Instance 4: Confidence=0.3358
tmp min: tensor(0.) tmp max: tensor(1.)
507 12 540 960
There are 14 prompts
current IoU is: 0.9607450366020203
Seok, iteration idx= 12 IoU = tensor(0.9607)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.6ms preprocess, 23.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9473
Instance 2: Confidence=0.8913
Instance 3: Confidence=0.8832
Instance 4: Confidence=0.8511
Instance 5: Confidence=0.4380
tmp min: tensor(0.) tmp max: tensor(1.)
536 0 540 960
There are 14 prompts
current IoU is: 0.9606090784072876
Seok, iteration idx= 13 IoU = tensor(0.9606)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.6ms preprocess, 24.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9414
Instance 1: Confidence=0.9324
Instance 2: Confidence=0.9207
Instance 3: Confidence=0.9081
Instance 4: Confidence=0.9032
Instance 5: Confidence=0.6914
tmp min: tensor(0.) tmp max: tensor(1.)
568 28 540 960
There are 15 prompts
current IoU is: 0.965148389339447
Seok, iteration idx= 14 IoU = tensor(0.9651)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.7ms preprocess, 24.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9402
Instance 2: Confidence=0.9388
Instance 3: Confidence=0.9054
Instance 4: Confidence=0.8651
tmp min: tensor(0.) tmp max: tensor(1.)
624 0 540 960
There are 13 prompts
current IoU is: 0.9587329030036926
Seok, iteration idx= 15 IoU = tensor(0.9587)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 2.6ms preprocess, 23.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 7
Instance 0: Confidence=0.9481
Instance 1: Confidence=0.9315
Instance 2: Confidence=0.9225
Instance 3: Confidence=0.9042
Instance 4: Confidence=0.8958
Instance 5: Confidence=0.6956
Instance 6: Confidence=0.3838
tmp min: tensor(0.) tmp max: tensor(1.)
648 4 540 960
There are 13 prompts
current IoU is: 0.9442118406295776
Seok, iteration idx= 16 IoU = tensor(0.9442)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 2.8ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9346
Instance 1: Confidence=0.9336
Instance 2: Confidence=0.9319
Instance 3: Confidence=0.9087
Instance 4: Confidence=0.8680
tmp min: tensor(0.) tmp max: tensor(1.)
611 28 540 960
There are 17 prompts
current IoU is: 0.9439839124679565
Seok, iteration idx= 17 IoU = tensor(0.9440)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 3.2ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 7
Instance 0: Confidence=0.9264
Instance 1: Confidence=0.9138
Instance 2: Confidence=0.9107
Instance 3: Confidence=0.8424
Instance 4: Confidence=0.8102
Instance 5: Confidence=0.7175
Instance 6: Confidence=0.7047
tmp min: tensor(0.) tmp max: tensor(1.)
640 16 540 960
There are 17 prompts
current IoU is: 0.9380590915679932
Seok, iteration idx= 18 IoU = tensor(0.9381)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 2.9ms preprocess, 23.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9388
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9012
Instance 3: Confidence=0.8933
Instance 4: Confidence=0.8737
tmp min: tensor(0.) tmp max: tensor(1.)
643 44 540 960
There are 14 prompts
current IoU is: 0.8707152009010315
Seok, iteration idx= 19 IoU = tensor(0.8707)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 3.6ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9356
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9268
Instance 3: Confidence=0.9164
Instance 4: Confidence=0.8873
Instance 5: Confidence=0.8672
tmp min: tensor(0.) tmp max: tensor(1.)
652 48 540 960
There are 16 prompts
current IoU is: 0.9460126757621765
Seok, iteration idx= 20 IoU = tensor(0.9460)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 2.7ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9320
Instance 1: Confidence=0.9259
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.9090
Instance 4: Confidence=0.9060
tmp min: tensor(0.) tmp max: tensor(1.)
628 88 540 960
There are 16 prompts
current IoU is: 0.9336943626403809
Seok, iteration idx= 21 IoU = tensor(0.9337)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 2.9ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9408
Instance 2: Confidence=0.9396
Instance 3: Confidence=0.9338
Instance 4: Confidence=0.9225
Instance 5: Confidence=0.4237
tmp min: tensor(0.) tmp max: tensor(1.)
617 56 540 960
There are 19 prompts
current IoU is: 0.825164258480072
Seok, iteration idx= 22 IoU = tensor(0.8252)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 2.8ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9491
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9331
Instance 3: Confidence=0.9178
Instance 4: Confidence=0.9059
Instance 5: Confidence=0.8131
tmp min: tensor(0.) tmp max: tensor(1.)
644 56 540 960
current IoU is: 0.879514217376709
Seok, iteration idx= 23 IoU = tensor(0.8795)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 2.1ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9306
Instance 2: Confidence=0.9102
Instance 3: Confidence=0.9030
Instance 4: Confidence=0.8677
Instance 5: Confidence=0.8433
tmp min: tensor(0.) tmp max: tensor(1.)
607 24 540 960
There are 17 prompts
current IoU is: 0.9358128905296326
Seok, iteration idx= 24 IoU = tensor(0.9358)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.4ms
Speed: 1.6ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9404
Instance 2: Confidence=0.9285
Instance 3: Confidence=0.9185
Instance 4: Confidence=0.8826
tmp min: tensor(0.) tmp max: tensor(1.)
615 32 540 960
There are 17 prompts
current IoU is: 0.929166853427887
Seok, iteration idx= 25 IoU = tensor(0.9292)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.6ms preprocess, 22.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9301
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.9115
Instance 4: Confidence=0.8082
Instance 5: Confidence=0.7248
tmp min: tensor(0.) tmp max: tensor(1.)
620 40 540 960
There are 16 prompts
current IoU is: 0.9246905446052551
Seok, iteration idx= 26 IoU = tensor(0.9247)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 8
Instance 0: Confidence=0.9402
Instance 1: Confidence=0.9296
Instance 2: Confidence=0.9254
Instance 3: Confidence=0.9197
Instance 4: Confidence=0.8924
Instance 5: Confidence=0.5797
Instance 6: Confidence=0.4707
Instance 7: Confidence=0.2998
tmp min: tensor(0.) tmp max: tensor(1.)
582 44 540 960
There are 14 prompts
current IoU is: 0.9215219020843506
Seok, iteration idx= 27 IoU = tensor(0.9215)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.2ms
Speed: 1.7ms preprocess, 25.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9379
Instance 2: Confidence=0.9213
Instance 3: Confidence=0.9213
Instance 4: Confidence=0.8837
tmp min: tensor(0.) tmp max: tensor(1.)
568 64 540 960
There are 16 prompts
current IoU is: 0.9286932945251465
Seok, iteration idx= 28 IoU = tensor(0.9287)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9453
Instance 1: Confidence=0.9352
Instance 2: Confidence=0.9312
Instance 3: Confidence=0.8691
Instance 4: Confidence=0.4903
tmp min: tensor(0.) tmp max: tensor(1.)
609 116 540 960
There are 15 prompts
current IoU is: 0.780518114566803
Seok, iteration idx= 29 IoU = tensor(0.7805)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9402
Instance 1: Confidence=0.9144
Instance 2: Confidence=0.9030
Instance 3: Confidence=0.8917
Instance 4: Confidence=0.8304
Instance 5: Confidence=0.7796
Instance 6: Confidence=0.4827
tmp min: tensor(0.) tmp max: tensor(1.)
538 76 540 960
There are 15 prompts
current IoU is: 0.6628754138946533
Seok, iteration idx= 30 IoU = tensor(0.6629)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 1.8ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9310
Instance 1: Confidence=0.9039
Instance 2: Confidence=0.8684
Instance 3: Confidence=0.8642
Instance 4: Confidence=0.8209
Instance 5: Confidence=0.6953
tmp min: tensor(0.) tmp max: tensor(1.)
521 92 540 960
There are 16 prompts
current IoU is: 0.806768536567688
Seok, iteration idx= 31 IoU = tensor(0.8068)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set4_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set4_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.25s/it]
Testing psnr 27.89732500910759 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set4_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.16it/s]
Testing psnr 3.2548858411610126 (avg)
train: coarse segmentation in 00:03:54
train: finish (eps time 00:03:54 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set4_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1001, in load_tensor
    wrap_storage=restore_location(storage, location),
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 175, in default_restore_location
    result = fn(storage, location)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 157, in _cuda_deserialize
    return obj.cuda(device)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/_utils.py", line 78, in _cuda
    return torch._UntypedStorage(self.size(), device=torch.device('cuda')).copy_(self, non_blocking)
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set5/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 41.26it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set5 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set5
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set5_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.4ms
Speed: 3.1ms preprocess, 19.4ms inference, 2.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.2ms
Speed: 1.4ms preprocess, 19.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 1.4ms preprocess, 20.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.4ms
Speed: 1.3ms preprocess, 19.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 1.2ms preprocess, 20.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.3ms
Speed: 1.3ms preprocess, 19.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.3ms
Speed: 1.2ms preprocess, 20.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 1.3ms preprocess, 20.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 1.2ms preprocess, 20.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.1ms
Speed: 1.3ms preprocess, 20.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.9ms
Speed: 1.2ms preprocess, 19.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.2ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.3ms
Speed: 1.3ms preprocess, 20.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.2ms preprocess, 19.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.9ms
Speed: 1.2ms preprocess, 19.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.2ms
Speed: 1.3ms preprocess, 19.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.6ms
Speed: 1.4ms preprocess, 19.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.1ms
Speed: 1.3ms preprocess, 19.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.9ms
Speed: 1.3ms preprocess, 19.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.2ms
Speed: 1.2ms preprocess, 19.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.5ms
Speed: 2.9ms preprocess, 20.5ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 24
view_order: [29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.5ms
Speed: 1.3ms preprocess, 19.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 7
Instance 0: Confidence=0.9386
Instance 1: Confidence=0.9359
Instance 2: Confidence=0.9328
Instance 3: Confidence=0.9221
Instance 4: Confidence=0.8036
Instance 5: Confidence=0.7507
Instance 6: Confidence=0.2664
Selected instance: 1 (Confidence: 0.9359)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

420 308 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 12 prompts
current IoU is: 0.9038380980491638
Seok, iteration idx= 1 IoU = tensor(0.9038)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 2.8ms preprocess, 23.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9552
Instance 1: Confidence=0.9328
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.9105
Instance 4: Confidence=0.8768
Instance 5: Confidence=0.6113
Selected instance: 0 (Confidence: 0.9552)
tmp min: tensor(0.) tmp max: tensor(1.)
403 276 540 960
There are 13 prompts
current IoU is: 0.8272823095321655
Seok, iteration idx= 2 IoU = tensor(0.8273)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 2.7ms preprocess, 22.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9494
Instance 1: Confidence=0.9387
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.8958
Instance 4: Confidence=0.8815
Selected instance: 0 (Confidence: 0.9494)
tmp min: tensor(0.) tmp max: tensor(1.)
390 276 540 960
There are 14 prompts
current IoU is: 0.8922230005264282
Seok, iteration idx= 3 IoU = tensor(0.8922)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.5ms
Speed: 3.1ms preprocess, 21.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9337
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.8928
Instance 3: Confidence=0.7319
Instance 4: Confidence=0.6180
Instance 5: Confidence=0.4375
Selected instance: 1 (Confidence: 0.9320)
tmp min: tensor(0.) tmp max: tensor(1.)
366 324 540 960
There are 14 prompts
current IoU is: 0.9551539421081543
Seok, iteration idx= 4 IoU = tensor(0.9552)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.6ms
Speed: 3.5ms preprocess, 22.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 7
Instance 0: Confidence=0.9374
Instance 1: Confidence=0.9284
Instance 2: Confidence=0.9260
Instance 3: Confidence=0.9164
Instance 4: Confidence=0.9091
Instance 5: Confidence=0.5029
Instance 6: Confidence=0.2646
Selected instance: 0 (Confidence: 0.9374)
tmp min: tensor(0.) tmp max: tensor(1.)
353 304 540 960
There are 15 prompts
current IoU is: 0.9158180356025696
Seok, iteration idx= 5 IoU = tensor(0.9158)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 3.3ms preprocess, 22.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9348
Instance 1: Confidence=0.9341
Instance 2: Confidence=0.9295
Instance 3: Confidence=0.9290
Instance 4: Confidence=0.9118
Instance 5: Confidence=0.5306
Selected instance: 0 (Confidence: 0.9348)
tmp min: tensor(0.) tmp max: tensor(1.)
345 308 540 960
There are 13 prompts
current IoU is: 0.9195409417152405
Seok, iteration idx= 6 IoU = tensor(0.9195)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.5ms
Speed: 3.3ms preprocess, 21.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9330
Instance 2: Confidence=0.9322
Instance 3: Confidence=0.9308
Instance 4: Confidence=0.8590
Instance 5: Confidence=0.5721
Instance 6: Confidence=0.3880
Selected instance: 2 (Confidence: 0.9322)
tmp min: tensor(0.) tmp max: tensor(1.)
340 288 540 960
There are 15 prompts
current IoU is: 0.8764029741287231
Seok, iteration idx= 7 IoU = tensor(0.8764)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.3ms
Speed: 3.1ms preprocess, 21.3ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9482
Instance 1: Confidence=0.9339
Instance 2: Confidence=0.9185
Instance 3: Confidence=0.7674
Instance 4: Confidence=0.4578
Instance 5: Confidence=0.4412
Instance 6: Confidence=0.4175
Selected instance: 5 (Confidence: 0.4412)
tmp min: tensor(0.) tmp max: tensor(1.)
620 328 540 960
There are 14 prompts
current IoU is: 0.291692852973938
Seok, iteration idx= 8 IoU = tensor(0.2917)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.4ms
Speed: 4.7ms preprocess, 21.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 4
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9331
Instance 2: Confidence=0.9069
Instance 3: Confidence=0.5795
Selected instance: 3 (Confidence: 0.5795)
tmp min: tensor(0.) tmp max: tensor(1.)
525 236 540 960
There are 17 prompts
current IoU is: 0.3584368824958801
Seok, iteration idx= 9 IoU = tensor(0.3584)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.3ms
Speed: 2.7ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 4
Instance 0: Confidence=0.9524
Instance 1: Confidence=0.9516
Instance 2: Confidence=0.9286
Instance 3: Confidence=0.8979
Selected instance: 3 (Confidence: 0.8979)
tmp min: tensor(0.) tmp max: tensor(1.)
628 312 540 960
There are 15 prompts
current IoU is: 0.6093271970748901
Seok, iteration idx= 10 IoU = tensor(0.6093)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 3.4ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9476
Instance 2: Confidence=0.8963
Instance 3: Confidence=0.8785
Instance 4: Confidence=0.8033
Selected instance: 3 (Confidence: 0.8785)
tmp min: tensor(0.) tmp max: tensor(1.)
574 272 540 960
There are 15 prompts
current IoU is: 0.8092360496520996
Seok, iteration idx= 11 IoU = tensor(0.8092)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 7
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.7916
Instance 4: Confidence=0.7327
Instance 5: Confidence=0.4687
Instance 6: Confidence=0.2725
Selected instance: 2 (Confidence: 0.9337)
tmp min: tensor(0.) tmp max: tensor(1.)
594 264 540 960
There are 14 prompts
current IoU is: 0.8656530380249023
Seok, iteration idx= 12 IoU = tensor(0.8657)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9520
Instance 1: Confidence=0.9453
Instance 2: Confidence=0.9338
Instance 3: Confidence=0.8405
Instance 4: Confidence=0.7673
Selected instance: 2 (Confidence: 0.9338)
tmp min: tensor(0.) tmp max: tensor(1.)
618 264 540 960
There are 14 prompts
current IoU is: 0.8958091735839844
Seok, iteration idx= 13 IoU = tensor(0.8958)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.0ms
Speed: 1.7ms preprocess, 23.0ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 8
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9499
Instance 2: Confidence=0.9467
Instance 3: Confidence=0.8013
Instance 4: Confidence=0.4372
Instance 5: Confidence=0.3440
Instance 6: Confidence=0.3215
Instance 7: Confidence=0.2739
Selected instance: 0 (Confidence: 0.9521)
tmp min: tensor(0.) tmp max: tensor(1.)
597 264 540 960
There are 15 prompts
current IoU is: 0.87563157081604
Seok, iteration idx= 14 IoU = tensor(0.8756)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.7ms preprocess, 23.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9465
Instance 2: Confidence=0.9439
Instance 3: Confidence=0.8874
Instance 4: Confidence=0.6249
Instance 5: Confidence=0.2727
Selected instance: 2 (Confidence: 0.9439)
tmp min: tensor(0.) tmp max: tensor(1.)
578 264 540 960
There are 13 prompts
current IoU is: 0.905936598777771
Seok, iteration idx= 15 IoU = tensor(0.9059)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 1.6ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9385
Instance 3: Confidence=0.9341
Instance 4: Confidence=0.9008
Instance 5: Confidence=0.6692
Selected instance: 4 (Confidence: 0.9008)
tmp min: tensor(0.) tmp max: tensor(1.)
347 268 540 960
There are 17 prompts
current IoU is: 0.8253142237663269
Seok, iteration idx= 16 IoU = tensor(0.8253)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.6ms preprocess, 23.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9584
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9329
Instance 3: Confidence=0.9113
Instance 4: Confidence=0.8125
Instance 5: Confidence=0.5363
Selected instance: 5 (Confidence: 0.5363)
tmp min: tensor(0.) tmp max: tensor(1.)
332 272 540 960
There are 15 prompts
current IoU is: 0.4928813576698303
Seok, iteration idx= 17 IoU = tensor(0.4929)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9408
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9217
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.7804
Instance 5: Confidence=0.3248
Selected instance: 5 (Confidence: 0.3248)
tmp min: tensor(0.) tmp max: tensor(1.)
340 256 540 960
There are 14 prompts
current IoU is: 0.6035962700843811
Seok, iteration idx= 18 IoU = tensor(0.6036)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.5ms preprocess, 23.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9463
Instance 1: Confidence=0.9379
Instance 2: Confidence=0.9269
Instance 3: Confidence=0.9177
Instance 4: Confidence=0.8096
Instance 5: Confidence=0.5529
Selected instance: 5 (Confidence: 0.5529)
tmp min: tensor(0.) tmp max: tensor(1.)
340 256 540 960
There are 13 prompts
current IoU is: 0.5227012634277344
Seok, iteration idx= 19 IoU = tensor(0.5227)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.5ms preprocess, 23.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9490
Instance 1: Confidence=0.9483
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9231
Instance 4: Confidence=0.6808
Instance 5: Confidence=0.6357
Selected instance: 4 (Confidence: 0.6808)
tmp min: tensor(0.) tmp max: tensor(1.)
348 260 540 960
There are 15 prompts
current IoU is: 0.56689453125
Seok, iteration idx= 20 IoU = tensor(0.5669)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 2.9ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9424
Instance 1: Confidence=0.9364
Instance 2: Confidence=0.9296
Instance 3: Confidence=0.9162
Instance 4: Confidence=0.6830
Instance 5: Confidence=0.6813
Selected instance: 4 (Confidence: 0.6830)
tmp min: tensor(0.) tmp max: tensor(1.)
375 264 540 960
There are 14 prompts
current IoU is: 0.4438146948814392
Seok, iteration idx= 21 IoU = tensor(0.4438)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 3.0ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9605
Instance 1: Confidence=0.9404
Instance 2: Confidence=0.9341
Instance 3: Confidence=0.9266
Instance 4: Confidence=0.9189
Selected instance: 0 (Confidence: 0.9605)
tmp min: tensor(0.) tmp max: tensor(1.)
384 264 540 960
There are 16 prompts
current IoU is: 0.020492929965257645
Seok, iteration idx= 22 IoU = tensor(0.0205)
SKIP, unacceptable sam prediction, IoU is tensor(0.0205)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 3.4ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9216
Instance 3: Confidence=0.9211
Instance 4: Confidence=0.9179
Selected instance: 0 (Confidence: 0.9515)
tmp min: tensor(0.) tmp max: tensor(1.)
377 288 540 960
There are 12 prompts
current IoU is: 0.04623504728078842
Seok, iteration idx= 23 IoU = tensor(0.0462)
SKIP, unacceptable sam prediction, IoU is tensor(0.0462)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.6ms preprocess, 22.4ms inference, 3.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9499
Instance 1: Confidence=0.9476
Instance 2: Confidence=0.9344
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.7513
Instance 5: Confidence=0.3441
Selected instance: 1 (Confidence: 0.9476)
tmp min: tensor(0.) tmp max: tensor(1.)
588 284 540 960
There are 13 prompts
current IoU is: 0.9139629006385803
Seok, iteration idx= 24 IoU = tensor(0.9140)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 2.8ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9454
Instance 1: Confidence=0.9376
Instance 2: Confidence=0.9193
Instance 3: Confidence=0.8833
Instance 4: Confidence=0.8594
Instance 5: Confidence=0.7986
Selected instance: 1 (Confidence: 0.9376)
tmp min: tensor(0.) tmp max: tensor(1.)
555 284 540 960
There are 14 prompts
current IoU is: 0.9127118587493896
Seok, iteration idx= 25 IoU = tensor(0.9127)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.7ms preprocess, 23.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9414
Instance 1: Confidence=0.9300
Instance 2: Confidence=0.8414
Instance 3: Confidence=0.7600
Instance 4: Confidence=0.7093
Instance 5: Confidence=0.6956
Selected instance: 0 (Confidence: 0.9414)
tmp min: tensor(0.) tmp max: tensor(1.)
565 308 540 960
There are 13 prompts
current IoU is: 0.9318321347236633
Seok, iteration idx= 26 IoU = tensor(0.9318)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.7ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9378
Instance 1: Confidence=0.9341
Instance 2: Confidence=0.9259
Instance 3: Confidence=0.9210
Instance 4: Confidence=0.9059
Selected instance: 2 (Confidence: 0.9259)
tmp min: tensor(0.) tmp max: tensor(1.)
541 296 540 960
There are 14 prompts
current IoU is: 0.9374022483825684
Seok, iteration idx= 27 IoU = tensor(0.9374)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.7ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9140
Instance 3: Confidence=0.9125
Instance 4: Confidence=0.8638
Instance 5: Confidence=0.7469
Selected instance: 1 (Confidence: 0.9269)
tmp min: tensor(0.) tmp max: tensor(1.)
521 296 540 960
There are 13 prompts
current IoU is: 0.8436264395713806
Seok, iteration idx= 28 IoU = tensor(0.8436)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.0ms
Speed: 1.6ms preprocess, 24.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9382
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9224
Instance 3: Confidence=0.9112
Instance 4: Confidence=0.8582
Instance 5: Confidence=0.4778
Instance 6: Confidence=0.3251
Selected instance: 2 (Confidence: 0.9224)
tmp min: tensor(0.) tmp max: tensor(1.)
509 288 540 960
There are 13 prompts
current IoU is: 0.8890410661697388
Seok, iteration idx= 29 IoU = tensor(0.8890)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.6ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9496
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9297
Instance 3: Confidence=0.9274
Instance 4: Confidence=0.9144
Instance 5: Confidence=0.3458
Selected instance: 4 (Confidence: 0.9144)
tmp min: tensor(0.) tmp max: tensor(1.)
464 308 540 960
There are 13 prompts
current IoU is: 0.9204346537590027
Seok, iteration idx= 30 IoU = tensor(0.9204)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.7ms preprocess, 24.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9542
Instance 1: Confidence=0.9425
Instance 2: Confidence=0.9398
Instance 3: Confidence=0.9328
Instance 4: Confidence=0.9250
Instance 5: Confidence=0.7913
Selected instance: 4 (Confidence: 0.9250)
tmp min: tensor(0.) tmp max: tensor(1.)
480 316 540 960
There are 14 prompts
current IoU is: 0.9434475898742676
Seok, iteration idx= 31 IoU = tensor(0.9434)
Selected Instance Confidence List: [tensor(0.9462), tensor(0.9167, device='cpu'), tensor(0.8785, device='cpu'), tensor(0.9151, device='cpu'), tensor(0.9459, device='cpu'), tensor(0.9244, device='cpu'), tensor(0.9256, device='cpu'), tensor(0.8987, device='cpu'), tensor(0.3793, device='cpu'), tensor(0.4469, device='cpu'), tensor(0.7247, device='cpu'), tensor(0.8370, device='cpu'), tensor(0.8929, device='cpu'), tensor(0.9110, device='cpu'), tensor(0.9062, device='cpu'), tensor(0.9211, device='cpu'), tensor(0.8555, device='cpu'), tensor(0.5102, device='cpu'), tensor(0.4921, device='cpu'), tensor(0.5348, device='cpu'), tensor(0.6125, device='cpu'), tensor(0.5395, device='cpu'), tensor(0.3965, device='cpu'), tensor(0.4083, device='cpu'), tensor(0.9274, device='cpu'), tensor(0.9227, device='cpu'), tensor(0.9357, device='cpu'), tensor(0.9328, device='cpu'), tensor(0.8769, device='cpu'), tensor(0.9024, device='cpu'), tensor(0.9180, device='cpu'), tensor(0.9361, device='cpu')]
Sorted Confidence Order: [tensor(0.9462), tensor(0.9167, device='cpu'), tensor(0.8785, device='cpu'), tensor(0.9151, device='cpu'), tensor(0.9459, device='cpu'), tensor(0.9244, device='cpu'), tensor(0.9256, device='cpu'), tensor(0.8987, device='cpu'), tensor(0.8555, device='cpu'), tensor(0.5102, device='cpu'), tensor(0.4921, device='cpu'), tensor(0.5348, device='cpu'), tensor(0.6125, device='cpu'), tensor(0.5395, device='cpu'), tensor(0.3965, device='cpu'), tensor(0.4083, device='cpu'), tensor(0.9361, device='cpu'), tensor(0.9180, device='cpu'), tensor(0.9024, device='cpu'), tensor(0.8769, device='cpu'), tensor(0.9328, device='cpu'), tensor(0.9357, device='cpu'), tensor(0.9227, device='cpu'), tensor(0.9274, device='cpu'), tensor(0.9211, device='cpu'), tensor(0.9062, device='cpu'), tensor(0.9110, device='cpu'), tensor(0.8929, device='cpu'), tensor(0.8370, device='cpu'), tensor(0.7247, device='cpu'), tensor(0.4469, device='cpu'), tensor(0.3793, device='cpu')]
sorted_indices: [0, 1, 2, 3, 4, 5, 6, 7, 16, 17, 18, 19, 20, 21, 22, 23, 31, 30, 29, 28, 27, 26, 25, 24, 15, 14, 13, 12, 11, 10, 9, 8]
Initial view (highest confidence): 1
New training order: [29, 30, 31, 32, 33, 34, 35, 36, 9, 10, 11, 12, 13, 14, 15, 16, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.9ms
Speed: 1.4ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.4ms
Speed: 1.7ms preprocess, 24.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 7
Instance 0: Confidence=0.9386
Instance 1: Confidence=0.9359
Instance 2: Confidence=0.9328
Instance 3: Confidence=0.9221
Instance 4: Confidence=0.8036
Instance 5: Confidence=0.7507
Instance 6: Confidence=0.2664
tmp min: tensor(0.) tmp max: tensor(1.)
420 308 540 960
There are 12 prompts
current IoU is: 0.12464547157287598
Seok, iteration idx= 1 IoU = tensor(0.1246)
SKIP, unacceptable sam prediction, IoU is tensor(0.1246)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.6ms preprocess, 24.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9552
Instance 1: Confidence=0.9328
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.9105
Instance 4: Confidence=0.8768
Instance 5: Confidence=0.6113
tmp min: tensor(0.) tmp max: tensor(1.)
403 276 540 960
There are 13 prompts
current IoU is: 0.297557532787323
Seok, iteration idx= 2 IoU = tensor(0.2976)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 2.1ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9494
Instance 1: Confidence=0.9387
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.8958
Instance 4: Confidence=0.8815
tmp min: tensor(0.) tmp max: tensor(1.)
390 276 540 960
There are 14 prompts
current IoU is: 0.37412530183792114
Seok, iteration idx= 3 IoU = tensor(0.3741)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9337
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.8928
Instance 3: Confidence=0.7319
Instance 4: Confidence=0.6180
Instance 5: Confidence=0.4375
tmp min: tensor(0.) tmp max: tensor(1.)
366 324 540 960
There are 14 prompts
current IoU is: 0.4014829993247986
Seok, iteration idx= 4 IoU = tensor(0.4015)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 7
Instance 0: Confidence=0.9374
Instance 1: Confidence=0.9284
Instance 2: Confidence=0.9260
Instance 3: Confidence=0.9164
Instance 4: Confidence=0.9091
Instance 5: Confidence=0.5029
Instance 6: Confidence=0.2646
tmp min: tensor(0.) tmp max: tensor(1.)
353 304 540 960
There are 15 prompts
current IoU is: 0.47552934288978577
Seok, iteration idx= 5 IoU = tensor(0.4755)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9348
Instance 1: Confidence=0.9341
Instance 2: Confidence=0.9295
Instance 3: Confidence=0.9290
Instance 4: Confidence=0.9118
Instance 5: Confidence=0.5306
tmp min: tensor(0.) tmp max: tensor(1.)
345 308 540 960
There are 13 prompts
current IoU is: 0.5042850971221924
Seok, iteration idx= 6 IoU = tensor(0.5043)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9330
Instance 2: Confidence=0.9322
Instance 3: Confidence=0.9308
Instance 4: Confidence=0.8590
Instance 5: Confidence=0.5721
Instance 6: Confidence=0.3880
tmp min: tensor(0.) tmp max: tensor(1.)
340 288 540 960
There are 15 prompts
current IoU is: 0.5069252252578735
Seok, iteration idx= 7 IoU = tensor(0.5069)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.7ms preprocess, 24.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9385
Instance 3: Confidence=0.9341
Instance 4: Confidence=0.9008
Instance 5: Confidence=0.6692
tmp min: tensor(0.) tmp max: tensor(1.)
347 268 540 960
There are 17 prompts
current IoU is: 0.4584457576274872
Seok, iteration idx= 8 IoU = tensor(0.4584)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9584
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9329
Instance 3: Confidence=0.9113
Instance 4: Confidence=0.8125
Instance 5: Confidence=0.5363
tmp min: tensor(0.) tmp max: tensor(1.)
332 272 540 960
There are 15 prompts
current IoU is: 0.5822208523750305
Seok, iteration idx= 9 IoU = tensor(0.5822)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9408
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9217
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.7804
Instance 5: Confidence=0.3248
tmp min: tensor(0.) tmp max: tensor(1.)
340 256 540 960
There are 14 prompts
current IoU is: 0.6473551392555237
Seok, iteration idx= 10 IoU = tensor(0.6474)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 1.6ms preprocess, 24.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9463
Instance 1: Confidence=0.9379
Instance 2: Confidence=0.9269
Instance 3: Confidence=0.9177
Instance 4: Confidence=0.8096
Instance 5: Confidence=0.5529
tmp min: tensor(0.) tmp max: tensor(1.)
340 256 540 960
There are 13 prompts
current IoU is: 0.529419481754303
Seok, iteration idx= 11 IoU = tensor(0.5294)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 3.6ms preprocess, 23.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9490
Instance 1: Confidence=0.9483
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9231
Instance 4: Confidence=0.6808
Instance 5: Confidence=0.6357
tmp min: tensor(0.) tmp max: tensor(1.)
348 260 540 960
There are 15 prompts
current IoU is: 0.4970827102661133
Seok, iteration idx= 12 IoU = tensor(0.4971)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.4ms
Speed: 3.0ms preprocess, 24.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9424
Instance 1: Confidence=0.9364
Instance 2: Confidence=0.9296
Instance 3: Confidence=0.9162
Instance 4: Confidence=0.6830
Instance 5: Confidence=0.6813
tmp min: tensor(0.) tmp max: tensor(1.)
375 264 540 960
There are 14 prompts
current IoU is: 0.37627696990966797
Seok, iteration idx= 13 IoU = tensor(0.3763)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 3.0ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9605
Instance 1: Confidence=0.9404
Instance 2: Confidence=0.9341
Instance 3: Confidence=0.9266
Instance 4: Confidence=0.9189
tmp min: tensor(0.) tmp max: tensor(1.)
384 264 540 960
There are 16 prompts
current IoU is: 0.019161200150847435
Seok, iteration idx= 14 IoU = tensor(0.0192)
SKIP, unacceptable sam prediction, IoU is tensor(0.0192)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 2.7ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9216
Instance 3: Confidence=0.9211
Instance 4: Confidence=0.9179
tmp min: tensor(0.) tmp max: tensor(1.)
377 288 540 960
There are 12 prompts
current IoU is: 0.046900711953639984
Seok, iteration idx= 15 IoU = tensor(0.0469)
SKIP, unacceptable sam prediction, IoU is tensor(0.0469)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 3.6ms preprocess, 23.4ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9542
Instance 1: Confidence=0.9425
Instance 2: Confidence=0.9398
Instance 3: Confidence=0.9328
Instance 4: Confidence=0.9250
Instance 5: Confidence=0.7913
tmp min: tensor(0.) tmp max: tensor(1.)
480 316 540 960
There are 14 prompts
current IoU is: 0.29996344447135925
Seok, iteration idx= 16 IoU = tensor(0.3000)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.6ms
Speed: 1.4ms preprocess, 24.6ms inference, 4.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9496
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9297
Instance 3: Confidence=0.9274
Instance 4: Confidence=0.9144
Instance 5: Confidence=0.3458
tmp min: tensor(0.) tmp max: tensor(1.)
464 308 540 960
There are 13 prompts
current IoU is: 0.4180240035057068
Seok, iteration idx= 17 IoU = tensor(0.4180)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 7
Instance 0: Confidence=0.9382
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9224
Instance 3: Confidence=0.9112
Instance 4: Confidence=0.8582
Instance 5: Confidence=0.4778
Instance 6: Confidence=0.3251
tmp min: tensor(0.) tmp max: tensor(1.)
509 288 540 960
There are 13 prompts
current IoU is: 0.6008908748626709
Seok, iteration idx= 18 IoU = tensor(0.6009)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.6ms preprocess, 23.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9140
Instance 3: Confidence=0.9125
Instance 4: Confidence=0.8638
Instance 5: Confidence=0.7469
tmp min: tensor(0.) tmp max: tensor(1.)
521 296 540 960
There are 13 prompts
current IoU is: 0.758681058883667
Seok, iteration idx= 19 IoU = tensor(0.7587)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.8ms preprocess, 23.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 5
Instance 0: Confidence=0.9378
Instance 1: Confidence=0.9341
Instance 2: Confidence=0.9259
Instance 3: Confidence=0.9210
Instance 4: Confidence=0.9059
tmp min: tensor(0.) tmp max: tensor(1.)
541 296 540 960
There are 14 prompts
current IoU is: 0.8620725870132446
Seok, iteration idx= 20 IoU = tensor(0.8621)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 1.5ms preprocess, 22.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9414
Instance 1: Confidence=0.9300
Instance 2: Confidence=0.8414
Instance 3: Confidence=0.7600
Instance 4: Confidence=0.7093
Instance 5: Confidence=0.6956
tmp min: tensor(0.) tmp max: tensor(1.)
565 308 540 960
There are 13 prompts
current IoU is: 0.913110077381134
Seok, iteration idx= 21 IoU = tensor(0.9131)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9454
Instance 1: Confidence=0.9376
Instance 2: Confidence=0.9193
Instance 3: Confidence=0.8833
Instance 4: Confidence=0.8594
Instance 5: Confidence=0.7986
tmp min: tensor(0.) tmp max: tensor(1.)
555 284 540 960
There are 14 prompts
current IoU is: 0.9310427308082581
Seok, iteration idx= 22 IoU = tensor(0.9310)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9499
Instance 1: Confidence=0.9476
Instance 2: Confidence=0.9344
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.7513
Instance 5: Confidence=0.3441
tmp min: tensor(0.) tmp max: tensor(1.)
588 284 540 960
There are 13 prompts
current IoU is: 0.9392165541648865
Seok, iteration idx= 23 IoU = tensor(0.9392)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9465
Instance 2: Confidence=0.9439
Instance 3: Confidence=0.8874
Instance 4: Confidence=0.6249
Instance 5: Confidence=0.2727
tmp min: tensor(0.) tmp max: tensor(1.)
578 264 540 960
There are 13 prompts
current IoU is: 0.9321502447128296
Seok, iteration idx= 24 IoU = tensor(0.9322)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.7ms
Speed: 1.5ms preprocess, 21.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 8
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9499
Instance 2: Confidence=0.9467
Instance 3: Confidence=0.8013
Instance 4: Confidence=0.4372
Instance 5: Confidence=0.3440
Instance 6: Confidence=0.3215
Instance 7: Confidence=0.2739
tmp min: tensor(0.) tmp max: tensor(1.)
597 264 540 960
There are 15 prompts
current IoU is: 0.9414695501327515
Seok, iteration idx= 25 IoU = tensor(0.9415)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.6ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9520
Instance 1: Confidence=0.9453
Instance 2: Confidence=0.9338
Instance 3: Confidence=0.8405
Instance 4: Confidence=0.7673
tmp min: tensor(0.) tmp max: tensor(1.)
618 264 540 960
There are 14 prompts
current IoU is: 0.954038143157959
Seok, iteration idx= 26 IoU = tensor(0.9540)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.9ms
Speed: 1.6ms preprocess, 24.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 7
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.7916
Instance 4: Confidence=0.7327
Instance 5: Confidence=0.4687
Instance 6: Confidence=0.2725
tmp min: tensor(0.) tmp max: tensor(1.)
594 264 540 960
There are 14 prompts
current IoU is: 0.9434115290641785
Seok, iteration idx= 27 IoU = tensor(0.9434)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9476
Instance 2: Confidence=0.8963
Instance 3: Confidence=0.8785
Instance 4: Confidence=0.8033
tmp min: tensor(0.) tmp max: tensor(1.)
574 272 540 960
There are 15 prompts
current IoU is: 0.9215388298034668
Seok, iteration idx= 28 IoU = tensor(0.9215)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 4
Instance 0: Confidence=0.9524
Instance 1: Confidence=0.9516
Instance 2: Confidence=0.9286
Instance 3: Confidence=0.8979
tmp min: tensor(0.) tmp max: tensor(1.)
628 312 540 960
There are 15 prompts
current IoU is: 0.9228108525276184
Seok, iteration idx= 29 IoU = tensor(0.9228)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.1ms
Speed: 1.7ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 4
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9331
Instance 2: Confidence=0.9069
Instance 3: Confidence=0.5795
tmp min: tensor(0.) tmp max: tensor(1.)
525 236 540 960
There are 17 prompts
current IoU is: 0.4019765853881836
Seok, iteration idx= 30 IoU = tensor(0.4020)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.3ms
Speed: 1.4ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 7
Instance 0: Confidence=0.9482
Instance 1: Confidence=0.9339
Instance 2: Confidence=0.9185
Instance 3: Confidence=0.7674
Instance 4: Confidence=0.4578
Instance 5: Confidence=0.4412
Instance 6: Confidence=0.4175
tmp min: tensor(0.) tmp max: tensor(1.)
620 328 540 960
There are 14 prompts
current IoU is: 0.7632166743278503
Seok, iteration idx= 31 IoU = tensor(0.7632)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set5_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set5_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:40<00:00,  1.27s/it]
Testing psnr 27.851903662085533 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set5_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.18it/s]
Testing psnr 3.017649403773248 (avg)
train: coarse segmentation in 02:03:47
train: finish (eps time 02:03:47 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set5_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set6/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 40.28it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set6 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set6
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set6_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.9ms
Speed: 2.8ms preprocess, 20.9ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.9ms
Speed: 1.2ms preprocess, 21.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.7ms
Speed: 1.3ms preprocess, 20.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.0ms
Speed: 1.5ms preprocess, 19.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.0ms
Speed: 1.7ms preprocess, 19.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.9ms
Speed: 1.6ms preprocess, 19.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.8ms
Speed: 1.4ms preprocess, 19.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.8ms
Speed: 1.4ms preprocess, 19.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.8ms
Speed: 1.5ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.7ms
Speed: 2.5ms preprocess, 20.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.9ms
Speed: 1.5ms preprocess, 19.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.7ms
Speed: 1.4ms preprocess, 19.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.6ms preprocess, 18.7ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.6ms preprocess, 18.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.8ms
Speed: 1.5ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.5ms
Speed: 2.9ms preprocess, 20.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 13
view_order: [14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.8ms
Speed: 2.9ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 3
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.9273
Instance 2: Confidence=0.8225
Selected instance: 0 (Confidence: 0.9384)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

365 112 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.8027077317237854
Seok, iteration idx= 1 IoU = tensor(0.8027)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.3ms
Speed: 1.4ms preprocess, 21.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 3
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9196
Instance 2: Confidence=0.5705
Selected instance: 0 (Confidence: 0.9367)
tmp min: tensor(0.) tmp max: tensor(1.)
388 144 540 960
There are 16 prompts
current IoU is: 0.7878819108009338
Seok, iteration idx= 2 IoU = tensor(0.7879)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 1.7ms preprocess, 22.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 2
Instance 0: Confidence=0.9475
Instance 1: Confidence=0.8862
Selected instance: 0 (Confidence: 0.9475)
tmp min: tensor(0.) tmp max: tensor(1.)
754 32 540 960
There are 14 prompts
current IoU is: 0.4520435631275177
Seok, iteration idx= 3 IoU = tensor(0.4520)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.7ms
Speed: 3.0ms preprocess, 21.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 2
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9560
Selected instance: 0 (Confidence: 0.9594)
tmp min: tensor(0.) tmp max: tensor(1.)
645 32 540 960
There are 15 prompts
current IoU is: 0.8228535652160645
Seok, iteration idx= 4 IoU = tensor(0.8229)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.4ms
Speed: 2.8ms preprocess, 21.4ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9470
Selected instance: 0 (Confidence: 0.9592)
tmp min: tensor(0.) tmp max: tensor(1.)
619 72 540 960
There are 14 prompts
current IoU is: 0.884863018989563
Seok, iteration idx= 5 IoU = tensor(0.8849)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.5ms
Speed: 1.3ms preprocess, 21.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9518
Selected instance: 0 (Confidence: 0.9532)
tmp min: tensor(0.) tmp max: tensor(1.)
526 36 540 960
There are 13 prompts
current IoU is: 0.885507345199585
Seok, iteration idx= 6 IoU = tensor(0.8855)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.5ms preprocess, 20.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9422
Selected instance: 0 (Confidence: 0.9519)
tmp min: tensor(0.) tmp max: tensor(1.)
400 28 540 960
There are 14 prompts
current IoU is: 0.8862084150314331
Seok, iteration idx= 7 IoU = tensor(0.8862)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.5ms
Speed: 1.4ms preprocess, 21.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9603
Instance 1: Confidence=0.9454
Selected instance: 0 (Confidence: 0.9603)
tmp min: tensor(0.) tmp max: tensor(1.)
313 4 540 960
There are 16 prompts
current IoU is: 0.9206082820892334
Seok, iteration idx= 8 IoU = tensor(0.9206)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9480
Selected instance: 0 (Confidence: 0.9626)
tmp min: tensor(0.) tmp max: tensor(1.)
202 16 540 960
There are 15 prompts
current IoU is: 0.9413344264030457
Seok, iteration idx= 9 IoU = tensor(0.9413)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.1ms
Speed: 2.0ms preprocess, 21.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9662
Instance 1: Confidence=0.8877
Selected instance: 0 (Confidence: 0.9662)
tmp min: tensor(0.) tmp max: tensor(1.)
144 12 540 960
There are 15 prompts
current IoU is: 0.9417577981948853
Seok, iteration idx= 10 IoU = tensor(0.9418)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.0ms
Speed: 2.8ms preprocess, 22.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9667
Instance 1: Confidence=0.9419
Selected instance: 0 (Confidence: 0.9667)
tmp min: tensor(0.) tmp max: tensor(1.)
128 0 540 960
There are 14 prompts
current IoU is: 0.9012515544891357
Seok, iteration idx= 11 IoU = tensor(0.9013)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 2.5ms preprocess, 23.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9518
Selected instance: 1 (Confidence: 0.9518)
tmp min: tensor(0.) tmp max: tensor(1.)
108 52 540 960
There are 14 prompts
current IoU is: 0.8662963509559631
Seok, iteration idx= 12 IoU = tensor(0.8663)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9573
Instance 1: Confidence=0.9542
Selected instance: 1 (Confidence: 0.9542)
tmp min: tensor(0.) tmp max: tensor(1.)
99 20 540 960
There are 14 prompts
current IoU is: 0.8719569444656372
Seok, iteration idx= 13 IoU = tensor(0.8720)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.6ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9631
Instance 1: Confidence=0.9505
Selected instance: 1 (Confidence: 0.9505)
tmp min: tensor(0.) tmp max: tensor(1.)
121 44 540 960
There are 15 prompts
current IoU is: 0.9232041835784912
Seok, iteration idx= 14 IoU = tensor(0.9232)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.1ms
Speed: 1.5ms preprocess, 21.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9450
Selected instance: 1 (Confidence: 0.9450)
tmp min: tensor(0.) tmp max: tensor(1.)
154 128 540 960
There are 15 prompts
current IoU is: 0.8728407621383667
Seok, iteration idx= 15 IoU = tensor(0.8728)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 1.7ms preprocess, 22.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9604
Instance 1: Confidence=0.6440
Selected instance: 1 (Confidence: 0.6440)
tmp min: tensor(0.) tmp max: tensor(1.)
162 104 540 960
There are 13 prompts
current IoU is: 0.2115728110074997
Seok, iteration idx= 16 IoU = tensor(0.2116)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.4ms
Speed: 1.6ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 1
Instance 0: Confidence=0.9642
Selected instance: 0 (Confidence: 0.9642)
tmp min: tensor(0.) tmp max: tensor(1.)
147 32 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 17 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.0ms
Speed: 4.2ms preprocess, 22.0ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 3
Instance 0: Confidence=0.9669
Instance 1: Confidence=0.4821
Instance 2: Confidence=0.4394
Selected instance: 1 (Confidence: 0.4821)
tmp min: tensor(0.) tmp max: tensor(1.)
176 76 540 960
There are 12 prompts
current IoU is: 0.3926589787006378
Seok, iteration idx= 18 IoU = tensor(0.3927)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 3.3ms preprocess, 22.4ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9351
Instance 1: Confidence=0.9205
Selected instance: 1 (Confidence: 0.9205)
tmp min: tensor(0.) tmp max: tensor(1.)
744 100 540 960
There are 15 prompts
current IoU is: 0.8847930431365967
Seok, iteration idx= 19 IoU = tensor(0.8848)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.0ms
Speed: 3.3ms preprocess, 22.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 3
Instance 0: Confidence=0.9503
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.7235
Selected instance: 0 (Confidence: 0.9503)
tmp min: tensor(0.) tmp max: tensor(1.)
785 72 540 960
There are 13 prompts
current IoU is: 0.895516574382782
Seok, iteration idx= 20 IoU = tensor(0.8955)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 3
Instance 0: Confidence=0.9471
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.4658
Selected instance: 1 (Confidence: 0.9434)
tmp min: tensor(0.) tmp max: tensor(1.)
832 60 540 960
There are 14 prompts
current IoU is: 0.911361575126648
Seok, iteration idx= 21 IoU = tensor(0.9114)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 1.7ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 2
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9457
Selected instance: 0 (Confidence: 0.9618)
tmp min: tensor(0.) tmp max: tensor(1.)
811 56 540 960
There are 13 prompts
current IoU is: 0.9421612024307251
Seok, iteration idx= 22 IoU = tensor(0.9422)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.0ms
Speed: 1.6ms preprocess, 22.0ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9676
Instance 1: Confidence=0.9445
Selected instance: 0 (Confidence: 0.9676)
tmp min: tensor(0.) tmp max: tensor(1.)
840 36 540 960
There are 14 prompts
current IoU is: 0.9302578568458557
Seok, iteration idx= 23 IoU = tensor(0.9303)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.5ms preprocess, 22.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9700
Instance 1: Confidence=0.9385
Selected instance: 0 (Confidence: 0.9700)
tmp min: tensor(0.) tmp max: tensor(1.)
848 24 540 960
There are 14 prompts
current IoU is: 0.9462180137634277
Seok, iteration idx= 24 IoU = tensor(0.9462)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.9ms
Speed: 1.5ms preprocess, 21.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 3
Instance 0: Confidence=0.9535
Instance 1: Confidence=0.8235
Instance 2: Confidence=0.5369
Selected instance: 0 (Confidence: 0.9535)
tmp min: tensor(0.) tmp max: tensor(1.)
810 12 540 960
There are 13 prompts
current IoU is: 0.9385560154914856
Seok, iteration idx= 25 IoU = tensor(0.9386)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.1ms
Speed: 2.7ms preprocess, 23.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 3
Instance 0: Confidence=0.9589
Instance 1: Confidence=0.2834
Instance 2: Confidence=0.2770
Selected instance: 0 (Confidence: 0.9589)
tmp min: tensor(0.) tmp max: tensor(1.)
762 0 540 960
There are 14 prompts
current IoU is: 0.8911232948303223
Seok, iteration idx= 26 IoU = tensor(0.8911)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 3.2ms preprocess, 22.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 2
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9059
Selected instance: 1 (Confidence: 0.9059)
tmp min: tensor(0.) tmp max: tensor(1.)
204 64 540 960
There are 17 prompts
current IoU is: 0.8955026865005493
Seok, iteration idx= 27 IoU = tensor(0.8955)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 1.6ms preprocess, 22.4ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 2
Instance 0: Confidence=0.9586
Instance 1: Confidence=0.9416
Selected instance: 1 (Confidence: 0.9416)
tmp min: tensor(0.) tmp max: tensor(1.)
216 68 540 960
There are 14 prompts
current IoU is: 0.8918605446815491
Seok, iteration idx= 28 IoU = tensor(0.8919)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 1.6ms preprocess, 22.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 2
Instance 0: Confidence=0.9624
Instance 1: Confidence=0.9404
Selected instance: 1 (Confidence: 0.9404)
tmp min: tensor(0.) tmp max: tensor(1.)
239 64 540 960
There are 16 prompts
current IoU is: 0.9026651978492737
Seok, iteration idx= 29 IoU = tensor(0.9027)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 3
Instance 0: Confidence=0.9538
Instance 1: Confidence=0.9460
Instance 2: Confidence=0.5105
Selected instance: 1 (Confidence: 0.9460)
tmp min: tensor(0.) tmp max: tensor(1.)
257 68 540 960
There are 15 prompts
current IoU is: 0.9032065272331238
Seok, iteration idx= 30 IoU = tensor(0.9032)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.5ms
Speed: 1.6ms preprocess, 23.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 4
Instance 0: Confidence=0.9569
Instance 1: Confidence=0.9566
Instance 2: Confidence=0.8389
Instance 3: Confidence=0.3479
Selected instance: 1 (Confidence: 0.9566)
tmp min: tensor(0.) tmp max: tensor(1.)
298 80 540 960
There are 15 prompts
current IoU is: 0.9207051992416382
Seok, iteration idx= 31 IoU = tensor(0.9207)
Selected Instance Confidence List: [tensor(0.9413), tensor(0.8570, device='cpu'), tensor(0.8474, device='cpu'), tensor(0.6502, device='cpu'), tensor(0.8775, device='cpu'), tensor(0.9146, device='cpu'), tensor(0.9126, device='cpu'), tensor(0.9125, device='cpu'), tensor(0.9365, device='cpu'), tensor(0.9498, device='cpu'), tensor(0.9515, device='cpu'), tensor(0.9274, device='cpu'), tensor(0.9005, device='cpu'), tensor(0.9048, device='cpu'), tensor(0.9341, device='cpu'), tensor(0.9017, device='cpu'), tensor(0.3882, device='cpu'), tensor(0.3857, device='cpu'), tensor(0.4284, device='cpu'), tensor(0.8991, device='cpu'), tensor(0.9174, device='cpu'), tensor(0.9242, device='cpu'), tensor(0.9500, device='cpu'), tensor(0.9452, device='cpu'), tensor(0.9557, device='cpu'), tensor(0.9446, device='cpu'), tensor(0.9182, device='cpu'), tensor(0.8997, device='cpu'), tensor(0.9117, device='cpu'), tensor(0.9178, device='cpu'), tensor(0.9203, device='cpu'), tensor(0.9351, device='cpu')]
Sorted Confidence Order: [tensor(0.9557, device='cpu'), tensor(0.9452, device='cpu'), tensor(0.9500, device='cpu'), tensor(0.9242, device='cpu'), tensor(0.9174, device='cpu'), tensor(0.8991, device='cpu'), tensor(0.9446, device='cpu'), tensor(0.9182, device='cpu'), tensor(0.6502, device='cpu'), tensor(0.8775, device='cpu'), tensor(0.9146, device='cpu'), tensor(0.9126, device='cpu'), tensor(0.9125, device='cpu'), tensor(0.9365, device='cpu'), tensor(0.9498, device='cpu'), tensor(0.9515, device='cpu'), tensor(0.9274, device='cpu'), tensor(0.9005, device='cpu'), tensor(0.9048, device='cpu'), tensor(0.9341, device='cpu'), tensor(0.9017, device='cpu'), tensor(0.3882, device='cpu'), tensor(0.3857, device='cpu'), tensor(0.4284, device='cpu'), tensor(0.8997, device='cpu'), tensor(0.9117, device='cpu'), tensor(0.9178, device='cpu'), tensor(0.9203, device='cpu'), tensor(0.9351, device='cpu'), tensor(0.9413), tensor(0.8570, device='cpu'), tensor(0.8474, device='cpu')]
sorted_indices: [24, 23, 22, 21, 20, 19, 25, 26, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 27, 28, 29, 30, 31, 0, 1, 2]
Initial view (highest confidence): 29
New training order: [6, 5, 4, 3, 2, 1, 7, 8, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 9, 10, 11, 12, 13, 14, 15, 16]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.3ms
Speed: 1.6ms preprocess, 20.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.0ms
Speed: 1.7ms preprocess, 21.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 2
Instance 0: Confidence=0.9676
Instance 1: Confidence=0.9445
tmp min: tensor(0.) tmp max: tensor(1.)
840 36 540 960
There are 14 prompts
current IoU is: 0.9540804624557495
Seok, iteration idx= 1 IoU = tensor(0.9541)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 2.7ms preprocess, 22.5ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 2
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9457
tmp min: tensor(0.) tmp max: tensor(1.)
811 56 540 960
There are 13 prompts
current IoU is: 0.9604394435882568
Seok, iteration idx= 2 IoU = tensor(0.9604)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.3ms
Speed: 5.2ms preprocess, 22.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 3
Instance 0: Confidence=0.9471
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.4658
tmp min: tensor(0.) tmp max: tensor(1.)
832 60 540 960
There are 14 prompts
current IoU is: 0.9482758641242981
Seok, iteration idx= 3 IoU = tensor(0.9483)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.0ms
Speed: 3.3ms preprocess, 21.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 3
Instance 0: Confidence=0.9503
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.7235
tmp min: tensor(0.) tmp max: tensor(1.)
785 72 540 960
There are 13 prompts
current IoU is: 0.9453994035720825
Seok, iteration idx= 4 IoU = tensor(0.9454)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9351
Instance 1: Confidence=0.9205
tmp min: tensor(0.) tmp max: tensor(1.)
744 100 540 960
There are 15 prompts
current IoU is: 0.937318742275238
Seok, iteration idx= 5 IoU = tensor(0.9373)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 3
Instance 0: Confidence=0.9535
Instance 1: Confidence=0.8235
Instance 2: Confidence=0.5369
tmp min: tensor(0.) tmp max: tensor(1.)
810 12 540 960
There are 13 prompts
current IoU is: 0.9452674388885498
Seok, iteration idx= 6 IoU = tensor(0.9453)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.9ms
Speed: 1.8ms preprocess, 21.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 3
Instance 0: Confidence=0.9589
Instance 1: Confidence=0.2834
Instance 2: Confidence=0.2770
tmp min: tensor(0.) tmp max: tensor(1.)
762 0 540 960
There are 14 prompts
current IoU is: 0.9202273488044739
Seok, iteration idx= 7 IoU = tensor(0.9202)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9475
Instance 1: Confidence=0.8862
tmp min: tensor(0.) tmp max: tensor(1.)
754 32 540 960
There are 14 prompts
current IoU is: 0.9381319880485535
Seok, iteration idx= 8 IoU = tensor(0.9381)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.6ms preprocess, 22.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9560
tmp min: tensor(0.) tmp max: tensor(1.)
645 32 540 960
There are 15 prompts
current IoU is: 0.901897668838501
Seok, iteration idx= 9 IoU = tensor(0.9019)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.7ms
Speed: 1.7ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9470
tmp min: tensor(0.) tmp max: tensor(1.)
619 72 540 960
There are 14 prompts
current IoU is: 0.9473513960838318
Seok, iteration idx= 10 IoU = tensor(0.9474)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 3.5ms preprocess, 22.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9518
tmp min: tensor(0.) tmp max: tensor(1.)
526 36 540 960
There are 13 prompts
current IoU is: 0.9292966723442078
Seok, iteration idx= 11 IoU = tensor(0.9293)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 3.0ms preprocess, 22.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9422
tmp min: tensor(0.) tmp max: tensor(1.)
400 28 540 960
There are 14 prompts
current IoU is: 0.9151336550712585
Seok, iteration idx= 12 IoU = tensor(0.9151)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 3.5ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9603
Instance 1: Confidence=0.9454
tmp min: tensor(0.) tmp max: tensor(1.)
313 4 540 960
There are 16 prompts
current IoU is: 0.9464976191520691
Seok, iteration idx= 13 IoU = tensor(0.9465)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9480
tmp min: tensor(0.) tmp max: tensor(1.)
202 16 540 960
There are 15 prompts
current IoU is: 0.9635399580001831
Seok, iteration idx= 14 IoU = tensor(0.9635)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 2.4ms preprocess, 23.3ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 2
Instance 0: Confidence=0.9662
Instance 1: Confidence=0.8877
tmp min: tensor(0.) tmp max: tensor(1.)
144 12 540 960
There are 15 prompts
current IoU is: 0.9667918086051941
Seok, iteration idx= 15 IoU = tensor(0.9668)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9667
Instance 1: Confidence=0.9419
tmp min: tensor(0.) tmp max: tensor(1.)
128 0 540 960
There are 14 prompts
current IoU is: 0.934685230255127
Seok, iteration idx= 16 IoU = tensor(0.9347)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 1.6ms preprocess, 22.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9518
tmp min: tensor(0.) tmp max: tensor(1.)
108 52 540 960
There are 14 prompts
current IoU is: 0.9553810358047485
Seok, iteration idx= 17 IoU = tensor(0.9554)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9573
Instance 1: Confidence=0.9542
tmp min: tensor(0.) tmp max: tensor(1.)
99 20 540 960
There are 14 prompts
current IoU is: 0.9588772654533386
Seok, iteration idx= 18 IoU = tensor(0.9589)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 3.5ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9631
Instance 1: Confidence=0.9505
tmp min: tensor(0.) tmp max: tensor(1.)
121 44 540 960
There are 15 prompts
current IoU is: 0.9489964842796326
Seok, iteration idx= 19 IoU = tensor(0.9490)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 2.9ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9450
tmp min: tensor(0.) tmp max: tensor(1.)
154 128 540 960
There are 15 prompts
current IoU is: 0.935162365436554
Seok, iteration idx= 20 IoU = tensor(0.9352)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 3.4ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9604
Instance 1: Confidence=0.6440
tmp min: tensor(0.) tmp max: tensor(1.)
162 104 540 960
There are 13 prompts
current IoU is: 0.3048657774925232
Seok, iteration idx= 21 IoU = tensor(0.3049)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 1
Instance 0: Confidence=0.9642
tmp min: tensor(0.) tmp max: tensor(1.)
147 32 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 22 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 3
Instance 0: Confidence=0.9669
Instance 1: Confidence=0.4821
Instance 2: Confidence=0.4394
tmp min: tensor(0.) tmp max: tensor(1.)
176 76 540 960
There are 12 prompts
current IoU is: 0.5129560828208923
Seok, iteration idx= 23 IoU = tensor(0.5130)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9059
tmp min: tensor(0.) tmp max: tensor(1.)
204 64 540 960
There are 17 prompts
current IoU is: 0.9082867503166199
Seok, iteration idx= 24 IoU = tensor(0.9083)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9586
Instance 1: Confidence=0.9416
tmp min: tensor(0.) tmp max: tensor(1.)
216 68 540 960
There are 14 prompts
current IoU is: 0.9024851322174072
Seok, iteration idx= 25 IoU = tensor(0.9025)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 3.4ms preprocess, 23.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 2
Instance 0: Confidence=0.9624
Instance 1: Confidence=0.9404
tmp min: tensor(0.) tmp max: tensor(1.)
239 64 540 960
There are 16 prompts
current IoU is: 0.9213142395019531
Seok, iteration idx= 26 IoU = tensor(0.9213)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.2ms
Speed: 2.9ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 3
Instance 0: Confidence=0.9538
Instance 1: Confidence=0.9460
Instance 2: Confidence=0.5105
tmp min: tensor(0.) tmp max: tensor(1.)
257 68 540 960
There are 15 prompts
current IoU is: 0.9137449264526367
Seok, iteration idx= 27 IoU = tensor(0.9137)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.4ms
Speed: 3.8ms preprocess, 22.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 4
Instance 0: Confidence=0.9569
Instance 1: Confidence=0.9566
Instance 2: Confidence=0.8389
Instance 3: Confidence=0.3479
tmp min: tensor(0.) tmp max: tensor(1.)
298 80 540 960
There are 15 prompts
current IoU is: 0.9245191216468811
Seok, iteration idx= 28 IoU = tensor(0.9245)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.9ms
Speed: 1.8ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 4
Instance 0: Confidence=0.9441
Instance 1: Confidence=0.9413
Instance 2: Confidence=0.8401
Instance 3: Confidence=0.5010
tmp min: tensor(0.) tmp max: tensor(1.)
338 96 540 960
There are 13 prompts
current IoU is: 0.9064162969589233
Seok, iteration idx= 29 IoU = tensor(0.9064)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.5ms
Speed: 1.7ms preprocess, 23.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 3
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.9273
Instance 2: Confidence=0.8225
tmp min: tensor(0.) tmp max: tensor(1.)
365 112 540 960
There are 16 prompts
current IoU is: 0.9113056659698486
Seok, iteration idx= 30 IoU = tensor(0.9113)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.8ms
Speed: 1.9ms preprocess, 21.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 3
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9196
Instance 2: Confidence=0.5705
tmp min: tensor(0.) tmp max: tensor(1.)
388 144 540 960
There are 16 prompts
current IoU is: 0.8918780088424683
Seok, iteration idx= 31 IoU = tensor(0.8919)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set6_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set6_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:38<00:00,  1.21s/it]
Testing psnr 29.24417570233345 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set6_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.16it/s]
Testing psnr 3.7670641019940376 (avg)
train: coarse segmentation in 00:17:03
train: finish (eps time 00:17:03 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set6_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set7/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 38.14it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set7 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set7
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set7_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.1ms
Speed: 3.5ms preprocess, 20.1ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.7ms
Speed: 1.2ms preprocess, 20.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.7ms
Speed: 1.3ms preprocess, 19.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.8ms
Speed: 1.2ms preprocess, 19.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.5ms
Speed: 1.2ms preprocess, 19.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.0ms
Speed: 3.4ms preprocess, 19.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 19.3ms
Speed: 1.4ms preprocess, 19.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.1ms
Speed: 1.7ms preprocess, 20.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.4ms
Speed: 1.4ms preprocess, 20.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 19.4ms
Speed: 1.4ms preprocess, 19.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.6ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.5ms
Speed: 1.4ms preprocess, 19.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.3ms
Speed: 1.4ms preprocess, 19.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.2ms
Speed: 1.2ms preprocess, 19.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.1ms
Speed: 1.6ms preprocess, 19.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.4ms
Speed: 3.1ms preprocess, 21.4ms inference, 3.0ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 30
view_order: [35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.8ms
Speed: 1.4ms preprocess, 20.8ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 2
Instance 0: Confidence=0.9563
Instance 1: Confidence=0.4461
Selected instance: 0 (Confidence: 0.9563)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

155 76 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 1 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 2.4ms preprocess, 20.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 2
Instance 0: Confidence=0.9536
Instance 1: Confidence=0.9447
Selected instance: 1 (Confidence: 0.9447)
tmp min: tensor(0.) tmp max: tensor(1.)
32 80 540 960
There are 14 prompts
current IoU is: 0.1649649292230606
Seok, iteration idx= 2 IoU = tensor(0.1650)
SKIP, unacceptable sam prediction, IoU is tensor(0.1650)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.9ms
Speed: 1.6ms preprocess, 22.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 3
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.3825
Selected instance: 1 (Confidence: 0.9503)
tmp min: tensor(0.) tmp max: tensor(1.)
24 72 540 960
There are 15 prompts
current IoU is: 0.17819324135780334
Seok, iteration idx= 3 IoU = tensor(0.1782)
SKIP, unacceptable sam prediction, IoU is tensor(0.1782)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 3
Instance 0: Confidence=0.9624
Instance 1: Confidence=0.9555
Instance 2: Confidence=0.6049
Selected instance: 1 (Confidence: 0.9555)
tmp min: tensor(0.) tmp max: tensor(1.)
43 64 540 960
There are 17 prompts
current IoU is: 0.1499778777360916
Seok, iteration idx= 4 IoU = tensor(0.1500)
SKIP, unacceptable sam prediction, IoU is tensor(0.1500)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9575
Selected instance: 1 (Confidence: 0.9575)
tmp min: tensor(0.) tmp max: tensor(1.)
44 68 540 960
There are 16 prompts
current IoU is: 0.14935123920440674
Seok, iteration idx= 5 IoU = tensor(0.1494)
SKIP, unacceptable sam prediction, IoU is tensor(0.1494)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.3ms
Speed: 1.5ms preprocess, 21.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9701
Instance 1: Confidence=0.9441
Selected instance: 1 (Confidence: 0.9441)
tmp min: tensor(0.) tmp max: tensor(1.)
69 48 540 960
There are 14 prompts
current IoU is: 0.14666181802749634
Seok, iteration idx= 6 IoU = tensor(0.1467)
SKIP, unacceptable sam prediction, IoU is tensor(0.1467)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.5ms
Speed: 3.5ms preprocess, 22.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 3
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.6308
Selected instance: 1 (Confidence: 0.9446)
tmp min: tensor(0.) tmp max: tensor(1.)
140 68 540 960
There are 16 prompts
current IoU is: 0.1448878049850464
Seok, iteration idx= 7 IoU = tensor(0.1449)
SKIP, unacceptable sam prediction, IoU is tensor(0.1449)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 2.6ms preprocess, 22.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9707
Instance 1: Confidence=0.9349
Selected instance: 1 (Confidence: 0.9349)
tmp min: tensor(0.) tmp max: tensor(1.)
165 60 540 960
There are 16 prompts
current IoU is: 0.15100008249282837
Seok, iteration idx= 8 IoU = tensor(0.1510)
SKIP, unacceptable sam prediction, IoU is tensor(0.1510)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.7ms
Speed: 2.9ms preprocess, 21.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9734
Instance 1: Confidence=0.9361
Selected instance: 1 (Confidence: 0.9361)
tmp min: tensor(0.) tmp max: tensor(1.)
187 72 540 960
There are 16 prompts
current IoU is: 0.15392181277275085
Seok, iteration idx= 9 IoU = tensor(0.1539)
SKIP, unacceptable sam prediction, IoU is tensor(0.1539)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 1
Instance 0: Confidence=0.9550
Selected instance: 0 (Confidence: 0.9550)
tmp min: tensor(0.) tmp max: tensor(1.)
184 64 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 10 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.3ms
Speed: 1.7ms preprocess, 22.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 1
Instance 0: Confidence=0.9572
Selected instance: 0 (Confidence: 0.9572)
tmp min: tensor(0.) tmp max: tensor(1.)
186 72 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 11 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.2ms
Speed: 1.6ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 3
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.8823
Instance 2: Confidence=0.4506
Selected instance: 0 (Confidence: 0.9594)
tmp min: tensor(0.) tmp max: tensor(1.)
214 64 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 12 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.0ms
Speed: 2.6ms preprocess, 22.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9674
Instance 1: Confidence=0.6939
Selected instance: 0 (Confidence: 0.9674)
tmp min: tensor(0.) tmp max: tensor(1.)
230 68 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 13 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.7ms
Speed: 1.8ms preprocess, 20.7ms inference, 4.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9456
Instance 1: Confidence=0.8489
Selected instance: 0 (Confidence: 0.9456)
tmp min: tensor(0.) tmp max: tensor(1.)
268 80 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 14 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 3
Instance 0: Confidence=0.9496
Instance 1: Confidence=0.8183
Instance 2: Confidence=0.3549
Selected instance: 0 (Confidence: 0.9496)
tmp min: tensor(0.) tmp max: tensor(1.)
312 96 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 15 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.4ms
Speed: 1.6ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 3
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9284
Instance 2: Confidence=0.7120
Selected instance: 1 (Confidence: 0.9284)
tmp min: tensor(0.) tmp max: tensor(1.)
952 32 540 960
There are 14 prompts
current IoU is: 0.03957144170999527
Seok, iteration idx= 16 IoU = tensor(0.0396)
SKIP, unacceptable sam prediction, IoU is tensor(0.0396)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 1.6ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9430
Selected instance: 0 (Confidence: 0.9680)
tmp min: tensor(0.) tmp max: tensor(1.)
886 36 540 960
There are 12 prompts
current IoU is: 0.03463161736726761
Seok, iteration idx= 17 IoU = tensor(0.0346)
SKIP, unacceptable sam prediction, IoU is tensor(0.0346)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.1ms
Speed: 1.5ms preprocess, 21.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9740
Instance 1: Confidence=0.9374
Selected instance: 1 (Confidence: 0.9374)
tmp min: tensor(0.) tmp max: tensor(1.)
267 76 540 960
There are 17 prompts
current IoU is: 0.15343914926052094
Seok, iteration idx= 18 IoU = tensor(0.1534)
SKIP, unacceptable sam prediction, IoU is tensor(0.1534)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.0ms
Speed: 3.1ms preprocess, 22.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9647
Instance 1: Confidence=0.9377
Selected instance: 1 (Confidence: 0.9377)
tmp min: tensor(0.) tmp max: tensor(1.)
286 88 540 960
There are 14 prompts
current IoU is: 0.15220750868320465
Seok, iteration idx= 19 IoU = tensor(0.1522)
SKIP, unacceptable sam prediction, IoU is tensor(0.1522)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 3.1ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9654
Instance 1: Confidence=0.9447
Selected instance: 1 (Confidence: 0.9447)
tmp min: tensor(0.) tmp max: tensor(1.)
330 120 540 960
There are 14 prompts
current IoU is: 0.1520230919122696
Seok, iteration idx= 20 IoU = tensor(0.1520)
SKIP, unacceptable sam prediction, IoU is tensor(0.1520)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9613
Instance 1: Confidence=0.9350
Selected instance: 1 (Confidence: 0.9350)
tmp min: tensor(0.) tmp max: tensor(1.)
399 72 540 960
There are 15 prompts
current IoU is: 0.15428465604782104
Seok, iteration idx= 21 IoU = tensor(0.1543)
SKIP, unacceptable sam prediction, IoU is tensor(0.1543)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 21.9ms
Speed: 1.6ms preprocess, 21.9ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 1
Instance 0: Confidence=0.9570
Selected instance: 0 (Confidence: 0.9570)
tmp min: tensor(0.) tmp max: tensor(1.)
498 36 540 960
There are 14 prompts
current IoU is: 0.007403417024761438
Seok, iteration idx= 22 IoU = tensor(0.0074)
SKIP, unacceptable sam prediction, IoU is tensor(0.0074)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9596
Instance 1: Confidence=0.9353
Selected instance: 1 (Confidence: 0.9353)
tmp min: tensor(0.) tmp max: tensor(1.)
510 68 540 960
There are 16 prompts
current IoU is: 0.14256930351257324
Seok, iteration idx= 23 IoU = tensor(0.1426)
SKIP, unacceptable sam prediction, IoU is tensor(0.1426)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 1.6ms preprocess, 22.2ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9272
Selected instance: 1 (Confidence: 0.9272)
tmp min: tensor(0.) tmp max: tensor(1.)
550 80 540 960
There are 11 prompts
current IoU is: 0.13247936964035034
Seok, iteration idx= 24 IoU = tensor(0.1325)
SKIP, unacceptable sam prediction, IoU is tensor(0.1325)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 2.8ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9309
Selected instance: 1 (Confidence: 0.9309)
tmp min: tensor(0.) tmp max: tensor(1.)
637 68 540 960
There are 12 prompts
current IoU is: 0.14321087300777435
Seok, iteration idx= 25 IoU = tensor(0.1432)
SKIP, unacceptable sam prediction, IoU is tensor(0.1432)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.0ms
Speed: 3.6ms preprocess, 22.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 2
Instance 0: Confidence=0.9582
Instance 1: Confidence=0.9248
Selected instance: 1 (Confidence: 0.9248)
tmp min: tensor(0.) tmp max: tensor(1.)
713 44 540 960
There are 12 prompts
current IoU is: 0.14021439850330353
Seok, iteration idx= 26 IoU = tensor(0.1402)
SKIP, unacceptable sam prediction, IoU is tensor(0.1402)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9183
Selected instance: 1 (Confidence: 0.9183)
tmp min: tensor(0.) tmp max: tensor(1.)
720 80 540 960
There are 14 prompts
current IoU is: 0.12638439238071442
Seok, iteration idx= 27 IoU = tensor(0.1264)
SKIP, unacceptable sam prediction, IoU is tensor(0.1264)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.7ms
Speed: 1.6ms preprocess, 21.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 2
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9258
Selected instance: 1 (Confidence: 0.9258)
tmp min: tensor(0.) tmp max: tensor(1.)
777 52 540 960
There are 16 prompts
current IoU is: 0.1154533252120018
Seok, iteration idx= 28 IoU = tensor(0.1155)
SKIP, unacceptable sam prediction, IoU is tensor(0.1155)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.8ms
Speed: 1.5ms preprocess, 20.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 2
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9293
Selected instance: 1 (Confidence: 0.9293)
tmp min: tensor(0.) tmp max: tensor(1.)
806 64 540 960
There are 15 prompts
current IoU is: 0.1081891655921936
Seok, iteration idx= 29 IoU = tensor(0.1082)
SKIP, unacceptable sam prediction, IoU is tensor(0.1082)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 2
Instance 0: Confidence=0.9606
Instance 1: Confidence=0.9400
Selected instance: 1 (Confidence: 0.9400)
tmp min: tensor(0.) tmp max: tensor(1.)
820 124 540 960
There are 14 prompts
current IoU is: 0.09290669113397598
Seok, iteration idx= 30 IoU = tensor(0.0929)
SKIP, unacceptable sam prediction, IoU is tensor(0.0929)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 1.3ms preprocess, 22.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 2
Instance 0: Confidence=0.9601
Instance 1: Confidence=0.8530
Selected instance: 1 (Confidence: 0.8530)
tmp min: tensor(0.) tmp max: tensor(1.)
924 96 540 960
There are 18 prompts
current IoU is: 0.2815995514392853
Seok, iteration idx= 31 IoU = tensor(0.2816)
Selected Instance Confidence List: [tensor(0.7309), tensor(0.3825, device='cpu'), tensor(0.4768, device='cpu'), tensor(0.4871, device='cpu'), tensor(0.4722, device='cpu'), tensor(0.4726, device='cpu'), tensor(0.4656, device='cpu'), tensor(0.4648, device='cpu'), tensor(0.4646, device='cpu'), tensor(0.4668, device='cpu'), tensor(0.3820, device='cpu'), tensor(0.3829, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3870, device='cpu'), tensor(0.3782, device='cpu'), tensor(0.3798, device='cpu'), tensor(0.3951, device='cpu'), tensor(0.4080, device='cpu'), tensor(0.4670, device='cpu'), tensor(0.4664, device='cpu'), tensor(0.4691, device='cpu'), tensor(0.4666, device='cpu'), tensor(0.3872, device='cpu'), tensor(0.4597, device='cpu'), tensor(0.4504, device='cpu'), tensor(0.4583, device='cpu'), tensor(0.4541, device='cpu'), tensor(0.4431, device='cpu'), tensor(0.4396, device='cpu'), tensor(0.4366, device='cpu'), tensor(0.4317, device='cpu'), tensor(0.5102, device='cpu')]
Sorted Confidence Order: [tensor(0.7309), tensor(0.5102, device='cpu'), tensor(0.3825, device='cpu'), tensor(0.3820, device='cpu'), tensor(0.3829, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3870, device='cpu'), tensor(0.3782, device='cpu'), tensor(0.3798, device='cpu'), tensor(0.3951, device='cpu'), tensor(0.4080, device='cpu'), tensor(0.4317, device='cpu'), tensor(0.4366, device='cpu'), tensor(0.4396, device='cpu'), tensor(0.4431, device='cpu'), tensor(0.4541, device='cpu'), tensor(0.4583, device='cpu'), tensor(0.4504, device='cpu'), tensor(0.4597, device='cpu'), tensor(0.3872, device='cpu'), tensor(0.4666, device='cpu'), tensor(0.4691, device='cpu'), tensor(0.4664, device='cpu'), tensor(0.4670, device='cpu'), tensor(0.4668, device='cpu'), tensor(0.4646, device='cpu'), tensor(0.4648, device='cpu'), tensor(0.4656, device='cpu'), tensor(0.4726, device='cpu'), tensor(0.4722, device='cpu'), tensor(0.4871, device='cpu'), tensor(0.4768, device='cpu')]
sorted_indices: [0, 31, 1, 10, 11, 12, 13, 14, 15, 16, 17, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 9, 8, 7, 6, 5, 4, 3, 2]
Initial view (highest confidence): 1
New training order: [35, 34, 36, 9, 10, 11, 12, 13, 14, 15, 16, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.9ms
Speed: 1.4ms preprocess, 19.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 3.2ms preprocess, 22.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 2
Instance 0: Confidence=0.9601
Instance 1: Confidence=0.8530
tmp min: tensor(0.) tmp max: tensor(1.)
924 96 540 960
There are 18 prompts
current IoU is: 0.6678212881088257
Seok, iteration idx= 1 IoU = tensor(0.6678)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 2.7ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 2
Instance 0: Confidence=0.9563
Instance 1: Confidence=0.4461
tmp min: tensor(0.) tmp max: tensor(1.)
155 76 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 2 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 1
Instance 0: Confidence=0.9550
tmp min: tensor(0.) tmp max: tensor(1.)
184 64 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 3 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.7ms
Speed: 1.7ms preprocess, 23.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 1
Instance 0: Confidence=0.9572
tmp min: tensor(0.) tmp max: tensor(1.)
186 72 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 4 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.0ms
Speed: 1.7ms preprocess, 23.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 3
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.8823
Instance 2: Confidence=0.4506
tmp min: tensor(0.) tmp max: tensor(1.)
214 64 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 5 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.6ms preprocess, 22.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9674
Instance 1: Confidence=0.6939
tmp min: tensor(0.) tmp max: tensor(1.)
230 68 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 6 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.2ms
Speed: 1.7ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9456
Instance 1: Confidence=0.8489
tmp min: tensor(0.) tmp max: tensor(1.)
268 80 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 7 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.9ms
Speed: 3.2ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 3
Instance 0: Confidence=0.9496
Instance 1: Confidence=0.8183
Instance 2: Confidence=0.3549
tmp min: tensor(0.) tmp max: tensor(1.)
312 96 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 8 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.9ms
Speed: 2.7ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 3
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9284
Instance 2: Confidence=0.7120
tmp min: tensor(0.) tmp max: tensor(1.)
952 32 540 960
There are 14 prompts
current IoU is: 0.2461843490600586
Seok, iteration idx= 9 IoU = tensor(0.2462)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 2.8ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9430
tmp min: tensor(0.) tmp max: tensor(1.)
886 36 540 960
There are 12 prompts
current IoU is: 0.5171966552734375
Seok, iteration idx= 10 IoU = tensor(0.5172)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9606
Instance 1: Confidence=0.9400
tmp min: tensor(0.) tmp max: tensor(1.)
820 124 540 960
There are 14 prompts
current IoU is: 0.5002660155296326
Seok, iteration idx= 11 IoU = tensor(0.5003)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.7ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9293
tmp min: tensor(0.) tmp max: tensor(1.)
806 64 540 960
There are 15 prompts
current IoU is: 0.6712875366210938
Seok, iteration idx= 12 IoU = tensor(0.6713)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.5ms preprocess, 23.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9258
tmp min: tensor(0.) tmp max: tensor(1.)
777 52 540 960
There are 16 prompts
current IoU is: 0.8241930603981018
Seok, iteration idx= 13 IoU = tensor(0.8242)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.1ms
Speed: 2.7ms preprocess, 24.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9183
tmp min: tensor(0.) tmp max: tensor(1.)
720 80 540 960
There are 14 prompts
current IoU is: 0.8318177461624146
Seok, iteration idx= 14 IoU = tensor(0.8318)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.7ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 2
Instance 0: Confidence=0.9582
Instance 1: Confidence=0.9248
tmp min: tensor(0.) tmp max: tensor(1.)
713 44 540 960
There are 12 prompts
current IoU is: 0.8351591229438782
Seok, iteration idx= 15 IoU = tensor(0.8352)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9309
tmp min: tensor(0.) tmp max: tensor(1.)
637 68 540 960
There are 12 prompts
current IoU is: 0.8377677202224731
Seok, iteration idx= 16 IoU = tensor(0.8378)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.7ms
Speed: 3.1ms preprocess, 21.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9272
tmp min: tensor(0.) tmp max: tensor(1.)
550 80 540 960
There are 11 prompts
current IoU is: 0.8011040091514587
Seok, iteration idx= 17 IoU = tensor(0.8011)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 3.4ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9596
Instance 1: Confidence=0.9353
tmp min: tensor(0.) tmp max: tensor(1.)
510 68 540 960
There are 16 prompts
current IoU is: 0.8238129615783691
Seok, iteration idx= 18 IoU = tensor(0.8238)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.6ms
Speed: 2.6ms preprocess, 23.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 1
Instance 0: Confidence=0.9570
tmp min: tensor(0.) tmp max: tensor(1.)
498 36 540 960
There are 14 prompts
current IoU is: 0.004609821364283562
Seok, iteration idx= 19 IoU = tensor(0.0046)
SKIP, unacceptable sam prediction, IoU is tensor(0.0046)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 4.5ms preprocess, 22.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9613
Instance 1: Confidence=0.9350
tmp min: tensor(0.) tmp max: tensor(1.)
399 72 540 960
There are 15 prompts
current IoU is: 0.7558830380439758
Seok, iteration idx= 20 IoU = tensor(0.7559)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.6ms preprocess, 22.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9654
Instance 1: Confidence=0.9447
tmp min: tensor(0.) tmp max: tensor(1.)
330 120 540 960
There are 14 prompts
current IoU is: 0.8259082436561584
Seok, iteration idx= 21 IoU = tensor(0.8259)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.4ms
Speed: 1.5ms preprocess, 24.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 2
Instance 0: Confidence=0.9647
Instance 1: Confidence=0.9377
tmp min: tensor(0.) tmp max: tensor(1.)
286 88 540 960
There are 14 prompts
current IoU is: 0.8193768262863159
Seok, iteration idx= 22 IoU = tensor(0.8194)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9740
Instance 1: Confidence=0.9374
tmp min: tensor(0.) tmp max: tensor(1.)
267 76 540 960
There are 17 prompts
current IoU is: 0.8563678860664368
Seok, iteration idx= 23 IoU = tensor(0.8564)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.0ms
Speed: 1.6ms preprocess, 24.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9734
Instance 1: Confidence=0.9361
tmp min: tensor(0.) tmp max: tensor(1.)
187 72 540 960
There are 16 prompts
current IoU is: 0.8613765835762024
Seok, iteration idx= 24 IoU = tensor(0.8614)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.7ms preprocess, 23.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9707
Instance 1: Confidence=0.9349
tmp min: tensor(0.) tmp max: tensor(1.)
165 60 540 960
There are 16 prompts
current IoU is: 0.8436053395271301
Seok, iteration idx= 25 IoU = tensor(0.8436)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.3ms
Speed: 1.7ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 3
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.6308
tmp min: tensor(0.) tmp max: tensor(1.)
140 68 540 960
There are 16 prompts
current IoU is: 0.8934586048126221
Seok, iteration idx= 26 IoU = tensor(0.8935)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 3.5ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 2
Instance 0: Confidence=0.9701
Instance 1: Confidence=0.9441
tmp min: tensor(0.) tmp max: tensor(1.)
69 48 540 960
There are 14 prompts
current IoU is: 0.8938137888908386
Seok, iteration idx= 27 IoU = tensor(0.8938)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 2.6ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 2
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9575
tmp min: tensor(0.) tmp max: tensor(1.)
44 68 540 960
There are 16 prompts
current IoU is: 0.9102243185043335
Seok, iteration idx= 28 IoU = tensor(0.9102)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.0ms
Speed: 1.7ms preprocess, 24.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 3
Instance 0: Confidence=0.9624
Instance 1: Confidence=0.9555
Instance 2: Confidence=0.6049
tmp min: tensor(0.) tmp max: tensor(1.)
43 64 540 960
There are 17 prompts
current IoU is: 0.9197061061859131
Seok, iteration idx= 29 IoU = tensor(0.9197)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.2ms
Speed: 1.4ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 3
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.3825
tmp min: tensor(0.) tmp max: tensor(1.)
24 72 540 960
There are 15 prompts
current IoU is: 0.9090554118156433
Seok, iteration idx= 30 IoU = tensor(0.9091)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.3ms
Speed: 1.6ms preprocess, 24.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 2
Instance 0: Confidence=0.9536
Instance 1: Confidence=0.9447
tmp min: tensor(0.) tmp max: tensor(1.)
32 80 540 960
There are 14 prompts
current IoU is: 0.9018623232841492
Seok, iteration idx= 31 IoU = tensor(0.9019)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set7_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set7_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:38<00:00,  1.21s/it]
Testing psnr 29.035378023982048 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set7_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.18it/s]
Testing psnr 3.3898200653493404 (avg)
train: coarse segmentation in 00:03:34
train: finish (eps time 00:03:34 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set7_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set8/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 46.58it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set8 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set8
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set8_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.8ms
Speed: 3.1ms preprocess, 20.8ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.0ms
Speed: 1.2ms preprocess, 20.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.9ms
Speed: 1.5ms preprocess, 18.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.9ms
Speed: 1.6ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.0ms
Speed: 1.5ms preprocess, 19.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.1ms
Speed: 1.4ms preprocess, 20.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.4ms
Speed: 1.3ms preprocess, 19.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.5ms
Speed: 1.2ms preprocess, 19.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.1ms
Speed: 1.2ms preprocess, 20.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.3ms
Speed: 1.3ms preprocess, 20.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.1ms
Speed: 1.3ms preprocess, 20.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.1ms
Speed: 1.2ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.5ms
Speed: 1.3ms preprocess, 19.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.2ms preprocess, 20.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.5ms
Speed: 1.2ms preprocess, 19.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.0ms
Speed: 1.4ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.4ms
Speed: 1.3ms preprocess, 19.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.6ms
Speed: 1.2ms preprocess, 19.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.6ms
Speed: 1.3ms preprocess, 19.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.5ms
Speed: 3.0ms preprocess, 20.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 15
view_order: [16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.1ms
Speed: 3.3ms preprocess, 20.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 1
Instance 0: Confidence=0.9438
Selected instance: 0 (Confidence: 0.9438)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

400 40 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 1 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 1
Instance 0: Confidence=0.9419
Selected instance: 0 (Confidence: 0.9419)
tmp min: tensor(0.) tmp max: tensor(1.)
375 52 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 2 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 2.8ms preprocess, 23.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 2
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.7583
Selected instance: 0 (Confidence: 0.9489)
tmp min: tensor(0.) tmp max: tensor(1.)
390 88 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 3 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.5ms
Speed: 3.1ms preprocess, 21.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 2
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9110
Selected instance: 0 (Confidence: 0.9526)
tmp min: tensor(0.) tmp max: tensor(1.)
386 44 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 4 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.0ms
Speed: 1.6ms preprocess, 24.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9398
Selected instance: 0 (Confidence: 0.9530)
tmp min: tensor(0.) tmp max: tensor(1.)
395 52 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 5 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9348
Selected instance: 0 (Confidence: 0.9594)
tmp min: tensor(0.) tmp max: tensor(1.)
388 32 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 6 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 1.5ms preprocess, 22.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9411
Selected instance: 0 (Confidence: 0.9540)
tmp min: tensor(0.) tmp max: tensor(1.)
374 48 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 7 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 1.6ms preprocess, 22.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9531
Instance 1: Confidence=0.9502
Selected instance: 0 (Confidence: 0.9531)
tmp min: tensor(0.) tmp max: tensor(1.)
413 36 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 8 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9479
Selected instance: 0 (Confidence: 0.9518)
tmp min: tensor(0.) tmp max: tensor(1.)
695 36 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 9 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 2.7ms preprocess, 22.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9527
Instance 1: Confidence=0.9453
Selected instance: 0 (Confidence: 0.9527)
tmp min: tensor(0.) tmp max: tensor(1.)
683 72 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 10 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 3.0ms preprocess, 22.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9330
Selected instance: 0 (Confidence: 0.9554)
tmp min: tensor(0.) tmp max: tensor(1.)
721 40 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 11 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 1.7ms preprocess, 23.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9514
Instance 1: Confidence=0.9420
Selected instance: 0 (Confidence: 0.9514)
tmp min: tensor(0.) tmp max: tensor(1.)
725 56 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 12 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.6ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9259
Selected instance: 0 (Confidence: 0.9526)
tmp min: tensor(0.) tmp max: tensor(1.)
704 124 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 13 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.2ms
Speed: 1.6ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 3
Instance 0: Confidence=0.9418
Instance 1: Confidence=0.9212
Instance 2: Confidence=0.5274
Selected instance: 0 (Confidence: 0.9418)
tmp min: tensor(0.) tmp max: tensor(1.)
758 92 540 960
There are 14 prompts
current IoU is: 0.005059750750660896
Seok, iteration idx= 14 IoU = tensor(0.0051)
SKIP, unacceptable sam prediction, IoU is tensor(0.0051)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.0ms
Speed: 1.7ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 3
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.2551
Selected instance: 0 (Confidence: 0.9457)
tmp min: tensor(0.) tmp max: tensor(1.)
760 84 540 960
There are 14 prompts
current IoU is: 0.005716871935874224
Seok, iteration idx= 15 IoU = tensor(0.0057)
SKIP, unacceptable sam prediction, IoU is tensor(0.0057)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.7ms preprocess, 23.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9257
Selected instance: 0 (Confidence: 0.9385)
tmp min: tensor(0.) tmp max: tensor(1.)
806 68 540 960
There are 14 prompts
current IoU is: 0.0018034082604572177
Seok, iteration idx= 16 IoU = tensor(0.0018)
SKIP, unacceptable sam prediction, IoU is tensor(0.0018)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.7ms
Speed: 1.7ms preprocess, 23.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9398
Instance 1: Confidence=0.8970
Selected instance: 0 (Confidence: 0.9398)
tmp min: tensor(0.) tmp max: tensor(1.)
463 76 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 17 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 3.3ms preprocess, 22.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9516
Instance 1: Confidence=0.8899
Selected instance: 0 (Confidence: 0.9516)
tmp min: tensor(0.) tmp max: tensor(1.)
454 56 540 960
There are 17 prompts
current IoU is: 0.0
Seok, iteration idx= 18 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.6ms
Speed: 2.6ms preprocess, 22.6ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 3
Instance 0: Confidence=0.9405
Instance 1: Confidence=0.9138
Instance 2: Confidence=0.4672
Selected instance: 0 (Confidence: 0.9405)
tmp min: tensor(0.) tmp max: tensor(1.)
449 44 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 19 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 3
Instance 0: Confidence=0.9450
Instance 1: Confidence=0.8929
Instance 2: Confidence=0.7195
Selected instance: 0 (Confidence: 0.9450)
tmp min: tensor(0.) tmp max: tensor(1.)
418 40 540 960
There are 16 prompts
current IoU is: 4.8048048483906314e-05
Seok, iteration idx= 20 IoU = tensor(4.8048e-05)
SKIP, unacceptable sam prediction, IoU is tensor(4.8048e-05)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.8ms
Speed: 1.6ms preprocess, 22.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 3
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9083
Instance 2: Confidence=0.7298
Selected instance: 0 (Confidence: 0.9458)
tmp min: tensor(0.) tmp max: tensor(1.)
405 20 540 960
There are 19 prompts
current IoU is: 0.0
Seok, iteration idx= 21 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 3
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.8985
Instance 2: Confidence=0.8365
Selected instance: 0 (Confidence: 0.9384)
tmp min: tensor(0.) tmp max: tensor(1.)
434 24 540 960
There are 19 prompts
current IoU is: 0.0
Seok, iteration idx= 22 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.5ms
Speed: 1.7ms preprocess, 24.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.8323
Selected instance: 0 (Confidence: 0.9477)
tmp min: tensor(0.) tmp max: tensor(1.)
397 20 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 23 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.6ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.7016
Selected instance: 0 (Confidence: 0.9483)
tmp min: tensor(0.) tmp max: tensor(1.)
364 20 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 24 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 3.6ms preprocess, 22.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9293
Instance 1: Confidence=0.9154
Selected instance: 0 (Confidence: 0.9293)
tmp min: tensor(0.) tmp max: tensor(1.)
503 48 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 25 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 3.0ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 2
Instance 0: Confidence=0.9417
Instance 1: Confidence=0.9213
Selected instance: 0 (Confidence: 0.9417)
tmp min: tensor(0.) tmp max: tensor(1.)
503 52 540 960
There are 17 prompts
current IoU is: 0.0
Seok, iteration idx= 26 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 3
Instance 0: Confidence=0.9340
Instance 1: Confidence=0.9279
Instance 2: Confidence=0.8775
Selected instance: 2 (Confidence: 0.8775)
tmp min: tensor(0.) tmp max: tensor(1.)
2 132 540 960
There are 13 prompts
current IoU is: 0.39889004826545715
Seok, iteration idx= 27 IoU = tensor(0.3989)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.1ms
Speed: 1.5ms preprocess, 24.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 3
Instance 0: Confidence=0.9416
Instance 1: Confidence=0.9159
Instance 2: Confidence=0.5724
Selected instance: 2 (Confidence: 0.5724)
tmp min: tensor(0.) tmp max: tensor(1.)
72 132 540 960
There are 12 prompts
current IoU is: 0.6127102971076965
Seok, iteration idx= 28 IoU = tensor(0.6127)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 3
Instance 0: Confidence=0.9417
Instance 1: Confidence=0.9193
Instance 2: Confidence=0.8251
Selected instance: 2 (Confidence: 0.8251)
tmp min: tensor(0.) tmp max: tensor(1.)
165 144 540 960
There are 13 prompts
current IoU is: 0.7042322754859924
Seok, iteration idx= 29 IoU = tensor(0.7042)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.5ms
Speed: 1.5ms preprocess, 22.5ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 3
Instance 0: Confidence=0.9349
Instance 1: Confidence=0.9199
Instance 2: Confidence=0.8269
Selected instance: 2 (Confidence: 0.8269)
tmp min: tensor(0.) tmp max: tensor(1.)
250 156 540 960
There are 12 prompts
current IoU is: 0.7164633870124817
Seok, iteration idx= 30 IoU = tensor(0.7165)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.2ms
Speed: 2.5ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 3
Instance 0: Confidence=0.8907
Instance 1: Confidence=0.8869
Instance 2: Confidence=0.8282
Selected instance: 2 (Confidence: 0.8282)
tmp min: tensor(0.) tmp max: tensor(1.)
309 168 540 960
There are 10 prompts
current IoU is: 0.711482584476471
Seok, iteration idx= 31 IoU = tensor(0.7115)
Selected Instance Confidence List: [tensor(0.8280), tensor(0.3775, device='cpu'), tensor(0.3767, device='cpu'), tensor(0.3796, device='cpu'), tensor(0.3810, device='cpu'), tensor(0.3812, device='cpu'), tensor(0.3838, device='cpu'), tensor(0.3816, device='cpu'), tensor(0.3812, device='cpu'), tensor(0.3807, device='cpu'), tensor(0.3811, device='cpu'), tensor(0.3822, device='cpu'), tensor(0.3806, device='cpu'), tensor(0.3811, device='cpu'), tensor(0.3798, device='cpu'), tensor(0.3817, device='cpu'), tensor(0.3765, device='cpu'), tensor(0.3759, device='cpu'), tensor(0.3806, device='cpu'), tensor(0.3762, device='cpu'), tensor(0.3780, device='cpu'), tensor(0.3783, device='cpu'), tensor(0.3754, device='cpu'), tensor(0.3791, device='cpu'), tensor(0.3793, device='cpu'), tensor(0.3717, device='cpu'), tensor(0.3767, device='cpu'), tensor(0.5903, device='cpu'), tensor(0.5966, device='cpu'), tensor(0.7526, device='cpu'), tensor(0.7607, device='cpu'), tensor(0.7582, device='cpu')]
Sorted Confidence Order: [tensor(0.8280), tensor(0.7582, device='cpu'), tensor(0.7607, device='cpu'), tensor(0.7526, device='cpu'), tensor(0.5966, device='cpu'), tensor(0.5903, device='cpu'), tensor(0.3767, device='cpu'), tensor(0.3717, device='cpu'), tensor(0.3765, device='cpu'), tensor(0.3817, device='cpu'), tensor(0.3798, device='cpu'), tensor(0.3811, device='cpu'), tensor(0.3806, device='cpu'), tensor(0.3822, device='cpu'), tensor(0.3811, device='cpu'), tensor(0.3807, device='cpu'), tensor(0.3812, device='cpu'), tensor(0.3816, device='cpu'), tensor(0.3838, device='cpu'), tensor(0.3812, device='cpu'), tensor(0.3810, device='cpu'), tensor(0.3796, device='cpu'), tensor(0.3767, device='cpu'), tensor(0.3775, device='cpu'), tensor(0.3793, device='cpu'), tensor(0.3791, device='cpu'), tensor(0.3754, device='cpu'), tensor(0.3783, device='cpu'), tensor(0.3780, device='cpu'), tensor(0.3762, device='cpu'), tensor(0.3806, device='cpu'), tensor(0.3759, device='cpu')]
sorted_indices: [0, 31, 30, 29, 28, 27, 26, 25, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 24, 23, 22, 21, 20, 19, 18, 17]
Initial view (highest confidence): 1
New training order: [16, 15, 14, 13, 12, 11, 10, 9, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 3
Instance 0: Confidence=0.8907
Instance 1: Confidence=0.8869
Instance 2: Confidence=0.8282
tmp min: tensor(0.) tmp max: tensor(1.)
309 168 540 960
There are 10 prompts
current IoU is: 0.19709090888500214
Seok, iteration idx= 1 IoU = tensor(0.1971)
SKIP, unacceptable sam prediction, IoU is tensor(0.1971)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.2ms
Speed: 2.5ms preprocess, 22.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 3
Instance 0: Confidence=0.9349
Instance 1: Confidence=0.9199
Instance 2: Confidence=0.8269
tmp min: tensor(0.) tmp max: tensor(1.)
250 156 540 960
There are 12 prompts
current IoU is: 0.28597787022590637
Seok, iteration idx= 2 IoU = tensor(0.2860)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.8ms
Speed: 3.1ms preprocess, 22.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 3
Instance 0: Confidence=0.9417
Instance 1: Confidence=0.9193
Instance 2: Confidence=0.8251
tmp min: tensor(0.) tmp max: tensor(1.)
165 144 540 960
There are 13 prompts
current IoU is: 0.3191699683666229
Seok, iteration idx= 3 IoU = tensor(0.3192)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 25.7ms
Speed: 3.2ms preprocess, 25.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 3
Instance 0: Confidence=0.9416
Instance 1: Confidence=0.9159
Instance 2: Confidence=0.5724
tmp min: tensor(0.) tmp max: tensor(1.)
72 132 540 960
There are 12 prompts
current IoU is: 0.4149474501609802
Seok, iteration idx= 4 IoU = tensor(0.4149)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.7ms
Speed: 1.5ms preprocess, 24.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 3
Instance 0: Confidence=0.9340
Instance 1: Confidence=0.9279
Instance 2: Confidence=0.8775
tmp min: tensor(0.) tmp max: tensor(1.)
2 132 540 960
There are 13 prompts
current IoU is: 0.5350772738456726
Seok, iteration idx= 5 IoU = tensor(0.5351)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 25.4ms
Speed: 1.6ms preprocess, 25.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9417
Instance 1: Confidence=0.9213
tmp min: tensor(0.) tmp max: tensor(1.)
503 52 540 960
There are 17 prompts
current IoU is: 0.0
Seok, iteration idx= 6 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9293
Instance 1: Confidence=0.9154
tmp min: tensor(0.) tmp max: tensor(1.)
503 48 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 7 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9257
tmp min: tensor(0.) tmp max: tensor(1.)
806 68 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 8 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.3ms
Speed: 2.3ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 3
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.2551
tmp min: tensor(0.) tmp max: tensor(1.)
760 84 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 9 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 25.2ms
Speed: 1.4ms preprocess, 25.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 3
Instance 0: Confidence=0.9418
Instance 1: Confidence=0.9212
Instance 2: Confidence=0.5274
tmp min: tensor(0.) tmp max: tensor(1.)
758 92 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 10 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 3.6ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9259
tmp min: tensor(0.) tmp max: tensor(1.)
704 124 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 11 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 4.5ms preprocess, 22.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9514
Instance 1: Confidence=0.9420
tmp min: tensor(0.) tmp max: tensor(1.)
725 56 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 12 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 25.3ms
Speed: 2.7ms preprocess, 25.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9330
tmp min: tensor(0.) tmp max: tensor(1.)
721 40 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 13 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 2.6ms preprocess, 22.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9527
Instance 1: Confidence=0.9453
tmp min: tensor(0.) tmp max: tensor(1.)
683 72 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 14 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.5ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 2
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9479
tmp min: tensor(0.) tmp max: tensor(1.)
695 36 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 15 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.6ms preprocess, 22.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9531
Instance 1: Confidence=0.9502
tmp min: tensor(0.) tmp max: tensor(1.)
413 36 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 16 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 2.3ms preprocess, 23.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9411
tmp min: tensor(0.) tmp max: tensor(1.)
374 48 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 17 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 3.0ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9348
tmp min: tensor(0.) tmp max: tensor(1.)
388 32 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 18 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9398
tmp min: tensor(0.) tmp max: tensor(1.)
395 52 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 19 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 3.1ms preprocess, 22.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9110
tmp min: tensor(0.) tmp max: tensor(1.)
386 44 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 20 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.6ms
Speed: 3.0ms preprocess, 21.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.7583
tmp min: tensor(0.) tmp max: tensor(1.)
390 88 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 21 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.2ms
Speed: 2.9ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 1
Instance 0: Confidence=0.9419
tmp min: tensor(0.) tmp max: tensor(1.)
375 52 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 22 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 24.4ms
Speed: 1.4ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 1
Instance 0: Confidence=0.9438
tmp min: tensor(0.) tmp max: tensor(1.)
400 40 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 23 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.3ms
Speed: 1.6ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.7016
tmp min: tensor(0.) tmp max: tensor(1.)
364 20 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 24 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.3ms
Speed: 1.7ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.8323
tmp min: tensor(0.) tmp max: tensor(1.)
397 20 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 25 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.8ms
Speed: 1.6ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 3
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.8985
Instance 2: Confidence=0.8365
tmp min: tensor(0.) tmp max: tensor(1.)
434 24 540 960
There are 19 prompts
current IoU is: 0.0
Seok, iteration idx= 26 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.5ms
Speed: 3.5ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 3
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9083
Instance 2: Confidence=0.7298
tmp min: tensor(0.) tmp max: tensor(1.)
405 20 540 960
There are 19 prompts
current IoU is: 0.0
Seok, iteration idx= 27 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.9ms
Speed: 2.9ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 3
Instance 0: Confidence=0.9450
Instance 1: Confidence=0.8929
Instance 2: Confidence=0.7195
tmp min: tensor(0.) tmp max: tensor(1.)
418 40 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 28 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.3ms
Speed: 2.4ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 3
Instance 0: Confidence=0.9405
Instance 1: Confidence=0.9138
Instance 2: Confidence=0.4672
tmp min: tensor(0.) tmp max: tensor(1.)
449 44 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 29 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 2
Instance 0: Confidence=0.9516
Instance 1: Confidence=0.8899
tmp min: tensor(0.) tmp max: tensor(1.)
454 56 540 960
There are 17 prompts
current IoU is: 0.0
Seok, iteration idx= 30 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.1ms
Speed: 1.6ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 2
Instance 0: Confidence=0.9398
Instance 1: Confidence=0.8970
tmp min: tensor(0.) tmp max: tensor(1.)
463 76 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 31 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set8_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set8_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.24s/it]
Testing psnr 28.604390397667885 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set8_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:26<00:00,  1.22it/s]
Testing psnr 3.3456030022352934 (avg)
train: coarse segmentation in 00:04:11
train: finish (eps time 00:04:11 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set8_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set9/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 44.26it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set9 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set9
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set9_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.2ms
Speed: 2.8ms preprocess, 21.2ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.3ms
Speed: 1.3ms preprocess, 20.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.3ms
Speed: 1.3ms preprocess, 19.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.9ms
Speed: 1.3ms preprocess, 19.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.7ms
Speed: 1.2ms preprocess, 19.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.5ms
Speed: 1.3ms preprocess, 19.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.0ms
Speed: 1.3ms preprocess, 20.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.9ms
Speed: 1.2ms preprocess, 19.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.7ms
Speed: 1.2ms preprocess, 19.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.4ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.6ms
Speed: 1.3ms preprocess, 19.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.4ms
Speed: 1.7ms preprocess, 20.4ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.1ms
Speed: 2.3ms preprocess, 21.1ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9530
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.8797
Instance 4: Confidence=0.8281
Instance 5: Confidence=0.7251
Selected instance: 4 (Confidence: 0.8281)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

707 80 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.7535424828529358
Seok, iteration idx= 1 IoU = tensor(0.7535)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.5ms
Speed: 2.6ms preprocess, 24.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 4
Instance 0: Confidence=0.9523
Instance 1: Confidence=0.9468
Instance 2: Confidence=0.9161
Instance 3: Confidence=0.8821
Selected instance: 1 (Confidence: 0.9468)
tmp min: tensor(0.) tmp max: tensor(1.)
691 80 540 960
There are 16 prompts
current IoU is: 0.001599127077497542
Seok, iteration idx= 2 IoU = tensor(0.0016)
SKIP, unacceptable sam prediction, IoU is tensor(0.0016)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 1.7ms preprocess, 24.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9327
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9102
Instance 3: Confidence=0.8415
Instance 4: Confidence=0.7714
Selected instance: 4 (Confidence: 0.7714)
tmp min: tensor(0.) tmp max: tensor(1.)
690 132 540 960
There are 19 prompts
current IoU is: 0.31502020359039307
Seok, iteration idx= 3 IoU = tensor(0.3150)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9506
Instance 2: Confidence=0.8723
Instance 3: Confidence=0.8416
Instance 4: Confidence=0.8138
Instance 5: Confidence=0.3145
Selected instance: 2 (Confidence: 0.8723)
tmp min: tensor(0.) tmp max: tensor(1.)
174 60 540 960
There are 15 prompts
current IoU is: 0.6588252782821655
Seok, iteration idx= 4 IoU = tensor(0.6588)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.7ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 6
Instance 0: Confidence=0.9543
Instance 1: Confidence=0.9481
Instance 2: Confidence=0.8723
Instance 3: Confidence=0.8448
Instance 4: Confidence=0.8141
Instance 5: Confidence=0.7543
Selected instance: 3 (Confidence: 0.8448)
tmp min: tensor(0.) tmp max: tensor(1.)
173 76 540 960
current IoU is: 0.8428953886032104
Seok, iteration idx= 5 IoU = tensor(0.8429)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.3ms
Speed: 2.9ms preprocess, 23.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 8
Instance 0: Confidence=0.9574
Instance 1: Confidence=0.9518
Instance 2: Confidence=0.8906
Instance 3: Confidence=0.8743
Instance 4: Confidence=0.6790
Instance 5: Confidence=0.4519
Instance 6: Confidence=0.3982
Instance 7: Confidence=0.2843
Selected instance: 5 (Confidence: 0.4519)
tmp min: tensor(0.) tmp max: tensor(1.)
196 120 540 960
current IoU is: 0.41914618015289307
Seok, iteration idx= 6 IoU = tensor(0.4191)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.9ms
Speed: 2.0ms preprocess, 21.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9355
Instance 2: Confidence=0.9115
Instance 3: Confidence=0.8830
Instance 4: Confidence=0.7381
Instance 5: Confidence=0.7063
Selected instance: 5 (Confidence: 0.7063)
tmp min: tensor(0.) tmp max: tensor(1.)
216 68 540 960
There are 19 prompts
current IoU is: 0.6458112597465515
Seok, iteration idx= 7 IoU = tensor(0.6458)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 3.2ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9499
Instance 1: Confidence=0.9225
Instance 2: Confidence=0.9120
Instance 3: Confidence=0.9019
Instance 4: Confidence=0.8923
Selected instance: 4 (Confidence: 0.8923)
tmp min: tensor(0.) tmp max: tensor(1.)
249 84 540 960
There are 15 prompts
current IoU is: 0.8150347471237183
Seok, iteration idx= 8 IoU = tensor(0.8150)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 3.1ms preprocess, 22.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9663
Instance 1: Confidence=0.9506
Instance 2: Confidence=0.9380
Instance 3: Confidence=0.8953
Instance 4: Confidence=0.8884
Instance 5: Confidence=0.6212
Selected instance: 4 (Confidence: 0.8884)
tmp min: tensor(0.) tmp max: tensor(1.)
257 68 540 960
There are 19 prompts
current IoU is: 0.8265787363052368
Seok, iteration idx= 9 IoU = tensor(0.8266)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 3.2ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9406
Instance 2: Confidence=0.8957
Instance 3: Confidence=0.8788
Instance 4: Confidence=0.6792
Instance 5: Confidence=0.2540
Selected instance: 5 (Confidence: 0.2540)
tmp min: tensor(0.) tmp max: tensor(1.)
362 200 540 960
There are 11 prompts
current IoU is: 0.32501834630966187
Seok, iteration idx= 10 IoU = tensor(0.3250)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.5ms
Speed: 1.6ms preprocess, 24.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9677
Instance 1: Confidence=0.9541
Instance 2: Confidence=0.9076
Instance 3: Confidence=0.8270
Instance 4: Confidence=0.6917
Selected instance: 3 (Confidence: 0.8270)
tmp min: tensor(0.) tmp max: tensor(1.)
328 72 540 960
There are 16 prompts
current IoU is: 0.8820361495018005
Seok, iteration idx= 11 IoU = tensor(0.8820)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9664
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.8923
Instance 3: Confidence=0.6204
Instance 4: Confidence=0.4815
Instance 5: Confidence=0.4394
Selected instance: 2 (Confidence: 0.8923)
tmp min: tensor(0.) tmp max: tensor(1.)
382 48 540 960
There are 16 prompts
current IoU is: 0.8783114552497864
Seok, iteration idx= 12 IoU = tensor(0.8783)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.8ms
Speed: 1.7ms preprocess, 24.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9655
Instance 1: Confidence=0.9527
Instance 2: Confidence=0.9136
Instance 3: Confidence=0.8798
Instance 4: Confidence=0.8149
Instance 5: Confidence=0.6837
Selected instance: 3 (Confidence: 0.8798)
tmp min: tensor(0.) tmp max: tensor(1.)
390 88 540 960
There are 16 prompts
current IoU is: 0.8786407709121704
Seok, iteration idx= 13 IoU = tensor(0.8786)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9565
Instance 1: Confidence=0.9201
Instance 2: Confidence=0.9047
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.8364
Instance 5: Confidence=0.4276
Instance 6: Confidence=0.3358
Selected instance: 6 (Confidence: 0.3358)
tmp min: tensor(0.) tmp max: tensor(1.)
425 60 540 960
There are 15 prompts
current IoU is: 0.6295591592788696
Seok, iteration idx= 14 IoU = tensor(0.6296)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9601
Instance 1: Confidence=0.9222
Instance 2: Confidence=0.9087
Instance 3: Confidence=0.8744
Instance 4: Confidence=0.7555
Selected instance: 4 (Confidence: 0.7555)
tmp min: tensor(0.) tmp max: tensor(1.)
658 100 540 960
There are 16 prompts
current IoU is: 0.0019719544798135757
Seok, iteration idx= 15 IoU = tensor(0.0020)
SKIP, unacceptable sam prediction, IoU is tensor(0.0020)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 7
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9223
Instance 2: Confidence=0.9203
Instance 3: Confidence=0.8729
Instance 4: Confidence=0.7752
Instance 5: Confidence=0.6791
Instance 6: Confidence=0.3599
Selected instance: 5 (Confidence: 0.6791)
tmp min: tensor(0.) tmp max: tensor(1.)
474 140 540 960
There are 17 prompts
current IoU is: 0.6390203237533569
Seok, iteration idx= 16 IoU = tensor(0.6390)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.5ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9394
Instance 1: Confidence=0.9324
Instance 2: Confidence=0.9258
Instance 3: Confidence=0.9160
Instance 4: Confidence=0.9043
Selected instance: 4 (Confidence: 0.9043)
tmp min: tensor(0.) tmp max: tensor(1.)
530 116 540 960
There are 15 prompts
current IoU is: 0.8759269714355469
Seok, iteration idx= 17 IoU = tensor(0.8759)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.7ms
Speed: 1.6ms preprocess, 22.7ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 7
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9479
Instance 2: Confidence=0.9307
Instance 3: Confidence=0.9156
Instance 4: Confidence=0.8290
Instance 5: Confidence=0.7404
Instance 6: Confidence=0.3328
Selected instance: 4 (Confidence: 0.8290)
tmp min: tensor(0.) tmp max: tensor(1.)
540 120 540 960
There are 18 prompts
current IoU is: 0.8575772643089294
Seok, iteration idx= 18 IoU = tensor(0.8576)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.2ms
Speed: 2.6ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9400
Instance 2: Confidence=0.9397
Instance 3: Confidence=0.8820
Instance 4: Confidence=0.8574
Instance 5: Confidence=0.5968
Instance 6: Confidence=0.3960
Selected instance: 5 (Confidence: 0.5968)
tmp min: tensor(0.) tmp max: tensor(1.)
573 96 540 960
There are 17 prompts
current IoU is: 0.8375751376152039
Seok, iteration idx= 19 IoU = tensor(0.8376)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 3.8ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 7
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9180
Instance 3: Confidence=0.8806
Instance 4: Confidence=0.7796
Instance 5: Confidence=0.4945
Instance 6: Confidence=0.4307
Selected instance: 0 (Confidence: 0.9477)
tmp min: tensor(0.) tmp max: tensor(1.)
355 80 540 960
There are 14 prompts
current IoU is: 0.775344967842102
Seok, iteration idx= 20 IoU = tensor(0.7753)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.0ms
Speed: 2.7ms preprocess, 22.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9511
Instance 2: Confidence=0.9189
Instance 3: Confidence=0.8933
Instance 4: Confidence=0.8605
Instance 5: Confidence=0.8161
Selected instance: 0 (Confidence: 0.9591)
tmp min: tensor(0.) tmp max: tensor(1.)
321 56 540 960
There are 16 prompts
current IoU is: 0.9362398982048035
Seok, iteration idx= 21 IoU = tensor(0.9362)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 2.7ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9659
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.9025
Instance 4: Confidence=0.8976
Instance 5: Confidence=0.8199
Selected instance: 1 (Confidence: 0.9363)
tmp min: tensor(0.) tmp max: tensor(1.)
271 48 540 960
There are 15 prompts
current IoU is: 0.9426307678222656
Seok, iteration idx= 22 IoU = tensor(0.9426)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.1ms
Speed: 1.5ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 7
Instance 0: Confidence=0.9650
Instance 1: Confidence=0.9498
Instance 2: Confidence=0.9253
Instance 3: Confidence=0.8752
Instance 4: Confidence=0.6702
Instance 5: Confidence=0.4329
Instance 6: Confidence=0.3059
Selected instance: 1 (Confidence: 0.9498)
tmp min: tensor(0.) tmp max: tensor(1.)
198 52 540 960
There are 14 prompts
current IoU is: 0.9412450194358826
Seok, iteration idx= 23 IoU = tensor(0.9412)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.9ms
Speed: 1.7ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 8
Instance 0: Confidence=0.9547
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9168
Instance 3: Confidence=0.9027
Instance 4: Confidence=0.7627
Instance 5: Confidence=0.3927
Instance 6: Confidence=0.3073
Instance 7: Confidence=0.2968
Selected instance: 1 (Confidence: 0.9421)
tmp min: tensor(0.) tmp max: tensor(1.)
166 28 540 960
There are 15 prompts
current IoU is: 0.9383550882339478
Seok, iteration idx= 24 IoU = tensor(0.9384)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.9ms preprocess, 24.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9214
Instance 2: Confidence=0.9091
Instance 3: Confidence=0.8954
Instance 4: Confidence=0.8457
Instance 5: Confidence=0.6131
Selected instance: 2 (Confidence: 0.9091)
tmp min: tensor(0.) tmp max: tensor(1.)
200 40 540 960
There are 17 prompts
current IoU is: 0.9441624283790588
Seok, iteration idx= 25 IoU = tensor(0.9442)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.9ms
Speed: 1.6ms preprocess, 24.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9614
Instance 1: Confidence=0.9360
Instance 2: Confidence=0.9196
Instance 3: Confidence=0.8601
Instance 4: Confidence=0.8506
Instance 5: Confidence=0.4255
Selected instance: 3 (Confidence: 0.8601)
tmp min: tensor(0.) tmp max: tensor(1.)
154 40 540 960
There are 15 prompts
current IoU is: 0.9473133683204651
Seok, iteration idx= 26 IoU = tensor(0.9473)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 7
Instance 0: Confidence=0.9614
Instance 1: Confidence=0.9443
Instance 2: Confidence=0.9363
Instance 3: Confidence=0.7233
Instance 4: Confidence=0.5203
Instance 5: Confidence=0.3875
Instance 6: Confidence=0.3196
Selected instance: 2 (Confidence: 0.9363)
tmp min: tensor(0.) tmp max: tensor(1.)
124 48 540 960
There are 14 prompts
current IoU is: 0.9252442121505737
Seok, iteration idx= 27 IoU = tensor(0.9252)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.5ms
Speed: 1.5ms preprocess, 24.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9562
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.9215
Instance 3: Confidence=0.8554
Instance 4: Confidence=0.7123
Selected instance: 1 (Confidence: 0.9509)
tmp min: tensor(0.) tmp max: tensor(1.)
574 20 540 960
There are 17 prompts
current IoU is: 0.001711276825517416
Seok, iteration idx= 28 IoU = tensor(0.0017)
SKIP, unacceptable sam prediction, IoU is tensor(0.0017)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.0ms
Speed: 3.0ms preprocess, 22.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9559
Instance 1: Confidence=0.9326
Instance 2: Confidence=0.9255
Instance 3: Confidence=0.8958
Instance 4: Confidence=0.8174
Instance 5: Confidence=0.2734
Selected instance: 3 (Confidence: 0.8958)
tmp min: tensor(0.) tmp max: tensor(1.)
623 80 540 960
There are 18 prompts
current IoU is: 0.7536738514900208
Seok, iteration idx= 29 IoU = tensor(0.7537)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.6ms
Speed: 3.8ms preprocess, 21.6ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9356
Instance 2: Confidence=0.9105
Instance 3: Confidence=0.8693
Instance 4: Confidence=0.7860
Instance 5: Confidence=0.4345
Instance 6: Confidence=0.2986
Selected instance: 1 (Confidence: 0.9356)
tmp min: tensor(0.) tmp max: tensor(1.)
644 68 540 960
There are 15 prompts
current IoU is: 0.8287429213523865
Seok, iteration idx= 30 IoU = tensor(0.8287)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 3.1ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9608
Instance 1: Confidence=0.9245
Instance 2: Confidence=0.9014
Instance 3: Confidence=0.8902
Instance 4: Confidence=0.8448
Selected instance: 4 (Confidence: 0.8448)
tmp min: tensor(0.) tmp max: tensor(1.)
665 68 540 960
There are 16 prompts
current IoU is: 0.8764303922653198
Seok, iteration idx= 31 IoU = tensor(0.8764)
Selected Instance Confidence List: [tensor(0.9444), tensor(0.7834, device='cpu'), tensor(0.3809, device='cpu'), tensor(0.4976, device='cpu'), tensor(0.7442, device='cpu'), tensor(0.8436, device='cpu'), tensor(0.4322, device='cpu'), tensor(0.6700, device='cpu'), tensor(0.8459, device='cpu'), tensor(0.8513, device='cpu'), tensor(0.3873, device='cpu'), tensor(0.8600, device='cpu'), tensor(0.8839, device='cpu'), tensor(0.8791, device='cpu'), tensor(0.5120, device='cpu'), tensor(0.3851, device='cpu'), tensor(0.6550, device='cpu'), tensor(0.8873, device='cpu'), tensor(0.8462, device='cpu'), tensor(0.7413, device='cpu'), tensor(0.8443, device='cpu'), tensor(0.9454, device='cpu'), tensor(0.9401, device='cpu'), tensor(0.9447, device='cpu'), tensor(0.9398, device='cpu'), tensor(0.9301, device='cpu'), tensor(0.9124, device='cpu'), tensor(0.9297, device='cpu'), tensor(0.3825, device='cpu'), tensor(0.8105, device='cpu'), tensor(0.8715, device='cpu'), tensor(0.8638, device='cpu')]
Sorted Confidence Order: [tensor(0.9454, device='cpu'), tensor(0.8443, device='cpu'), tensor(0.9401, device='cpu'), tensor(0.9447, device='cpu'), tensor(0.9398, device='cpu'), tensor(0.9301, device='cpu'), tensor(0.9124, device='cpu'), tensor(0.9297, device='cpu'), tensor(0.7442, device='cpu'), tensor(0.8436, device='cpu'), tensor(0.4322, device='cpu'), tensor(0.6700, device='cpu'), tensor(0.8459, device='cpu'), tensor(0.8513, device='cpu'), tensor(0.3873, device='cpu'), tensor(0.8600, device='cpu'), tensor(0.8839, device='cpu'), tensor(0.8791, device='cpu'), tensor(0.5120, device='cpu'), tensor(0.3851, device='cpu'), tensor(0.6550, device='cpu'), tensor(0.8873, device='cpu'), tensor(0.8462, device='cpu'), tensor(0.7413, device='cpu'), tensor(0.3825, device='cpu'), tensor(0.8105, device='cpu'), tensor(0.8715, device='cpu'), tensor(0.8638, device='cpu'), tensor(0.9444), tensor(0.7834, device='cpu'), tensor(0.3809, device='cpu'), tensor(0.4976, device='cpu')]
sorted_indices: [21, 20, 22, 23, 24, 25, 26, 27, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 28, 29, 30, 31, 0, 1, 2, 3]
Initial view (highest confidence): 26
New training order: [2, 1, 3, 4, 5, 6, 7, 8, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 9, 10, 11, 12, 13, 14, 15, 16]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.5ms
Speed: 1.6ms preprocess, 24.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 7
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9180
Instance 3: Confidence=0.8806
Instance 4: Confidence=0.7796
Instance 5: Confidence=0.4945
Instance 6: Confidence=0.4307
tmp min: tensor(0.) tmp max: tensor(1.)
355 80 540 960
There are 14 prompts
current IoU is: 0.9108917117118835
Seok, iteration idx= 1 IoU = tensor(0.9109)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9659
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.9025
Instance 4: Confidence=0.8976
Instance 5: Confidence=0.8199
tmp min: tensor(0.) tmp max: tensor(1.)
271 48 540 960
There are 15 prompts
current IoU is: 0.9503867626190186
Seok, iteration idx= 2 IoU = tensor(0.9504)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.2ms
Speed: 1.7ms preprocess, 24.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 7
Instance 0: Confidence=0.9650
Instance 1: Confidence=0.9498
Instance 2: Confidence=0.9253
Instance 3: Confidence=0.8752
Instance 4: Confidence=0.6702
Instance 5: Confidence=0.4329
Instance 6: Confidence=0.3059
tmp min: tensor(0.) tmp max: tensor(1.)
198 52 540 960
There are 14 prompts
current IoU is: 0.9378911256790161
Seok, iteration idx= 3 IoU = tensor(0.9379)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.6ms
Speed: 1.5ms preprocess, 23.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 8
Instance 0: Confidence=0.9547
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9168
Instance 3: Confidence=0.9027
Instance 4: Confidence=0.7627
Instance 5: Confidence=0.3927
Instance 6: Confidence=0.3073
Instance 7: Confidence=0.2968
tmp min: tensor(0.) tmp max: tensor(1.)
166 28 540 960
There are 15 prompts
current IoU is: 0.9378413558006287
Seok, iteration idx= 4 IoU = tensor(0.9378)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.8ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9214
Instance 2: Confidence=0.9091
Instance 3: Confidence=0.8954
Instance 4: Confidence=0.8457
Instance 5: Confidence=0.6131
tmp min: tensor(0.) tmp max: tensor(1.)
200 40 540 960
There are 17 prompts
current IoU is: 0.9481885433197021
Seok, iteration idx= 5 IoU = tensor(0.9482)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 2.9ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9614
Instance 1: Confidence=0.9360
Instance 2: Confidence=0.9196
Instance 3: Confidence=0.8601
Instance 4: Confidence=0.8506
Instance 5: Confidence=0.4255
tmp min: tensor(0.) tmp max: tensor(1.)
154 40 540 960
There are 15 prompts
current IoU is: 0.9522861838340759
Seok, iteration idx= 6 IoU = tensor(0.9523)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.0ms
Speed: 2.9ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9614
Instance 1: Confidence=0.9443
Instance 2: Confidence=0.9363
Instance 3: Confidence=0.7233
Instance 4: Confidence=0.5203
Instance 5: Confidence=0.3875
Instance 6: Confidence=0.3196
tmp min: tensor(0.) tmp max: tensor(1.)
124 48 540 960
There are 14 prompts
current IoU is: 0.9416303634643555
Seok, iteration idx= 7 IoU = tensor(0.9416)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 3.3ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9506
Instance 2: Confidence=0.8723
Instance 3: Confidence=0.8416
Instance 4: Confidence=0.8138
Instance 5: Confidence=0.3145
tmp min: tensor(0.) tmp max: tensor(1.)
174 60 540 960
There are 15 prompts
current IoU is: 0.9039414525032043
Seok, iteration idx= 8 IoU = tensor(0.9039)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9543
Instance 1: Confidence=0.9481
Instance 2: Confidence=0.8723
Instance 3: Confidence=0.8448
Instance 4: Confidence=0.8141
Instance 5: Confidence=0.7543
tmp min: tensor(0.) tmp max: tensor(1.)
173 76 540 960
current IoU is: 0.8948638439178467
Seok, iteration idx= 9 IoU = tensor(0.8949)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.7ms
Speed: 1.7ms preprocess, 22.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 8
Instance 0: Confidence=0.9574
Instance 1: Confidence=0.9518
Instance 2: Confidence=0.8906
Instance 3: Confidence=0.8743
Instance 4: Confidence=0.6790
Instance 5: Confidence=0.4519
Instance 6: Confidence=0.3982
Instance 7: Confidence=0.2843
tmp min: tensor(0.) tmp max: tensor(1.)
196 120 540 960
current IoU is: 0.7453722953796387
Seok, iteration idx= 10 IoU = tensor(0.7454)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.7ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9355
Instance 2: Confidence=0.9115
Instance 3: Confidence=0.8830
Instance 4: Confidence=0.7381
Instance 5: Confidence=0.7063
tmp min: tensor(0.) tmp max: tensor(1.)
216 68 540 960
There are 19 prompts
current IoU is: 0.7619904279708862
Seok, iteration idx= 11 IoU = tensor(0.7620)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9499
Instance 1: Confidence=0.9225
Instance 2: Confidence=0.9120
Instance 3: Confidence=0.9019
Instance 4: Confidence=0.8923
tmp min: tensor(0.) tmp max: tensor(1.)
249 84 540 960
There are 15 prompts
current IoU is: 0.8724358677864075
Seok, iteration idx= 12 IoU = tensor(0.8724)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9663
Instance 1: Confidence=0.9506
Instance 2: Confidence=0.9380
Instance 3: Confidence=0.8953
Instance 4: Confidence=0.8884
Instance 5: Confidence=0.6212
tmp min: tensor(0.) tmp max: tensor(1.)
257 68 540 960
There are 19 prompts
current IoU is: 0.9032279253005981
Seok, iteration idx= 13 IoU = tensor(0.9032)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.6ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9406
Instance 2: Confidence=0.8957
Instance 3: Confidence=0.8788
Instance 4: Confidence=0.6792
Instance 5: Confidence=0.2540
tmp min: tensor(0.) tmp max: tensor(1.)
362 200 540 960
There are 11 prompts
current IoU is: 0.5807228684425354
Seok, iteration idx= 14 IoU = tensor(0.5807)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9677
Instance 1: Confidence=0.9541
Instance 2: Confidence=0.9076
Instance 3: Confidence=0.8270
Instance 4: Confidence=0.6917
tmp min: tensor(0.) tmp max: tensor(1.)
328 72 540 960
There are 16 prompts
current IoU is: 0.9259975552558899
Seok, iteration idx= 15 IoU = tensor(0.9260)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 2.5ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9664
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.8923
Instance 3: Confidence=0.6204
Instance 4: Confidence=0.4815
Instance 5: Confidence=0.4394
tmp min: tensor(0.) tmp max: tensor(1.)
382 48 540 960
There are 16 prompts
current IoU is: 0.893019437789917
Seok, iteration idx= 16 IoU = tensor(0.8930)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 3.0ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9655
Instance 1: Confidence=0.9527
Instance 2: Confidence=0.9136
Instance 3: Confidence=0.8798
Instance 4: Confidence=0.8149
Instance 5: Confidence=0.6837
tmp min: tensor(0.) tmp max: tensor(1.)
390 88 540 960
There are 16 prompts
current IoU is: 0.8855773210525513
Seok, iteration idx= 17 IoU = tensor(0.8856)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 2.7ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 7
Instance 0: Confidence=0.9565
Instance 1: Confidence=0.9201
Instance 2: Confidence=0.9047
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.8364
Instance 5: Confidence=0.4276
Instance 6: Confidence=0.3358
tmp min: tensor(0.) tmp max: tensor(1.)
425 60 540 960
There are 15 prompts
current IoU is: 0.739391565322876
Seok, iteration idx= 18 IoU = tensor(0.7394)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.8ms
Speed: 3.0ms preprocess, 21.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9601
Instance 1: Confidence=0.9222
Instance 2: Confidence=0.9087
Instance 3: Confidence=0.8744
Instance 4: Confidence=0.7555
tmp min: tensor(0.) tmp max: tensor(1.)
445 0 540 960
There are 14 prompts
current IoU is: 0.0015669595450162888
Seok, iteration idx= 19 IoU = tensor(0.0016)
SKIP, unacceptable sam prediction, IoU is tensor(0.0016)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 7
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9223
Instance 2: Confidence=0.9203
Instance 3: Confidence=0.8729
Instance 4: Confidence=0.7752
Instance 5: Confidence=0.6791
Instance 6: Confidence=0.3599
tmp min: tensor(0.) tmp max: tensor(1.)
474 140 540 960
There are 17 prompts
current IoU is: 0.7506082653999329
Seok, iteration idx= 20 IoU = tensor(0.7506)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.3ms
Speed: 1.4ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9394
Instance 1: Confidence=0.9324
Instance 2: Confidence=0.9258
Instance 3: Confidence=0.9160
Instance 4: Confidence=0.9043
tmp min: tensor(0.) tmp max: tensor(1.)
530 116 540 960
There are 15 prompts
current IoU is: 0.9048090577125549
Seok, iteration idx= 21 IoU = tensor(0.9048)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.1ms
Speed: 2.5ms preprocess, 22.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 7
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9479
Instance 2: Confidence=0.9307
Instance 3: Confidence=0.9156
Instance 4: Confidence=0.8290
Instance 5: Confidence=0.7404
Instance 6: Confidence=0.3328
tmp min: tensor(0.) tmp max: tensor(1.)
540 120 540 960
There are 18 prompts
current IoU is: 0.8765300512313843
Seok, iteration idx= 22 IoU = tensor(0.8765)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.5ms
Speed: 1.7ms preprocess, 24.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 7
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9400
Instance 2: Confidence=0.9397
Instance 3: Confidence=0.8820
Instance 4: Confidence=0.8574
Instance 5: Confidence=0.5968
Instance 6: Confidence=0.3960
tmp min: tensor(0.) tmp max: tensor(1.)
573 96 540 960
There are 17 prompts
current IoU is: 0.8560196161270142
Seok, iteration idx= 23 IoU = tensor(0.8560)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9562
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.9215
Instance 3: Confidence=0.8554
Instance 4: Confidence=0.7123
tmp min: tensor(0.) tmp max: tensor(1.)
574 20 540 960
There are 17 prompts
current IoU is: 0.0018511444795876741
Seok, iteration idx= 24 IoU = tensor(0.0019)
SKIP, unacceptable sam prediction, IoU is tensor(0.0019)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9559
Instance 1: Confidence=0.9326
Instance 2: Confidence=0.9255
Instance 3: Confidence=0.8958
Instance 4: Confidence=0.8174
Instance 5: Confidence=0.2734
tmp min: tensor(0.) tmp max: tensor(1.)
623 80 540 960
There are 18 prompts
current IoU is: 0.8186391592025757
Seok, iteration idx= 25 IoU = tensor(0.8186)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.5ms
Speed: 1.5ms preprocess, 24.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9356
Instance 2: Confidence=0.9105
Instance 3: Confidence=0.8693
Instance 4: Confidence=0.7860
Instance 5: Confidence=0.4345
Instance 6: Confidence=0.2986
tmp min: tensor(0.) tmp max: tensor(1.)
644 68 540 960
There are 15 prompts
current IoU is: 0.8802512884140015
Seok, iteration idx= 26 IoU = tensor(0.8803)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.6ms preprocess, 22.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9608
Instance 1: Confidence=0.9245
Instance 2: Confidence=0.9014
Instance 3: Confidence=0.8902
Instance 4: Confidence=0.8448
tmp min: tensor(0.) tmp max: tensor(1.)
665 68 540 960
There are 16 prompts
current IoU is: 0.8936843872070312
Seok, iteration idx= 27 IoU = tensor(0.8937)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 8
Instance 0: Confidence=0.9628
Instance 1: Confidence=0.9444
Instance 2: Confidence=0.9268
Instance 3: Confidence=0.9250
Instance 4: Confidence=0.9162
Instance 5: Confidence=0.8189
Instance 6: Confidence=0.3158
Instance 7: Confidence=0.2605
tmp min: tensor(0.) tmp max: tensor(1.)
681 76 540 960
There are 16 prompts
current IoU is: 0.8946196436882019
Seok, iteration idx= 28 IoU = tensor(0.8946)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 1.6ms preprocess, 22.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9530
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.8797
Instance 4: Confidence=0.8281
Instance 5: Confidence=0.7251
tmp min: tensor(0.) tmp max: tensor(1.)
707 80 540 960
There are 16 prompts
current IoU is: 0.8592638969421387
Seok, iteration idx= 29 IoU = tensor(0.8593)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 4
Instance 0: Confidence=0.9523
Instance 1: Confidence=0.9468
Instance 2: Confidence=0.9161
Instance 3: Confidence=0.8821
tmp min: tensor(0.) tmp max: tensor(1.)
691 80 540 960
There are 16 prompts
current IoU is: 0.00281343050301075
Seok, iteration idx= 30 IoU = tensor(0.0028)
SKIP, unacceptable sam prediction, IoU is tensor(0.0028)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 3.3ms preprocess, 23.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9327
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9102
Instance 3: Confidence=0.8415
Instance 4: Confidence=0.7714
tmp min: tensor(0.) tmp max: tensor(1.)
690 132 540 960
There are 19 prompts
current IoU is: 0.7066750526428223
Seok, iteration idx= 31 IoU = tensor(0.7067)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set9_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set9_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:38<00:00,  1.22s/it]
Testing psnr 27.148047611117363 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set9_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.16it/s]
Testing psnr 2.9573485907167196 (avg)
train: coarse segmentation in 00:03:57
train: finish (eps time 00:03:57 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set9_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1001, in load_tensor
    wrap_storage=restore_location(storage, location),
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 175, in default_restore_location
    result = fn(storage, location)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 157, in _cuda_deserialize
    return obj.cuda(device)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/_utils.py", line 78, in _cuda
    return torch._UntypedStorage(self.size(), device=torch.device('cuda')).copy_(self, non_blocking)
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set10/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 45.66it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set10 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set10
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set10_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 2.7ms preprocess, 20.0ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.5ms
Speed: 1.2ms preprocess, 19.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.3ms
Speed: 1.5ms preprocess, 19.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.8ms
Speed: 1.3ms preprocess, 19.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.0ms
Speed: 1.3ms preprocess, 20.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 19.7ms
Speed: 1.2ms preprocess, 19.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.9ms
Speed: 1.4ms preprocess, 20.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.4ms
Speed: 1.6ms preprocess, 19.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.6ms
Speed: 1.4ms preprocess, 19.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.5ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.5ms preprocess, 18.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.9ms
Speed: 1.5ms preprocess, 18.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.2ms
Speed: 1.4ms preprocess, 19.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.0ms
Speed: 1.5ms preprocess, 19.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.1ms
Speed: 1.5ms preprocess, 19.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.2ms
Speed: 1.5ms preprocess, 20.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.4ms preprocess, 18.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.4ms
Speed: 1.6ms preprocess, 19.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.2ms
Speed: 1.5ms preprocess, 19.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.5ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 20.3ms
Speed: 1.7ms preprocess, 20.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.8ms
Speed: 1.6ms preprocess, 20.8ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9428
Instance 1: Confidence=0.9198
Instance 2: Confidence=0.8951
Instance 3: Confidence=0.8149
Instance 4: Confidence=0.7098
Instance 5: Confidence=0.4333
Selected instance: 2 (Confidence: 0.8951)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

333 60 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.8686214089393616
Seok, iteration idx= 1 IoU = tensor(0.8686)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.3ms
Speed: 1.7ms preprocess, 23.3ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 8
Instance 0: Confidence=0.9484
Instance 1: Confidence=0.9271
Instance 2: Confidence=0.9025
Instance 3: Confidence=0.7065
Instance 4: Confidence=0.5530
Instance 5: Confidence=0.4350
Instance 6: Confidence=0.2934
Instance 7: Confidence=0.2923
Selected instance: 2 (Confidence: 0.9025)
tmp min: tensor(0.) tmp max: tensor(1.)
340 80 540 960
There are 17 prompts
current IoU is: 0.8117430210113525
Seok, iteration idx= 2 IoU = tensor(0.8117)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.8ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9401
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.7368
Instance 4: Confidence=0.3522
Selected instance: 2 (Confidence: 0.9104)
tmp min: tensor(0.) tmp max: tensor(1.)
352 116 540 960
There are 18 prompts
current IoU is: 0.8428933024406433
Seok, iteration idx= 3 IoU = tensor(0.8429)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.9ms
Speed: 1.7ms preprocess, 24.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9338
Instance 1: Confidence=0.9123
Instance 2: Confidence=0.8407
Instance 3: Confidence=0.4946
Instance 4: Confidence=0.4087
Instance 5: Confidence=0.3586
Selected instance: 5 (Confidence: 0.3586)
tmp min: tensor(0.) tmp max: tensor(1.)
674 96 540 960
There are 15 prompts
current IoU is: 0.15249134600162506
Seok, iteration idx= 4 IoU = tensor(0.1525)
SKIP, unacceptable sam prediction, IoU is tensor(0.1525)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.8207
Instance 3: Confidence=0.7721
Instance 4: Confidence=0.7155
Selected instance: 2 (Confidence: 0.8207)
tmp min: tensor(0.) tmp max: tensor(1.)
610 52 540 960
There are 15 prompts
current IoU is: 0.413840651512146
Seok, iteration idx= 5 IoU = tensor(0.4138)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.7ms preprocess, 23.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9373
Instance 1: Confidence=0.9227
Instance 2: Confidence=0.8916
Instance 3: Confidence=0.8082
Instance 4: Confidence=0.3235
Selected instance: 2 (Confidence: 0.8916)
tmp min: tensor(0.) tmp max: tensor(1.)
594 84 540 960
There are 19 prompts
current IoU is: 0.7583925724029541
Seok, iteration idx= 6 IoU = tensor(0.7584)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 1.7ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9313
Instance 1: Confidence=0.8929
Instance 2: Confidence=0.8629
Instance 3: Confidence=0.8365
Instance 4: Confidence=0.7943
Instance 5: Confidence=0.7689
Instance 6: Confidence=0.3691
Selected instance: 1 (Confidence: 0.8929)
tmp min: tensor(0.) tmp max: tensor(1.)
602 44 540 960
There are 14 prompts
current IoU is: 0.7187412977218628
Seok, iteration idx= 7 IoU = tensor(0.7187)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9403
Instance 1: Confidence=0.9039
Instance 2: Confidence=0.8857
Instance 3: Confidence=0.8587
Instance 4: Confidence=0.7733
Selected instance: 1 (Confidence: 0.9039)
tmp min: tensor(0.) tmp max: tensor(1.)
584 44 540 960
There are 14 prompts
current IoU is: 0.7833948731422424
Seok, iteration idx= 8 IoU = tensor(0.7834)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.5ms
Speed: 1.6ms preprocess, 22.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 8
Instance 0: Confidence=0.9461
Instance 1: Confidence=0.9275
Instance 2: Confidence=0.9187
Instance 3: Confidence=0.7332
Instance 4: Confidence=0.5451
Instance 5: Confidence=0.3224
Instance 6: Confidence=0.3072
Instance 7: Confidence=0.2709
Selected instance: 1 (Confidence: 0.9275)
tmp min: tensor(0.) tmp max: tensor(1.)
577 12 540 960
There are 14 prompts
current IoU is: 0.9384967088699341
Seok, iteration idx= 9 IoU = tensor(0.9385)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.6ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9400
Instance 2: Confidence=0.8922
Instance 3: Confidence=0.7839
Instance 4: Confidence=0.7346
Instance 5: Confidence=0.6675
Selected instance: 1 (Confidence: 0.9400)
tmp min: tensor(0.) tmp max: tensor(1.)
543 24 540 960
There are 16 prompts
current IoU is: 0.8992721438407898
Seok, iteration idx= 10 IoU = tensor(0.8993)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.7ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9128
Instance 2: Confidence=0.8616
Instance 3: Confidence=0.7378
Instance 4: Confidence=0.4551
Selected instance: 0 (Confidence: 0.9489)
tmp min: tensor(0.) tmp max: tensor(1.)
559 8 540 960
There are 14 prompts
current IoU is: 0.9568275213241577
Seok, iteration idx= 11 IoU = tensor(0.9568)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 2.8ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9553
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.8795
Instance 3: Confidence=0.5983
Instance 4: Confidence=0.4742
Selected instance: 0 (Confidence: 0.9553)
tmp min: tensor(0.) tmp max: tensor(1.)
538 0 540 960
There are 14 prompts
current IoU is: 0.9681678414344788
Seok, iteration idx= 12 IoU = tensor(0.9682)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.9ms
Speed: 3.2ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 8
Instance 0: Confidence=0.9589
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.8897
Instance 3: Confidence=0.8221
Instance 4: Confidence=0.7976
Instance 5: Confidence=0.7491
Instance 6: Confidence=0.3801
Instance 7: Confidence=0.2839
Selected instance: 0 (Confidence: 0.9589)
tmp min: tensor(0.) tmp max: tensor(1.)
490 32 540 960
There are 15 prompts
current IoU is: 0.9563669562339783
Seok, iteration idx= 13 IoU = tensor(0.9564)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 3.0ms preprocess, 22.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9545
Instance 1: Confidence=0.9200
Instance 2: Confidence=0.8959
Instance 3: Confidence=0.8240
Instance 4: Confidence=0.8171
Instance 5: Confidence=0.3278
Selected instance: 0 (Confidence: 0.9545)
tmp min: tensor(0.) tmp max: tensor(1.)
468 0 540 960
There are 13 prompts
current IoU is: 0.9607825875282288
Seok, iteration idx= 14 IoU = tensor(0.9608)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 3.4ms preprocess, 22.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9534
Instance 1: Confidence=0.9170
Instance 2: Confidence=0.9081
Instance 3: Confidence=0.7840
Instance 4: Confidence=0.7586
Selected instance: 0 (Confidence: 0.9534)
tmp min: tensor(0.) tmp max: tensor(1.)
443 20 540 960
There are 14 prompts
current IoU is: 0.959376335144043
Seok, iteration idx= 15 IoU = tensor(0.9594)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 3.0ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9128
Instance 2: Confidence=0.9021
Instance 3: Confidence=0.7538
Instance 4: Confidence=0.6958
Instance 5: Confidence=0.4477
Selected instance: 0 (Confidence: 0.9436)
tmp min: tensor(0.) tmp max: tensor(1.)
400 104 540 960
There are 13 prompts
current IoU is: 0.9374112486839294
Seok, iteration idx= 16 IoU = tensor(0.9374)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.5ms
Speed: 3.0ms preprocess, 24.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9349
Instance 2: Confidence=0.8948
Instance 3: Confidence=0.8225
Instance 4: Confidence=0.7823
Selected instance: 1 (Confidence: 0.9349)
tmp min: tensor(0.) tmp max: tensor(1.)
375 72 540 960
There are 15 prompts
current IoU is: 0.9333522319793701
Seok, iteration idx= 17 IoU = tensor(0.9334)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 1.5ms preprocess, 24.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9343
Instance 1: Confidence=0.9156
Instance 2: Confidence=0.8866
Instance 3: Confidence=0.8747
Instance 4: Confidence=0.7347
Instance 5: Confidence=0.5717
Selected instance: 1 (Confidence: 0.9156)
tmp min: tensor(0.) tmp max: tensor(1.)
354 76 540 960
There are 15 prompts
current IoU is: 0.9534097909927368
Seok, iteration idx= 18 IoU = tensor(0.9534)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9327
Instance 2: Confidence=0.8889
Instance 3: Confidence=0.8410
Instance 4: Confidence=0.7670
Instance 5: Confidence=0.3930
Instance 6: Confidence=0.3173
Selected instance: 1 (Confidence: 0.9327)
tmp min: tensor(0.) tmp max: tensor(1.)
354 40 540 960
There are 13 prompts
current IoU is: 0.9577106833457947
Seok, iteration idx= 19 IoU = tensor(0.9577)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9357
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.8987
Instance 3: Confidence=0.8981
Instance 4: Confidence=0.8441
Instance 5: Confidence=0.7465
Selected instance: 5 (Confidence: 0.7465)
tmp min: tensor(0.) tmp max: tensor(1.)
534 92 540 960
There are 14 prompts
current IoU is: 0.466356098651886
Seok, iteration idx= 20 IoU = tensor(0.4664)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.4ms
Speed: 1.6ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9505
Instance 1: Confidence=0.9323
Instance 2: Confidence=0.8850
Instance 3: Confidence=0.8476
Instance 4: Confidence=0.6034
Instance 5: Confidence=0.3047
Selected instance: 4 (Confidence: 0.6034)
tmp min: tensor(0.) tmp max: tensor(1.)
418 64 540 960
There are 19 prompts
current IoU is: 0.015245283022522926
Seok, iteration idx= 21 IoU = tensor(0.0152)
SKIP, unacceptable sam prediction, IoU is tensor(0.0152)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 1.6ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 7
Instance 0: Confidence=0.9535
Instance 1: Confidence=0.9077
Instance 2: Confidence=0.8941
Instance 3: Confidence=0.7788
Instance 4: Confidence=0.7653
Instance 5: Confidence=0.6566
Instance 6: Confidence=0.4216
Selected instance: 5 (Confidence: 0.6566)
tmp min: tensor(0.) tmp max: tensor(1.)
601 57 540 960
There are 18 prompts
current IoU is: 0.8196765780448914
Seok, iteration idx= 22 IoU = tensor(0.8197)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 1.7ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 7
Instance 0: Confidence=0.9425
Instance 1: Confidence=0.9028
Instance 2: Confidence=0.8830
Instance 3: Confidence=0.8673
Instance 4: Confidence=0.8513
Instance 5: Confidence=0.6991
Instance 6: Confidence=0.4623
Selected instance: 2 (Confidence: 0.8830)
tmp min: tensor(0.) tmp max: tensor(1.)
566 56 540 960
There are 16 prompts
current IoU is: 0.8356935977935791
Seok, iteration idx= 23 IoU = tensor(0.8357)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.2ms
Speed: 1.7ms preprocess, 21.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9449
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9027
Instance 3: Confidence=0.8698
Instance 4: Confidence=0.7552
Instance 5: Confidence=0.5370
Selected instance: 2 (Confidence: 0.9027)
tmp min: tensor(0.) tmp max: tensor(1.)
586 32 540 960
There are 18 prompts
current IoU is: 0.8090683221817017
Seok, iteration idx= 24 IoU = tensor(0.8091)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 2.7ms preprocess, 22.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9103
Instance 2: Confidence=0.9077
Instance 3: Confidence=0.8864
Instance 4: Confidence=0.3265
Selected instance: 3 (Confidence: 0.8864)
tmp min: tensor(0.) tmp max: tensor(1.)
616 32 540 960
There are 17 prompts
current IoU is: 0.8398994207382202
Seok, iteration idx= 25 IoU = tensor(0.8399)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.7ms preprocess, 24.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9350
Instance 1: Confidence=0.9340
Instance 2: Confidence=0.8964
Instance 3: Confidence=0.8023
Instance 4: Confidence=0.4329
Selected instance: 3 (Confidence: 0.8023)
tmp min: tensor(0.) tmp max: tensor(1.)
605 24 540 960
There are 19 prompts
current IoU is: 0.6268666386604309
Seok, iteration idx= 26 IoU = tensor(0.6269)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.6ms
Speed: 1.4ms preprocess, 24.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 4
Instance 0: Confidence=0.9348
Instance 1: Confidence=0.9073
Instance 2: Confidence=0.9057
Instance 3: Confidence=0.7642
Selected instance: 0 (Confidence: 0.9348)
tmp min: tensor(0.) tmp max: tensor(1.)
606 0 540 960
There are 15 prompts
current IoU is: 0.025938794016838074
Seok, iteration idx= 27 IoU = tensor(0.0259)
SKIP, unacceptable sam prediction, IoU is tensor(0.0259)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 3.1ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9387
Instance 1: Confidence=0.9300
Instance 2: Confidence=0.9169
Instance 3: Confidence=0.6203
Instance 4: Confidence=0.5186
Instance 5: Confidence=0.2775
Selected instance: 1 (Confidence: 0.9300)
tmp min: tensor(0.) tmp max: tensor(1.)
355 20 540 960
There are 14 prompts
current IoU is: 0.8989769816398621
Seok, iteration idx= 28 IoU = tensor(0.8990)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.5ms
Speed: 3.0ms preprocess, 22.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 8
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9200
Instance 2: Confidence=0.9052
Instance 3: Confidence=0.5757
Instance 4: Confidence=0.3700
Instance 5: Confidence=0.3422
Instance 6: Confidence=0.3060
Instance 7: Confidence=0.2816
Selected instance: 1 (Confidence: 0.9200)
tmp min: tensor(0.) tmp max: tensor(1.)
325 28 540 960
There are 14 prompts
current IoU is: 0.9483609199523926
Seok, iteration idx= 29 IoU = tensor(0.9484)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 2.4ms preprocess, 23.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9051
Instance 2: Confidence=0.9033
Instance 3: Confidence=0.8099
Instance 4: Confidence=0.2907
Selected instance: 2 (Confidence: 0.9033)
tmp min: tensor(0.) tmp max: tensor(1.)
325 20 540 960
There are 15 prompts
current IoU is: 0.9141450524330139
Seok, iteration idx= 30 IoU = tensor(0.9141)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 2.7ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9487
Instance 1: Confidence=0.9292
Instance 2: Confidence=0.8816
Instance 3: Confidence=0.8691
Instance 4: Confidence=0.7868
Instance 5: Confidence=0.2647
Selected instance: 1 (Confidence: 0.9292)
tmp min: tensor(0.) tmp max: tensor(1.)
313 24 540 960
There are 17 prompts
current IoU is: 0.938339114189148
Seok, iteration idx= 31 IoU = tensor(0.9383)
Selected Instance Confidence List: [tensor(0.9310), tensor(0.8792, device='cpu'), tensor(0.8480, device='cpu'), tensor(0.8699, device='cpu'), tensor(0.3832, device='cpu'), tensor(0.5766, device='cpu'), tensor(0.8117, device='cpu'), tensor(0.7884, device='cpu'), tensor(0.8316, device='cpu'), tensor(0.9341, device='cpu'), tensor(0.9155, device='cpu'), tensor(0.9537, device='cpu'), tensor(0.9630, device='cpu'), tensor(0.9574, device='cpu'), tensor(0.9583, device='cpu'), tensor(0.9570, device='cpu'), tensor(0.9399, device='cpu'), tensor(0.9340, device='cpu'), tensor(0.9383, device='cpu'), tensor(0.9477, device='cpu'), tensor(0.5784, device='cpu'), tensor(0.3825, device='cpu'), tensor(0.7545, device='cpu'), tensor(0.8546, device='cpu'), tensor(0.8465, device='cpu'), tensor(0.8585, device='cpu'), tensor(0.6970, device='cpu'), tensor(0.3895, device='cpu'), tensor(0.9114, device='cpu'), tensor(0.9370, device='cpu'), tensor(0.9098, device='cpu'), tensor(0.9347, device='cpu')]
Sorted Confidence Order: [tensor(0.9630, device='cpu'), tensor(0.9574, device='cpu'), tensor(0.9583, device='cpu'), tensor(0.9570, device='cpu'), tensor(0.9399, device='cpu'), tensor(0.9340, device='cpu'), tensor(0.9383, device='cpu'), tensor(0.9477, device='cpu'), tensor(0.9114, device='cpu'), tensor(0.9370, device='cpu'), tensor(0.9098, device='cpu'), tensor(0.9347, device='cpu'), tensor(0.9310), tensor(0.8792, device='cpu'), tensor(0.8480, device='cpu'), tensor(0.8699, device='cpu'), tensor(0.9537, device='cpu'), tensor(0.9155, device='cpu'), tensor(0.9341, device='cpu'), tensor(0.8316, device='cpu'), tensor(0.7884, device='cpu'), tensor(0.8117, device='cpu'), tensor(0.5766, device='cpu'), tensor(0.3832, device='cpu'), tensor(0.3895, device='cpu'), tensor(0.6970, device='cpu'), tensor(0.8585, device='cpu'), tensor(0.8465, device='cpu'), tensor(0.8546, device='cpu'), tensor(0.7545, device='cpu'), tensor(0.3825, device='cpu'), tensor(0.5784, device='cpu')]
sorted_indices: [12, 13, 14, 15, 16, 17, 18, 19, 28, 29, 30, 31, 0, 1, 2, 3, 11, 10, 9, 8, 7, 6, 5, 4, 27, 26, 25, 24, 23, 22, 21, 20]
Initial view (highest confidence): 13
New training order: [29, 30, 31, 32, 33, 34, 35, 36, 9, 10, 11, 12, 13, 14, 15, 16, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.0ms
Speed: 1.3ms preprocess, 20.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.5ms
Speed: 1.6ms preprocess, 23.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 8
Instance 0: Confidence=0.9589
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.8897
Instance 3: Confidence=0.8221
Instance 4: Confidence=0.7976
Instance 5: Confidence=0.7491
Instance 6: Confidence=0.3801
Instance 7: Confidence=0.2839
tmp min: tensor(0.) tmp max: tensor(1.)
490 32 540 960
There are 15 prompts
current IoU is: 0.9634318351745605
Seok, iteration idx= 1 IoU = tensor(0.9634)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.6ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9545
Instance 1: Confidence=0.9200
Instance 2: Confidence=0.8959
Instance 3: Confidence=0.8240
Instance 4: Confidence=0.8171
Instance 5: Confidence=0.3278
tmp min: tensor(0.) tmp max: tensor(1.)
468 0 540 960
There are 13 prompts
current IoU is: 0.9654169678688049
Seok, iteration idx= 2 IoU = tensor(0.9654)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 2.5ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9534
Instance 1: Confidence=0.9170
Instance 2: Confidence=0.9081
Instance 3: Confidence=0.7840
Instance 4: Confidence=0.7586
tmp min: tensor(0.) tmp max: tensor(1.)
443 20 540 960
There are 14 prompts
current IoU is: 0.9654009938240051
Seok, iteration idx= 3 IoU = tensor(0.9654)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.5ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9128
Instance 2: Confidence=0.9021
Instance 3: Confidence=0.7538
Instance 4: Confidence=0.6958
Instance 5: Confidence=0.4477
tmp min: tensor(0.) tmp max: tensor(1.)
400 104 540 960
There are 13 prompts
current IoU is: 0.9488869309425354
Seok, iteration idx= 4 IoU = tensor(0.9489)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 26.2ms
Speed: 1.5ms preprocess, 26.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9349
Instance 2: Confidence=0.8948
Instance 3: Confidence=0.8225
Instance 4: Confidence=0.7823
tmp min: tensor(0.) tmp max: tensor(1.)
375 72 540 960
There are 15 prompts
current IoU is: 0.956412136554718
Seok, iteration idx= 5 IoU = tensor(0.9564)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9343
Instance 1: Confidence=0.9156
Instance 2: Confidence=0.8866
Instance 3: Confidence=0.8747
Instance 4: Confidence=0.7347
Instance 5: Confidence=0.5717
tmp min: tensor(0.) tmp max: tensor(1.)
354 76 540 960
There are 15 prompts
current IoU is: 0.9634806513786316
Seok, iteration idx= 6 IoU = tensor(0.9635)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.5ms
Speed: 1.6ms preprocess, 24.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9327
Instance 2: Confidence=0.8889
Instance 3: Confidence=0.8410
Instance 4: Confidence=0.7670
Instance 5: Confidence=0.3930
Instance 6: Confidence=0.3173
tmp min: tensor(0.) tmp max: tensor(1.)
354 40 540 960
There are 13 prompts
current IoU is: 0.9613236784934998
Seok, iteration idx= 7 IoU = tensor(0.9613)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.8ms
Speed: 1.7ms preprocess, 24.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9387
Instance 1: Confidence=0.9300
Instance 2: Confidence=0.9169
Instance 3: Confidence=0.6203
Instance 4: Confidence=0.5186
Instance 5: Confidence=0.2775
tmp min: tensor(0.) tmp max: tensor(1.)
355 20 540 960
There are 14 prompts
current IoU is: 0.9066802263259888
Seok, iteration idx= 8 IoU = tensor(0.9067)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.3ms
Speed: 2.6ms preprocess, 24.3ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 8
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9200
Instance 2: Confidence=0.9052
Instance 3: Confidence=0.5757
Instance 4: Confidence=0.3700
Instance 5: Confidence=0.3422
Instance 6: Confidence=0.3060
Instance 7: Confidence=0.2816
tmp min: tensor(0.) tmp max: tensor(1.)
325 28 540 960
There are 14 prompts
current IoU is: 0.950494110584259
Seok, iteration idx= 9 IoU = tensor(0.9505)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9051
Instance 2: Confidence=0.9033
Instance 3: Confidence=0.8099
Instance 4: Confidence=0.2907
tmp min: tensor(0.) tmp max: tensor(1.)
325 20 540 960
There are 15 prompts
current IoU is: 0.9161795973777771
Seok, iteration idx= 10 IoU = tensor(0.9162)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9487
Instance 1: Confidence=0.9292
Instance 2: Confidence=0.8816
Instance 3: Confidence=0.8691
Instance 4: Confidence=0.7868
Instance 5: Confidence=0.2647
tmp min: tensor(0.) tmp max: tensor(1.)
313 24 540 960
There are 17 prompts
current IoU is: 0.9455211162567139
Seok, iteration idx= 11 IoU = tensor(0.9455)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 9
Instance 0: Confidence=0.9370
Instance 1: Confidence=0.9310
Instance 2: Confidence=0.9182
Instance 3: Confidence=0.7854
Instance 4: Confidence=0.6226
Instance 5: Confidence=0.5370
Instance 6: Confidence=0.5030
Instance 7: Confidence=0.4030
Instance 8: Confidence=0.3007
tmp min: tensor(0.) tmp max: tensor(1.)
315 40 540 960
There are 17 prompts
current IoU is: 0.952916145324707
Seok, iteration idx= 12 IoU = tensor(0.9529)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.1ms
Speed: 3.5ms preprocess, 22.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9428
Instance 1: Confidence=0.9198
Instance 2: Confidence=0.8951
Instance 3: Confidence=0.8149
Instance 4: Confidence=0.7098
Instance 5: Confidence=0.4333
tmp min: tensor(0.) tmp max: tensor(1.)
333 60 540 960
There are 16 prompts
current IoU is: 0.9306774139404297
Seok, iteration idx= 13 IoU = tensor(0.9307)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.2ms
Speed: 2.6ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 8
Instance 0: Confidence=0.9484
Instance 1: Confidence=0.9271
Instance 2: Confidence=0.9025
Instance 3: Confidence=0.7065
Instance 4: Confidence=0.5530
Instance 5: Confidence=0.4350
Instance 6: Confidence=0.2934
Instance 7: Confidence=0.2923
tmp min: tensor(0.) tmp max: tensor(1.)
340 80 540 960
There are 17 prompts
current IoU is: 0.8944145441055298
Seok, iteration idx= 14 IoU = tensor(0.8944)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 2.9ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9401
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.7368
Instance 4: Confidence=0.3522
tmp min: tensor(0.) tmp max: tensor(1.)
352 116 540 960
There are 18 prompts
current IoU is: 0.8781591653823853
Seok, iteration idx= 15 IoU = tensor(0.8782)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 3.3ms preprocess, 22.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9128
Instance 2: Confidence=0.8616
Instance 3: Confidence=0.7378
Instance 4: Confidence=0.4551
tmp min: tensor(0.) tmp max: tensor(1.)
559 8 540 960
There are 14 prompts
current IoU is: 0.9805731177330017
Seok, iteration idx= 16 IoU = tensor(0.9806)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 2.8ms preprocess, 22.7ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9400
Instance 2: Confidence=0.8922
Instance 3: Confidence=0.7839
Instance 4: Confidence=0.7346
Instance 5: Confidence=0.6675
tmp min: tensor(0.) tmp max: tensor(1.)
543 24 540 960
There are 16 prompts
current IoU is: 0.9600045084953308
Seok, iteration idx= 17 IoU = tensor(0.9600)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.7ms
Speed: 2.9ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 8
Instance 0: Confidence=0.9461
Instance 1: Confidence=0.9275
Instance 2: Confidence=0.9187
Instance 3: Confidence=0.7332
Instance 4: Confidence=0.5451
Instance 5: Confidence=0.3224
Instance 6: Confidence=0.3072
Instance 7: Confidence=0.2709
tmp min: tensor(0.) tmp max: tensor(1.)
577 12 540 960
There are 14 prompts
current IoU is: 0.958045482635498
Seok, iteration idx= 18 IoU = tensor(0.9580)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 2.9ms preprocess, 22.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9403
Instance 1: Confidence=0.9039
Instance 2: Confidence=0.8857
Instance 3: Confidence=0.8587
Instance 4: Confidence=0.7733
tmp min: tensor(0.) tmp max: tensor(1.)
584 44 540 960
There are 14 prompts
current IoU is: 0.9218728542327881
Seok, iteration idx= 19 IoU = tensor(0.9219)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 2.8ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 7
Instance 0: Confidence=0.9313
Instance 1: Confidence=0.8929
Instance 2: Confidence=0.8629
Instance 3: Confidence=0.8365
Instance 4: Confidence=0.7943
Instance 5: Confidence=0.7689
Instance 6: Confidence=0.3691
tmp min: tensor(0.) tmp max: tensor(1.)
602 44 540 960
There are 14 prompts
current IoU is: 0.9553054571151733
Seok, iteration idx= 20 IoU = tensor(0.9553)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 3.0ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9373
Instance 1: Confidence=0.9227
Instance 2: Confidence=0.8916
Instance 3: Confidence=0.8082
Instance 4: Confidence=0.3235
tmp min: tensor(0.) tmp max: tensor(1.)
594 84 540 960
There are 19 prompts
current IoU is: 0.9368040561676025
Seok, iteration idx= 21 IoU = tensor(0.9368)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.8ms
Speed: 2.8ms preprocess, 21.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.8207
Instance 3: Confidence=0.7721
Instance 4: Confidence=0.7155
tmp min: tensor(0.) tmp max: tensor(1.)
610 52 540 960
There are 15 prompts
current IoU is: 0.9234948754310608
Seok, iteration idx= 22 IoU = tensor(0.9235)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 3.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9338
Instance 1: Confidence=0.9123
Instance 2: Confidence=0.8407
Instance 3: Confidence=0.4946
Instance 4: Confidence=0.4087
Instance 5: Confidence=0.3586
tmp min: tensor(0.) tmp max: tensor(1.)
674 96 540 960
There are 15 prompts
current IoU is: 0.34789302945137024
Seok, iteration idx= 23 IoU = tensor(0.3479)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.3ms
Speed: 1.7ms preprocess, 24.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 4
Instance 0: Confidence=0.9348
Instance 1: Confidence=0.9073
Instance 2: Confidence=0.9057
Instance 3: Confidence=0.7642
tmp min: tensor(0.) tmp max: tensor(1.)
606 0 540 960
There are 15 prompts
current IoU is: 0.02526278980076313
Seok, iteration idx= 24 IoU = tensor(0.0253)
SKIP, unacceptable sam prediction, IoU is tensor(0.0253)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 4.1ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9350
Instance 1: Confidence=0.9340
Instance 2: Confidence=0.8964
Instance 3: Confidence=0.8023
Instance 4: Confidence=0.4329
tmp min: tensor(0.) tmp max: tensor(1.)
605 24 540 960
There are 19 prompts
current IoU is: 0.7970190048217773
Seok, iteration idx= 25 IoU = tensor(0.7970)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 1.5ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9103
Instance 2: Confidence=0.9077
Instance 3: Confidence=0.8864
Instance 4: Confidence=0.3265
tmp min: tensor(0.) tmp max: tensor(1.)
616 32 540 960
There are 17 prompts
current IoU is: 0.9207799434661865
Seok, iteration idx= 26 IoU = tensor(0.9208)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.6ms preprocess, 22.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9449
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9027
Instance 3: Confidence=0.8698
Instance 4: Confidence=0.7552
Instance 5: Confidence=0.5370
tmp min: tensor(0.) tmp max: tensor(1.)
586 32 540 960
There are 18 prompts
current IoU is: 0.899975597858429
Seok, iteration idx= 27 IoU = tensor(0.9000)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 7
Instance 0: Confidence=0.9425
Instance 1: Confidence=0.9028
Instance 2: Confidence=0.8830
Instance 3: Confidence=0.8673
Instance 4: Confidence=0.8513
Instance 5: Confidence=0.6991
Instance 6: Confidence=0.4623
tmp min: tensor(0.) tmp max: tensor(1.)
566 56 540 960
There are 16 prompts
current IoU is: 0.9101980328559875
Seok, iteration idx= 28 IoU = tensor(0.9102)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.9ms
Speed: 1.6ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9535
Instance 1: Confidence=0.9077
Instance 2: Confidence=0.8941
Instance 3: Confidence=0.7788
Instance 4: Confidence=0.7653
Instance 5: Confidence=0.6566
Instance 6: Confidence=0.4216
tmp min: tensor(0.) tmp max: tensor(1.)
601 57 540 960
There are 18 prompts
current IoU is: 0.8861923813819885
Seok, iteration idx= 29 IoU = tensor(0.8862)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 1.7ms preprocess, 22.7ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9505
Instance 1: Confidence=0.9323
Instance 2: Confidence=0.8850
Instance 3: Confidence=0.8476
Instance 4: Confidence=0.6034
Instance 5: Confidence=0.3047
tmp min: tensor(0.) tmp max: tensor(1.)
564 52 540 960
There are 16 prompts
current IoU is: 0.004478035494685173
Seok, iteration idx= 30 IoU = tensor(0.0045)
SKIP, unacceptable sam prediction, IoU is tensor(0.0045)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.3ms
Speed: 1.6ms preprocess, 25.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9357
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.8987
Instance 3: Confidence=0.8981
Instance 4: Confidence=0.8441
Instance 5: Confidence=0.7465
tmp min: tensor(0.) tmp max: tensor(1.)
534 92 540 960
There are 14 prompts
current IoU is: 0.5848774909973145
Seok, iteration idx= 31 IoU = tensor(0.5849)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set10_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set10_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.24s/it]
Testing psnr 27.642518803477287 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set10_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.14it/s]
Testing psnr 3.4275071509182453 (avg)
train: coarse segmentation in 00:11:02
train: finish (eps time 00:11:02 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set10_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set11/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 37.29it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set11 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set11
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set11_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.2ms
Speed: 2.6ms preprocess, 19.2ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.5ms
Speed: 1.3ms preprocess, 18.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.5ms
Speed: 1.3ms preprocess, 18.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.5ms
Speed: 1.2ms preprocess, 18.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.4ms
Speed: 1.3ms preprocess, 19.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.5ms
Speed: 1.3ms preprocess, 19.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.5ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.5ms
Speed: 1.2ms preprocess, 18.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.2ms
Speed: 1.5ms preprocess, 19.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.5ms
Speed: 1.2ms preprocess, 18.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.0ms
Speed: 2.2ms preprocess, 19.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.3ms
Speed: 1.7ms preprocess, 19.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.5ms
Speed: 1.3ms preprocess, 19.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.5ms
Speed: 1.2ms preprocess, 18.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 20.9ms
Speed: 3.0ms preprocess, 20.9ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 10
view_order: [11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.2ms
Speed: 2.3ms preprocess, 21.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9456
Instance 2: Confidence=0.9313
Instance 3: Confidence=0.8808
Instance 4: Confidence=0.8715
Instance 5: Confidence=0.8483
Selected instance: 0 (Confidence: 0.9457)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

746 24 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.7254754304885864
Seok, iteration idx= 1 IoU = tensor(0.7255)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.1ms
Speed: 3.3ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 7
Instance 0: Confidence=0.9597
Instance 1: Confidence=0.9420
Instance 2: Confidence=0.9354
Instance 3: Confidence=0.8429
Instance 4: Confidence=0.8336
Instance 5: Confidence=0.6522
Instance 6: Confidence=0.4532
Selected instance: 0 (Confidence: 0.9597)
tmp min: tensor(0.) tmp max: tensor(1.)
668 28 540 960
There are 16 prompts
current IoU is: 0.7452831268310547
Seok, iteration idx= 2 IoU = tensor(0.7453)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.7ms
Speed: 3.1ms preprocess, 20.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9577
Instance 1: Confidence=0.9560
Instance 2: Confidence=0.9503
Instance 3: Confidence=0.8193
Instance 4: Confidence=0.7426
Selected instance: 0 (Confidence: 0.9577)
tmp min: tensor(0.) tmp max: tensor(1.)
614 40 540 960
There are 16 prompts
current IoU is: 0.811326801776886
Seok, iteration idx= 3 IoU = tensor(0.8113)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.8ms
Speed: 4.5ms preprocess, 21.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9427
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9067
Instance 4: Confidence=0.8978
Instance 5: Confidence=0.6321
Selected instance: 1 (Confidence: 0.9427)
tmp min: tensor(0.) tmp max: tensor(1.)
542 64 540 960
current IoU is: 0.8197805881500244
Seok, iteration idx= 4 IoU = tensor(0.8198)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 3.5ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9471
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.9224
Instance 4: Confidence=0.8923
Selected instance: 0 (Confidence: 0.9471)
tmp min: tensor(0.) tmp max: tensor(1.)
492 104 540 960
There are 17 prompts
current IoU is: 0.8171731233596802
Seok, iteration idx= 5 IoU = tensor(0.8172)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 3.2ms preprocess, 22.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9479
Instance 2: Confidence=0.9416
Instance 3: Confidence=0.8988
Instance 4: Confidence=0.8421
Selected instance: 3 (Confidence: 0.8988)
tmp min: tensor(0.) tmp max: tensor(1.)
431 88 540 960
current IoU is: 0.3060947060585022
Seok, iteration idx= 6 IoU = tensor(0.3061)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.8ms
Speed: 2.9ms preprocess, 20.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9253
Instance 2: Confidence=0.8717
Instance 3: Confidence=0.8405
Instance 4: Confidence=0.5369
Instance 5: Confidence=0.3214
Instance 6: Confidence=0.2665
Selected instance: 5 (Confidence: 0.3214)
tmp min: tensor(0.) tmp max: tensor(1.)
423 92 540 960
There are 10 prompts
current IoU is: 0.1319115310907364
Seok, iteration idx= 7 IoU = tensor(0.1319)
SKIP, unacceptable sam prediction, IoU is tensor(0.1319)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9245
Instance 2: Confidence=0.9200
Instance 3: Confidence=0.7033
Instance 4: Confidence=0.6931
Selected instance: 0 (Confidence: 0.9519)
tmp min: tensor(0.) tmp max: tensor(1.)
419 40 540 960
There are 14 prompts
current IoU is: 0.0008226144127547741
Seok, iteration idx= 8 IoU = tensor(0.0008)
SKIP, unacceptable sam prediction, IoU is tensor(0.0008)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.7ms preprocess, 24.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9556
Instance 1: Confidence=0.9451
Instance 2: Confidence=0.9042
Instance 3: Confidence=0.7678
Instance 4: Confidence=0.6133
Instance 5: Confidence=0.3890
Selected instance: 3 (Confidence: 0.7678)
tmp min: tensor(0.) tmp max: tensor(1.)
510 80 540 960
There are 17 prompts
current IoU is: 0.52173912525177
Seok, iteration idx= 9 IoU = tensor(0.5217)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.7ms preprocess, 23.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9671
Instance 1: Confidence=0.9570
Instance 2: Confidence=0.9262
Instance 3: Confidence=0.8464
Instance 4: Confidence=0.6664
Selected instance: 4 (Confidence: 0.6664)
tmp min: tensor(0.) tmp max: tensor(1.)
555 100 540 960
There are 15 prompts
current IoU is: 0.22825150191783905
Seok, iteration idx= 10 IoU = tensor(0.2283)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9659
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9171
Instance 3: Confidence=0.8072
Instance 4: Confidence=0.7156
Instance 5: Confidence=0.4521
Instance 6: Confidence=0.3306
Selected instance: 6 (Confidence: 0.3306)
tmp min: tensor(0.) tmp max: tensor(1.)
590 68 540 960
There are 12 prompts
current IoU is: 0.19851045310497284
Seok, iteration idx= 11 IoU = tensor(0.1985)
SKIP, unacceptable sam prediction, IoU is tensor(0.1985)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 1.6ms preprocess, 23.4ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 7
Instance 0: Confidence=0.9631
Instance 1: Confidence=0.9326
Instance 2: Confidence=0.9224
Instance 3: Confidence=0.8920
Instance 4: Confidence=0.8891
Instance 5: Confidence=0.5450
Instance 6: Confidence=0.4295
Selected instance: 4 (Confidence: 0.8891)
tmp min: tensor(0.) tmp max: tensor(1.)
614 80 540 960
There are 17 prompts
current IoU is: 0.7205902934074402
Seok, iteration idx= 12 IoU = tensor(0.7206)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 2.1ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9710
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9314
Instance 3: Confidence=0.9307
Instance 4: Confidence=0.7829
Instance 5: Confidence=0.5400
Selected instance: 2 (Confidence: 0.9314)
tmp min: tensor(0.) tmp max: tensor(1.)
694 68 540 960
There are 14 prompts
current IoU is: 0.826960027217865
Seok, iteration idx= 13 IoU = tensor(0.8270)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.3ms
Speed: 3.1ms preprocess, 22.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 8
Instance 0: Confidence=0.9684
Instance 1: Confidence=0.9498
Instance 2: Confidence=0.9438
Instance 3: Confidence=0.8761
Instance 4: Confidence=0.7452
Instance 5: Confidence=0.5554
Instance 6: Confidence=0.4846
Instance 7: Confidence=0.4124
Selected instance: 3 (Confidence: 0.8761)
tmp min: tensor(0.) tmp max: tensor(1.)
749 44 540 960
There are 18 prompts
current IoU is: 0.829181969165802
Seok, iteration idx= 14 IoU = tensor(0.8292)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.6ms
Speed: 2.6ms preprocess, 22.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 7
Instance 0: Confidence=0.9550
Instance 1: Confidence=0.9468
Instance 2: Confidence=0.9211
Instance 3: Confidence=0.8658
Instance 4: Confidence=0.3527
Instance 5: Confidence=0.3313
Instance 6: Confidence=0.2660
Selected instance: 5 (Confidence: 0.3313)
tmp min: tensor(0.) tmp max: tensor(1.)
689 160 540 960
There are 14 prompts
current IoU is: 0.35298773646354675
Seok, iteration idx= 15 IoU = tensor(0.3530)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.9ms
Speed: 1.5ms preprocess, 20.9ms inference, 3.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9542
Instance 1: Confidence=0.9452
Instance 2: Confidence=0.8901
Instance 3: Confidence=0.8789
Instance 4: Confidence=0.8606
Instance 5: Confidence=0.7636
Selected instance: 3 (Confidence: 0.8789)
tmp min: tensor(0.) tmp max: tensor(1.)
767 52 540 960
There are 16 prompts
current IoU is: 0.7396130561828613
Seok, iteration idx= 16 IoU = tensor(0.7396)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9487
Instance 1: Confidence=0.9423
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.8932
Instance 4: Confidence=0.8345
Instance 5: Confidence=0.7952
Selected instance: 2 (Confidence: 0.9240)
tmp min: tensor(0.) tmp max: tensor(1.)
771 64 540 960
There are 13 prompts
current IoU is: 0.8923105597496033
Seok, iteration idx= 17 IoU = tensor(0.8923)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9577
Instance 1: Confidence=0.9502
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8409
Instance 4: Confidence=0.8097
Selected instance: 2 (Confidence: 0.9414)
tmp min: tensor(0.) tmp max: tensor(1.)
740 132 540 960
There are 14 prompts
current IoU is: 0.9153201580047607
Seok, iteration idx= 18 IoU = tensor(0.9153)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9568
Instance 1: Confidence=0.9337
Instance 2: Confidence=0.9183
Instance 3: Confidence=0.9098
Instance 4: Confidence=0.7857
Instance 5: Confidence=0.4356
Instance 6: Confidence=0.2723
Selected instance: 1 (Confidence: 0.9337)
tmp min: tensor(0.) tmp max: tensor(1.)
790 100 540 960
There are 17 prompts
current IoU is: 0.9167611002922058
Seok, iteration idx= 19 IoU = tensor(0.9168)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 1.6ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 7
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9389
Instance 2: Confidence=0.9162
Instance 3: Confidence=0.9079
Instance 4: Confidence=0.8868
Instance 5: Confidence=0.5165
Instance 6: Confidence=0.4232
Selected instance: 1 (Confidence: 0.9389)
tmp min: tensor(0.) tmp max: tensor(1.)
789 92 540 960
There are 15 prompts
current IoU is: 0.9181112051010132
Seok, iteration idx= 20 IoU = tensor(0.9181)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 7
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9321
Instance 2: Confidence=0.9290
Instance 3: Confidence=0.9221
Instance 4: Confidence=0.8640
Instance 5: Confidence=0.7488
Instance 6: Confidence=0.3407
Selected instance: 1 (Confidence: 0.9321)
tmp min: tensor(0.) tmp max: tensor(1.)
826 72 540 960
There are 15 prompts
current IoU is: 0.9270007014274597
Seok, iteration idx= 21 IoU = tensor(0.9270)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 2.4ms preprocess, 23.3ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9415
Instance 1: Confidence=0.9146
Instance 2: Confidence=0.9040
Instance 3: Confidence=0.8978
Instance 4: Confidence=0.8853
Instance 5: Confidence=0.3458
Selected instance: 4 (Confidence: 0.8853)
tmp min: tensor(0.) tmp max: tensor(1.)
253 104 540 960
There are 16 prompts
current IoU is: 0.6623653769493103
Seok, iteration idx= 22 IoU = tensor(0.6624)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 8
Instance 0: Confidence=0.9570
Instance 1: Confidence=0.9254
Instance 2: Confidence=0.9230
Instance 3: Confidence=0.9228
Instance 4: Confidence=0.9172
Instance 5: Confidence=0.5296
Instance 6: Confidence=0.4528
Instance 7: Confidence=0.3554
Selected instance: 4 (Confidence: 0.9172)
tmp min: tensor(0.) tmp max: tensor(1.)
259 92 540 960
There are 14 prompts
current IoU is: 0.7383487820625305
Seok, iteration idx= 23 IoU = tensor(0.7383)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9401
Instance 1: Confidence=0.9391
Instance 2: Confidence=0.9293
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9041
Instance 5: Confidence=0.8093
Selected instance: 3 (Confidence: 0.9217)
tmp min: tensor(0.) tmp max: tensor(1.)
273 84 540 960
There are 16 prompts
current IoU is: 0.7531106472015381
Seok, iteration idx= 24 IoU = tensor(0.7531)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.8ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9441
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9204
Instance 3: Confidence=0.8937
Instance 4: Confidence=0.8811
Instance 5: Confidence=0.6694
Selected instance: 3 (Confidence: 0.8937)
tmp min: tensor(0.) tmp max: tensor(1.)
266 84 540 960
There are 17 prompts
current IoU is: 0.7961044311523438
Seok, iteration idx= 25 IoU = tensor(0.7961)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 4
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9497
Instance 2: Confidence=0.9269
Instance 3: Confidence=0.9004
Selected instance: 3 (Confidence: 0.9004)
tmp min: tensor(0.) tmp max: tensor(1.)
567 76 540 960
There are 14 prompts
current IoU is: 0.001868915162049234
Seok, iteration idx= 26 IoU = tensor(0.0019)
SKIP, unacceptable sam prediction, IoU is tensor(0.0019)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.0ms
Speed: 2.6ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 8
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9354
Instance 2: Confidence=0.9341
Instance 3: Confidence=0.8591
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.6447
Instance 6: Confidence=0.4165
Instance 7: Confidence=0.2997
Selected instance: 5 (Confidence: 0.6447)
tmp min: tensor(0.) tmp max: tensor(1.)
355 76 540 960
There are 17 prompts
current IoU is: 0.2699761986732483
Seok, iteration idx= 27 IoU = tensor(0.2700)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9518
Instance 2: Confidence=0.9162
Instance 3: Confidence=0.8995
Instance 4: Confidence=0.8007
Instance 5: Confidence=0.7572
Selected instance: 4 (Confidence: 0.8007)
tmp min: tensor(0.) tmp max: tensor(1.)
349 68 540 960
There are 15 prompts
current IoU is: 0.8299270868301392
Seok, iteration idx= 28 IoU = tensor(0.8299)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 2.3ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9464
Instance 1: Confidence=0.9412
Instance 2: Confidence=0.9307
Instance 3: Confidence=0.8961
Instance 4: Confidence=0.8483
Selected instance: 3 (Confidence: 0.8961)
tmp min: tensor(0.) tmp max: tensor(1.)
360 72 540 960
There are 16 prompts
current IoU is: 0.8885337114334106
Seok, iteration idx= 29 IoU = tensor(0.8885)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.4ms
Speed: 1.7ms preprocess, 24.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9355
Instance 1: Confidence=0.9264
Instance 2: Confidence=0.9218
Instance 3: Confidence=0.8835
Instance 4: Confidence=0.8732
Instance 5: Confidence=0.7672
Instance 6: Confidence=0.3035
Selected instance: 0 (Confidence: 0.9355)
tmp min: tensor(0.) tmp max: tensor(1.)
824 48 540 960
There are 16 prompts
current IoU is: 0.9380192160606384
Seok, iteration idx= 30 IoU = tensor(0.9380)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9406
Instance 2: Confidence=0.9377
Instance 3: Confidence=0.8722
Instance 4: Confidence=0.2874
Selected instance: 1 (Confidence: 0.9406)
tmp min: tensor(0.) tmp max: tensor(1.)
804 40 540 960
There are 15 prompts
current IoU is: 0.8803747892379761
Seok, iteration idx= 31 IoU = tensor(0.8804)
Selected Instance Confidence List: [tensor(0.9334), tensor(0.8135, device='cpu'), tensor(0.8311, device='cpu'), tensor(0.8699, device='cpu'), tensor(0.8690, device='cpu'), tensor(0.8691, device='cpu'), tensor(0.5432, device='cpu'), tensor(0.3823, device='cpu'), tensor(0.3813, device='cpu'), tensor(0.6202, device='cpu'), tensor(0.4035, device='cpu'), tensor(0.3884, device='cpu'), tensor(0.7880, device='cpu'), tensor(0.8687, device='cpu'), tensor(0.8479, device='cpu'), tensor(0.3905, device='cpu'), tensor(0.7953, device='cpu'), tensor(0.9050, device='cpu'), tensor(0.9258, device='cpu'), tensor(0.9235, device='cpu'), tensor(0.9264, device='cpu'), tensor(0.9290, device='cpu'), tensor(0.7515, device='cpu'), tensor(0.8099, device='cpu'), tensor(0.8205, device='cpu'), tensor(0.8351, device='cpu'), tensor(0.3834, device='cpu'), tensor(0.4199, device='cpu'), tensor(0.8182, device='cpu'), tensor(0.8916, device='cpu'), tensor(0.9370, device='cpu'), tensor(0.9045, device='cpu')]
Sorted Confidence Order: [tensor(0.9370, device='cpu'), tensor(0.9045, device='cpu'), tensor(0.9334), tensor(0.8135, device='cpu'), tensor(0.8311, device='cpu'), tensor(0.8699, device='cpu'), tensor(0.8690, device='cpu'), tensor(0.8691, device='cpu'), tensor(0.9290, device='cpu'), tensor(0.9264, device='cpu'), tensor(0.9235, device='cpu'), tensor(0.9258, device='cpu'), tensor(0.9050, device='cpu'), tensor(0.7953, device='cpu'), tensor(0.3905, device='cpu'), tensor(0.8479, device='cpu'), tensor(0.8687, device='cpu'), tensor(0.7880, device='cpu'), tensor(0.3884, device='cpu'), tensor(0.4035, device='cpu'), tensor(0.6202, device='cpu'), tensor(0.3813, device='cpu'), tensor(0.3823, device='cpu'), tensor(0.5432, device='cpu'), tensor(0.8916, device='cpu'), tensor(0.8182, device='cpu'), tensor(0.4199, device='cpu'), tensor(0.3834, device='cpu'), tensor(0.8351, device='cpu'), tensor(0.8205, device='cpu'), tensor(0.8099, device='cpu'), tensor(0.7515, device='cpu')]
sorted_indices: [30, 31, 0, 1, 2, 3, 4, 5, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 29, 28, 27, 26, 25, 24, 23, 22]
Initial view (highest confidence): 35
New training order: [9, 10, 11, 12, 13, 14, 15, 16, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.1ms
Speed: 1.3ms preprocess, 21.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 3.3ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9406
Instance 2: Confidence=0.9377
Instance 3: Confidence=0.8722
Instance 4: Confidence=0.2874
tmp min: tensor(0.) tmp max: tensor(1.)
804 40 540 960
There are 15 prompts
current IoU is: 0.8758910298347473
Seok, iteration idx= 1 IoU = tensor(0.8759)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 23.3ms
Speed: 2.4ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 9
Instance 0: Confidence=0.9466
Instance 1: Confidence=0.9334
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.8262
Instance 4: Confidence=0.6424
Instance 5: Confidence=0.5983
Instance 6: Confidence=0.5834
Instance 7: Confidence=0.2999
Instance 8: Confidence=0.2600
tmp min: tensor(0.) tmp max: tensor(1.)
778 28 540 960
There are 15 prompts
current IoU is: 0.8714926838874817
Seok, iteration idx= 2 IoU = tensor(0.8715)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.6ms preprocess, 24.3ms inference, 4.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 6
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9456
Instance 2: Confidence=0.9313
Instance 3: Confidence=0.8808
Instance 4: Confidence=0.8715
Instance 5: Confidence=0.8483
tmp min: tensor(0.) tmp max: tensor(1.)
746 24 540 960
There are 16 prompts
current IoU is: 0.8944025039672852
Seok, iteration idx= 3 IoU = tensor(0.8944)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.7ms
Speed: 3.0ms preprocess, 22.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 7
Instance 0: Confidence=0.9597
Instance 1: Confidence=0.9420
Instance 2: Confidence=0.9354
Instance 3: Confidence=0.8429
Instance 4: Confidence=0.8336
Instance 5: Confidence=0.6522
Instance 6: Confidence=0.4532
tmp min: tensor(0.) tmp max: tensor(1.)
668 28 540 960
There are 16 prompts
current IoU is: 0.8549618124961853
Seok, iteration idx= 4 IoU = tensor(0.8550)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.1ms
Speed: 1.5ms preprocess, 21.1ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9577
Instance 1: Confidence=0.9560
Instance 2: Confidence=0.9503
Instance 3: Confidence=0.8193
Instance 4: Confidence=0.7426
tmp min: tensor(0.) tmp max: tensor(1.)
614 40 540 960
There are 16 prompts
current IoU is: 0.8700848817825317
Seok, iteration idx= 5 IoU = tensor(0.8701)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.0ms
Speed: 1.6ms preprocess, 21.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9427
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9067
Instance 4: Confidence=0.8978
Instance 5: Confidence=0.6321
tmp min: tensor(0.) tmp max: tensor(1.)
542 64 540 960
current IoU is: 0.881935715675354
Seok, iteration idx= 6 IoU = tensor(0.8819)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 1.6ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9471
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.9224
Instance 4: Confidence=0.8923
tmp min: tensor(0.) tmp max: tensor(1.)
492 104 540 960
There are 17 prompts
current IoU is: 0.8479719758033752
Seok, iteration idx= 7 IoU = tensor(0.8480)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 26.0ms
Speed: 1.6ms preprocess, 26.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9321
Instance 2: Confidence=0.9290
Instance 3: Confidence=0.9221
Instance 4: Confidence=0.8640
Instance 5: Confidence=0.7488
Instance 6: Confidence=0.3407
tmp min: tensor(0.) tmp max: tensor(1.)
826 72 540 960
There are 15 prompts
current IoU is: 0.9376951456069946
Seok, iteration idx= 8 IoU = tensor(0.9377)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 2.6ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 7
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9389
Instance 2: Confidence=0.9162
Instance 3: Confidence=0.9079
Instance 4: Confidence=0.8868
Instance 5: Confidence=0.5165
Instance 6: Confidence=0.4232
tmp min: tensor(0.) tmp max: tensor(1.)
789 92 540 960
There are 15 prompts
current IoU is: 0.93267422914505
Seok, iteration idx= 9 IoU = tensor(0.9327)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.5ms
Speed: 1.6ms preprocess, 24.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 7
Instance 0: Confidence=0.9568
Instance 1: Confidence=0.9337
Instance 2: Confidence=0.9183
Instance 3: Confidence=0.9098
Instance 4: Confidence=0.7857
Instance 5: Confidence=0.4356
Instance 6: Confidence=0.2723
tmp min: tensor(0.) tmp max: tensor(1.)
790 100 540 960
There are 17 prompts
current IoU is: 0.938683807849884
Seok, iteration idx= 10 IoU = tensor(0.9387)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.5ms
Speed: 1.6ms preprocess, 25.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9577
Instance 1: Confidence=0.9502
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8409
Instance 4: Confidence=0.8097
tmp min: tensor(0.) tmp max: tensor(1.)
740 132 540 960
There are 14 prompts
current IoU is: 0.9249919056892395
Seok, iteration idx= 11 IoU = tensor(0.9250)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.6ms
Speed: 1.5ms preprocess, 24.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9487
Instance 1: Confidence=0.9423
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.8932
Instance 4: Confidence=0.8345
Instance 5: Confidence=0.7952
tmp min: tensor(0.) tmp max: tensor(1.)
771 64 540 960
There are 13 prompts
current IoU is: 0.9087285399436951
Seok, iteration idx= 12 IoU = tensor(0.9087)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9542
Instance 1: Confidence=0.9452
Instance 2: Confidence=0.8901
Instance 3: Confidence=0.8789
Instance 4: Confidence=0.8606
Instance 5: Confidence=0.7636
tmp min: tensor(0.) tmp max: tensor(1.)
767 52 540 960
There are 16 prompts
current IoU is: 0.8253369927406311
Seok, iteration idx= 13 IoU = tensor(0.8253)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 1.6ms preprocess, 22.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9550
Instance 1: Confidence=0.9468
Instance 2: Confidence=0.9211
Instance 3: Confidence=0.8658
Instance 4: Confidence=0.3527
Instance 5: Confidence=0.3313
Instance 6: Confidence=0.2660
tmp min: tensor(0.) tmp max: tensor(1.)
689 160 540 960
There are 14 prompts
current IoU is: 0.5081577897071838
Seok, iteration idx= 14 IoU = tensor(0.5082)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 8
Instance 0: Confidence=0.9684
Instance 1: Confidence=0.9498
Instance 2: Confidence=0.9438
Instance 3: Confidence=0.8761
Instance 4: Confidence=0.7452
Instance 5: Confidence=0.5554
Instance 6: Confidence=0.4846
Instance 7: Confidence=0.4124
tmp min: tensor(0.) tmp max: tensor(1.)
749 44 540 960
There are 18 prompts
current IoU is: 0.8605200052261353
Seok, iteration idx= 15 IoU = tensor(0.8605)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.9ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9710
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9314
Instance 3: Confidence=0.9307
Instance 4: Confidence=0.7829
Instance 5: Confidence=0.5400
tmp min: tensor(0.) tmp max: tensor(1.)
694 68 540 960
There are 14 prompts
current IoU is: 0.9054244756698608
Seok, iteration idx= 16 IoU = tensor(0.9054)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.0ms
Speed: 3.0ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 7
Instance 0: Confidence=0.9631
Instance 1: Confidence=0.9326
Instance 2: Confidence=0.9224
Instance 3: Confidence=0.8920
Instance 4: Confidence=0.8891
Instance 5: Confidence=0.5450
Instance 6: Confidence=0.4295
tmp min: tensor(0.) tmp max: tensor(1.)
614 80 540 960
There are 17 prompts
current IoU is: 0.8874685764312744
Seok, iteration idx= 17 IoU = tensor(0.8875)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.5ms
Speed: 3.5ms preprocess, 22.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 7
Instance 0: Confidence=0.9659
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9171
Instance 3: Confidence=0.8072
Instance 4: Confidence=0.7156
Instance 5: Confidence=0.4521
Instance 6: Confidence=0.3306
tmp min: tensor(0.) tmp max: tensor(1.)
590 68 540 960
There are 12 prompts
current IoU is: 0.2907075881958008
Seok, iteration idx= 18 IoU = tensor(0.2907)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 2.5ms preprocess, 23.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9671
Instance 1: Confidence=0.9570
Instance 2: Confidence=0.9262
Instance 3: Confidence=0.8464
Instance 4: Confidence=0.6664
tmp min: tensor(0.) tmp max: tensor(1.)
555 100 540 960
There are 15 prompts
current IoU is: 0.5493767857551575
Seok, iteration idx= 19 IoU = tensor(0.5494)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 4.0ms preprocess, 22.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9556
Instance 1: Confidence=0.9451
Instance 2: Confidence=0.9042
Instance 3: Confidence=0.7678
Instance 4: Confidence=0.6133
Instance 5: Confidence=0.3890
tmp min: tensor(0.) tmp max: tensor(1.)
510 80 540 960
There are 17 prompts
current IoU is: 0.7953940033912659
Seok, iteration idx= 20 IoU = tensor(0.7954)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 2.6ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9245
Instance 2: Confidence=0.9200
Instance 3: Confidence=0.7033
Instance 4: Confidence=0.6931
tmp min: tensor(0.) tmp max: tensor(1.)
419 40 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 21 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.9ms
Speed: 1.6ms preprocess, 24.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 7
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9253
Instance 2: Confidence=0.8717
Instance 3: Confidence=0.8405
Instance 4: Confidence=0.5369
Instance 5: Confidence=0.3214
Instance 6: Confidence=0.2665
tmp min: tensor(0.) tmp max: tensor(1.)
423 92 540 960
There are 10 prompts
current IoU is: 0.4021163880825043
Seok, iteration idx= 22 IoU = tensor(0.4021)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9479
Instance 2: Confidence=0.9416
Instance 3: Confidence=0.8988
Instance 4: Confidence=0.8421
tmp min: tensor(0.) tmp max: tensor(1.)
431 88 540 960
current IoU is: 0.6366999745368958
Seok, iteration idx= 23 IoU = tensor(0.6367)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.8ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9464
Instance 1: Confidence=0.9412
Instance 2: Confidence=0.9307
Instance 3: Confidence=0.8961
Instance 4: Confidence=0.8483
tmp min: tensor(0.) tmp max: tensor(1.)
360 72 540 960
There are 16 prompts
current IoU is: 0.9145413637161255
Seok, iteration idx= 24 IoU = tensor(0.9145)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9518
Instance 2: Confidence=0.9162
Instance 3: Confidence=0.8995
Instance 4: Confidence=0.8007
Instance 5: Confidence=0.7572
tmp min: tensor(0.) tmp max: tensor(1.)
349 68 540 960
There are 15 prompts
current IoU is: 0.8380230665206909
Seok, iteration idx= 25 IoU = tensor(0.8380)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.8ms
Speed: 1.6ms preprocess, 22.8ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 8
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9354
Instance 2: Confidence=0.9341
Instance 3: Confidence=0.8591
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.6447
Instance 6: Confidence=0.4165
Instance 7: Confidence=0.2997
tmp min: tensor(0.) tmp max: tensor(1.)
355 76 540 960
There are 17 prompts
current IoU is: 0.3658682703971863
Seok, iteration idx= 26 IoU = tensor(0.3659)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 4
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9497
Instance 2: Confidence=0.9269
Instance 3: Confidence=0.9004
tmp min: tensor(0.) tmp max: tensor(1.)
288 8 540 960
There are 14 prompts
current IoU is: 0.00033341668313369155
Seok, iteration idx= 27 IoU = tensor(0.0003)
SKIP, unacceptable sam prediction, IoU is tensor(0.0003)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9441
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9204
Instance 3: Confidence=0.8937
Instance 4: Confidence=0.8811
Instance 5: Confidence=0.6694
tmp min: tensor(0.) tmp max: tensor(1.)
266 84 540 960
There are 17 prompts
current IoU is: 0.8152703046798706
Seok, iteration idx= 28 IoU = tensor(0.8153)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9401
Instance 1: Confidence=0.9391
Instance 2: Confidence=0.9293
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9041
Instance 5: Confidence=0.8093
tmp min: tensor(0.) tmp max: tensor(1.)
273 84 540 960
There are 16 prompts
current IoU is: 0.8435982465744019
Seok, iteration idx= 29 IoU = tensor(0.8436)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 8
Instance 0: Confidence=0.9570
Instance 1: Confidence=0.9254
Instance 2: Confidence=0.9230
Instance 3: Confidence=0.9228
Instance 4: Confidence=0.9172
Instance 5: Confidence=0.5296
Instance 6: Confidence=0.4528
Instance 7: Confidence=0.3554
tmp min: tensor(0.) tmp max: tensor(1.)
259 92 540 960
There are 14 prompts
current IoU is: 0.8357509970664978
Seok, iteration idx= 30 IoU = tensor(0.8358)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9415
Instance 1: Confidence=0.9146
Instance 2: Confidence=0.9040
Instance 3: Confidence=0.8978
Instance 4: Confidence=0.8853
Instance 5: Confidence=0.3458
tmp min: tensor(0.) tmp max: tensor(1.)
253 104 540 960
There are 16 prompts
current IoU is: 0.751945972442627
Seok, iteration idx= 31 IoU = tensor(0.7519)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set11_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set11_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:40<00:00,  1.25s/it]
Testing psnr 26.62242643535137 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set11_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.17it/s]
Testing psnr 3.1270953733474016 (avg)
train: coarse segmentation in 11:48:37
train: finish (eps time 11:48:37 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set11_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set12/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 44.19it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set12 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set12
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set12_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 2.8ms preprocess, 20.5ms inference, 3.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.1ms
Speed: 1.4ms preprocess, 20.1ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 1.4ms preprocess, 20.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.7ms
Speed: 1.9ms preprocess, 20.7ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.6ms preprocess, 20.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 1.5ms preprocess, 20.2ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 1.4ms preprocess, 20.3ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.8ms
Speed: 1.4ms preprocess, 20.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 1.5ms preprocess, 20.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.8ms
Speed: 1.6ms preprocess, 20.8ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.5ms preprocess, 20.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.6ms
Speed: 1.6ms preprocess, 20.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.6ms
Speed: 1.4ms preprocess, 20.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.6ms
Speed: 1.6ms preprocess, 20.6ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.1ms
Speed: 1.6ms preprocess, 20.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.5ms preprocess, 20.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.4ms
Speed: 1.4ms preprocess, 20.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.0ms
Speed: 1.5ms preprocess, 21.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.4ms
Speed: 1.4ms preprocess, 20.4ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.2ms
Speed: 1.5ms preprocess, 20.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.7ms preprocess, 20.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.7ms
Speed: 1.4ms preprocess, 20.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.7ms
Speed: 1.4ms preprocess, 20.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 1.4ms preprocess, 20.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 1.5ms preprocess, 20.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.3ms
Speed: 1.5ms preprocess, 20.3ms inference, 2.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 1.4ms preprocess, 20.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.9ms
Speed: 1.9ms preprocess, 19.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.4ms preprocess, 20.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.6ms preprocess, 20.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.9ms
Speed: 2.9ms preprocess, 21.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 20
view_order: [25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.1ms
Speed: 1.5ms preprocess, 20.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 4
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.8929
Instance 3: Confidence=0.7493
Selected instance: 1 (Confidence: 0.9348)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

585 0 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 15 prompts
current IoU is: 0.7711666226387024
Seok, iteration idx= 1 IoU = tensor(0.7712)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.4ms
Speed: 3.2ms preprocess, 25.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9285
Instance 1: Confidence=0.8933
Instance 2: Confidence=0.8802
Instance 3: Confidence=0.7548
Instance 4: Confidence=0.6740
Instance 5: Confidence=0.4509
Selected instance: 0 (Confidence: 0.9285)
tmp min: tensor(0.) tmp max: tensor(1.)
487 4 540 960
There are 15 prompts
current IoU is: 0.7261430621147156
Seok, iteration idx= 2 IoU = tensor(0.7261)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 3.1ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9410
Instance 1: Confidence=0.9132
Instance 2: Confidence=0.8935
Instance 3: Confidence=0.8732
Instance 4: Confidence=0.5436
Selected instance: 0 (Confidence: 0.9410)
tmp min: tensor(0.) tmp max: tensor(1.)
437 0 540 960
There are 14 prompts
current IoU is: 0.8247221112251282
Seok, iteration idx= 3 IoU = tensor(0.8247)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.7ms
Speed: 2.9ms preprocess, 21.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9265
Instance 1: Confidence=0.9139
Instance 2: Confidence=0.8982
Instance 3: Confidence=0.8130
Instance 4: Confidence=0.7903
Selected instance: 0 (Confidence: 0.9265)
tmp min: tensor(0.) tmp max: tensor(1.)
359 0 540 960
There are 14 prompts
current IoU is: 0.8980485796928406
Seok, iteration idx= 4 IoU = tensor(0.8980)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.7ms
Speed: 1.4ms preprocess, 21.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9261
Instance 2: Confidence=0.9165
Instance 3: Confidence=0.8297
Instance 4: Confidence=0.7494
Selected instance: 0 (Confidence: 0.9430)
tmp min: tensor(0.) tmp max: tensor(1.)
299 0 540 960
There are 13 prompts
current IoU is: 0.8533101081848145
Seok, iteration idx= 5 IoU = tensor(0.8533)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.7ms
Speed: 1.5ms preprocess, 21.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9550
Instance 1: Confidence=0.9480
Instance 2: Confidence=0.9431
Instance 3: Confidence=0.9207
Instance 4: Confidence=0.5784
Selected instance: 1 (Confidence: 0.9480)
tmp min: tensor(0.) tmp max: tensor(1.)
223 0 540 960
There are 15 prompts
current IoU is: 0.9410673379898071
Seok, iteration idx= 6 IoU = tensor(0.9411)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.3ms
Speed: 1.7ms preprocess, 22.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 4
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.8809
Selected instance: 0 (Confidence: 0.9460)
tmp min: tensor(0.) tmp max: tensor(1.)
214 0 540 960
There are 17 prompts
current IoU is: 0.9364724159240723
Seok, iteration idx= 7 IoU = tensor(0.9365)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.9ms
Speed: 1.4ms preprocess, 21.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9471
Instance 2: Confidence=0.9431
Instance 3: Confidence=0.6623
Instance 4: Confidence=0.2560
Selected instance: 0 (Confidence: 0.9621)
tmp min: tensor(0.) tmp max: tensor(1.)
202 88 540 960
There are 15 prompts
current IoU is: 0.9051902890205383
Seok, iteration idx= 8 IoU = tensor(0.9052)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.0ms
Speed: 3.1ms preprocess, 22.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9649
Instance 1: Confidence=0.9461
Instance 2: Confidence=0.9441
Instance 3: Confidence=0.8727
Instance 4: Confidence=0.7388
Instance 5: Confidence=0.3397
Selected instance: 0 (Confidence: 0.9649)
tmp min: tensor(0.) tmp max: tensor(1.)
166 56 540 960
There are 15 prompts
current IoU is: 0.9076991081237793
Seok, iteration idx= 9 IoU = tensor(0.9077)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.7ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9661
Instance 1: Confidence=0.9528
Instance 2: Confidence=0.9436
Instance 3: Confidence=0.9059
Instance 4: Confidence=0.7484
Selected instance: 0 (Confidence: 0.9661)
tmp min: tensor(0.) tmp max: tensor(1.)
146 68 540 960
There are 14 prompts
current IoU is: 0.940109133720398
Seok, iteration idx= 10 IoU = tensor(0.9401)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.7ms preprocess, 22.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9573
Instance 1: Confidence=0.9485
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.9090
Instance 4: Confidence=0.9048
Selected instance: 0 (Confidence: 0.9573)
tmp min: tensor(0.) tmp max: tensor(1.)
139 28 540 960
There are 15 prompts
current IoU is: 0.9342198371887207
Seok, iteration idx= 11 IoU = tensor(0.9342)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.5ms preprocess, 23.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9406
Instance 3: Confidence=0.9326
Instance 4: Confidence=0.8584
Selected instance: 3 (Confidence: 0.9326)
tmp min: tensor(0.) tmp max: tensor(1.)
661 88 540 960
There are 13 prompts
current IoU is: 0.8109118938446045
Seok, iteration idx= 12 IoU = tensor(0.8109)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.3ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9605
Instance 1: Confidence=0.9523
Instance 2: Confidence=0.9335
Instance 3: Confidence=0.9316
Instance 4: Confidence=0.8775
Selected instance: 3 (Confidence: 0.9316)
tmp min: tensor(0.) tmp max: tensor(1.)
702 60 540 960
There are 16 prompts
current IoU is: 0.8320727348327637
Seok, iteration idx= 13 IoU = tensor(0.8321)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.7ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9609
Instance 1: Confidence=0.9444
Instance 2: Confidence=0.9416
Instance 3: Confidence=0.9373
Instance 4: Confidence=0.9147
Selected instance: 2 (Confidence: 0.9416)
tmp min: tensor(0.) tmp max: tensor(1.)
750 48 540 960
There are 13 prompts
current IoU is: 0.8318530917167664
Seok, iteration idx= 14 IoU = tensor(0.8319)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9470
Instance 1: Confidence=0.9424
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9360
Instance 4: Confidence=0.9339
Selected instance: 2 (Confidence: 0.9392)
tmp min: tensor(0.) tmp max: tensor(1.)
743 44 540 960
There are 14 prompts
current IoU is: 0.8635126352310181
Seok, iteration idx= 15 IoU = tensor(0.8635)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9436
Instance 3: Confidence=0.9424
Instance 4: Confidence=0.9320
Selected instance: 0 (Confidence: 0.9521)
tmp min: tensor(0.) tmp max: tensor(1.)
776 24 540 960
There are 15 prompts
current IoU is: 0.8903089165687561
Seok, iteration idx= 16 IoU = tensor(0.8903)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 1.4ms preprocess, 22.1ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9525
Instance 2: Confidence=0.9508
Instance 3: Confidence=0.9356
Instance 4: Confidence=0.9341
Selected instance: 0 (Confidence: 0.9555)
tmp min: tensor(0.) tmp max: tensor(1.)
813 12 540 960
There are 14 prompts
current IoU is: 0.9043934941291809
Seok, iteration idx= 17 IoU = tensor(0.9044)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9560
Instance 1: Confidence=0.9556
Instance 2: Confidence=0.9446
Instance 3: Confidence=0.9356
Instance 4: Confidence=0.9297
Selected instance: 1 (Confidence: 0.9556)
tmp min: tensor(0.) tmp max: tensor(1.)
808 0 540 960
There are 15 prompts
current IoU is: 0.904991865158081
Seok, iteration idx= 18 IoU = tensor(0.9050)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9584
Instance 1: Confidence=0.9531
Instance 2: Confidence=0.9364
Instance 3: Confidence=0.9357
Instance 4: Confidence=0.8459
Selected instance: 0 (Confidence: 0.9584)
tmp min: tensor(0.) tmp max: tensor(1.)
773 0 540 960
There are 14 prompts
current IoU is: 0.9247525334358215
Seok, iteration idx= 19 IoU = tensor(0.9248)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.2ms
Speed: 1.4ms preprocess, 21.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 5
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9486
Instance 2: Confidence=0.9481
Instance 3: Confidence=0.9425
Instance 4: Confidence=0.9152
Selected instance: 0 (Confidence: 0.9610)
tmp min: tensor(0.) tmp max: tensor(1.)
154 16 540 960
There are 14 prompts
current IoU is: 0.9239241480827332
Seok, iteration idx= 20 IoU = tensor(0.9239)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.8ms
Speed: 3.5ms preprocess, 21.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9641
Instance 1: Confidence=0.9486
Instance 2: Confidence=0.9464
Instance 3: Confidence=0.9459
Instance 4: Confidence=0.9247
Selected instance: 1 (Confidence: 0.9486)
tmp min: tensor(0.) tmp max: tensor(1.)
141 24 540 960
There are 15 prompts
current IoU is: 0.9412509202957153
Seok, iteration idx= 21 IoU = tensor(0.9413)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 2.8ms preprocess, 23.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.9499
Instance 3: Confidence=0.9484
Instance 4: Confidence=0.9239
Selected instance: 3 (Confidence: 0.9484)
tmp min: tensor(0.) tmp max: tensor(1.)
160 20 540 960
There are 12 prompts
current IoU is: 0.9409263134002686
Seok, iteration idx= 22 IoU = tensor(0.9409)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 2.5ms preprocess, 22.7ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9541
Instance 1: Confidence=0.9507
Instance 2: Confidence=0.9499
Instance 3: Confidence=0.9434
Instance 4: Confidence=0.9244
Selected instance: 2 (Confidence: 0.9499)
tmp min: tensor(0.) tmp max: tensor(1.)
168 28 540 960
There are 15 prompts
current IoU is: 0.9393792152404785
Seok, iteration idx= 23 IoU = tensor(0.9394)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.9ms
Speed: 3.0ms preprocess, 21.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9393
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.9061
Selected instance: 2 (Confidence: 0.9393)
tmp min: tensor(0.) tmp max: tensor(1.)
202 44 540 960
There are 15 prompts
current IoU is: 0.9180842041969299
Seok, iteration idx= 24 IoU = tensor(0.9181)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.9ms
Speed: 2.7ms preprocess, 21.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9574
Instance 1: Confidence=0.9514
Instance 2: Confidence=0.9313
Instance 3: Confidence=0.9223
Instance 4: Confidence=0.9072
Selected instance: 2 (Confidence: 0.9313)
tmp min: tensor(0.) tmp max: tensor(1.)
240 68 540 960
There are 16 prompts
current IoU is: 0.9068742990493774
Seok, iteration idx= 25 IoU = tensor(0.9069)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 2.4ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9655
Instance 1: Confidence=0.9410
Instance 2: Confidence=0.9096
Instance 3: Confidence=0.9021
Instance 4: Confidence=0.8728
Selected instance: 3 (Confidence: 0.9021)
tmp min: tensor(0.) tmp max: tensor(1.)
271 84 540 960
There are 12 prompts
current IoU is: 0.9100330471992493
Seok, iteration idx= 26 IoU = tensor(0.9100)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 2.3ms preprocess, 22.5ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9578
Instance 1: Confidence=0.9251
Instance 2: Confidence=0.8965
Instance 3: Confidence=0.8850
Instance 4: Confidence=0.8000
Instance 5: Confidence=0.6041
Selected instance: 3 (Confidence: 0.8850)
tmp min: tensor(0.) tmp max: tensor(1.)
295 120 540 960
There are 17 prompts
current IoU is: 0.8867722749710083
Seok, iteration idx= 27 IoU = tensor(0.8868)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 2.7ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9413
Instance 3: Confidence=0.9286
Instance 4: Confidence=0.8911
Instance 5: Confidence=0.8629
Selected instance: 0 (Confidence: 0.9616)
tmp min: tensor(0.) tmp max: tensor(1.)
821 20 540 960
There are 14 prompts
current IoU is: 0.9425090551376343
Seok, iteration idx= 28 IoU = tensor(0.9425)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.2ms
Speed: 2.6ms preprocess, 22.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9563
Instance 1: Confidence=0.9416
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.9166
Instance 4: Confidence=0.6422
Instance 5: Confidence=0.3537
Instance 6: Confidence=0.3190
Selected instance: 0 (Confidence: 0.9563)
tmp min: tensor(0.) tmp max: tensor(1.)
756 20 540 960
There are 15 prompts
current IoU is: 0.9414566159248352
Seok, iteration idx= 29 IoU = tensor(0.9415)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 2.7ms preprocess, 22.7ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9407
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9287
Instance 3: Confidence=0.9253
Instance 4: Confidence=0.5503
Instance 5: Confidence=0.4910
Selected instance: 0 (Confidence: 0.9407)
tmp min: tensor(0.) tmp max: tensor(1.)
748 52 540 960
There are 15 prompts
current IoU is: 0.9429889917373657
Seok, iteration idx= 30 IoU = tensor(0.9430)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 3.3ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9480
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.9271
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9137
Instance 5: Confidence=0.4320
Selected instance: 0 (Confidence: 0.9480)
tmp min: tensor(0.) tmp max: tensor(1.)
746 8 540 960
There are 13 prompts
current IoU is: 0.9351761341094971
Seok, iteration idx= 31 IoU = tensor(0.9352)
Selected Instance Confidence List: [tensor(0.9137), tensor(0.8366, device='cpu'), tensor(0.8071, device='cpu'), tensor(0.8712, device='cpu'), tensor(0.9094, device='cpu'), tensor(0.8892, device='cpu'), tensor(0.9438, device='cpu'), tensor(0.9403, device='cpu'), tensor(0.9279, device='cpu'), tensor(0.9306, device='cpu'), tensor(0.9505, device='cpu'), tensor(0.9434, device='cpu'), tensor(0.8596, device='cpu'), tensor(0.8719, device='cpu'), tensor(0.8758, device='cpu'), tensor(0.8938, device='cpu'), tensor(0.9150, device='cpu'), tensor(0.9248, device='cpu'), tensor(0.9252, device='cpu'), tensor(0.9382, device='cpu'), tensor(0.9388, device='cpu'), tensor(0.9442, device='cpu'), tensor(0.9439, device='cpu'), tensor(0.9436, device='cpu'), tensor(0.9266, device='cpu'), tensor(0.9166, device='cpu'), tensor(0.9069, device='cpu'), tensor(0.8861, device='cpu'), tensor(0.9502, device='cpu'), tensor(0.9474, device='cpu'), tensor(0.9421, device='cpu'), tensor(0.9403, device='cpu')]
Sorted Confidence Order: [tensor(0.9505, device='cpu'), tensor(0.9306, device='cpu'), tensor(0.9434, device='cpu'), tensor(0.9388, device='cpu'), tensor(0.9442, device='cpu'), tensor(0.9439, device='cpu'), tensor(0.9436, device='cpu'), tensor(0.9266, device='cpu'), tensor(0.9166, device='cpu'), tensor(0.9069, device='cpu'), tensor(0.8861, device='cpu'), tensor(0.9279, device='cpu'), tensor(0.9403, device='cpu'), tensor(0.9438, device='cpu'), tensor(0.8892, device='cpu'), tensor(0.9094, device='cpu'), tensor(0.8712, device='cpu'), tensor(0.8071, device='cpu'), tensor(0.8366, device='cpu'), tensor(0.9137), tensor(0.9403, device='cpu'), tensor(0.9421, device='cpu'), tensor(0.9474, device='cpu'), tensor(0.9502, device='cpu'), tensor(0.9382, device='cpu'), tensor(0.9252, device='cpu'), tensor(0.9248, device='cpu'), tensor(0.9150, device='cpu'), tensor(0.8938, device='cpu'), tensor(0.8758, device='cpu'), tensor(0.8719, device='cpu'), tensor(0.8596, device='cpu')]
sorted_indices: [10, 9, 11, 20, 21, 22, 23, 24, 25, 26, 27, 8, 7, 6, 5, 4, 3, 2, 1, 0, 31, 30, 29, 28, 19, 18, 17, 16, 15, 14, 13, 12]
Initial view (highest confidence): 11
New training order: [35, 34, 36, 9, 10, 11, 12, 13, 14, 15, 16, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.0ms
Speed: 1.3ms preprocess, 20.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9649
Instance 1: Confidence=0.9461
Instance 2: Confidence=0.9441
Instance 3: Confidence=0.8727
Instance 4: Confidence=0.7388
Instance 5: Confidence=0.3397
tmp min: tensor(0.) tmp max: tensor(1.)
166 56 540 960
There are 15 prompts
current IoU is: 0.9679572582244873
Seok, iteration idx= 1 IoU = tensor(0.9680)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 3.3ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 5
Instance 0: Confidence=0.9573
Instance 1: Confidence=0.9485
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.9090
Instance 4: Confidence=0.9048
tmp min: tensor(0.) tmp max: tensor(1.)
139 28 540 960
There are 15 prompts
current IoU is: 0.9614602327346802
Seok, iteration idx= 2 IoU = tensor(0.9615)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 3.4ms preprocess, 22.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9486
Instance 2: Confidence=0.9481
Instance 3: Confidence=0.9425
Instance 4: Confidence=0.9152
tmp min: tensor(0.) tmp max: tensor(1.)
154 16 540 960
There are 14 prompts
current IoU is: 0.9452263116836548
Seok, iteration idx= 3 IoU = tensor(0.9452)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 2.3ms preprocess, 22.7ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9641
Instance 1: Confidence=0.9486
Instance 2: Confidence=0.9464
Instance 3: Confidence=0.9459
Instance 4: Confidence=0.9247
tmp min: tensor(0.) tmp max: tensor(1.)
141 24 540 960
There are 15 prompts
current IoU is: 0.960655152797699
Seok, iteration idx= 4 IoU = tensor(0.9607)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 3.3ms preprocess, 22.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.9499
Instance 3: Confidence=0.9484
Instance 4: Confidence=0.9239
tmp min: tensor(0.) tmp max: tensor(1.)
160 20 540 960
There are 12 prompts
current IoU is: 0.9516592621803284
Seok, iteration idx= 5 IoU = tensor(0.9517)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 3.3ms preprocess, 22.8ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9541
Instance 1: Confidence=0.9507
Instance 2: Confidence=0.9499
Instance 3: Confidence=0.9434
Instance 4: Confidence=0.9244
tmp min: tensor(0.) tmp max: tensor(1.)
168 28 540 960
There are 15 prompts
current IoU is: 0.9475780129432678
Seok, iteration idx= 6 IoU = tensor(0.9476)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 3.5ms preprocess, 23.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9393
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.9061
tmp min: tensor(0.) tmp max: tensor(1.)
202 44 540 960
There are 15 prompts
current IoU is: 0.9274101853370667
Seok, iteration idx= 7 IoU = tensor(0.9274)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 3.0ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9574
Instance 1: Confidence=0.9514
Instance 2: Confidence=0.9313
Instance 3: Confidence=0.9223
Instance 4: Confidence=0.9072
tmp min: tensor(0.) tmp max: tensor(1.)
240 68 540 960
There are 16 prompts
current IoU is: 0.9143176674842834
Seok, iteration idx= 8 IoU = tensor(0.9143)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 2.6ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9655
Instance 1: Confidence=0.9410
Instance 2: Confidence=0.9096
Instance 3: Confidence=0.9021
Instance 4: Confidence=0.8728
tmp min: tensor(0.) tmp max: tensor(1.)
271 84 540 960
There are 12 prompts
current IoU is: 0.9102963805198669
Seok, iteration idx= 9 IoU = tensor(0.9103)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 2.3ms preprocess, 22.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9578
Instance 1: Confidence=0.9251
Instance 2: Confidence=0.8965
Instance 3: Confidence=0.8850
Instance 4: Confidence=0.8000
Instance 5: Confidence=0.6041
tmp min: tensor(0.) tmp max: tensor(1.)
295 120 540 960
There are 17 prompts
current IoU is: 0.8874807357788086
Seok, iteration idx= 10 IoU = tensor(0.8875)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9471
Instance 2: Confidence=0.9431
Instance 3: Confidence=0.6623
Instance 4: Confidence=0.2560
tmp min: tensor(0.) tmp max: tensor(1.)
202 88 540 960
There are 15 prompts
current IoU is: 0.9581887722015381
Seok, iteration idx= 11 IoU = tensor(0.9582)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 4
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.8809
tmp min: tensor(0.) tmp max: tensor(1.)
214 0 540 960
There are 17 prompts
current IoU is: 0.9667044878005981
Seok, iteration idx= 12 IoU = tensor(0.9667)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9550
Instance 1: Confidence=0.9480
Instance 2: Confidence=0.9431
Instance 3: Confidence=0.9207
Instance 4: Confidence=0.5784
tmp min: tensor(0.) tmp max: tensor(1.)
223 0 540 960
There are 15 prompts
current IoU is: 0.9676479697227478
Seok, iteration idx= 13 IoU = tensor(0.9676)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9261
Instance 2: Confidence=0.9165
Instance 3: Confidence=0.8297
Instance 4: Confidence=0.7494
tmp min: tensor(0.) tmp max: tensor(1.)
299 0 540 960
There are 13 prompts
current IoU is: 0.9721320271492004
Seok, iteration idx= 14 IoU = tensor(0.9721)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.9ms
Speed: 1.5ms preprocess, 21.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9265
Instance 1: Confidence=0.9139
Instance 2: Confidence=0.8982
Instance 3: Confidence=0.8130
Instance 4: Confidence=0.7903
tmp min: tensor(0.) tmp max: tensor(1.)
359 0 540 960
There are 14 prompts
current IoU is: 0.9695481061935425
Seok, iteration idx= 15 IoU = tensor(0.9695)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.8ms
Speed: 1.5ms preprocess, 24.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9410
Instance 1: Confidence=0.9132
Instance 2: Confidence=0.8935
Instance 3: Confidence=0.8732
Instance 4: Confidence=0.5436
tmp min: tensor(0.) tmp max: tensor(1.)
437 0 540 960
There are 14 prompts
current IoU is: 0.9790440797805786
Seok, iteration idx= 16 IoU = tensor(0.9790)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 1.3ms preprocess, 22.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9285
Instance 1: Confidence=0.8933
Instance 2: Confidence=0.8802
Instance 3: Confidence=0.7548
Instance 4: Confidence=0.6740
Instance 5: Confidence=0.4509
tmp min: tensor(0.) tmp max: tensor(1.)
487 4 540 960
There are 15 prompts
current IoU is: 0.9624266028404236
Seok, iteration idx= 17 IoU = tensor(0.9624)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.9ms
Speed: 1.3ms preprocess, 22.9ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 4
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.8929
Instance 3: Confidence=0.7493
tmp min: tensor(0.) tmp max: tensor(1.)
585 0 540 960
There are 15 prompts
current IoU is: 0.9468634128570557
Seok, iteration idx= 18 IoU = tensor(0.9469)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.6ms
Speed: 1.6ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9241
Instance 1: Confidence=0.9137
Instance 2: Confidence=0.8986
Instance 3: Confidence=0.8831
Instance 4: Confidence=0.8546
Instance 5: Confidence=0.7726
Instance 6: Confidence=0.2917
tmp min: tensor(0.) tmp max: tensor(1.)
654 0 540 960
There are 15 prompts
current IoU is: 0.9221513867378235
Seok, iteration idx= 19 IoU = tensor(0.9222)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9480
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.9271
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9137
Instance 5: Confidence=0.4320
tmp min: tensor(0.) tmp max: tensor(1.)
746 8 540 960
There are 13 prompts
current IoU is: 0.9507418870925903
Seok, iteration idx= 20 IoU = tensor(0.9507)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 3.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9407
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9287
Instance 3: Confidence=0.9253
Instance 4: Confidence=0.5503
Instance 5: Confidence=0.4910
tmp min: tensor(0.) tmp max: tensor(1.)
748 52 540 960
There are 15 prompts
current IoU is: 0.9620174765586853
Seok, iteration idx= 21 IoU = tensor(0.9620)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 3.7ms preprocess, 22.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 7
Instance 0: Confidence=0.9563
Instance 1: Confidence=0.9416
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.9166
Instance 4: Confidence=0.6422
Instance 5: Confidence=0.3537
Instance 6: Confidence=0.3190
tmp min: tensor(0.) tmp max: tensor(1.)
756 20 540 960
There are 15 prompts
current IoU is: 0.9540321230888367
Seok, iteration idx= 22 IoU = tensor(0.9540)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 3.3ms preprocess, 22.9ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9413
Instance 3: Confidence=0.9286
Instance 4: Confidence=0.8911
Instance 5: Confidence=0.8629
tmp min: tensor(0.) tmp max: tensor(1.)
821 20 540 960
There are 14 prompts
current IoU is: 0.9632494449615479
Seok, iteration idx= 23 IoU = tensor(0.9632)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 2.6ms preprocess, 22.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9584
Instance 1: Confidence=0.9531
Instance 2: Confidence=0.9364
Instance 3: Confidence=0.9357
Instance 4: Confidence=0.8459
tmp min: tensor(0.) tmp max: tensor(1.)
773 0 540 960
There are 14 prompts
current IoU is: 0.955338180065155
Seok, iteration idx= 24 IoU = tensor(0.9553)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9560
Instance 1: Confidence=0.9556
Instance 2: Confidence=0.9446
Instance 3: Confidence=0.9356
Instance 4: Confidence=0.9297
tmp min: tensor(0.) tmp max: tensor(1.)
808 0 540 960
There are 15 prompts
current IoU is: 0.948503315448761
Seok, iteration idx= 25 IoU = tensor(0.9485)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.3ms preprocess, 22.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9525
Instance 2: Confidence=0.9508
Instance 3: Confidence=0.9356
Instance 4: Confidence=0.9341
tmp min: tensor(0.) tmp max: tensor(1.)
813 12 540 960
There are 14 prompts
current IoU is: 0.9469026327133179
Seok, iteration idx= 26 IoU = tensor(0.9469)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 1.5ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9436
Instance 3: Confidence=0.9424
Instance 4: Confidence=0.9320
tmp min: tensor(0.) tmp max: tensor(1.)
776 24 540 960
There are 15 prompts
current IoU is: 0.9472317695617676
Seok, iteration idx= 27 IoU = tensor(0.9472)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 3.3ms preprocess, 22.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9470
Instance 1: Confidence=0.9424
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9360
Instance 4: Confidence=0.9339
tmp min: tensor(0.) tmp max: tensor(1.)
743 44 540 960
There are 14 prompts
current IoU is: 0.9414104223251343
Seok, iteration idx= 28 IoU = tensor(0.9414)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 3.3ms preprocess, 22.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9609
Instance 1: Confidence=0.9444
Instance 2: Confidence=0.9416
Instance 3: Confidence=0.9373
Instance 4: Confidence=0.9147
tmp min: tensor(0.) tmp max: tensor(1.)
750 48 540 960
There are 13 prompts
current IoU is: 0.9439288973808289
Seok, iteration idx= 29 IoU = tensor(0.9439)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 2.4ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9605
Instance 1: Confidence=0.9523
Instance 2: Confidence=0.9335
Instance 3: Confidence=0.9316
Instance 4: Confidence=0.8775
tmp min: tensor(0.) tmp max: tensor(1.)
702 60 540 960
There are 16 prompts
current IoU is: 0.9308934211730957
Seok, iteration idx= 30 IoU = tensor(0.9309)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 2.6ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9406
Instance 3: Confidence=0.9326
Instance 4: Confidence=0.8584
tmp min: tensor(0.) tmp max: tensor(1.)
661 88 540 960
There are 13 prompts
current IoU is: 0.9328908324241638
Seok, iteration idx= 31 IoU = tensor(0.9329)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set12_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set12_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:41<00:00,  1.29s/it]
Testing psnr 27.958649769425392 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set12_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:28<00:00,  1.14it/s]
Testing psnr 3.477752720937133 (avg)
train: coarse segmentation in 00:06:01
train: finish (eps time 00:06:01 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set12_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set13/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 49.72it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set13 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set13
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set13_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.9ms
Speed: 2.5ms preprocess, 20.9ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.7ms
Speed: 1.4ms preprocess, 20.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.3ms
Speed: 1.4ms preprocess, 20.3ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.3ms
Speed: 1.3ms preprocess, 20.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 21.0ms
Speed: 1.3ms preprocess, 21.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.1ms
Speed: 1.9ms preprocess, 20.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.2ms
Speed: 1.3ms preprocess, 20.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.4ms
Speed: 1.5ms preprocess, 20.4ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.0ms
Speed: 1.7ms preprocess, 20.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.7ms
Speed: 1.4ms preprocess, 20.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.8ms
Speed: 1.2ms preprocess, 20.8ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.7ms
Speed: 1.5ms preprocess, 20.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.6ms
Speed: 1.5ms preprocess, 20.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.1ms
Speed: 1.4ms preprocess, 21.1ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.4ms
Speed: 1.4ms preprocess, 21.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.8ms
Speed: 1.6ms preprocess, 20.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.1ms
Speed: 1.3ms preprocess, 21.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.0ms
Speed: 1.3ms preprocess, 20.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.9ms
Speed: 1.4ms preprocess, 19.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.9ms
Speed: 1.3ms preprocess, 19.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.0ms
Speed: 1.4ms preprocess, 20.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.9ms
Speed: 1.3ms preprocess, 19.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 1.2ms preprocess, 20.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 1.3ms preprocess, 20.3ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 1.3ms preprocess, 20.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.9ms
Speed: 1.8ms preprocess, 20.9ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 25
view_order: [30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.6ms
Speed: 1.2ms preprocess, 20.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9473
Instance 1: Confidence=0.9204
Instance 2: Confidence=0.9187
Instance 3: Confidence=0.9093
Instance 4: Confidence=0.7686
Selected instance: 0 (Confidence: 0.9473)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

804 36 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 12 prompts
current IoU is: 0.8110707402229309
Seok, iteration idx= 1 IoU = tensor(0.8111)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.2ms
Speed: 1.9ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 4
Instance 0: Confidence=0.9493
Instance 1: Confidence=0.9198
Instance 2: Confidence=0.9132
Instance 3: Confidence=0.8117
Selected instance: 0 (Confidence: 0.9493)
tmp min: tensor(0.) tmp max: tensor(1.)
816 48 540 960
There are 15 prompts
current IoU is: 0.8622496128082275
Seok, iteration idx= 2 IoU = tensor(0.8622)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 1.5ms preprocess, 22.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9467
Instance 1: Confidence=0.9218
Instance 2: Confidence=0.9005
Instance 3: Confidence=0.8803
Instance 4: Confidence=0.8561
Selected instance: 0 (Confidence: 0.9467)
tmp min: tensor(0.) tmp max: tensor(1.)
797 112 540 960
There are 15 prompts
current IoU is: 0.8207463622093201
Seok, iteration idx= 3 IoU = tensor(0.8207)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.0ms
Speed: 1.4ms preprocess, 22.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9544
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9241
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.7200
Selected instance: 0 (Confidence: 0.9544)
tmp min: tensor(0.) tmp max: tensor(1.)
866 80 540 960
There are 14 prompts
current IoU is: 0.8590766191482544
Seok, iteration idx= 4 IoU = tensor(0.8591)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9280
Instance 2: Confidence=0.9266
Instance 3: Confidence=0.9235
Instance 4: Confidence=0.7901
Selected instance: 0 (Confidence: 0.9430)
tmp min: tensor(0.) tmp max: tensor(1.)
867 68 540 960
There are 13 prompts
current IoU is: 0.9181810617446899
Seok, iteration idx= 5 IoU = tensor(0.9182)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.3ms preprocess, 23.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9459
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9226
Instance 3: Confidence=0.9140
Instance 4: Confidence=0.6220
Selected instance: 0 (Confidence: 0.9459)
tmp min: tensor(0.) tmp max: tensor(1.)
923 44 540 960
There are 13 prompts
current IoU is: 0.9609100818634033
Seok, iteration idx= 6 IoU = tensor(0.9609)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 1
Instance 0: Confidence=0.9169
Selected instance: 0 (Confidence: 0.9169)
tmp min: tensor(0.) tmp max: tensor(1.)
200 88 540 960
There are 18 prompts
current IoU is: 0.7162322402000427
Seok, iteration idx= 7 IoU = tensor(0.7162)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 1
Instance 0: Confidence=0.9297
Selected instance: 0 (Confidence: 0.9297)
tmp min: tensor(0.) tmp max: tensor(1.)
208 76 540 960
There are 16 prompts
current IoU is: 0.6551847457885742
Seok, iteration idx= 8 IoU = tensor(0.6552)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.1ms
Speed: 1.4ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 1
Instance 0: Confidence=0.9227
Selected instance: 0 (Confidence: 0.9227)
tmp min: tensor(0.) tmp max: tensor(1.)
220 68 540 960
There are 15 prompts
current IoU is: 0.6412858963012695
Seok, iteration idx= 9 IoU = tensor(0.6413)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 1
Instance 0: Confidence=0.9274
Selected instance: 0 (Confidence: 0.9274)
tmp min: tensor(0.) tmp max: tensor(1.)
226 68 540 960
There are 13 prompts
current IoU is: 0.7712418437004089
Seok, iteration idx= 10 IoU = tensor(0.7712)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.1ms
Speed: 1.5ms preprocess, 22.1ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 1
Instance 0: Confidence=0.9171
Selected instance: 0 (Confidence: 0.9171)
tmp min: tensor(0.) tmp max: tensor(1.)
239 48 540 960
There are 16 prompts
current IoU is: 0.760324239730835
Seok, iteration idx= 11 IoU = tensor(0.7603)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.4ms
Speed: 1.3ms preprocess, 22.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 1
Instance 0: Confidence=0.9199
Selected instance: 0 (Confidence: 0.9199)
tmp min: tensor(0.) tmp max: tensor(1.)
296 60 540 960
There are 16 prompts
current IoU is: 0.8390336632728577
Seok, iteration idx= 12 IoU = tensor(0.8390)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 2.5ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9370
Instance 1: Confidence=0.9239
Selected instance: 1 (Confidence: 0.9239)
tmp min: tensor(0.) tmp max: tensor(1.)
311 56 540 960
There are 15 prompts
current IoU is: 0.848904013633728
Seok, iteration idx= 13 IoU = tensor(0.8489)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 3.1ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9040
Selected instance: 1 (Confidence: 0.9040)
tmp min: tensor(0.) tmp max: tensor(1.)
324 60 540 960
There are 13 prompts
current IoU is: 0.8125401735305786
Seok, iteration idx= 14 IoU = tensor(0.8125)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.4ms
Speed: 2.3ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 4
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9207
Instance 2: Confidence=0.8929
Instance 3: Confidence=0.5436
Selected instance: 0 (Confidence: 0.9460)
tmp min: tensor(0.) tmp max: tensor(1.)
929 16 540 960
There are 14 prompts
current IoU is: 0.9452030062675476
Seok, iteration idx= 15 IoU = tensor(0.9452)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.9ms
Speed: 2.9ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 3
Instance 0: Confidence=0.9560
Instance 1: Confidence=0.8635
Instance 2: Confidence=0.7620
Selected instance: 0 (Confidence: 0.9560)
tmp min: tensor(0.) tmp max: tensor(1.)
922 4 540 960
There are 13 prompts
current IoU is: 0.9683519601821899
Seok, iteration idx= 16 IoU = tensor(0.9684)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 3.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9567
Instance 1: Confidence=0.7969
Selected instance: 0 (Confidence: 0.9567)
tmp min: tensor(0.) tmp max: tensor(1.)
881 0 540 960
There are 15 prompts
current IoU is: 0.9525071978569031
Seok, iteration idx= 17 IoU = tensor(0.9525)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 3
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.7888
Instance 2: Confidence=0.4837
Selected instance: 0 (Confidence: 0.9593)
tmp min: tensor(0.) tmp max: tensor(1.)
848 0 540 960
There are 16 prompts
current IoU is: 0.9328938722610474
Seok, iteration idx= 18 IoU = tensor(0.9329)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 4
Instance 0: Confidence=0.9485
Instance 1: Confidence=0.7439
Instance 2: Confidence=0.5048
Instance 3: Confidence=0.2655
Selected instance: 0 (Confidence: 0.9485)
tmp min: tensor(0.) tmp max: tensor(1.)
754 0 540 960
There are 15 prompts
current IoU is: 0.9262967705726624
Seok, iteration idx= 19 IoU = tensor(0.9263)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 1.5ms preprocess, 22.1ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9561
Instance 1: Confidence=0.6777
Selected instance: 0 (Confidence: 0.9561)
tmp min: tensor(0.) tmp max: tensor(1.)
691 0 540 960
There are 15 prompts
current IoU is: 0.9296140670776367
Seok, iteration idx= 20 IoU = tensor(0.9296)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9415
Instance 1: Confidence=0.7778
Selected instance: 0 (Confidence: 0.9415)
tmp min: tensor(0.) tmp max: tensor(1.)
611 12 540 960
There are 14 prompts
current IoU is: 0.927017092704773
Seok, iteration idx= 21 IoU = tensor(0.9270)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.6ms preprocess, 22.5ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 2
Instance 0: Confidence=0.9420
Instance 1: Confidence=0.8016
Selected instance: 0 (Confidence: 0.9420)
tmp min: tensor(0.) tmp max: tensor(1.)
535 56 540 960
There are 13 prompts
current IoU is: 0.9006033539772034
Seok, iteration idx= 22 IoU = tensor(0.9006)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9039
Selected instance: 1 (Confidence: 0.9039)
tmp min: tensor(0.) tmp max: tensor(1.)
397 68 540 960
There are 15 prompts
current IoU is: 0.8364189863204956
Seok, iteration idx= 23 IoU = tensor(0.8364)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9440
Instance 1: Confidence=0.9201
Selected instance: 1 (Confidence: 0.9201)
tmp min: tensor(0.) tmp max: tensor(1.)
402 80 540 960
There are 14 prompts
current IoU is: 0.8316332101821899
Seok, iteration idx= 24 IoU = tensor(0.8316)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 2.8ms preprocess, 22.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9452
Instance 1: Confidence=0.9129
Selected instance: 1 (Confidence: 0.9129)
tmp min: tensor(0.) tmp max: tensor(1.)
437 112 540 960
There are 12 prompts
current IoU is: 0.82126784324646
Seok, iteration idx= 25 IoU = tensor(0.8213)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 3
Instance 0: Confidence=0.9407
Instance 1: Confidence=0.9229
Instance 2: Confidence=0.9179
Selected instance: 2 (Confidence: 0.9179)
tmp min: tensor(0.) tmp max: tensor(1.)
497 68 540 960
There are 14 prompts
current IoU is: 0.8403758406639099
Seok, iteration idx= 26 IoU = tensor(0.8404)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 3
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9345
Instance 2: Confidence=0.9300
Selected instance: 2 (Confidence: 0.9300)
tmp min: tensor(0.) tmp max: tensor(1.)
559 76 540 960
There are 14 prompts
current IoU is: 0.8806830048561096
Seok, iteration idx= 27 IoU = tensor(0.8807)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.4ms
Speed: 1.3ms preprocess, 23.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 4
Instance 0: Confidence=0.9410
Instance 1: Confidence=0.9318
Instance 2: Confidence=0.9127
Instance 3: Confidence=0.5230
Selected instance: 1 (Confidence: 0.9318)
tmp min: tensor(0.) tmp max: tensor(1.)
594 52 540 960
There are 12 prompts
current IoU is: 0.877070963382721
Seok, iteration idx= 28 IoU = tensor(0.8771)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.1ms
Speed: 1.3ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 4
Instance 0: Confidence=0.9267
Instance 1: Confidence=0.9262
Instance 2: Confidence=0.9231
Instance 3: Confidence=0.4524
Selected instance: 2 (Confidence: 0.9231)
tmp min: tensor(0.) tmp max: tensor(1.)
622 68 540 960
There are 12 prompts
current IoU is: 0.8811979293823242
Seok, iteration idx= 29 IoU = tensor(0.8812)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 4
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9273
Instance 2: Confidence=0.9198
Instance 3: Confidence=0.7961
Selected instance: 0 (Confidence: 0.9367)
tmp min: tensor(0.) tmp max: tensor(1.)
707 52 540 960
There are 13 prompts
current IoU is: 0.9045416712760925
Seok, iteration idx= 30 IoU = tensor(0.9045)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9217
Instance 2: Confidence=0.9215
Instance 3: Confidence=0.9189
Instance 4: Confidence=0.8922
Selected instance: 0 (Confidence: 0.9385)
tmp min: tensor(0.) tmp max: tensor(1.)
772 28 540 960
There are 13 prompts
current IoU is: 0.9148487448692322
Seok, iteration idx= 31 IoU = tensor(0.9148)
Selected Instance Confidence List: [tensor(0.9405), tensor(0.8656, device='cpu'), tensor(0.8971, device='cpu'), tensor(0.8711, device='cpu'), tensor(0.8972, device='cpu'), tensor(0.9281, device='cpu'), tensor(0.9549, device='cpu'), tensor(0.7965, device='cpu'), tensor(0.7650, device='cpu'), tensor(0.7539, device='cpu'), tensor(0.8337, device='cpu'), tensor(0.8230, device='cpu'), tensor(0.8714, device='cpu'), tensor(0.8789, device='cpu'), tensor(0.8491, device='cpu'), tensor(0.9455, device='cpu'), tensor(0.9634, device='cpu'), tensor(0.9542, device='cpu'), tensor(0.9435, device='cpu'), tensor(0.9352, device='cpu'), tensor(0.9402, device='cpu'), tensor(0.9328, device='cpu'), tensor(0.9171, device='cpu'), tensor(0.8634, device='cpu'), tensor(0.8670, device='cpu'), tensor(0.8579, device='cpu'), tensor(0.8714, device='cpu'), tensor(0.9004, device='cpu'), tensor(0.8990, device='cpu'), tensor(0.8980, device='cpu'), tensor(0.9174, device='cpu'), tensor(0.9243, device='cpu')]
Sorted Confidence Order: [tensor(0.9634, device='cpu'), tensor(0.9542, device='cpu'), tensor(0.9435, device='cpu'), tensor(0.9352, device='cpu'), tensor(0.9402, device='cpu'), tensor(0.9328, device='cpu'), tensor(0.9171, device='cpu'), tensor(0.9455, device='cpu'), tensor(0.9549, device='cpu'), tensor(0.9281, device='cpu'), tensor(0.8972, device='cpu'), tensor(0.8711, device='cpu'), tensor(0.8971, device='cpu'), tensor(0.8656, device='cpu'), tensor(0.9405), tensor(0.9243, device='cpu'), tensor(0.9174, device='cpu'), tensor(0.8980, device='cpu'), tensor(0.8990, device='cpu'), tensor(0.9004, device='cpu'), tensor(0.8714, device='cpu'), tensor(0.8579, device='cpu'), tensor(0.8670, device='cpu'), tensor(0.8634, device='cpu'), tensor(0.8491, device='cpu'), tensor(0.8789, device='cpu'), tensor(0.8714, device='cpu'), tensor(0.8230, device='cpu'), tensor(0.8337, device='cpu'), tensor(0.7539, device='cpu'), tensor(0.7650, device='cpu'), tensor(0.7965, device='cpu')]
sorted_indices: [16, 17, 18, 19, 20, 21, 22, 15, 6, 5, 4, 3, 2, 1, 0, 31, 30, 29, 28, 27, 26, 25, 24, 23, 14, 13, 12, 11, 10, 9, 8, 7]
Initial view (highest confidence): 21
New training order: [10, 11, 12, 13, 14, 15, 16, 9, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.0ms
Speed: 1.3ms preprocess, 21.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 2.7ms preprocess, 22.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 2
Instance 0: Confidence=0.9567
Instance 1: Confidence=0.7969
tmp min: tensor(0.) tmp max: tensor(1.)
881 0 540 960
There are 15 prompts
current IoU is: 0.9584367275238037
Seok, iteration idx= 1 IoU = tensor(0.9584)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.6ms
Speed: 2.8ms preprocess, 22.6ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 3
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.7888
Instance 2: Confidence=0.4837
tmp min: tensor(0.) tmp max: tensor(1.)
848 0 540 960
There are 16 prompts
current IoU is: 0.9425185918807983
Seok, iteration idx= 2 IoU = tensor(0.9425)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.3ms
Speed: 3.0ms preprocess, 22.3ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 4
Instance 0: Confidence=0.9485
Instance 1: Confidence=0.7439
Instance 2: Confidence=0.5048
Instance 3: Confidence=0.2655
tmp min: tensor(0.) tmp max: tensor(1.)
754 0 540 960
There are 15 prompts
current IoU is: 0.9401676058769226
Seok, iteration idx= 3 IoU = tensor(0.9402)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 2.9ms preprocess, 23.2ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 2
Instance 0: Confidence=0.9561
Instance 1: Confidence=0.6777
tmp min: tensor(0.) tmp max: tensor(1.)
691 0 540 960
There are 15 prompts
current IoU is: 0.932973325252533
Seok, iteration idx= 4 IoU = tensor(0.9330)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 2.4ms preprocess, 23.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9415
Instance 1: Confidence=0.7778
tmp min: tensor(0.) tmp max: tensor(1.)
611 12 540 960
There are 14 prompts
current IoU is: 0.9313703179359436
Seok, iteration idx= 5 IoU = tensor(0.9314)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 2.4ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9420
Instance 1: Confidence=0.8016
tmp min: tensor(0.) tmp max: tensor(1.)
535 56 540 960
There are 13 prompts
current IoU is: 0.9139400124549866
Seok, iteration idx= 6 IoU = tensor(0.9139)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.4ms
Speed: 2.9ms preprocess, 22.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 4
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9207
Instance 2: Confidence=0.8929
Instance 3: Confidence=0.5436
tmp min: tensor(0.) tmp max: tensor(1.)
929 16 540 960
There are 14 prompts
current IoU is: 0.9510954022407532
Seok, iteration idx= 7 IoU = tensor(0.9511)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 3.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9459
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9226
Instance 3: Confidence=0.9140
Instance 4: Confidence=0.6220
tmp min: tensor(0.) tmp max: tensor(1.)
923 44 540 960
There are 13 prompts
current IoU is: 0.9693772196769714
Seok, iteration idx= 8 IoU = tensor(0.9694)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 1.9ms preprocess, 22.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9280
Instance 2: Confidence=0.9266
Instance 3: Confidence=0.9235
Instance 4: Confidence=0.7901
tmp min: tensor(0.) tmp max: tensor(1.)
867 68 540 960
There are 13 prompts
current IoU is: 0.9297915101051331
Seok, iteration idx= 9 IoU = tensor(0.9298)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9544
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9241
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.7200
tmp min: tensor(0.) tmp max: tensor(1.)
866 80 540 960
There are 14 prompts
current IoU is: 0.9416540265083313
Seok, iteration idx= 10 IoU = tensor(0.9417)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9467
Instance 1: Confidence=0.9218
Instance 2: Confidence=0.9005
Instance 3: Confidence=0.8803
Instance 4: Confidence=0.8561
tmp min: tensor(0.) tmp max: tensor(1.)
797 112 540 960
There are 15 prompts
current IoU is: 0.9428967833518982
Seok, iteration idx= 11 IoU = tensor(0.9429)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.9ms
Speed: 1.3ms preprocess, 22.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 4
Instance 0: Confidence=0.9493
Instance 1: Confidence=0.9198
Instance 2: Confidence=0.9132
Instance 3: Confidence=0.8117
tmp min: tensor(0.) tmp max: tensor(1.)
816 48 540 960
There are 15 prompts
current IoU is: 0.9507925510406494
Seok, iteration idx= 12 IoU = tensor(0.9508)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 1.5ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9473
Instance 1: Confidence=0.9204
Instance 2: Confidence=0.9187
Instance 3: Confidence=0.9093
Instance 4: Confidence=0.7686
tmp min: tensor(0.) tmp max: tensor(1.)
804 36 540 960
There are 12 prompts
current IoU is: 0.9354207515716553
Seok, iteration idx= 13 IoU = tensor(0.9354)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9408
Instance 1: Confidence=0.9405
Instance 2: Confidence=0.9239
Instance 3: Confidence=0.9109
Instance 4: Confidence=0.9033
tmp min: tensor(0.) tmp max: tensor(1.)
758 68 540 960
There are 12 prompts
current IoU is: 0.9338105320930481
Seok, iteration idx= 14 IoU = tensor(0.9338)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9217
Instance 2: Confidence=0.9215
Instance 3: Confidence=0.9189
Instance 4: Confidence=0.8922
tmp min: tensor(0.) tmp max: tensor(1.)
772 28 540 960
There are 13 prompts
current IoU is: 0.9156281352043152
Seok, iteration idx= 15 IoU = tensor(0.9156)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.7ms
Speed: 1.3ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 4
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9273
Instance 2: Confidence=0.9198
Instance 3: Confidence=0.7961
tmp min: tensor(0.) tmp max: tensor(1.)
707 52 540 960
There are 13 prompts
current IoU is: 0.9180720448493958
Seok, iteration idx= 16 IoU = tensor(0.9181)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 4
Instance 0: Confidence=0.9267
Instance 1: Confidence=0.9262
Instance 2: Confidence=0.9231
Instance 3: Confidence=0.4524
tmp min: tensor(0.) tmp max: tensor(1.)
622 68 540 960
There are 12 prompts
current IoU is: 0.9010353088378906
Seok, iteration idx= 17 IoU = tensor(0.9010)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 4
Instance 0: Confidence=0.9410
Instance 1: Confidence=0.9318
Instance 2: Confidence=0.9127
Instance 3: Confidence=0.5230
tmp min: tensor(0.) tmp max: tensor(1.)
594 52 540 960
There are 12 prompts
current IoU is: 0.8872270584106445
Seok, iteration idx= 18 IoU = tensor(0.8872)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 3
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9345
Instance 2: Confidence=0.9300
tmp min: tensor(0.) tmp max: tensor(1.)
559 76 540 960
There are 14 prompts
current IoU is: 0.8980673551559448
Seok, iteration idx= 19 IoU = tensor(0.8981)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.8ms
Speed: 1.6ms preprocess, 22.8ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 3
Instance 0: Confidence=0.9407
Instance 1: Confidence=0.9229
Instance 2: Confidence=0.9179
tmp min: tensor(0.) tmp max: tensor(1.)
497 68 540 960
There are 14 prompts
current IoU is: 0.8503725528717041
Seok, iteration idx= 20 IoU = tensor(0.8504)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9452
Instance 1: Confidence=0.9129
tmp min: tensor(0.) tmp max: tensor(1.)
437 112 540 960
There are 12 prompts
current IoU is: 0.8284240961074829
Seok, iteration idx= 21 IoU = tensor(0.8284)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 2
Instance 0: Confidence=0.9440
Instance 1: Confidence=0.9201
tmp min: tensor(0.) tmp max: tensor(1.)
402 80 540 960
There are 14 prompts
current IoU is: 0.8418064117431641
Seok, iteration idx= 22 IoU = tensor(0.8418)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9039
tmp min: tensor(0.) tmp max: tensor(1.)
397 68 540 960
There are 15 prompts
current IoU is: 0.8432043790817261
Seok, iteration idx= 23 IoU = tensor(0.8432)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9040
tmp min: tensor(0.) tmp max: tensor(1.)
324 60 540 960
There are 13 prompts
current IoU is: 0.8184001445770264
Seok, iteration idx= 24 IoU = tensor(0.8184)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 4.9ms preprocess, 23.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9370
Instance 1: Confidence=0.9239
tmp min: tensor(0.) tmp max: tensor(1.)
311 56 540 960
There are 15 prompts
current IoU is: 0.8639916777610779
Seok, iteration idx= 25 IoU = tensor(0.8640)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.5ms
Speed: 2.5ms preprocess, 22.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 1
Instance 0: Confidence=0.9199
tmp min: tensor(0.) tmp max: tensor(1.)
296 60 540 960
There are 16 prompts
current IoU is: 0.859255313873291
Seok, iteration idx= 26 IoU = tensor(0.8593)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.5ms
Speed: 2.9ms preprocess, 22.5ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 1
Instance 0: Confidence=0.9171
tmp min: tensor(0.) tmp max: tensor(1.)
239 48 540 960
There are 16 prompts
current IoU is: 0.8084179162979126
Seok, iteration idx= 27 IoU = tensor(0.8084)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.0ms
Speed: 2.6ms preprocess, 23.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 1
Instance 0: Confidence=0.9274
tmp min: tensor(0.) tmp max: tensor(1.)
226 68 540 960
There are 13 prompts
current IoU is: 0.7902858853340149
Seok, iteration idx= 28 IoU = tensor(0.7903)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 21.9ms
Speed: 3.0ms preprocess, 21.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 1
Instance 0: Confidence=0.9227
tmp min: tensor(0.) tmp max: tensor(1.)
220 68 540 960
There are 15 prompts
current IoU is: 0.8028901219367981
Seok, iteration idx= 29 IoU = tensor(0.8029)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.7ms
Speed: 3.0ms preprocess, 23.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 1
Instance 0: Confidence=0.9297
tmp min: tensor(0.) tmp max: tensor(1.)
208 76 540 960
There are 16 prompts
current IoU is: 0.7761213183403015
Seok, iteration idx= 30 IoU = tensor(0.7761)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.1ms
Speed: 3.9ms preprocess, 23.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 1
Instance 0: Confidence=0.9169
tmp min: tensor(0.) tmp max: tensor(1.)
200 88 540 960
There are 18 prompts
current IoU is: 0.8679957985877991
Seok, iteration idx= 31 IoU = tensor(0.8680)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set13_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set13_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.24s/it]
Testing psnr 29.099098816514015 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set13_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.16it/s]
Testing psnr 3.87919208034873 (avg)
train: coarse segmentation in 00:09:19
train: finish (eps time 00:09:20 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set13_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
