Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set1/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 46.94it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set1 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set1
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set1_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 2.6ms preprocess, 20.7ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.9ms
Speed: 1.5ms preprocess, 20.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.6ms
Speed: 1.2ms preprocess, 21.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.6ms
Speed: 1.2ms preprocess, 20.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.4ms
Speed: 1.6ms preprocess, 21.4ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.0ms
Speed: 1.2ms preprocess, 22.0ms inference, 3.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.7ms
Speed: 1.3ms preprocess, 20.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.6ms
Speed: 1.4ms preprocess, 21.6ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.5ms preprocess, 20.4ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.6ms
Speed: 1.2ms preprocess, 20.6ms inference, 0.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.7ms
Speed: 1.2ms preprocess, 20.7ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 1.2ms preprocess, 20.7ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.5ms
Speed: 1.2ms preprocess, 21.5ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 1.2ms preprocess, 20.7ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.4ms
Speed: 1.2ms preprocess, 21.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.3ms
Speed: 1.2ms preprocess, 21.3ms inference, 0.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.3ms
Speed: 1.2ms preprocess, 21.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.0ms
Speed: 1.2ms preprocess, 21.0ms inference, 0.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.0ms
Speed: 1.2ms preprocess, 21.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.3ms
Speed: 1.2ms preprocess, 20.3ms inference, 0.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.9ms
Speed: 1.5ms preprocess, 21.9ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.2ms preprocess, 20.5ms inference, 0.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.6ms
Speed: 1.5ms preprocess, 21.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.3ms
Speed: 1.2ms preprocess, 20.3ms inference, 0.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.9ms
Speed: 1.9ms preprocess, 21.9ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.4ms
Speed: 1.2ms preprocess, 20.4ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.7ms
Speed: 1.4ms preprocess, 21.7ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.3ms
Speed: 1.2ms preprocess, 20.3ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.0ms
Speed: 1.8ms preprocess, 22.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.5ms
Speed: 1.2ms preprocess, 20.5ms inference, 0.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.3ms
Speed: 1.2ms preprocess, 21.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.3ms
Speed: 9.4ms preprocess, 23.3ms inference, 3.6ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 20
view_order: [25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.8ms
Speed: 2.3ms preprocess, 21.8ms inference, 3.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9656
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8572
Instance 5: Confidence=0.7074
Selected instance: 0 (Confidence: 0.9656)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

883 44 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.9256628155708313
Seok, iteration idx= 1 IoU = tensor(0.9257)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.2ms
Speed: 3.1ms preprocess, 25.2ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9558
Instance 1: Confidence=0.9384
Instance 2: Confidence=0.9350
Instance 3: Confidence=0.9330
Instance 4: Confidence=0.8556
Instance 5: Confidence=0.8479
Selected instance: 0 (Confidence: 0.9558)
tmp min: tensor(0.) tmp max: tensor(1.)
889 56 540 960
There are 14 prompts
current IoU is: 0.9366161227226257
Seok, iteration idx= 2 IoU = tensor(0.9366)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 2.3ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9492
Instance 1: Confidence=0.9473
Instance 2: Confidence=0.8976
Instance 3: Confidence=0.8878
Instance 4: Confidence=0.7385
Selected instance: 2 (Confidence: 0.8976)
tmp min: tensor(0.) tmp max: tensor(1.)
955 48 540 960
There are 14 prompts
current IoU is: 0.9495760202407837
Seok, iteration idx= 3 IoU = tensor(0.9496)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9493
Instance 1: Confidence=0.9481
Instance 2: Confidence=0.9454
Instance 3: Confidence=0.8710
Instance 4: Confidence=0.5295
Instance 5: Confidence=0.5013
Selected instance: 2 (Confidence: 0.9454)
tmp min: tensor(0.) tmp max: tensor(1.)
951 24 540 960
There are 14 prompts
current IoU is: 0.9393290281295776
Seok, iteration idx= 4 IoU = tensor(0.9393)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9719
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9354
Instance 3: Confidence=0.8589
Instance 4: Confidence=0.5243
Selected instance: 0 (Confidence: 0.9719)
tmp min: tensor(0.) tmp max: tensor(1.)
857 48 540 960
There are 15 prompts
current IoU is: 0.9358389973640442
Seok, iteration idx= 5 IoU = tensor(0.9358)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9585
Instance 2: Confidence=0.9417
Instance 3: Confidence=0.9039
Instance 4: Confidence=0.8364
Instance 5: Confidence=0.4622
Selected instance: 0 (Confidence: 0.9618)
tmp min: tensor(0.) tmp max: tensor(1.)
808 12 540 960
There are 12 prompts
current IoU is: 0.8649951219558716
Seok, iteration idx= 6 IoU = tensor(0.8650)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 2.1ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9523
Instance 2: Confidence=0.9520
Instance 3: Confidence=0.8925
Instance 4: Confidence=0.6584
Selected instance: 2 (Confidence: 0.9520)
tmp min: tensor(0.) tmp max: tensor(1.)
711 28 540 960
There are 14 prompts
current IoU is: 0.9249151945114136
Seok, iteration idx= 7 IoU = tensor(0.9249)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.9ms
Speed: 1.3ms preprocess, 24.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9462
Instance 2: Confidence=0.9264
Instance 3: Confidence=0.8582
Instance 4: Confidence=0.8035
Instance 5: Confidence=0.7958
Instance 6: Confidence=0.3784
Selected instance: 1 (Confidence: 0.9462)
tmp min: tensor(0.) tmp max: tensor(1.)
547 116 540 960
There are 14 prompts
current IoU is: 0.9257308840751648
Seok, iteration idx= 8 IoU = tensor(0.9257)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.3ms
Speed: 1.4ms preprocess, 24.3ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 4
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9397
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.9188
Selected instance: 2 (Confidence: 0.9333)
tmp min: tensor(0.) tmp max: tensor(1.)
426 72 540 960
There are 14 prompts
current IoU is: 0.9034515619277954
Seok, iteration idx= 9 IoU = tensor(0.9035)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.0ms
Speed: 3.1ms preprocess, 24.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 4
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9233
Instance 2: Confidence=0.8993
Instance 3: Confidence=0.7667
Selected instance: 2 (Confidence: 0.8993)
tmp min: tensor(0.) tmp max: tensor(1.)
354 72 540 960
There are 15 prompts
current IoU is: 0.8567199110984802
Seok, iteration idx= 10 IoU = tensor(0.8567)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 2.8ms preprocess, 23.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9608
Instance 1: Confidence=0.9321
Instance 2: Confidence=0.9267
Instance 3: Confidence=0.6191
Instance 4: Confidence=0.4317
Instance 5: Confidence=0.4099
Selected instance: 2 (Confidence: 0.9267)
tmp min: tensor(0.) tmp max: tensor(1.)
295 36 540 960
There are 16 prompts
current IoU is: 0.9344415664672852
Seok, iteration idx= 11 IoU = tensor(0.9344)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 3.0ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9405
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9210
Instance 5: Confidence=0.9140
Selected instance: 3 (Confidence: 0.9217)
tmp min: tensor(0.) tmp max: tensor(1.)
498 116 540 960
There are 17 prompts
current IoU is: 0.7077014446258545
Seok, iteration idx= 12 IoU = tensor(0.7077)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.9ms
Speed: 1.3ms preprocess, 24.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9598
Instance 1: Confidence=0.9502
Instance 2: Confidence=0.9318
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9104
Instance 5: Confidence=0.8862
Selected instance: 5 (Confidence: 0.8862)
tmp min: tensor(0.) tmp max: tensor(1.)
530 100 540 960
There are 19 prompts
current IoU is: 0.7374179363250732
Seok, iteration idx= 13 IoU = tensor(0.7374)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.6ms
Speed: 1.2ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.9447
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.7582
Instance 5: Confidence=0.7479
Instance 6: Confidence=0.3858
Selected instance: 6 (Confidence: 0.3858)
tmp min: tensor(0.) tmp max: tensor(1.)
576 92 540 960
There are 17 prompts
current IoU is: 0.5441176295280457
Seok, iteration idx= 14 IoU = tensor(0.5441)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 25.2ms
Speed: 1.3ms preprocess, 25.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 7
Instance 0: Confidence=0.9569
Instance 1: Confidence=0.9488
Instance 2: Confidence=0.9424
Instance 3: Confidence=0.9368
Instance 4: Confidence=0.3790
Instance 5: Confidence=0.3706
Instance 6: Confidence=0.3087
Selected instance: 1 (Confidence: 0.9488)
tmp min: tensor(0.) tmp max: tensor(1.)
583 76 540 960
There are 16 prompts
current IoU is: 0.012980923056602478
Seok, iteration idx= 15 IoU = tensor(0.0130)
SKIP, unacceptable sam prediction, IoU is tensor(0.0130)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 3.4ms preprocess, 23.9ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9515
Instance 2: Confidence=0.9465
Instance 3: Confidence=0.9285
Instance 4: Confidence=0.5979
Selected instance: 1 (Confidence: 0.9515)
tmp min: tensor(0.) tmp max: tensor(1.)
592 60 540 960
There are 16 prompts
current IoU is: 0.00427060853689909
Seok, iteration idx= 16 IoU = tensor(0.0043)
SKIP, unacceptable sam prediction, IoU is tensor(0.0043)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9450
Instance 2: Confidence=0.9402
Instance 3: Confidence=0.9285
Instance 4: Confidence=0.6814
Selected instance: 4 (Confidence: 0.6814)
tmp min: tensor(0.) tmp max: tensor(1.)
668 76 540 960
There are 14 prompts
current IoU is: 0.18174709379673004
Seok, iteration idx= 17 IoU = tensor(0.1817)
SKIP, unacceptable sam prediction, IoU is tensor(0.1817)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.6ms
Speed: 3.0ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 8
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9512
Instance 2: Confidence=0.9320
Instance 3: Confidence=0.9235
Instance 4: Confidence=0.8462
Instance 5: Confidence=0.5823
Instance 6: Confidence=0.4505
Instance 7: Confidence=0.2670
Selected instance: 4 (Confidence: 0.8462)
tmp min: tensor(0.) tmp max: tensor(1.)
678 64 540 960
There are 17 prompts
current IoU is: 0.4695150852203369
Seok, iteration idx= 18 IoU = tensor(0.4695)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 3.2ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9517
Instance 2: Confidence=0.9480
Instance 3: Confidence=0.9387
Instance 4: Confidence=0.9152
Instance 5: Confidence=0.5453
Instance 6: Confidence=0.3526
Selected instance: 3 (Confidence: 0.9387)
tmp min: tensor(0.) tmp max: tensor(1.)
692 56 540 960
There are 17 prompts
current IoU is: 0.8304738998413086
Seok, iteration idx= 19 IoU = tensor(0.8305)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 2.6ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9603
Instance 1: Confidence=0.9415
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9376
Instance 4: Confidence=0.7264
Instance 5: Confidence=0.3404
Selected instance: 3 (Confidence: 0.9376)
tmp min: tensor(0.) tmp max: tensor(1.)
229 16 540 960
There are 15 prompts
current IoU is: 0.9503912329673767
Seok, iteration idx= 20 IoU = tensor(0.9504)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.7ms
Speed: 3.2ms preprocess, 24.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9516
Instance 1: Confidence=0.9497
Instance 2: Confidence=0.9427
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.3692
Selected instance: 2 (Confidence: 0.9427)
tmp min: tensor(0.) tmp max: tensor(1.)
132 16 540 960
There are 15 prompts
current IoU is: 0.9461303353309631
Seok, iteration idx= 21 IoU = tensor(0.9461)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.5ms
Speed: 3.1ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 4
Instance 0: Confidence=0.9620
Instance 1: Confidence=0.9516
Instance 2: Confidence=0.9441
Instance 3: Confidence=0.8590
Selected instance: 0 (Confidence: 0.9620)
tmp min: tensor(0.) tmp max: tensor(1.)
93 20 540 960
There are 16 prompts
current IoU is: 0.9350932836532593
Seok, iteration idx= 22 IoU = tensor(0.9351)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.2ms
Speed: 1.4ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 4
Instance 0: Confidence=0.9596
Instance 1: Confidence=0.9460
Instance 2: Confidence=0.9159
Instance 3: Confidence=0.3852
Selected instance: 0 (Confidence: 0.9596)
tmp min: tensor(0.) tmp max: tensor(1.)
50 24 540 960
There are 14 prompts
current IoU is: 0.9407596588134766
Seok, iteration idx= 23 IoU = tensor(0.9408)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 1.3ms preprocess, 22.7ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9604
Instance 1: Confidence=0.9048
Instance 2: Confidence=0.8323
Instance 3: Confidence=0.7273
Instance 4: Confidence=0.5794
Instance 5: Confidence=0.3322
Selected instance: 0 (Confidence: 0.9604)
tmp min: tensor(0.) tmp max: tensor(1.)
43 48 540 960
There are 12 prompts
current IoU is: 0.9085791707038879
Seok, iteration idx= 24 IoU = tensor(0.9086)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9554
Instance 2: Confidence=0.9503
Instance 3: Confidence=0.9088
Instance 4: Confidence=0.2799
Instance 5: Confidence=0.2793
Selected instance: 0 (Confidence: 0.9652)
tmp min: tensor(0.) tmp max: tensor(1.)
71 76 540 960
There are 13 prompts
current IoU is: 0.8530629873275757
Seok, iteration idx= 25 IoU = tensor(0.8531)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.3ms preprocess, 24.2ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9443
Instance 1: Confidence=0.9402
Instance 2: Confidence=0.9050
Instance 3: Confidence=0.8995
Instance 4: Confidence=0.8411
Instance 5: Confidence=0.8070
Selected instance: 0 (Confidence: 0.9443)
tmp min: tensor(0.) tmp max: tensor(1.)
98 92 540 960
There are 15 prompts
current IoU is: 0.8756521344184875
Seok, iteration idx= 26 IoU = tensor(0.8757)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.6ms
Speed: 1.2ms preprocess, 24.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9572
Instance 1: Confidence=0.9524
Instance 2: Confidence=0.9424
Instance 3: Confidence=0.9414
Instance 4: Confidence=0.8698
Selected instance: 2 (Confidence: 0.9424)
tmp min: tensor(0.) tmp max: tensor(1.)
123 136 540 960
There are 14 prompts
current IoU is: 0.899793803691864
Seok, iteration idx= 27 IoU = tensor(0.8998)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 1.3ms preprocess, 22.8ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 7
Instance 0: Confidence=0.9549
Instance 1: Confidence=0.9432
Instance 2: Confidence=0.9343
Instance 3: Confidence=0.9288
Instance 4: Confidence=0.8839
Instance 5: Confidence=0.5460
Instance 6: Confidence=0.2770
Selected instance: 3 (Confidence: 0.9288)
tmp min: tensor(0.) tmp max: tensor(1.)
745 88 540 960
There are 17 prompts
current IoU is: 0.8779312968254089
Seok, iteration idx= 28 IoU = tensor(0.8779)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.9376
Instance 2: Confidence=0.9306
Instance 3: Confidence=0.8279
Instance 4: Confidence=0.7871
Instance 5: Confidence=0.3723
Instance 6: Confidence=0.2568
Selected instance: 2 (Confidence: 0.9306)
tmp min: tensor(0.) tmp max: tensor(1.)
727 88 540 960
There are 17 prompts
current IoU is: 0.8720985054969788
Seok, iteration idx= 29 IoU = tensor(0.8721)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.5ms
Speed: 2.3ms preprocess, 24.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9439
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9349
Instance 3: Confidence=0.8851
Instance 4: Confidence=0.5107
Selected instance: 2 (Confidence: 0.9349)
tmp min: tensor(0.) tmp max: tensor(1.)
744 120 540 960
There are 15 prompts
current IoU is: 0.8758668303489685
Seok, iteration idx= 30 IoU = tensor(0.8759)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 3.0ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9620
Instance 1: Confidence=0.9385
Instance 2: Confidence=0.9375
Instance 3: Confidence=0.9245
Instance 4: Confidence=0.8593
Selected instance: 0 (Confidence: 0.9620)
tmp min: tensor(0.) tmp max: tensor(1.)
817 84 540 960
There are 13 prompts
current IoU is: 0.8766649961471558
Seok, iteration idx= 31 IoU = tensor(0.8767)
Selected Instance Confidence List: [tensor(0.9529), tensor(0.9417, device='cpu'), tensor(0.9443, device='cpu'), tensor(0.9288, device='cpu'), tensor(0.9417, device='cpu'), tensor(0.9503, device='cpu'), tensor(0.9037, device='cpu'), tensor(0.9357, device='cpu'), tensor(0.9339, device='cpu'), tensor(0.9154, device='cpu'), tensor(0.8738, device='cpu'), tensor(0.9314, device='cpu'), tensor(0.7933, device='cpu'), tensor(0.7969, device='cpu'), tensor(0.5008, device='cpu'), tensor(0.3873, device='cpu'), tensor(0.3832, device='cpu'), tensor(0.3882, device='cpu'), tensor(0.6202, device='cpu'), tensor(0.8738, device='cpu'), tensor(0.9453, device='cpu'), tensor(0.9448, device='cpu'), tensor(0.9458, device='cpu'), tensor(0.9483, device='cpu'), tensor(0.9293, device='cpu'), tensor(0.8979, device='cpu'), tensor(0.9031, device='cpu'), tensor(0.9168, device='cpu'), tensor(0.8983, device='cpu'), tensor(0.8955, device='cpu'), tensor(0.8995, device='cpu'), tensor(0.9108, device='cpu')]
Sorted Confidence Order: [tensor(0.9529), tensor(0.9417, device='cpu'), tensor(0.9443, device='cpu'), tensor(0.9288, device='cpu'), tensor(0.9417, device='cpu'), tensor(0.9503, device='cpu'), tensor(0.9037, device='cpu'), tensor(0.9357, device='cpu'), tensor(0.9339, device='cpu'), tensor(0.9154, device='cpu'), tensor(0.8738, device='cpu'), tensor(0.9314, device='cpu'), tensor(0.9453, device='cpu'), tensor(0.9448, device='cpu'), tensor(0.9458, device='cpu'), tensor(0.9483, device='cpu'), tensor(0.9293, device='cpu'), tensor(0.8979, device='cpu'), tensor(0.9031, device='cpu'), tensor(0.9168, device='cpu'), tensor(0.7933, device='cpu'), tensor(0.7969, device='cpu'), tensor(0.5008, device='cpu'), tensor(0.3873, device='cpu'), tensor(0.3832, device='cpu'), tensor(0.3882, device='cpu'), tensor(0.6202, device='cpu'), tensor(0.8738, device='cpu'), tensor(0.8983, device='cpu'), tensor(0.8955, device='cpu'), tensor(0.8995, device='cpu'), tensor(0.9108, device='cpu')]
sorted_indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 20, 21, 22, 23, 24, 25, 26, 27, 12, 13, 14, 15, 16, 17, 18, 19, 28, 29, 30, 31]
Initial view (highest confidence): 1
New training order: [25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 9, 10, 11, 12, 13, 14, 15, 16, 1, 2, 3, 4, 5, 6, 7, 8, 21, 22, 23, 24]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.1ms
Speed: 1.4ms preprocess, 21.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 1.3ms preprocess, 23.1ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9656
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8572
Instance 5: Confidence=0.7074
tmp min: tensor(0.) tmp max: tensor(1.)
883 44 540 960
There are 16 prompts
current IoU is: 0.9475141167640686
Seok, iteration idx= 1 IoU = tensor(0.9475)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.6ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9558
Instance 1: Confidence=0.9384
Instance 2: Confidence=0.9350
Instance 3: Confidence=0.9330
Instance 4: Confidence=0.8556
Instance 5: Confidence=0.8479
tmp min: tensor(0.) tmp max: tensor(1.)
889 56 540 960
There are 14 prompts
current IoU is: 0.9553112983703613
Seok, iteration idx= 2 IoU = tensor(0.9553)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.8ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9492
Instance 1: Confidence=0.9473
Instance 2: Confidence=0.8976
Instance 3: Confidence=0.8878
Instance 4: Confidence=0.7385
tmp min: tensor(0.) tmp max: tensor(1.)
955 48 540 960
There are 14 prompts
current IoU is: 0.9473476409912109
Seok, iteration idx= 3 IoU = tensor(0.9473)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.9ms preprocess, 23.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9493
Instance 1: Confidence=0.9481
Instance 2: Confidence=0.9454
Instance 3: Confidence=0.8710
Instance 4: Confidence=0.5295
Instance 5: Confidence=0.5013
tmp min: tensor(0.) tmp max: tensor(1.)
951 24 540 960
There are 14 prompts
current IoU is: 0.9367607235908508
Seok, iteration idx= 4 IoU = tensor(0.9368)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.0ms
Speed: 1.4ms preprocess, 25.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9719
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9354
Instance 3: Confidence=0.8589
Instance 4: Confidence=0.5243
tmp min: tensor(0.) tmp max: tensor(1.)
857 48 540 960
There are 15 prompts
current IoU is: 0.9679398536682129
Seok, iteration idx= 5 IoU = tensor(0.9679)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.8ms
Speed: 1.3ms preprocess, 24.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9585
Instance 2: Confidence=0.9417
Instance 3: Confidence=0.9039
Instance 4: Confidence=0.8364
Instance 5: Confidence=0.4622
tmp min: tensor(0.) tmp max: tensor(1.)
808 12 540 960
There are 12 prompts
current IoU is: 0.9642012119293213
Seok, iteration idx= 6 IoU = tensor(0.9642)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 3.1ms preprocess, 23.2ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9523
Instance 2: Confidence=0.9520
Instance 3: Confidence=0.8925
Instance 4: Confidence=0.6584
tmp min: tensor(0.) tmp max: tensor(1.)
711 28 540 960
There are 14 prompts
current IoU is: 0.9577597975730896
Seok, iteration idx= 7 IoU = tensor(0.9578)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.2ms
Speed: 3.7ms preprocess, 23.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9462
Instance 2: Confidence=0.9264
Instance 3: Confidence=0.8582
Instance 4: Confidence=0.8035
Instance 5: Confidence=0.7958
Instance 6: Confidence=0.3784
tmp min: tensor(0.) tmp max: tensor(1.)
547 116 540 960
There are 14 prompts
current IoU is: 0.9603796005249023
Seok, iteration idx= 8 IoU = tensor(0.9604)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.7ms
Speed: 1.3ms preprocess, 24.7ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 4
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9397
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.9188
tmp min: tensor(0.) tmp max: tensor(1.)
426 72 540 960
There are 14 prompts
current IoU is: 0.9447212815284729
Seok, iteration idx= 9 IoU = tensor(0.9447)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 4
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9233
Instance 2: Confidence=0.8993
Instance 3: Confidence=0.7667
tmp min: tensor(0.) tmp max: tensor(1.)
354 72 540 960
There are 15 prompts
current IoU is: 0.8818365335464478
Seok, iteration idx= 10 IoU = tensor(0.8818)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.8ms
Speed: 1.3ms preprocess, 24.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9608
Instance 1: Confidence=0.9321
Instance 2: Confidence=0.9267
Instance 3: Confidence=0.6191
Instance 4: Confidence=0.4317
Instance 5: Confidence=0.4099
tmp min: tensor(0.) tmp max: tensor(1.)
295 36 540 960
There are 16 prompts
current IoU is: 0.9512128829956055
Seok, iteration idx= 11 IoU = tensor(0.9512)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.4ms
Speed: 1.3ms preprocess, 24.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9603
Instance 1: Confidence=0.9415
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9376
Instance 4: Confidence=0.7264
Instance 5: Confidence=0.3404
tmp min: tensor(0.) tmp max: tensor(1.)
229 16 540 960
There are 15 prompts
current IoU is: 0.9610168933868408
Seok, iteration idx= 12 IoU = tensor(0.9610)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.6ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9516
Instance 1: Confidence=0.9497
Instance 2: Confidence=0.9427
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.3692
tmp min: tensor(0.) tmp max: tensor(1.)
132 16 540 960
There are 15 prompts
current IoU is: 0.9716851711273193
Seok, iteration idx= 13 IoU = tensor(0.9717)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.6ms
Speed: 1.8ms preprocess, 23.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 4
Instance 0: Confidence=0.9620
Instance 1: Confidence=0.9516
Instance 2: Confidence=0.9441
Instance 3: Confidence=0.8590
tmp min: tensor(0.) tmp max: tensor(1.)
93 20 540 960
There are 16 prompts
current IoU is: 0.9727860689163208
Seok, iteration idx= 14 IoU = tensor(0.9728)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 25.7ms
Speed: 1.9ms preprocess, 25.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 4
Instance 0: Confidence=0.9596
Instance 1: Confidence=0.9460
Instance 2: Confidence=0.9159
Instance 3: Confidence=0.3852
tmp min: tensor(0.) tmp max: tensor(1.)
50 24 540 960
There are 14 prompts
current IoU is: 0.9643110632896423
Seok, iteration idx= 15 IoU = tensor(0.9643)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.7ms
Speed: 1.2ms preprocess, 24.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9604
Instance 1: Confidence=0.9048
Instance 2: Confidence=0.8323
Instance 3: Confidence=0.7273
Instance 4: Confidence=0.5794
Instance 5: Confidence=0.3322
tmp min: tensor(0.) tmp max: tensor(1.)
43 48 540 960
There are 12 prompts
current IoU is: 0.9635674357414246
Seok, iteration idx= 16 IoU = tensor(0.9636)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.3ms preprocess, 24.1ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9554
Instance 2: Confidence=0.9503
Instance 3: Confidence=0.9088
Instance 4: Confidence=0.2799
Instance 5: Confidence=0.2793
tmp min: tensor(0.) tmp max: tensor(1.)
71 76 540 960
There are 13 prompts
current IoU is: 0.9643946886062622
Seok, iteration idx= 17 IoU = tensor(0.9644)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.3ms preprocess, 24.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9443
Instance 1: Confidence=0.9402
Instance 2: Confidence=0.9050
Instance 3: Confidence=0.8995
Instance 4: Confidence=0.8411
Instance 5: Confidence=0.8070
tmp min: tensor(0.) tmp max: tensor(1.)
98 92 540 960
There are 15 prompts
current IoU is: 0.9411396980285645
Seok, iteration idx= 18 IoU = tensor(0.9411)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.3ms preprocess, 23.6ms inference, 3.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9572
Instance 1: Confidence=0.9524
Instance 2: Confidence=0.9424
Instance 3: Confidence=0.9414
Instance 4: Confidence=0.8698
tmp min: tensor(0.) tmp max: tensor(1.)
123 136 540 960
There are 14 prompts
current IoU is: 0.912179708480835
Seok, iteration idx= 19 IoU = tensor(0.9122)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 3.1ms preprocess, 22.7ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9405
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9210
Instance 5: Confidence=0.9140
tmp min: tensor(0.) tmp max: tensor(1.)
498 116 540 960
There are 17 prompts
current IoU is: 0.8217200636863708
Seok, iteration idx= 20 IoU = tensor(0.8217)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 3.0ms preprocess, 24.1ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9598
Instance 1: Confidence=0.9502
Instance 2: Confidence=0.9318
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9104
Instance 5: Confidence=0.8862
tmp min: tensor(0.) tmp max: tensor(1.)
530 100 540 960
There are 19 prompts
current IoU is: 0.8175114989280701
Seok, iteration idx= 21 IoU = tensor(0.8175)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 7
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.9447
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.7582
Instance 5: Confidence=0.7479
Instance 6: Confidence=0.3858
tmp min: tensor(0.) tmp max: tensor(1.)
576 92 540 960
There are 17 prompts
current IoU is: 0.6691163778305054
Seok, iteration idx= 22 IoU = tensor(0.6691)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.5ms
Speed: 1.5ms preprocess, 24.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 7
Instance 0: Confidence=0.9569
Instance 1: Confidence=0.9488
Instance 2: Confidence=0.9424
Instance 3: Confidence=0.9368
Instance 4: Confidence=0.3790
Instance 5: Confidence=0.3706
Instance 6: Confidence=0.3087
tmp min: tensor(0.) tmp max: tensor(1.)
583 76 540 960
There are 16 prompts
current IoU is: 0.013318161480128765
Seok, iteration idx= 23 IoU = tensor(0.0133)
SKIP, unacceptable sam prediction, IoU is tensor(0.0133)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9515
Instance 2: Confidence=0.9465
Instance 3: Confidence=0.9285
Instance 4: Confidence=0.5979
tmp min: tensor(0.) tmp max: tensor(1.)
592 60 540 960
There are 16 prompts
current IoU is: 0.0041921744123101234
Seok, iteration idx= 24 IoU = tensor(0.0042)
SKIP, unacceptable sam prediction, IoU is tensor(0.0042)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9450
Instance 2: Confidence=0.9402
Instance 3: Confidence=0.9285
Instance 4: Confidence=0.6814
tmp min: tensor(0.) tmp max: tensor(1.)
668 76 540 960
There are 14 prompts
current IoU is: 0.3760445713996887
Seok, iteration idx= 25 IoU = tensor(0.3760)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.9ms
Speed: 1.9ms preprocess, 23.9ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 8
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9512
Instance 2: Confidence=0.9320
Instance 3: Confidence=0.9235
Instance 4: Confidence=0.8462
Instance 5: Confidence=0.5823
Instance 6: Confidence=0.4505
Instance 7: Confidence=0.2670
tmp min: tensor(0.) tmp max: tensor(1.)
678 64 540 960
There are 17 prompts
current IoU is: 0.7331470847129822
Seok, iteration idx= 26 IoU = tensor(0.7331)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 3.3ms preprocess, 23.8ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 7
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9517
Instance 2: Confidence=0.9480
Instance 3: Confidence=0.9387
Instance 4: Confidence=0.9152
Instance 5: Confidence=0.5453
Instance 6: Confidence=0.3526
tmp min: tensor(0.) tmp max: tensor(1.)
692 56 540 960
There are 17 prompts
current IoU is: 0.8414542078971863
Seok, iteration idx= 27 IoU = tensor(0.8415)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 25.8ms
Speed: 3.4ms preprocess, 25.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 7
Instance 0: Confidence=0.9549
Instance 1: Confidence=0.9432
Instance 2: Confidence=0.9343
Instance 3: Confidence=0.9288
Instance 4: Confidence=0.8839
Instance 5: Confidence=0.5460
Instance 6: Confidence=0.2770
tmp min: tensor(0.) tmp max: tensor(1.)
745 88 540 960
There are 17 prompts
current IoU is: 0.8960492014884949
Seok, iteration idx= 28 IoU = tensor(0.8960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.0ms
Speed: 3.2ms preprocess, 24.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.9376
Instance 2: Confidence=0.9306
Instance 3: Confidence=0.8279
Instance 4: Confidence=0.7871
Instance 5: Confidence=0.3723
Instance 6: Confidence=0.2568
tmp min: tensor(0.) tmp max: tensor(1.)
727 88 540 960
There are 17 prompts
current IoU is: 0.8892847299575806
Seok, iteration idx= 29 IoU = tensor(0.8893)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.3ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9439
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9349
Instance 3: Confidence=0.8851
Instance 4: Confidence=0.5107
tmp min: tensor(0.) tmp max: tensor(1.)
744 120 540 960
There are 15 prompts
current IoU is: 0.8883234858512878
Seok, iteration idx= 30 IoU = tensor(0.8883)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.1ms
Speed: 1.3ms preprocess, 25.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9620
Instance 1: Confidence=0.9385
Instance 2: Confidence=0.9375
Instance 3: Confidence=0.9245
Instance 4: Confidence=0.8593
tmp min: tensor(0.) tmp max: tensor(1.)
817 84 540 960
There are 13 prompts
current IoU is: 0.9040926694869995
Seok, iteration idx= 31 IoU = tensor(0.9041)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set1_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set1_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:43<00:00,  1.36s/it]
Testing psnr 28.20988915860653 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set1_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:29<00:00,  1.09it/s]
Testing psnr 3.6114913318306208 (avg)
train: coarse segmentation in 00:04:21
train: finish (eps time 00:04:21 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set1_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set2/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 35.49it/s]
Loaded image data (540, 960, 3, 32) [        540         960      752.26]
Loaded ./data/360_v2/Set2 1.2440621357132549 85.66757164363565
UserWarning: Optimal rotation is not uniquely or poorly defined for the given sets of vectors.
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960      752.26] ./data/360_v2/Set2
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.2539947867393494
original far 19.433752059936523
NEAR FAR 0 2.2590632
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.0105, -0.9112, -0.8033])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7333, 0.8326, 0.9405])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set2_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.8ms
Speed: 2.3ms preprocess, 20.8ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.6ms
Speed: 1.3ms preprocess, 20.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.3ms preprocess, 22.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.9ms
Speed: 1.5ms preprocess, 20.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.3ms
Speed: 1.4ms preprocess, 21.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.5ms
Speed: 1.4ms preprocess, 21.5ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.2ms preprocess, 20.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.6ms
Speed: 1.8ms preprocess, 21.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.8ms
Speed: 1.2ms preprocess, 20.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.4ms
Speed: 1.2ms preprocess, 21.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.4ms
Speed: 1.2ms preprocess, 21.4ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.3ms
Speed: 1.2ms preprocess, 21.3ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.6ms
Speed: 1.6ms preprocess, 21.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.6ms
Speed: 1.2ms preprocess, 20.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.0ms
Speed: 1.3ms preprocess, 21.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.4ms
Speed: 1.2ms preprocess, 21.4ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.9ms
Speed: 1.2ms preprocess, 20.9ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.6ms
Speed: 1.7ms preprocess, 21.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.3ms
Speed: 1.2ms preprocess, 21.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.0ms
Speed: 1.2ms preprocess, 21.0ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.2ms
Speed: 1.2ms preprocess, 21.2ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.5ms
Speed: 1.7ms preprocess, 21.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.1ms
Speed: 1.2ms preprocess, 21.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.3ms
Speed: 1.2ms preprocess, 21.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.9ms
Speed: 1.2ms preprocess, 20.9ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.9ms
Speed: 1.2ms preprocess, 21.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.8ms
Speed: 1.3ms preprocess, 20.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.6ms
Speed: 2.0ms preprocess, 21.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.2ms
Speed: 1.2ms preprocess, 21.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.4ms
Speed: 1.2ms preprocess, 21.4ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.8ms
Speed: 10.6ms preprocess, 22.8ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.9ms
Speed: 2.0ms preprocess, 21.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9300
Instance 3: Confidence=0.8918
Instance 4: Confidence=0.8458
Instance 5: Confidence=0.3819
Selected instance: 2 (Confidence: 0.9300)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

464 20 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.80633145570755
Seok, iteration idx= 1 IoU = tensor(0.8063)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.3ms
Speed: 5.6ms preprocess, 24.3ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 5
Instance 0: Confidence=0.9629
Instance 1: Confidence=0.9472
Instance 2: Confidence=0.9233
Instance 3: Confidence=0.8755
Instance 4: Confidence=0.7944
Selected instance: 2 (Confidence: 0.9233)
tmp min: tensor(0.) tmp max: tensor(1.)
433 44 540 960
There are 16 prompts
current IoU is: 0.8464546799659729
Seok, iteration idx= 2 IoU = tensor(0.8465)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 2.5ms preprocess, 22.6ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.8868
Instance 4: Confidence=0.7933
Selected instance: 1 (Confidence: 0.9430)
tmp min: tensor(0.) tmp max: tensor(1.)
401 88 540 960
There are 15 prompts
current IoU is: 0.9136825799942017
Seok, iteration idx= 3 IoU = tensor(0.9137)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.7ms
Speed: 3.1ms preprocess, 24.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9409
Instance 3: Confidence=0.9232
Instance 4: Confidence=0.7056
Instance 5: Confidence=0.5562
Selected instance: 3 (Confidence: 0.9232)
tmp min: tensor(0.) tmp max: tensor(1.)
486 60 540 960
There are 15 prompts
current IoU is: 0.4645603895187378
Seok, iteration idx= 4 IoU = tensor(0.4646)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 2.3ms preprocess, 22.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9383
Instance 3: Confidence=0.8695
Instance 4: Confidence=0.6814
Selected instance: 3 (Confidence: 0.8695)
tmp min: tensor(0.) tmp max: tensor(1.)
477 68 540 960
There are 17 prompts
current IoU is: 0.7970385551452637
Seok, iteration idx= 5 IoU = tensor(0.7970)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 3.1ms preprocess, 24.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9612
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8944
Instance 4: Confidence=0.5440
Instance 5: Confidence=0.3031
Selected instance: 3 (Confidence: 0.8944)
tmp min: tensor(0.) tmp max: tensor(1.)
504 100 540 960
There are 18 prompts
current IoU is: 0.8846654891967773
Seok, iteration idx= 6 IoU = tensor(0.8847)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.3ms preprocess, 22.4ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9577
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.8692
Instance 4: Confidence=0.8435
Instance 5: Confidence=0.2911
Selected instance: 3 (Confidence: 0.8692)
tmp min: tensor(0.) tmp max: tensor(1.)
559 52 540 960
current IoU is: 0.003514363896101713
Seok, iteration idx= 7 IoU = tensor(0.0035)
SKIP, unacceptable sam prediction, IoU is tensor(0.0035)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9609
Instance 2: Confidence=0.9381
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9067
Instance 5: Confidence=0.8774
Selected instance: 4 (Confidence: 0.9067)
tmp min: tensor(0.) tmp max: tensor(1.)
582 60 540 960
There are 14 prompts
current IoU is: 0.4248626232147217
Seok, iteration idx= 8 IoU = tensor(0.4249)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.6ms
Speed: 1.3ms preprocess, 24.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9636
Instance 1: Confidence=0.9628
Instance 2: Confidence=0.9492
Instance 3: Confidence=0.9315
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.3011
Selected instance: 5 (Confidence: 0.3011)
tmp min: tensor(0.) tmp max: tensor(1.)
600 40 540 960
There are 18 prompts
current IoU is: 0.6312187910079956
Seok, iteration idx= 9 IoU = tensor(0.6312)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 7
Instance 0: Confidence=0.9600
Instance 1: Confidence=0.9489
Instance 2: Confidence=0.9429
Instance 3: Confidence=0.9350
Instance 4: Confidence=0.7563
Instance 5: Confidence=0.5645
Instance 6: Confidence=0.3526
Selected instance: 5 (Confidence: 0.5645)
tmp min: tensor(0.) tmp max: tensor(1.)
616 48 540 960
There are 17 prompts
current IoU is: 0.4747810959815979
Seok, iteration idx= 10 IoU = tensor(0.4748)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9504
Instance 3: Confidence=0.7410
Instance 4: Confidence=0.5533
Instance 5: Confidence=0.5528
Instance 6: Confidence=0.3753
Selected instance: 5 (Confidence: 0.5528)
tmp min: tensor(0.) tmp max: tensor(1.)
681 32 540 960
There are 15 prompts
current IoU is: 0.768607497215271
Seok, iteration idx= 11 IoU = tensor(0.7686)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 1.3ms preprocess, 23.4ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9540
Instance 2: Confidence=0.9500
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9019
Instance 5: Confidence=0.7190
Selected instance: 3 (Confidence: 0.9365)
tmp min: tensor(0.) tmp max: tensor(1.)
726 4 540 960
There are 16 prompts
current IoU is: 0.8959833383560181
Seok, iteration idx= 12 IoU = tensor(0.8960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 1.3ms preprocess, 22.3ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9389
Instance 3: Confidence=0.9388
Instance 4: Confidence=0.9250
Selected instance: 2 (Confidence: 0.9389)
tmp min: tensor(0.) tmp max: tensor(1.)
687 48 540 960
There are 16 prompts
current IoU is: 0.9225732088088989
Seok, iteration idx= 13 IoU = tensor(0.9226)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9248
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9204
Instance 5: Confidence=0.5236
Instance 6: Confidence=0.2980
Selected instance: 1 (Confidence: 0.9474)
tmp min: tensor(0.) tmp max: tensor(1.)
705 16 540 960
There are 14 prompts
current IoU is: 0.9288186430931091
Seok, iteration idx= 14 IoU = tensor(0.9288)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.7ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.9090
Instance 5: Confidence=0.8731
Selected instance: 2 (Confidence: 0.9324)
tmp min: tensor(0.) tmp max: tensor(1.)
696 28 540 960
There are 17 prompts
current IoU is: 0.9406614303588867
Seok, iteration idx= 15 IoU = tensor(0.9407)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 2.3ms preprocess, 23.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9339
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9057
Instance 5: Confidence=0.8295
Selected instance: 0 (Confidence: 0.9358)
tmp min: tensor(0.) tmp max: tensor(1.)
644 104 540 960
There are 17 prompts
current IoU is: 0.9447518587112427
Seok, iteration idx= 16 IoU = tensor(0.9448)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 4.0ms preprocess, 22.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9287
Instance 4: Confidence=0.9237
Selected instance: 2 (Confidence: 0.9399)
tmp min: tensor(0.) tmp max: tensor(1.)
662 64 540 960
There are 16 prompts
current IoU is: 0.9512990117073059
Seok, iteration idx= 17 IoU = tensor(0.9513)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 2.2ms preprocess, 24.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9501
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9253
Instance 3: Confidence=0.9167
Instance 4: Confidence=0.9130
Instance 5: Confidence=0.7570
Selected instance: 2 (Confidence: 0.9253)
tmp min: tensor(0.) tmp max: tensor(1.)
647 60 540 960
There are 15 prompts
current IoU is: 0.9645362496376038
Seok, iteration idx= 18 IoU = tensor(0.9645)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.4ms
Speed: 2.1ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9468
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9173
Instance 3: Confidence=0.9139
Instance 4: Confidence=0.9082
Instance 5: Confidence=0.8839
Selected instance: 1 (Confidence: 0.9373)
tmp min: tensor(0.) tmp max: tensor(1.)
664 32 540 960
There are 17 prompts
current IoU is: 0.9623361825942993
Seok, iteration idx= 19 IoU = tensor(0.9623)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.3ms preprocess, 24.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9123
Instance 4: Confidence=0.8140
Instance 5: Confidence=0.7047
Selected instance: 2 (Confidence: 0.9145)
tmp min: tensor(0.) tmp max: tensor(1.)
351 88 540 960
There are 15 prompts
current IoU is: 0.8799508213996887
Seok, iteration idx= 20 IoU = tensor(0.8800)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.4ms preprocess, 24.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9382
Instance 3: Confidence=0.9325
Instance 4: Confidence=0.8753
Selected instance: 1 (Confidence: 0.9396)
tmp min: tensor(0.) tmp max: tensor(1.)
355 72 540 960
There are 16 prompts
current IoU is: 0.8882198929786682
Seok, iteration idx= 21 IoU = tensor(0.8882)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.3ms preprocess, 22.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9564
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9442
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.9084
Selected instance: 3 (Confidence: 0.9409)
tmp min: tensor(0.) tmp max: tensor(1.)
376 60 540 960
There are 16 prompts
current IoU is: 0.9187584519386292
Seok, iteration idx= 22 IoU = tensor(0.9188)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.3ms preprocess, 24.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9426
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9157
Instance 4: Confidence=0.8987
Instance 5: Confidence=0.8984
Selected instance: 5 (Confidence: 0.8984)
tmp min: tensor(0.) tmp max: tensor(1.)
365 60 540 960
There are 18 prompts
current IoU is: 0.9134791493415833
Seok, iteration idx= 23 IoU = tensor(0.9135)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.3ms
Speed: 1.3ms preprocess, 24.3ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9580
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9340
Instance 3: Confidence=0.9104
Instance 4: Confidence=0.8875
Selected instance: 2 (Confidence: 0.9340)
tmp min: tensor(0.) tmp max: tensor(1.)
400 4 540 960
There are 14 prompts
current IoU is: 0.00422578165307641
Seok, iteration idx= 24 IoU = tensor(0.0042)
SKIP, unacceptable sam prediction, IoU is tensor(0.0042)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.8ms
Speed: 1.4ms preprocess, 24.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9439
Instance 2: Confidence=0.9419
Instance 3: Confidence=0.9107
Instance 4: Confidence=0.8744
Instance 5: Confidence=0.8606
Selected instance: 5 (Confidence: 0.8606)
tmp min: tensor(0.) tmp max: tensor(1.)
449 52 540 960
There are 16 prompts
current IoU is: 0.8671360015869141
Seok, iteration idx= 25 IoU = tensor(0.8671)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 26.2ms
Speed: 1.3ms preprocess, 26.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9461
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9423
Instance 3: Confidence=0.8899
Instance 4: Confidence=0.8821
Instance 5: Confidence=0.8120
Selected instance: 1 (Confidence: 0.9430)
tmp min: tensor(0.) tmp max: tensor(1.)
430 40 540 960
There are 16 prompts
current IoU is: 0.9318258762359619
Seok, iteration idx= 26 IoU = tensor(0.9318)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 2.8ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9428
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.8651
Instance 4: Confidence=0.8009
Instance 5: Confidence=0.6158
Selected instance: 2 (Confidence: 0.9324)
tmp min: tensor(0.) tmp max: tensor(1.)
432 40 540 960
There are 15 prompts
current IoU is: 0.9377433061599731
Seok, iteration idx= 27 IoU = tensor(0.9377)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 1.3ms preprocess, 24.5ms inference, 4.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9324
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9186
Instance 3: Confidence=0.9152
Instance 4: Confidence=0.9005
Instance 5: Confidence=0.7954
Selected instance: 2 (Confidence: 0.9186)
tmp min: tensor(0.) tmp max: tensor(1.)
642 12 540 960
There are 15 prompts
current IoU is: 0.9550233483314514
Seok, iteration idx= 28 IoU = tensor(0.9550)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 3.1ms preprocess, 23.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9442
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8480
Instance 4: Confidence=0.7411
Instance 5: Confidence=0.4972
Instance 6: Confidence=0.3251
Selected instance: 2 (Confidence: 0.9149)
tmp min: tensor(0.) tmp max: tensor(1.)
610 4 540 960
There are 14 prompts
current IoU is: 0.9632749557495117
Seok, iteration idx= 29 IoU = tensor(0.9633)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 3.4ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9406
Instance 1: Confidence=0.9192
Instance 2: Confidence=0.8926
Instance 3: Confidence=0.8394
Instance 4: Confidence=0.4365
Instance 5: Confidence=0.4170
Instance 6: Confidence=0.3318
Selected instance: 1 (Confidence: 0.9192)
tmp min: tensor(0.) tmp max: tensor(1.)
569 0 540 960
There are 15 prompts
current IoU is: 0.9528376460075378
Seok, iteration idx= 30 IoU = tensor(0.9528)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 2.7ms preprocess, 23.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 7
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9065
Instance 2: Confidence=0.7635
Instance 3: Confidence=0.5051
Instance 4: Confidence=0.4478
Instance 5: Confidence=0.4426
Instance 6: Confidence=0.2696
Selected instance: 1 (Confidence: 0.9065)
tmp min: tensor(0.) tmp max: tensor(1.)
531 0 540 960
There are 14 prompts
current IoU is: 0.9671046137809753
Seok, iteration idx= 31 IoU = tensor(0.9671)
Selected Instance Confidence List: [tensor(0.9377), tensor(0.8558, device='cpu'), tensor(0.8772, device='cpu'), tensor(0.9254, device='cpu'), tensor(0.6480, device='cpu'), tensor(0.8260, device='cpu'), tensor(0.8885, device='cpu'), tensor(0.3873, device='cpu'), tensor(0.6176, device='cpu'), tensor(0.6317, device='cpu'), tensor(0.5107, device='cpu'), tensor(0.6823, device='cpu'), tensor(0.9122, device='cpu'), tensor(0.9291, device='cpu'), tensor(0.9362, device='cpu'), tensor(0.9373, device='cpu'), tensor(0.9412, device='cpu'), tensor(0.9467, device='cpu'), tensor(0.9489, device='cpu'), tensor(0.9523, device='cpu'), tensor(0.8938, device='cpu'), tensor(0.9088, device='cpu'), tensor(0.9276, device='cpu'), tensor(0.9075, device='cpu'), tensor(0.3832, device='cpu'), tensor(0.8645, device='cpu'), tensor(0.9363, device='cpu'), tensor(0.9356, device='cpu'), tensor(0.9404, device='cpu'), tensor(0.9439, device='cpu'), tensor(0.9394, device='cpu'), tensor(0.9429, device='cpu')]
Sorted Confidence Order: [tensor(0.9523, device='cpu'), tensor(0.9489, device='cpu'), tensor(0.9467, device='cpu'), tensor(0.9404, device='cpu'), tensor(0.9439, device='cpu'), tensor(0.9394, device='cpu'), tensor(0.9429, device='cpu'), tensor(0.9377), tensor(0.8558, device='cpu'), tensor(0.8772, device='cpu'), tensor(0.9254, device='cpu'), tensor(0.9412, device='cpu'), tensor(0.9373, device='cpu'), tensor(0.9362, device='cpu'), tensor(0.9291, device='cpu'), tensor(0.9122, device='cpu'), tensor(0.6823, device='cpu'), tensor(0.5107, device='cpu'), tensor(0.6317, device='cpu'), tensor(0.6176, device='cpu'), tensor(0.3873, device='cpu'), tensor(0.8885, device='cpu'), tensor(0.8260, device='cpu'), tensor(0.6480, device='cpu'), tensor(0.9356, device='cpu'), tensor(0.9363, device='cpu'), tensor(0.8645, device='cpu'), tensor(0.3832, device='cpu'), tensor(0.9075, device='cpu'), tensor(0.9276, device='cpu'), tensor(0.9088, device='cpu'), tensor(0.8938, device='cpu')]
sorted_indices: [19, 18, 17, 28, 29, 30, 31, 0, 1, 2, 3, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 27, 26, 25, 24, 23, 22, 21, 20]
Initial view (highest confidence): 24
New training order: [36, 35, 34, 9, 10, 11, 12, 13, 14, 15, 16, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.2ms
Speed: 1.3ms preprocess, 21.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 3.3ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9501
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9253
Instance 3: Confidence=0.9167
Instance 4: Confidence=0.9130
Instance 5: Confidence=0.7570
tmp min: tensor(0.) tmp max: tensor(1.)
647 60 540 960
There are 15 prompts
current IoU is: 0.9573858976364136
Seok, iteration idx= 1 IoU = tensor(0.9574)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9287
Instance 4: Confidence=0.9237
tmp min: tensor(0.) tmp max: tensor(1.)
662 64 540 960
There are 16 prompts
current IoU is: 0.9443821310997009
Seok, iteration idx= 2 IoU = tensor(0.9444)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 6
Instance 0: Confidence=0.9324
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9186
Instance 3: Confidence=0.9152
Instance 4: Confidence=0.9005
Instance 5: Confidence=0.7954
tmp min: tensor(0.) tmp max: tensor(1.)
642 12 540 960
There are 15 prompts
current IoU is: 0.9612179398536682
Seok, iteration idx= 3 IoU = tensor(0.9612)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 1.3ms preprocess, 23.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 7
Instance 0: Confidence=0.9442
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8480
Instance 4: Confidence=0.7411
Instance 5: Confidence=0.4972
Instance 6: Confidence=0.3251
tmp min: tensor(0.) tmp max: tensor(1.)
610 4 540 960
There are 14 prompts
current IoU is: 0.9635270237922668
Seok, iteration idx= 4 IoU = tensor(0.9635)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 7
Instance 0: Confidence=0.9406
Instance 1: Confidence=0.9192
Instance 2: Confidence=0.8926
Instance 3: Confidence=0.8394
Instance 4: Confidence=0.4365
Instance 5: Confidence=0.4170
Instance 6: Confidence=0.3318
tmp min: tensor(0.) tmp max: tensor(1.)
569 0 540 960
There are 15 prompts
current IoU is: 0.9533374905586243
Seok, iteration idx= 5 IoU = tensor(0.9533)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.4ms
Speed: 2.4ms preprocess, 24.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 7
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9065
Instance 2: Confidence=0.7635
Instance 3: Confidence=0.5051
Instance 4: Confidence=0.4478
Instance 5: Confidence=0.4426
Instance 6: Confidence=0.2696
tmp min: tensor(0.) tmp max: tensor(1.)
531 0 540 960
There are 14 prompts
current IoU is: 0.9683151245117188
Seok, iteration idx= 6 IoU = tensor(0.9683)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.9ms
Speed: 2.7ms preprocess, 24.9ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 8
Instance 0: Confidence=0.9377
Instance 1: Confidence=0.9249
Instance 2: Confidence=0.9153
Instance 3: Confidence=0.7253
Instance 4: Confidence=0.7085
Instance 5: Confidence=0.4352
Instance 6: Confidence=0.3452
Instance 7: Confidence=0.2772
tmp min: tensor(0.) tmp max: tensor(1.)
488 4 540 960
There are 14 prompts
current IoU is: 0.9629513025283813
Seok, iteration idx= 7 IoU = tensor(0.9630)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.8ms
Speed: 2.8ms preprocess, 24.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9300
Instance 3: Confidence=0.8918
Instance 4: Confidence=0.8458
Instance 5: Confidence=0.3819
tmp min: tensor(0.) tmp max: tensor(1.)
464 20 540 960
There are 16 prompts
current IoU is: 0.9425255656242371
Seok, iteration idx= 8 IoU = tensor(0.9425)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 26.6ms
Speed: 1.3ms preprocess, 26.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9629
Instance 1: Confidence=0.9472
Instance 2: Confidence=0.9233
Instance 3: Confidence=0.8755
Instance 4: Confidence=0.7944
tmp min: tensor(0.) tmp max: tensor(1.)
433 44 540 960
There are 16 prompts
current IoU is: 0.9606592059135437
Seok, iteration idx= 9 IoU = tensor(0.9607)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.7ms
Speed: 1.3ms preprocess, 24.7ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.8868
Instance 4: Confidence=0.7933
tmp min: tensor(0.) tmp max: tensor(1.)
401 88 540 960
There are 15 prompts
current IoU is: 0.9612101316452026
Seok, iteration idx= 10 IoU = tensor(0.9612)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.7ms
Speed: 1.5ms preprocess, 24.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9339
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9057
Instance 5: Confidence=0.8295
tmp min: tensor(0.) tmp max: tensor(1.)
644 104 540 960
There are 17 prompts
current IoU is: 0.9511563777923584
Seok, iteration idx= 11 IoU = tensor(0.9512)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 2.8ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.9090
Instance 5: Confidence=0.8731
tmp min: tensor(0.) tmp max: tensor(1.)
696 28 540 960
There are 17 prompts
current IoU is: 0.9622600078582764
Seok, iteration idx= 12 IoU = tensor(0.9623)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 3.1ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9248
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9204
Instance 5: Confidence=0.5236
Instance 6: Confidence=0.2980
tmp min: tensor(0.) tmp max: tensor(1.)
705 16 540 960
There are 14 prompts
current IoU is: 0.9574770331382751
Seok, iteration idx= 13 IoU = tensor(0.9575)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 2.7ms preprocess, 23.2ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9389
Instance 3: Confidence=0.9388
Instance 4: Confidence=0.9250
tmp min: tensor(0.) tmp max: tensor(1.)
687 48 540 960
There are 16 prompts
current IoU is: 0.9535821676254272
Seok, iteration idx= 14 IoU = tensor(0.9536)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 3.1ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9540
Instance 2: Confidence=0.9500
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9019
Instance 5: Confidence=0.7190
tmp min: tensor(0.) tmp max: tensor(1.)
726 4 540 960
There are 16 prompts
current IoU is: 0.9525040984153748
Seok, iteration idx= 15 IoU = tensor(0.9525)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 25.7ms
Speed: 2.7ms preprocess, 25.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 7
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9504
Instance 3: Confidence=0.7410
Instance 4: Confidence=0.5533
Instance 5: Confidence=0.5528
Instance 6: Confidence=0.3753
tmp min: tensor(0.) tmp max: tensor(1.)
681 32 540 960
There are 15 prompts
current IoU is: 0.7557386159896851
Seok, iteration idx= 16 IoU = tensor(0.7557)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.3ms
Speed: 1.3ms preprocess, 24.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 7
Instance 0: Confidence=0.9600
Instance 1: Confidence=0.9489
Instance 2: Confidence=0.9429
Instance 3: Confidence=0.9350
Instance 4: Confidence=0.7563
Instance 5: Confidence=0.5645
Instance 6: Confidence=0.3526
tmp min: tensor(0.) tmp max: tensor(1.)
616 48 540 960
There are 17 prompts
current IoU is: 0.5138424634933472
Seok, iteration idx= 17 IoU = tensor(0.5138)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9636
Instance 1: Confidence=0.9628
Instance 2: Confidence=0.9492
Instance 3: Confidence=0.9315
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.3011
tmp min: tensor(0.) tmp max: tensor(1.)
600 40 540 960
There are 18 prompts
current IoU is: 0.7139982581138611
Seok, iteration idx= 18 IoU = tensor(0.7140)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.0ms
Speed: 1.3ms preprocess, 25.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9609
Instance 2: Confidence=0.9381
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9067
Instance 5: Confidence=0.8774
tmp min: tensor(0.) tmp max: tensor(1.)
582 60 540 960
There are 14 prompts
current IoU is: 0.7753396034240723
Seok, iteration idx= 19 IoU = tensor(0.7753)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.6ms
Speed: 2.1ms preprocess, 24.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9577
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.8692
Instance 4: Confidence=0.8435
Instance 5: Confidence=0.2911
tmp min: tensor(0.) tmp max: tensor(1.)
483 0 540 960
There are 14 prompts
current IoU is: 5.2009112550877035e-05
Seok, iteration idx= 20 IoU = tensor(5.2009e-05)
SKIP, unacceptable sam prediction, IoU is tensor(5.2009e-05)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.3ms preprocess, 23.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9612
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8944
Instance 4: Confidence=0.5440
Instance 5: Confidence=0.3031
tmp min: tensor(0.) tmp max: tensor(1.)
504 100 540 960
There are 18 prompts
current IoU is: 0.8894702196121216
Seok, iteration idx= 21 IoU = tensor(0.8895)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.1ms
Speed: 1.3ms preprocess, 25.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9383
Instance 3: Confidence=0.8695
Instance 4: Confidence=0.6814
tmp min: tensor(0.) tmp max: tensor(1.)
477 68 540 960
There are 17 prompts
current IoU is: 0.9026535153388977
Seok, iteration idx= 22 IoU = tensor(0.9027)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.3ms preprocess, 23.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9409
Instance 3: Confidence=0.9232
Instance 4: Confidence=0.7056
Instance 5: Confidence=0.5562
tmp min: tensor(0.) tmp max: tensor(1.)
486 60 540 960
There are 15 prompts
current IoU is: 0.950469434261322
Seok, iteration idx= 23 IoU = tensor(0.9505)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9428
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.8651
Instance 4: Confidence=0.8009
Instance 5: Confidence=0.6158
tmp min: tensor(0.) tmp max: tensor(1.)
432 40 540 960
There are 15 prompts
current IoU is: 0.9409621357917786
Seok, iteration idx= 24 IoU = tensor(0.9410)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 2.9ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9461
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9423
Instance 3: Confidence=0.8899
Instance 4: Confidence=0.8821
Instance 5: Confidence=0.8120
tmp min: tensor(0.) tmp max: tensor(1.)
430 40 540 960
There are 16 prompts
current IoU is: 0.939201831817627
Seok, iteration idx= 25 IoU = tensor(0.9392)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 4.8ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9439
Instance 2: Confidence=0.9419
Instance 3: Confidence=0.9107
Instance 4: Confidence=0.8744
Instance 5: Confidence=0.8606
tmp min: tensor(0.) tmp max: tensor(1.)
449 52 540 960
There are 16 prompts
current IoU is: 0.8682019114494324
Seok, iteration idx= 26 IoU = tensor(0.8682)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 3.1ms preprocess, 23.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9580
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9340
Instance 3: Confidence=0.9104
Instance 4: Confidence=0.8875
tmp min: tensor(0.) tmp max: tensor(1.)
400 4 540 960
There are 14 prompts
current IoU is: 0.004835402127355337
Seok, iteration idx= 27 IoU = tensor(0.0048)
SKIP, unacceptable sam prediction, IoU is tensor(0.0048)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 3.1ms preprocess, 23.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9426
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9157
Instance 4: Confidence=0.8987
Instance 5: Confidence=0.8984
tmp min: tensor(0.) tmp max: tensor(1.)
365 60 540 960
There are 18 prompts
current IoU is: 0.9204413890838623
Seok, iteration idx= 28 IoU = tensor(0.9204)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 3.5ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9564
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9442
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.9084
tmp min: tensor(0.) tmp max: tensor(1.)
376 60 540 960
There are 16 prompts
current IoU is: 0.9291567206382751
Seok, iteration idx= 29 IoU = tensor(0.9292)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 2.2ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9382
Instance 3: Confidence=0.9325
Instance 4: Confidence=0.8753
tmp min: tensor(0.) tmp max: tensor(1.)
355 72 540 960
There are 16 prompts
current IoU is: 0.9247845411300659
Seok, iteration idx= 30 IoU = tensor(0.9248)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 3.1ms preprocess, 23.6ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9123
Instance 4: Confidence=0.8140
Instance 5: Confidence=0.7047
tmp min: tensor(0.) tmp max: tensor(1.)
351 88 540 960
There are 15 prompts
current IoU is: 0.9010195732116699
Seok, iteration idx= 31 IoU = tensor(0.9010)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set2_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set2_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:42<00:00,  1.33s/it]
Testing psnr 28.1736521422863 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set2_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:29<00:00,  1.09it/s]
Testing psnr 3.4413615614175797 (avg)
train: coarse segmentation in 00:10:31
train: finish (eps time 00:10:31 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set2_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set3/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 45.36it/s]
Loaded image data (540, 960, 3, 32) [        540         960      752.34]
Loaded ./data/360_v2/Set3 1.7761290072006928 55.6629549596001
UserWarning: Optimal rotation is not uniquely or poorly defined for the given sets of vectors.
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960      752.34] ./data/360_v2/Set3
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.36282292306423186
original far 12.634090423583984
NEAR FAR 0 2.2571032
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-0.9373, -0.8730, -0.7720])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.6911, 0.7554, 0.8564])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set3_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.0ms
Speed: 3.1ms preprocess, 22.0ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.8ms
Speed: 1.2ms preprocess, 21.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.6ms
Speed: 1.2ms preprocess, 21.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.0ms
Speed: 1.3ms preprocess, 22.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.9ms
Speed: 1.4ms preprocess, 21.9ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.1ms
Speed: 1.3ms preprocess, 21.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 1.2ms preprocess, 22.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.4ms
Speed: 1.5ms preprocess, 21.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.5ms
Speed: 1.4ms preprocess, 21.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.1ms
Speed: 1.6ms preprocess, 22.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.6ms
Speed: 1.3ms preprocess, 21.6ms inference, 3.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.3ms
Speed: 1.5ms preprocess, 21.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.8ms
Speed: 1.4ms preprocess, 21.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.6ms
Speed: 1.4ms preprocess, 21.6ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.5ms
Speed: 1.5ms preprocess, 21.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.8ms
Speed: 1.5ms preprocess, 20.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.9ms
Speed: 1.5ms preprocess, 21.9ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.1ms
Speed: 1.4ms preprocess, 21.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.6ms
Speed: 1.7ms preprocess, 21.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.8ms
Speed: 1.4ms preprocess, 21.8ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.3ms
Speed: 1.5ms preprocess, 21.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.5ms
Speed: 1.4ms preprocess, 21.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.0ms
Speed: 1.5ms preprocess, 21.0ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.3ms
Speed: 1.6ms preprocess, 21.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.3ms
Speed: 1.5ms preprocess, 21.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.9ms
Speed: 1.2ms preprocess, 21.9ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.2ms
Speed: 1.2ms preprocess, 21.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 1.2ms preprocess, 22.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.4ms
Speed: 1.4ms preprocess, 21.4ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.3ms
Speed: 1.3ms preprocess, 21.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 1.3ms preprocess, 23.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.1ms
Speed: 15.4ms preprocess, 23.1ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.6ms
Speed: 2.4ms preprocess, 20.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9418
Instance 2: Confidence=0.9238
Instance 3: Confidence=0.9103
Instance 4: Confidence=0.8137
Instance 5: Confidence=0.3678
Selected instance: 1 (Confidence: 0.9418)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

409 72 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 13 prompts
current IoU is: 0.8767334222793579
Seok, iteration idx= 1 IoU = tensor(0.8767)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 1.5ms preprocess, 22.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9432
Instance 1: Confidence=0.9382
Instance 2: Confidence=0.9229
Instance 3: Confidence=0.9166
Instance 4: Confidence=0.8470
Instance 5: Confidence=0.8422
Selected instance: 1 (Confidence: 0.9382)
tmp min: tensor(0.) tmp max: tensor(1.)
381 92 540 960
There are 12 prompts
current IoU is: 0.8646902441978455
Seok, iteration idx= 2 IoU = tensor(0.8647)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9398
Instance 1: Confidence=0.9287
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.8930
Instance 4: Confidence=0.8873
Selected instance: 0 (Confidence: 0.9398)
tmp min: tensor(0.) tmp max: tensor(1.)
368 128 540 960
There are 14 prompts
current IoU is: 0.8796725869178772
Seok, iteration idx= 3 IoU = tensor(0.8797)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 7
Instance 0: Confidence=0.9443
Instance 1: Confidence=0.9263
Instance 2: Confidence=0.9112
Instance 3: Confidence=0.8529
Instance 4: Confidence=0.7917
Instance 5: Confidence=0.5320
Instance 6: Confidence=0.4048
Selected instance: 2 (Confidence: 0.9112)
tmp min: tensor(0.) tmp max: tensor(1.)
516 88 540 960
There are 16 prompts
current IoU is: 0.40591248869895935
Seok, iteration idx= 4 IoU = tensor(0.4059)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 8
Instance 0: Confidence=0.9391
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9228
Instance 3: Confidence=0.8782
Instance 4: Confidence=0.6843
Instance 5: Confidence=0.5397
Instance 6: Confidence=0.5218
Instance 7: Confidence=0.3399
Selected instance: 1 (Confidence: 0.9269)
tmp min: tensor(0.) tmp max: tensor(1.)
504 96 540 960
There are 14 prompts
current IoU is: 0.6899511218070984
Seok, iteration idx= 5 IoU = tensor(0.6900)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.8ms
Speed: 3.6ms preprocess, 24.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9437
Instance 1: Confidence=0.9314
Instance 2: Confidence=0.9091
Instance 3: Confidence=0.8747
Instance 4: Confidence=0.8331
Selected instance: 1 (Confidence: 0.9314)
tmp min: tensor(0.) tmp max: tensor(1.)
528 124 540 960
There are 14 prompts
current IoU is: 0.8382800817489624
Seok, iteration idx= 6 IoU = tensor(0.8383)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.6ms
Speed: 2.6ms preprocess, 24.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9220
Instance 1: Confidence=0.9218
Instance 2: Confidence=0.9069
Instance 3: Confidence=0.9049
Instance 4: Confidence=0.9018
Instance 5: Confidence=0.8183
Selected instance: 5 (Confidence: 0.8183)
tmp min: tensor(0.) tmp max: tensor(1.)
575 80 540 960
current IoU is: 0.7890989780426025
Seok, iteration idx= 7 IoU = tensor(0.7891)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.3ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.8996
Instance 3: Confidence=0.8888
Instance 4: Confidence=0.8676
Selected instance: 2 (Confidence: 0.8996)
tmp min: tensor(0.) tmp max: tensor(1.)
596 92 540 960
There are 17 prompts
current IoU is: 0.7807324528694153
Seok, iteration idx= 8 IoU = tensor(0.7807)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.6ms
Speed: 1.6ms preprocess, 24.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9476
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.8890
Instance 3: Confidence=0.8363
Instance 4: Confidence=0.8338
Selected instance: 2 (Confidence: 0.8890)
tmp min: tensor(0.) tmp max: tensor(1.)
612 68 540 960
There are 15 prompts
current IoU is: 0.7935086488723755
Seok, iteration idx= 9 IoU = tensor(0.7935)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 1.2ms preprocess, 23.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9144
Instance 2: Confidence=0.9064
Instance 3: Confidence=0.9036
Instance 4: Confidence=0.8918
Instance 5: Confidence=0.8164
Selected instance: 4 (Confidence: 0.8918)
tmp min: tensor(0.) tmp max: tensor(1.)
619 80 540 960
current IoU is: 0.6247988343238831
Seok, iteration idx= 10 IoU = tensor(0.6248)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.2ms
Speed: 2.6ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9670
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9256
Instance 3: Confidence=0.8502
Instance 4: Confidence=0.8407
Instance 5: Confidence=0.5675
Instance 6: Confidence=0.2603
Selected instance: 4 (Confidence: 0.8407)
tmp min: tensor(0.) tmp max: tensor(1.)
617 72 540 960
There are 18 prompts
current IoU is: 0.5996840000152588
Seok, iteration idx= 11 IoU = tensor(0.5997)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 3.0ms preprocess, 23.2ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9585
Instance 1: Confidence=0.9275
Instance 2: Confidence=0.9113
Instance 3: Confidence=0.9041
Instance 4: Confidence=0.8095
Selected instance: 3 (Confidence: 0.9041)
tmp min: tensor(0.) tmp max: tensor(1.)
660 52 540 960
There are 16 prompts
current IoU is: 0.07332996279001236
Seok, iteration idx= 12 IoU = tensor(0.0733)
SKIP, unacceptable sam prediction, IoU is tensor(0.0733)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 25.9ms
Speed: 2.5ms preprocess, 25.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 4
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9405
Instance 2: Confidence=0.9168
Instance 3: Confidence=0.8296
Selected instance: 3 (Confidence: 0.8296)
tmp min: tensor(0.) tmp max: tensor(1.)
670 84 540 960
There are 18 prompts
current IoU is: 0.7492140531539917
Seok, iteration idx= 13 IoU = tensor(0.7492)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.6ms
Speed: 2.9ms preprocess, 24.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9529
Instance 1: Confidence=0.9514
Instance 2: Confidence=0.9135
Instance 3: Confidence=0.9119
Instance 4: Confidence=0.3781
Selected instance: 2 (Confidence: 0.9135)
tmp min: tensor(0.) tmp max: tensor(1.)
679 52 540 960
There are 16 prompts
current IoU is: 0.8889445662498474
Seok, iteration idx= 14 IoU = tensor(0.8889)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.7ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9456
Instance 1: Confidence=0.9262
Instance 2: Confidence=0.8959
Instance 3: Confidence=0.8348
Instance 4: Confidence=0.6141
Instance 5: Confidence=0.3271
Selected instance: 2 (Confidence: 0.8959)
tmp min: tensor(0.) tmp max: tensor(1.)
664 64 540 960
There are 15 prompts
current IoU is: 0.8685120344161987
Seok, iteration idx= 15 IoU = tensor(0.8685)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 1.6ms preprocess, 24.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9397
Instance 2: Confidence=0.9054
Instance 3: Confidence=0.8999
Instance 4: Confidence=0.8815
Instance 5: Confidence=0.8617
Selected instance: 2 (Confidence: 0.9054)
tmp min: tensor(0.) tmp max: tensor(1.)
608 140 540 960
There are 16 prompts
current IoU is: 0.9078729748725891
Seok, iteration idx= 16 IoU = tensor(0.9079)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9502
Instance 1: Confidence=0.9332
Instance 2: Confidence=0.9264
Instance 3: Confidence=0.9254
Instance 4: Confidence=0.9229
Instance 5: Confidence=0.5863
Selected instance: 1 (Confidence: 0.9332)
tmp min: tensor(0.) tmp max: tensor(1.)
613 108 540 960
There are 13 prompts
current IoU is: 0.921101987361908
Seok, iteration idx= 17 IoU = tensor(0.9211)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.6ms
Speed: 2.4ms preprocess, 24.6ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9502
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9259
Instance 3: Confidence=0.9246
Instance 4: Confidence=0.7572
Selected instance: 1 (Confidence: 0.9373)
tmp min: tensor(0.) tmp max: tensor(1.)
599 104 540 960
There are 13 prompts
current IoU is: 0.9547751545906067
Seok, iteration idx= 18 IoU = tensor(0.9548)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.1ms
Speed: 3.0ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9451
Instance 2: Confidence=0.9205
Instance 3: Confidence=0.8957
Instance 4: Confidence=0.7199
Instance 5: Confidence=0.6674
Instance 6: Confidence=0.4065
Selected instance: 1 (Confidence: 0.9451)
tmp min: tensor(0.) tmp max: tensor(1.)
595 80 540 960
There are 13 prompts
current IoU is: 0.9321780800819397
Seok, iteration idx= 19 IoU = tensor(0.9322)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.0ms
Speed: 3.2ms preprocess, 25.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9306
Instance 1: Confidence=0.9305
Instance 2: Confidence=0.9199
Instance 3: Confidence=0.9194
Instance 4: Confidence=0.9074
Instance 5: Confidence=0.8918
Selected instance: 4 (Confidence: 0.9074)
tmp min: tensor(0.) tmp max: tensor(1.)
383 112 540 960
There are 16 prompts
current IoU is: 0.8168076872825623
Seok, iteration idx= 20 IoU = tensor(0.8168)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9305
Instance 1: Confidence=0.9276
Instance 2: Confidence=0.9191
Instance 3: Confidence=0.8996
Instance 4: Confidence=0.8552
Instance 5: Confidence=0.8230
Selected instance: 3 (Confidence: 0.8996)
tmp min: tensor(0.) tmp max: tensor(1.)
394 96 540 960
There are 15 prompts
current IoU is: 0.8011211156845093
Seok, iteration idx= 21 IoU = tensor(0.8011)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 8
Instance 0: Confidence=0.9374
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9352
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.5537
Instance 5: Confidence=0.3907
Instance 6: Confidence=0.3726
Instance 7: Confidence=0.3383
Selected instance: 0 (Confidence: 0.9374)
tmp min: tensor(0.) tmp max: tensor(1.)
412 92 540 960
There are 15 prompts
current IoU is: 0.8638562560081482
Seok, iteration idx= 22 IoU = tensor(0.8639)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 2.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9308
Instance 2: Confidence=0.9301
Instance 3: Confidence=0.9154
Instance 4: Confidence=0.8041
Selected instance: 3 (Confidence: 0.9154)
tmp min: tensor(0.) tmp max: tensor(1.)
402 92 540 960
There are 15 prompts
current IoU is: 0.8997616171836853
Seok, iteration idx= 23 IoU = tensor(0.8998)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9390
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9113
Instance 3: Confidence=0.9079
Instance 4: Confidence=0.8845
Selected instance: 3 (Confidence: 0.9079)
tmp min: tensor(0.) tmp max: tensor(1.)
422 72 540 960
There are 17 prompts
current IoU is: 0.8589954376220703
Seok, iteration idx= 24 IoU = tensor(0.8590)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.3ms preprocess, 23.2ms inference, 3.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9429
Instance 1: Confidence=0.9358
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.8998
Instance 4: Confidence=0.8047
Instance 5: Confidence=0.7897
Selected instance: 4 (Confidence: 0.8047)
tmp min: tensor(0.) tmp max: tensor(1.)
462 76 540 960
There are 17 prompts
current IoU is: 0.8155807852745056
Seok, iteration idx= 25 IoU = tensor(0.8156)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 3.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9544
Instance 1: Confidence=0.9382
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.9165
Instance 4: Confidence=0.9129
Selected instance: 1 (Confidence: 0.9382)
tmp min: tensor(0.) tmp max: tensor(1.)
619 40 540 960
There are 15 prompts
current IoU is: 0.010138354264199734
Seok, iteration idx= 26 IoU = tensor(0.0101)
SKIP, unacceptable sam prediction, IoU is tensor(0.0101)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.2ms
Speed: 1.3ms preprocess, 25.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9328
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.9281
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8874
Instance 5: Confidence=0.8685
Selected instance: 5 (Confidence: 0.8685)
tmp min: tensor(0.) tmp max: tensor(1.)
481 68 540 960
There are 18 prompts
current IoU is: 0.776439368724823
Seok, iteration idx= 27 IoU = tensor(0.7764)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 7
Instance 0: Confidence=0.9433
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.9262
Instance 3: Confidence=0.9099
Instance 4: Confidence=0.9046
Instance 5: Confidence=0.7494
Instance 6: Confidence=0.2752
Selected instance: 0 (Confidence: 0.9433)
tmp min: tensor(0.) tmp max: tensor(1.)
580 56 540 960
There are 14 prompts
current IoU is: 0.9267081618309021
Seok, iteration idx= 28 IoU = tensor(0.9267)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 3.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9436
Instance 2: Confidence=0.9257
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9060
Instance 5: Confidence=0.4599
Selected instance: 1 (Confidence: 0.9436)
tmp min: tensor(0.) tmp max: tensor(1.)
534 56 540 960
There are 14 prompts
current IoU is: 0.94426429271698
Seok, iteration idx= 29 IoU = tensor(0.9443)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 2.6ms preprocess, 23.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9418
Instance 2: Confidence=0.9267
Instance 3: Confidence=0.9179
Instance 4: Confidence=0.8670
Selected instance: 1 (Confidence: 0.9418)
tmp min: tensor(0.) tmp max: tensor(1.)
511 44 540 960
There are 14 prompts
current IoU is: 0.9531790614128113
Seok, iteration idx= 30 IoU = tensor(0.9532)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 4.5ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9559
Instance 1: Confidence=0.9546
Instance 2: Confidence=0.9364
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.8237
Instance 5: Confidence=0.3776
Selected instance: 1 (Confidence: 0.9546)
tmp min: tensor(0.) tmp max: tensor(1.)
473 44 540 960
There are 14 prompts
current IoU is: 0.9591789245605469
Seok, iteration idx= 31 IoU = tensor(0.9592)
Selected Instance Confidence List: [tensor(0.9478), tensor(0.9028, device='cpu'), tensor(0.8941, device='cpu'), tensor(0.9037, device='cpu'), tensor(0.6080, device='cpu'), tensor(0.7847, device='cpu'), tensor(0.8755, device='cpu'), tensor(0.8008, device='cpu'), tensor(0.8283, device='cpu'), tensor(0.8317, device='cpu'), tensor(0.7316, device='cpu'), tensor(0.6961, device='cpu'), tensor(0.4057, device='cpu'), tensor(0.7814, device='cpu'), tensor(0.8988, device='cpu'), tensor(0.8795, device='cpu'), tensor(0.9069, device='cpu'), tensor(0.9259, device='cpu'), tensor(0.9478, device='cpu'), tensor(0.9373, device='cpu'), tensor(0.8531, device='cpu'), tensor(0.8405, device='cpu'), tensor(0.8933, device='cpu'), tensor(0.9060, device='cpu'), tensor(0.8786, device='cpu'), tensor(0.8112, device='cpu'), tensor(0.3836, device='cpu'), tensor(0.8133, device='cpu'), tensor(0.9333, device='cpu'), tensor(0.9440, device='cpu'), tensor(0.9486, device='cpu'), tensor(0.9574, device='cpu')]
Sorted Confidence Order: [tensor(0.9574, device='cpu'), tensor(0.9486, device='cpu'), tensor(0.9440, device='cpu'), tensor(0.9333, device='cpu'), tensor(0.9373, device='cpu'), tensor(0.9478, device='cpu'), tensor(0.9259, device='cpu'), tensor(0.9069, device='cpu'), tensor(0.8795, device='cpu'), tensor(0.8988, device='cpu'), tensor(0.7814, device='cpu'), tensor(0.4057, device='cpu'), tensor(0.6961, device='cpu'), tensor(0.7316, device='cpu'), tensor(0.8317, device='cpu'), tensor(0.8283, device='cpu'), tensor(0.8008, device='cpu'), tensor(0.8755, device='cpu'), tensor(0.7847, device='cpu'), tensor(0.6080, device='cpu'), tensor(0.8133, device='cpu'), tensor(0.3836, device='cpu'), tensor(0.8112, device='cpu'), tensor(0.8786, device='cpu'), tensor(0.9060, device='cpu'), tensor(0.8933, device='cpu'), tensor(0.8405, device='cpu'), tensor(0.8531, device='cpu'), tensor(0.9037, device='cpu'), tensor(0.8941, device='cpu'), tensor(0.9028, device='cpu'), tensor(0.9478)]
sorted_indices: [31, 30, 29, 28, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 27, 26, 25, 24, 23, 22, 21, 20, 3, 2, 1, 0]
Initial view (highest confidence): 36
New training order: [12, 11, 10, 9, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15, 14, 13]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 1.3ms preprocess, 20.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.4ms
Speed: 4.0ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9418
Instance 2: Confidence=0.9267
Instance 3: Confidence=0.9179
Instance 4: Confidence=0.8670
tmp min: tensor(0.) tmp max: tensor(1.)
511 44 540 960
There are 14 prompts
current IoU is: 0.9544777274131775
Seok, iteration idx= 1 IoU = tensor(0.9545)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.4ms preprocess, 24.3ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9436
Instance 2: Confidence=0.9257
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9060
Instance 5: Confidence=0.4599
tmp min: tensor(0.) tmp max: tensor(1.)
534 56 540 960
There are 14 prompts
current IoU is: 0.9548397660255432
Seok, iteration idx= 2 IoU = tensor(0.9548)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 7
Instance 0: Confidence=0.9433
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.9262
Instance 3: Confidence=0.9099
Instance 4: Confidence=0.9046
Instance 5: Confidence=0.7494
Instance 6: Confidence=0.2752
tmp min: tensor(0.) tmp max: tensor(1.)
580 56 540 960
There are 14 prompts
current IoU is: 0.963314950466156
Seok, iteration idx= 3 IoU = tensor(0.9633)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 1.3ms preprocess, 22.9ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 7
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9451
Instance 2: Confidence=0.9205
Instance 3: Confidence=0.8957
Instance 4: Confidence=0.7199
Instance 5: Confidence=0.6674
Instance 6: Confidence=0.4065
tmp min: tensor(0.) tmp max: tensor(1.)
595 80 540 960
There are 13 prompts
current IoU is: 0.971055805683136
Seok, iteration idx= 4 IoU = tensor(0.9711)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.5ms
Speed: 1.3ms preprocess, 25.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9502
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9259
Instance 3: Confidence=0.9246
Instance 4: Confidence=0.7572
tmp min: tensor(0.) tmp max: tensor(1.)
599 104 540 960
There are 13 prompts
current IoU is: 0.9653865098953247
Seok, iteration idx= 5 IoU = tensor(0.9654)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.3ms preprocess, 23.5ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9502
Instance 1: Confidence=0.9332
Instance 2: Confidence=0.9264
Instance 3: Confidence=0.9254
Instance 4: Confidence=0.9229
Instance 5: Confidence=0.5863
tmp min: tensor(0.) tmp max: tensor(1.)
613 108 540 960
There are 13 prompts
current IoU is: 0.9609883427619934
Seok, iteration idx= 6 IoU = tensor(0.9610)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.9ms
Speed: 2.9ms preprocess, 24.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9397
Instance 2: Confidence=0.9054
Instance 3: Confidence=0.8999
Instance 4: Confidence=0.8815
Instance 5: Confidence=0.8617
tmp min: tensor(0.) tmp max: tensor(1.)
608 140 540 960
There are 16 prompts
current IoU is: 0.9356221556663513
Seok, iteration idx= 7 IoU = tensor(0.9356)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.9ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9456
Instance 1: Confidence=0.9262
Instance 2: Confidence=0.8959
Instance 3: Confidence=0.8348
Instance 4: Confidence=0.6141
Instance 5: Confidence=0.3271
tmp min: tensor(0.) tmp max: tensor(1.)
664 64 540 960
There are 15 prompts
current IoU is: 0.8994986414909363
Seok, iteration idx= 8 IoU = tensor(0.8995)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.3ms preprocess, 23.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9529
Instance 1: Confidence=0.9514
Instance 2: Confidence=0.9135
Instance 3: Confidence=0.9119
Instance 4: Confidence=0.3781
tmp min: tensor(0.) tmp max: tensor(1.)
679 52 540 960
There are 16 prompts
current IoU is: 0.9149463772773743
Seok, iteration idx= 9 IoU = tensor(0.9149)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 4
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9405
Instance 2: Confidence=0.9168
Instance 3: Confidence=0.8296
tmp min: tensor(0.) tmp max: tensor(1.)
670 84 540 960
There are 18 prompts
current IoU is: 0.8832935690879822
Seok, iteration idx= 10 IoU = tensor(0.8833)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.8ms
Speed: 1.3ms preprocess, 24.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9585
Instance 1: Confidence=0.9275
Instance 2: Confidence=0.9113
Instance 3: Confidence=0.9041
Instance 4: Confidence=0.8095
tmp min: tensor(0.) tmp max: tensor(1.)
660 52 540 960
There are 16 prompts
current IoU is: 0.03211791068315506
Seok, iteration idx= 11 IoU = tensor(0.0321)
SKIP, unacceptable sam prediction, IoU is tensor(0.0321)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 2.6ms preprocess, 23.3ms inference, 3.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 7
Instance 0: Confidence=0.9670
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9256
Instance 3: Confidence=0.8502
Instance 4: Confidence=0.8407
Instance 5: Confidence=0.5675
Instance 6: Confidence=0.2603
tmp min: tensor(0.) tmp max: tensor(1.)
617 72 540 960
There are 18 prompts
current IoU is: 0.7263864278793335
Seok, iteration idx= 12 IoU = tensor(0.7264)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.4ms
Speed: 2.9ms preprocess, 24.4ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9144
Instance 2: Confidence=0.9064
Instance 3: Confidence=0.9036
Instance 4: Confidence=0.8918
Instance 5: Confidence=0.8164
tmp min: tensor(0.) tmp max: tensor(1.)
619 80 540 960
current IoU is: 0.7261818647384644
Seok, iteration idx= 13 IoU = tensor(0.7262)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.6ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9476
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.8890
Instance 3: Confidence=0.8363
Instance 4: Confidence=0.8338
tmp min: tensor(0.) tmp max: tensor(1.)
612 68 540 960
There are 15 prompts
current IoU is: 0.8918361663818359
Seok, iteration idx= 14 IoU = tensor(0.8918)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.7ms
Speed: 1.4ms preprocess, 25.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.8996
Instance 3: Confidence=0.8888
Instance 4: Confidence=0.8676
tmp min: tensor(0.) tmp max: tensor(1.)
596 92 540 960
There are 17 prompts
current IoU is: 0.850509762763977
Seok, iteration idx= 15 IoU = tensor(0.8505)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.4ms preprocess, 24.3ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9220
Instance 1: Confidence=0.9218
Instance 2: Confidence=0.9069
Instance 3: Confidence=0.9049
Instance 4: Confidence=0.9018
Instance 5: Confidence=0.8183
tmp min: tensor(0.) tmp max: tensor(1.)
575 80 540 960
current IoU is: 0.8113590478897095
Seok, iteration idx= 16 IoU = tensor(0.8114)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 2.3ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9437
Instance 1: Confidence=0.9314
Instance 2: Confidence=0.9091
Instance 3: Confidence=0.8747
Instance 4: Confidence=0.8331
tmp min: tensor(0.) tmp max: tensor(1.)
528 124 540 960
There are 14 prompts
current IoU is: 0.9124318957328796
Seok, iteration idx= 17 IoU = tensor(0.9124)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.3ms
Speed: 2.5ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 8
Instance 0: Confidence=0.9391
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9228
Instance 3: Confidence=0.8782
Instance 4: Confidence=0.6843
Instance 5: Confidence=0.5397
Instance 6: Confidence=0.5218
Instance 7: Confidence=0.3399
tmp min: tensor(0.) tmp max: tensor(1.)
504 96 540 960
There are 14 prompts
current IoU is: 0.9068917632102966
Seok, iteration idx= 18 IoU = tensor(0.9069)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.9ms
Speed: 2.8ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9443
Instance 1: Confidence=0.9263
Instance 2: Confidence=0.9112
Instance 3: Confidence=0.8529
Instance 4: Confidence=0.7917
Instance 5: Confidence=0.5320
Instance 6: Confidence=0.4048
tmp min: tensor(0.) tmp max: tensor(1.)
516 88 540 960
There are 16 prompts
current IoU is: 0.8671039938926697
Seok, iteration idx= 19 IoU = tensor(0.8671)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 2.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9328
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.9281
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8874
Instance 5: Confidence=0.8685
tmp min: tensor(0.) tmp max: tensor(1.)
481 68 540 960
There are 18 prompts
current IoU is: 0.7993335127830505
Seok, iteration idx= 20 IoU = tensor(0.7993)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.6ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9544
Instance 1: Confidence=0.9382
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.9165
Instance 4: Confidence=0.9129
tmp min: tensor(0.) tmp max: tensor(1.)
619 40 540 960
There are 15 prompts
current IoU is: 0.008173554204404354
Seok, iteration idx= 21 IoU = tensor(0.0082)
SKIP, unacceptable sam prediction, IoU is tensor(0.0082)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.9ms
Speed: 1.3ms preprocess, 24.9ms inference, 2.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9429
Instance 1: Confidence=0.9358
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.8998
Instance 4: Confidence=0.8047
Instance 5: Confidence=0.7897
tmp min: tensor(0.) tmp max: tensor(1.)
462 76 540 960
There are 17 prompts
current IoU is: 0.8186595439910889
Seok, iteration idx= 22 IoU = tensor(0.8187)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.3ms
Speed: 1.4ms preprocess, 25.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9390
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9113
Instance 3: Confidence=0.9079
Instance 4: Confidence=0.8845
tmp min: tensor(0.) tmp max: tensor(1.)
422 72 540 960
There are 17 prompts
current IoU is: 0.88921719789505
Seok, iteration idx= 23 IoU = tensor(0.8892)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.5ms
Speed: 1.4ms preprocess, 25.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9308
Instance 2: Confidence=0.9301
Instance 3: Confidence=0.9154
Instance 4: Confidence=0.8041
tmp min: tensor(0.) tmp max: tensor(1.)
402 92 540 960
There are 15 prompts
current IoU is: 0.9174474477767944
Seok, iteration idx= 24 IoU = tensor(0.9174)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 26.0ms
Speed: 1.3ms preprocess, 26.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 8
Instance 0: Confidence=0.9374
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9352
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.5537
Instance 5: Confidence=0.3907
Instance 6: Confidence=0.3726
Instance 7: Confidence=0.3383
tmp min: tensor(0.) tmp max: tensor(1.)
412 92 540 960
There are 15 prompts
current IoU is: 0.9202717542648315
Seok, iteration idx= 25 IoU = tensor(0.9203)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 2.8ms preprocess, 24.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9305
Instance 1: Confidence=0.9276
Instance 2: Confidence=0.9191
Instance 3: Confidence=0.8996
Instance 4: Confidence=0.8552
Instance 5: Confidence=0.8230
tmp min: tensor(0.) tmp max: tensor(1.)
394 96 540 960
There are 15 prompts
current IoU is: 0.8786574006080627
Seok, iteration idx= 26 IoU = tensor(0.8787)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 3.2ms preprocess, 23.5ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9306
Instance 1: Confidence=0.9305
Instance 2: Confidence=0.9199
Instance 3: Confidence=0.9194
Instance 4: Confidence=0.9074
Instance 5: Confidence=0.8918
tmp min: tensor(0.) tmp max: tensor(1.)
383 112 540 960
There are 16 prompts
current IoU is: 0.8422102332115173
Seok, iteration idx= 27 IoU = tensor(0.8422)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.4ms
Speed: 4.1ms preprocess, 25.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9398
Instance 1: Confidence=0.9287
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.8930
Instance 4: Confidence=0.8873
tmp min: tensor(0.) tmp max: tensor(1.)
368 128 540 960
There are 14 prompts
current IoU is: 0.9432002902030945
Seok, iteration idx= 28 IoU = tensor(0.9432)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.9ms
Speed: 1.4ms preprocess, 25.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9432
Instance 1: Confidence=0.9382
Instance 2: Confidence=0.9229
Instance 3: Confidence=0.9166
Instance 4: Confidence=0.8470
Instance 5: Confidence=0.8422
tmp min: tensor(0.) tmp max: tensor(1.)
381 92 540 960
There are 12 prompts
current IoU is: 0.959784209728241
Seok, iteration idx= 29 IoU = tensor(0.9598)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.3ms
Speed: 1.4ms preprocess, 25.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9418
Instance 2: Confidence=0.9238
Instance 3: Confidence=0.9103
Instance 4: Confidence=0.8137
Instance 5: Confidence=0.3678
tmp min: tensor(0.) tmp max: tensor(1.)
409 72 540 960
There are 13 prompts
current IoU is: 0.9613536596298218
Seok, iteration idx= 30 IoU = tensor(0.9614)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.7ms
Speed: 1.3ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 8
Instance 0: Confidence=0.9478
Instance 1: Confidence=0.9216
Instance 2: Confidence=0.9111
Instance 3: Confidence=0.8634
Instance 4: Confidence=0.7675
Instance 5: Confidence=0.6778
Instance 6: Confidence=0.3866
Instance 7: Confidence=0.3368
tmp min: tensor(0.) tmp max: tensor(1.)
426 56 540 960
There are 13 prompts
current IoU is: 0.9640275835990906
Seok, iteration idx= 31 IoU = tensor(0.9640)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set3_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set3_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:44<00:00,  1.38s/it]
Testing psnr 28.415960296988487 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set3_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:29<00:00,  1.08it/s]
Testing psnr 3.1768823135644197 (avg)
train: coarse segmentation in 00:07:31
train: finish (eps time 00:07:31 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set3_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set4/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 45.62it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set4 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set4
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set4_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.7ms
Speed: 2.6ms preprocess, 21.7ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.0ms
Speed: 2.2ms preprocess, 21.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.3ms preprocess, 23.0ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.9ms
Speed: 1.3ms preprocess, 21.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.9ms
Speed: 1.4ms preprocess, 20.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.2ms preprocess, 22.4ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.1ms
Speed: 1.2ms preprocess, 21.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.9ms
Speed: 1.2ms preprocess, 20.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 1.2ms preprocess, 20.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.9ms
Speed: 1.3ms preprocess, 21.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.1ms
Speed: 1.2ms preprocess, 21.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.9ms
Speed: 1.2ms preprocess, 20.9ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.5ms
Speed: 1.2ms preprocess, 20.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.7ms
Speed: 1.3ms preprocess, 20.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 1.3ms preprocess, 20.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.5ms
Speed: 1.2ms preprocess, 21.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.5ms
Speed: 1.2ms preprocess, 21.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.3ms
Speed: 1.2ms preprocess, 21.3ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 1.2ms preprocess, 20.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.5ms
Speed: 1.3ms preprocess, 21.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.6ms
Speed: 1.2ms preprocess, 19.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.3ms
Speed: 1.2ms preprocess, 21.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.7ms
Speed: 1.2ms preprocess, 20.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.0ms
Speed: 1.3ms preprocess, 22.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.1ms
Speed: 1.2ms preprocess, 21.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.4ms
Speed: 1.2ms preprocess, 21.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.0ms
Speed: 1.2ms preprocess, 21.0ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 10 persons, 21.5ms
Speed: 1.3ms preprocess, 21.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 10 persons, 28.8ms
Speed: 13.7ms preprocess, 28.8ms inference, 3.4ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 31
view_order: [36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.1ms preprocess, 20.5ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9310
Instance 1: Confidence=0.9039
Instance 2: Confidence=0.8684
Instance 3: Confidence=0.8642
Instance 4: Confidence=0.8209
Instance 5: Confidence=0.6953
Selected instance: 1 (Confidence: 0.9039)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

385 108 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 17 prompts
current IoU is: 0.32798460125923157
Seok, iteration idx= 1 IoU = tensor(0.3280)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 7
Instance 0: Confidence=0.9402
Instance 1: Confidence=0.9144
Instance 2: Confidence=0.9030
Instance 3: Confidence=0.8917
Instance 4: Confidence=0.8304
Instance 5: Confidence=0.7796
Instance 6: Confidence=0.4827
Selected instance: 2 (Confidence: 0.9030)
tmp min: tensor(0.) tmp max: tensor(1.)
397 92 540 960
There are 15 prompts
current IoU is: 0.6299011707305908
Seok, iteration idx= 2 IoU = tensor(0.6299)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.5ms
Speed: 1.4ms preprocess, 24.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9453
Instance 1: Confidence=0.9352
Instance 2: Confidence=0.9312
Instance 3: Confidence=0.8691
Instance 4: Confidence=0.4903
Selected instance: 2 (Confidence: 0.9312)
tmp min: tensor(0.) tmp max: tensor(1.)
415 88 540 960
There are 14 prompts
current IoU is: 0.678934633731842
Seok, iteration idx= 3 IoU = tensor(0.6789)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.7ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9379
Instance 2: Confidence=0.9213
Instance 3: Confidence=0.9213
Instance 4: Confidence=0.8837
Selected instance: 2 (Confidence: 0.9213)
tmp min: tensor(0.) tmp max: tensor(1.)
407 88 540 960
There are 15 prompts
current IoU is: 0.8414034843444824
Seok, iteration idx= 4 IoU = tensor(0.8414)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 8
Instance 0: Confidence=0.9402
Instance 1: Confidence=0.9296
Instance 2: Confidence=0.9254
Instance 3: Confidence=0.9197
Instance 4: Confidence=0.8924
Instance 5: Confidence=0.5797
Instance 6: Confidence=0.4707
Instance 7: Confidence=0.2998
Selected instance: 4 (Confidence: 0.8924)
tmp min: tensor(0.) tmp max: tensor(1.)
428 68 540 960
There are 15 prompts
current IoU is: 0.853446900844574
Seok, iteration idx= 5 IoU = tensor(0.8534)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.7ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9301
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.9115
Instance 4: Confidence=0.8082
Instance 5: Confidence=0.7248
Selected instance: 4 (Confidence: 0.8082)
tmp min: tensor(0.) tmp max: tensor(1.)
469 72 540 960
There are 16 prompts
current IoU is: 0.7683481574058533
Seok, iteration idx= 6 IoU = tensor(0.7683)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.5ms
Speed: 1.4ms preprocess, 24.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9404
Instance 2: Confidence=0.9285
Instance 3: Confidence=0.9185
Instance 4: Confidence=0.8826
Selected instance: 2 (Confidence: 0.9285)
tmp min: tensor(0.) tmp max: tensor(1.)
615 32 540 960
There are 17 prompts
current IoU is: 0.002444304758682847
Seok, iteration idx= 7 IoU = tensor(0.0024)
SKIP, unacceptable sam prediction, IoU is tensor(0.0024)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.8ms
Speed: 1.6ms preprocess, 24.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9306
Instance 2: Confidence=0.9102
Instance 3: Confidence=0.9030
Instance 4: Confidence=0.8677
Instance 5: Confidence=0.8433
Selected instance: 5 (Confidence: 0.8433)
tmp min: tensor(0.) tmp max: tensor(1.)
483 64 540 960
There are 16 prompts
current IoU is: 0.74992835521698
Seok, iteration idx= 8 IoU = tensor(0.7499)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 1.6ms preprocess, 22.7ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9367
Instance 2: Confidence=0.8905
Instance 3: Confidence=0.8844
Instance 4: Confidence=0.8646
Instance 5: Confidence=0.2912
Selected instance: 0 (Confidence: 0.9460)
tmp min: tensor(0.) tmp max: tensor(1.)
579 48 540 960
There are 14 prompts
current IoU is: 0.9005329608917236
Seok, iteration idx= 9 IoU = tensor(0.9005)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9527
Instance 1: Confidence=0.9436
Instance 2: Confidence=0.9006
Instance 3: Confidence=0.8998
Instance 4: Confidence=0.8845
Instance 5: Confidence=0.4642
Selected instance: 1 (Confidence: 0.9436)
tmp min: tensor(0.) tmp max: tensor(1.)
539 44 540 960
There are 12 prompts
current IoU is: 0.9067007899284363
Seok, iteration idx= 10 IoU = tensor(0.9067)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 8
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9309
Instance 2: Confidence=0.9081
Instance 3: Confidence=0.7502
Instance 4: Confidence=0.7004
Instance 5: Confidence=0.4914
Instance 6: Confidence=0.4399
Instance 7: Confidence=0.2941
Selected instance: 0 (Confidence: 0.9457)
tmp min: tensor(0.) tmp max: tensor(1.)
507 36 540 960
There are 14 prompts
current IoU is: 0.9209873080253601
Seok, iteration idx= 11 IoU = tensor(0.9210)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 2.4ms preprocess, 23.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9470
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.8950
Instance 4: Confidence=0.8500
Selected instance: 1 (Confidence: 0.9470)
tmp min: tensor(0.) tmp max: tensor(1.)
470 36 540 960
There are 15 prompts
current IoU is: 0.9221147894859314
Seok, iteration idx= 12 IoU = tensor(0.9221)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.5ms
Speed: 4.0ms preprocess, 22.5ms inference, 3.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 7
Instance 0: Confidence=0.9433
Instance 1: Confidence=0.9295
Instance 2: Confidence=0.9015
Instance 3: Confidence=0.8754
Instance 4: Confidence=0.8475
Instance 5: Confidence=0.5789
Instance 6: Confidence=0.4633
Selected instance: 0 (Confidence: 0.9433)
tmp min: tensor(0.) tmp max: tensor(1.)
424 48 540 960
There are 16 prompts
current IoU is: 0.8529398441314697
Seok, iteration idx= 13 IoU = tensor(0.8529)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.2ms
Speed: 3.0ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9409
Instance 1: Confidence=0.9153
Instance 2: Confidence=0.9146
Instance 3: Confidence=0.8973
Instance 4: Confidence=0.6037
Instance 5: Confidence=0.4515
Instance 6: Confidence=0.2713
Selected instance: 0 (Confidence: 0.9409)
tmp min: tensor(0.) tmp max: tensor(1.)
407 64 540 960
There are 13 prompts
current IoU is: 0.9357393980026245
Seok, iteration idx= 14 IoU = tensor(0.9357)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 2.7ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9345
Instance 1: Confidence=0.9176
Instance 2: Confidence=0.9114
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8976
Selected instance: 1 (Confidence: 0.9176)
tmp min: tensor(0.) tmp max: tensor(1.)
318 84 540 960
There are 18 prompts
current IoU is: 0.9127678275108337
Seok, iteration idx= 15 IoU = tensor(0.9128)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9384
Instance 2: Confidence=0.9249
Instance 3: Confidence=0.9049
Instance 4: Confidence=0.8864
Selected instance: 1 (Confidence: 0.9384)
tmp min: tensor(0.) tmp max: tensor(1.)
365 124 540 960
There are 13 prompts
current IoU is: 0.9055221080780029
Seok, iteration idx= 16 IoU = tensor(0.9055)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.4ms preprocess, 24.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9491
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9331
Instance 3: Confidence=0.9178
Instance 4: Confidence=0.9059
Instance 5: Confidence=0.8131
Selected instance: 4 (Confidence: 0.9059)
tmp min: tensor(0.) tmp max: tensor(1.)
525 84 540 960
There are 19 prompts
current IoU is: 0.8700165748596191
Seok, iteration idx= 17 IoU = tensor(0.8700)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9408
Instance 2: Confidence=0.9396
Instance 3: Confidence=0.9338
Instance 4: Confidence=0.9225
Instance 5: Confidence=0.4237
Selected instance: 1 (Confidence: 0.9408)
tmp min: tensor(0.) tmp max: tensor(1.)
516 88 540 960
There are 16 prompts
current IoU is: 0.8186986446380615
Seok, iteration idx= 18 IoU = tensor(0.8187)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9320
Instance 1: Confidence=0.9259
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.9090
Instance 4: Confidence=0.9060
Selected instance: 4 (Confidence: 0.9060)
tmp min: tensor(0.) tmp max: tensor(1.)
537 120 540 960
There are 15 prompts
current IoU is: 0.8374668955802917
Seok, iteration idx= 19 IoU = tensor(0.8375)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.6ms
Speed: 1.4ms preprocess, 24.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9356
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9268
Instance 3: Confidence=0.9164
Instance 4: Confidence=0.8873
Instance 5: Confidence=0.8672
Selected instance: 4 (Confidence: 0.8873)
tmp min: tensor(0.) tmp max: tensor(1.)
580 80 540 960
There are 17 prompts
current IoU is: 0.8554127812385559
Seok, iteration idx= 20 IoU = tensor(0.8554)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 26.6ms
Speed: 2.7ms preprocess, 26.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9388
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9012
Instance 3: Confidence=0.8933
Instance 4: Confidence=0.8737
Selected instance: 4 (Confidence: 0.8737)
tmp min: tensor(0.) tmp max: tensor(1.)
611 84 540 960
current IoU is: 0.7578739523887634
Seok, iteration idx= 21 IoU = tensor(0.7579)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.7ms
Speed: 3.0ms preprocess, 22.7ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 7
Instance 0: Confidence=0.9264
Instance 1: Confidence=0.9138
Instance 2: Confidence=0.9107
Instance 3: Confidence=0.8424
Instance 4: Confidence=0.8102
Instance 5: Confidence=0.7175
Instance 6: Confidence=0.7047
Selected instance: 3 (Confidence: 0.8424)
tmp min: tensor(0.) tmp max: tensor(1.)
620 68 540 960
There are 18 prompts
current IoU is: 0.673108696937561
Seok, iteration idx= 22 IoU = tensor(0.6731)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.2ms
Speed: 1.5ms preprocess, 25.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9346
Instance 1: Confidence=0.9336
Instance 2: Confidence=0.9319
Instance 3: Confidence=0.9087
Instance 4: Confidence=0.8680
Selected instance: 3 (Confidence: 0.9087)
tmp min: tensor(0.) tmp max: tensor(1.)
611 28 540 960
There are 17 prompts
current IoU is: 0.018068762496113777
Seok, iteration idx= 23 IoU = tensor(0.0181)
SKIP, unacceptable sam prediction, IoU is tensor(0.0181)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 7
Instance 0: Confidence=0.9481
Instance 1: Confidence=0.9315
Instance 2: Confidence=0.9225
Instance 3: Confidence=0.9042
Instance 4: Confidence=0.8958
Instance 5: Confidence=0.6956
Instance 6: Confidence=0.3838
Selected instance: 5 (Confidence: 0.6956)
tmp min: tensor(0.) tmp max: tensor(1.)
718 60 540 960
current IoU is: 0.5824747085571289
Seok, iteration idx= 24 IoU = tensor(0.5825)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.9ms preprocess, 23.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9402
Instance 2: Confidence=0.9388
Instance 3: Confidence=0.9054
Instance 4: Confidence=0.8651
Selected instance: 4 (Confidence: 0.8651)
tmp min: tensor(0.) tmp max: tensor(1.)
727 36 540 960
There are 19 prompts
current IoU is: 0.8604375123977661
Seok, iteration idx= 25 IoU = tensor(0.8604)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9414
Instance 1: Confidence=0.9324
Instance 2: Confidence=0.9207
Instance 3: Confidence=0.9081
Instance 4: Confidence=0.9032
Instance 5: Confidence=0.6914
Selected instance: 3 (Confidence: 0.9081)
tmp min: tensor(0.) tmp max: tensor(1.)
685 76 540 960
There are 16 prompts
current IoU is: 0.9136592745780945
Seok, iteration idx= 26 IoU = tensor(0.9137)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.6ms
Speed: 2.3ms preprocess, 24.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9473
Instance 2: Confidence=0.8913
Instance 3: Confidence=0.8832
Instance 4: Confidence=0.8511
Instance 5: Confidence=0.4380
Selected instance: 2 (Confidence: 0.8913)
tmp min: tensor(0.) tmp max: tensor(1.)
695 44 540 960
There are 16 prompts
current IoU is: 0.9227989912033081
Seok, iteration idx= 27 IoU = tensor(0.9228)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 3.8ms preprocess, 23.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9522
Instance 1: Confidence=0.9410
Instance 2: Confidence=0.9127
Instance 3: Confidence=0.7607
Instance 4: Confidence=0.3358
Selected instance: 2 (Confidence: 0.9127)
tmp min: tensor(0.) tmp max: tensor(1.)
674 60 540 960
There are 16 prompts
current IoU is: 0.8669845461845398
Seok, iteration idx= 28 IoU = tensor(0.8670)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.7ms
Speed: 2.7ms preprocess, 22.7ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 8
Instance 0: Confidence=0.9434
Instance 1: Confidence=0.9339
Instance 2: Confidence=0.9202
Instance 3: Confidence=0.8963
Instance 4: Confidence=0.8529
Instance 5: Confidence=0.8451
Instance 6: Confidence=0.3002
Instance 7: Confidence=0.2701
Selected instance: 2 (Confidence: 0.9202)
tmp min: tensor(0.) tmp max: tensor(1.)
618 132 540 960
There are 16 prompts
current IoU is: 0.9318917989730835
Seok, iteration idx= 29 IoU = tensor(0.9319)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9313
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8973
Instance 4: Confidence=0.5839
Instance 5: Confidence=0.4561
Selected instance: 1 (Confidence: 0.9313)
tmp min: tensor(0.) tmp max: tensor(1.)
615 100 540 960
There are 13 prompts
current IoU is: 0.9310428500175476
Seok, iteration idx= 30 IoU = tensor(0.9310)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.2ms
Speed: 1.9ms preprocess, 24.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 7
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9330
Instance 3: Confidence=0.5783
Instance 4: Confidence=0.4017
Instance 5: Confidence=0.3446
Instance 6: Confidence=0.2606
Selected instance: 1 (Confidence: 0.9434)
tmp min: tensor(0.) tmp max: tensor(1.)
593 96 540 960
There are 14 prompts
current IoU is: 0.9549175500869751
Seok, iteration idx= 31 IoU = tensor(0.9549)
Selected Instance Confidence List: [tensor(0.9473), tensor(0.5584, device='cpu'), tensor(0.7391, device='cpu'), tensor(0.7798, device='cpu'), tensor(0.8734, device='cpu'), tensor(0.8690, device='cpu'), tensor(0.7843, device='cpu'), tensor(0.3810, device='cpu'), tensor(0.7873, device='cpu'), tensor(0.9187, device='cpu'), tensor(0.9214, device='cpu'), tensor(0.9309, device='cpu'), tensor(0.9321, device='cpu'), tensor(0.8891, device='cpu'), tensor(0.9378, device='cpu'), tensor(0.9147, device='cpu'), tensor(0.9187, device='cpu'), tensor(0.8844, device='cpu'), tensor(0.8675, device='cpu'), tensor(0.8649, device='cpu'), tensor(0.8682, device='cpu'), tensor(0.8042, device='cpu'), tensor(0.7408, device='cpu'), tensor(0.3774, device='cpu'), tensor(0.6277, device='cpu'), tensor(0.8623, device='cpu'), tensor(0.9114, device='cpu'), tensor(0.9102, device='cpu'), tensor(0.8853, device='cpu'), tensor(0.9272, device='cpu'), tensor(0.9312, device='cpu'), tensor(0.9503, device='cpu')]
Sorted Confidence Order: [tensor(0.9503, device='cpu'), tensor(0.9312, device='cpu'), tensor(0.9473), tensor(0.9187, device='cpu'), tensor(0.9214, device='cpu'), tensor(0.9309, device='cpu'), tensor(0.9321, device='cpu'), tensor(0.8891, device='cpu'), tensor(0.9378, device='cpu'), tensor(0.9147, device='cpu'), tensor(0.9187, device='cpu'), tensor(0.9272, device='cpu'), tensor(0.8853, device='cpu'), tensor(0.9102, device='cpu'), tensor(0.9114, device='cpu'), tensor(0.8623, device='cpu'), tensor(0.6277, device='cpu'), tensor(0.3774, device='cpu'), tensor(0.7408, device='cpu'), tensor(0.8042, device='cpu'), tensor(0.8682, device='cpu'), tensor(0.8649, device='cpu'), tensor(0.8675, device='cpu'), tensor(0.8844, device='cpu'), tensor(0.7873, device='cpu'), tensor(0.3810, device='cpu'), tensor(0.7843, device='cpu'), tensor(0.8690, device='cpu'), tensor(0.8734, device='cpu'), tensor(0.7798, device='cpu'), tensor(0.7391, device='cpu'), tensor(0.5584, device='cpu')]
sorted_indices: [31, 30, 0, 9, 10, 11, 12, 13, 14, 15, 16, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 8, 7, 6, 5, 4, 3, 2, 1]
Initial view (highest confidence): 36
New training order: [35, 34, 36, 9, 10, 11, 12, 13, 14, 15, 16, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.5ms
Speed: 1.3ms preprocess, 21.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9313
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8973
Instance 4: Confidence=0.5839
Instance 5: Confidence=0.4561
tmp min: tensor(0.) tmp max: tensor(1.)
615 100 540 960
There are 13 prompts
current IoU is: 0.9461525082588196
Seok, iteration idx= 1 IoU = tensor(0.9462)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 10 persons, 24.6ms
Speed: 1.3ms preprocess, 24.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 10
Instance 0: Confidence=0.9473
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.6370
Instance 4: Confidence=0.5932
Instance 5: Confidence=0.5777
Instance 6: Confidence=0.4581
Instance 7: Confidence=0.3354
Instance 8: Confidence=0.3136
Instance 9: Confidence=0.2909
tmp min: tensor(0.) tmp max: tensor(1.)
598 72 540 960
There are 16 prompts
current IoU is: 0.9623787999153137
Seok, iteration idx= 2 IoU = tensor(0.9624)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.9ms
Speed: 2.7ms preprocess, 24.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 6
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9367
Instance 2: Confidence=0.8905
Instance 3: Confidence=0.8844
Instance 4: Confidence=0.8646
Instance 5: Confidence=0.2912
tmp min: tensor(0.) tmp max: tensor(1.)
579 48 540 960
There are 14 prompts
current IoU is: 0.9482089281082153
Seok, iteration idx= 3 IoU = tensor(0.9482)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.0ms
Speed: 2.5ms preprocess, 25.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9527
Instance 1: Confidence=0.9436
Instance 2: Confidence=0.9006
Instance 3: Confidence=0.8998
Instance 4: Confidence=0.8845
Instance 5: Confidence=0.4642
tmp min: tensor(0.) tmp max: tensor(1.)
539 44 540 960
There are 12 prompts
current IoU is: 0.9491729140281677
Seok, iteration idx= 4 IoU = tensor(0.9492)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.9ms
Speed: 3.2ms preprocess, 23.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 8
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9309
Instance 2: Confidence=0.9081
Instance 3: Confidence=0.7502
Instance 4: Confidence=0.7004
Instance 5: Confidence=0.4914
Instance 6: Confidence=0.4399
Instance 7: Confidence=0.2941
tmp min: tensor(0.) tmp max: tensor(1.)
507 36 540 960
There are 14 prompts
current IoU is: 0.9520576596260071
Seok, iteration idx= 5 IoU = tensor(0.9521)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 2.5ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9470
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.8950
Instance 4: Confidence=0.8500
tmp min: tensor(0.) tmp max: tensor(1.)
470 36 540 960
There are 15 prompts
current IoU is: 0.9596355557441711
Seok, iteration idx= 6 IoU = tensor(0.9596)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.9ms
Speed: 2.7ms preprocess, 23.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9433
Instance 1: Confidence=0.9295
Instance 2: Confidence=0.9015
Instance 3: Confidence=0.8754
Instance 4: Confidence=0.8475
Instance 5: Confidence=0.5789
Instance 6: Confidence=0.4633
tmp min: tensor(0.) tmp max: tensor(1.)
424 48 540 960
There are 16 prompts
current IoU is: 0.957689106464386
Seok, iteration idx= 7 IoU = tensor(0.9577)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 3.2ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9409
Instance 1: Confidence=0.9153
Instance 2: Confidence=0.9146
Instance 3: Confidence=0.8973
Instance 4: Confidence=0.6037
Instance 5: Confidence=0.4515
Instance 6: Confidence=0.2713
tmp min: tensor(0.) tmp max: tensor(1.)
407 64 540 960
There are 13 prompts
current IoU is: 0.9499868750572205
Seok, iteration idx= 8 IoU = tensor(0.9500)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.2ms
Speed: 1.4ms preprocess, 25.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9345
Instance 1: Confidence=0.9176
Instance 2: Confidence=0.9114
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8976
tmp min: tensor(0.) tmp max: tensor(1.)
318 84 540 960
There are 18 prompts
current IoU is: 0.9291507005691528
Seok, iteration idx= 9 IoU = tensor(0.9292)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9384
Instance 2: Confidence=0.9249
Instance 3: Confidence=0.9049
Instance 4: Confidence=0.8864
tmp min: tensor(0.) tmp max: tensor(1.)
365 124 540 960
There are 13 prompts
current IoU is: 0.9225020408630371
Seok, iteration idx= 10 IoU = tensor(0.9225)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.8ms
Speed: 1.4ms preprocess, 24.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 8
Instance 0: Confidence=0.9434
Instance 1: Confidence=0.9339
Instance 2: Confidence=0.9202
Instance 3: Confidence=0.8963
Instance 4: Confidence=0.8529
Instance 5: Confidence=0.8451
Instance 6: Confidence=0.3002
Instance 7: Confidence=0.2701
tmp min: tensor(0.) tmp max: tensor(1.)
618 132 540 960
There are 16 prompts
current IoU is: 0.9440540671348572
Seok, iteration idx= 11 IoU = tensor(0.9441)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.5ms preprocess, 23.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9522
Instance 1: Confidence=0.9410
Instance 2: Confidence=0.9127
Instance 3: Confidence=0.7607
Instance 4: Confidence=0.3358
tmp min: tensor(0.) tmp max: tensor(1.)
674 60 540 960
There are 16 prompts
current IoU is: 0.8706881999969482
Seok, iteration idx= 12 IoU = tensor(0.8707)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 2.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9473
Instance 2: Confidence=0.8913
Instance 3: Confidence=0.8832
Instance 4: Confidence=0.8511
Instance 5: Confidence=0.4380
tmp min: tensor(0.) tmp max: tensor(1.)
695 44 540 960
There are 16 prompts
current IoU is: 0.9396561980247498
Seok, iteration idx= 13 IoU = tensor(0.9397)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 2.7ms preprocess, 23.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9414
Instance 1: Confidence=0.9324
Instance 2: Confidence=0.9207
Instance 3: Confidence=0.9081
Instance 4: Confidence=0.9032
Instance 5: Confidence=0.6914
tmp min: tensor(0.) tmp max: tensor(1.)
685 76 540 960
There are 16 prompts
current IoU is: 0.9288894534111023
Seok, iteration idx= 14 IoU = tensor(0.9289)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.6ms
Speed: 3.8ms preprocess, 24.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9402
Instance 2: Confidence=0.9388
Instance 3: Confidence=0.9054
Instance 4: Confidence=0.8651
tmp min: tensor(0.) tmp max: tensor(1.)
727 36 540 960
There are 19 prompts
current IoU is: 0.9067108035087585
Seok, iteration idx= 15 IoU = tensor(0.9067)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.9ms
Speed: 1.4ms preprocess, 24.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 7
Instance 0: Confidence=0.9481
Instance 1: Confidence=0.9315
Instance 2: Confidence=0.9225
Instance 3: Confidence=0.9042
Instance 4: Confidence=0.8958
Instance 5: Confidence=0.6956
Instance 6: Confidence=0.3838
tmp min: tensor(0.) tmp max: tensor(1.)
718 60 540 960
current IoU is: 0.6805144548416138
Seok, iteration idx= 16 IoU = tensor(0.6805)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 2.0ms preprocess, 23.3ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9346
Instance 1: Confidence=0.9336
Instance 2: Confidence=0.9319
Instance 3: Confidence=0.9087
Instance 4: Confidence=0.8680
tmp min: tensor(0.) tmp max: tensor(1.)
611 28 540 960
There are 17 prompts
current IoU is: 0.009520523250102997
Seok, iteration idx= 17 IoU = tensor(0.0095)
SKIP, unacceptable sam prediction, IoU is tensor(0.0095)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 25.3ms
Speed: 1.5ms preprocess, 25.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 7
Instance 0: Confidence=0.9264
Instance 1: Confidence=0.9138
Instance 2: Confidence=0.9107
Instance 3: Confidence=0.8424
Instance 4: Confidence=0.8102
Instance 5: Confidence=0.7175
Instance 6: Confidence=0.7047
tmp min: tensor(0.) tmp max: tensor(1.)
620 68 540 960
There are 18 prompts
current IoU is: 0.6667498350143433
Seok, iteration idx= 18 IoU = tensor(0.6667)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9388
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9012
Instance 3: Confidence=0.8933
Instance 4: Confidence=0.8737
tmp min: tensor(0.) tmp max: tensor(1.)
611 84 540 960
current IoU is: 0.7535633444786072
Seok, iteration idx= 19 IoU = tensor(0.7536)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.3ms
Speed: 2.5ms preprocess, 25.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9356
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9268
Instance 3: Confidence=0.9164
Instance 4: Confidence=0.8873
Instance 5: Confidence=0.8672
tmp min: tensor(0.) tmp max: tensor(1.)
580 80 540 960
There are 17 prompts
current IoU is: 0.881110429763794
Seok, iteration idx= 20 IoU = tensor(0.8811)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 2.9ms preprocess, 24.2ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9320
Instance 1: Confidence=0.9259
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.9090
Instance 4: Confidence=0.9060
tmp min: tensor(0.) tmp max: tensor(1.)
537 120 540 960
There are 15 prompts
current IoU is: 0.8317772150039673
Seok, iteration idx= 21 IoU = tensor(0.8318)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 26.4ms
Speed: 1.5ms preprocess, 26.4ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9408
Instance 2: Confidence=0.9396
Instance 3: Confidence=0.9338
Instance 4: Confidence=0.9225
Instance 5: Confidence=0.4237
tmp min: tensor(0.) tmp max: tensor(1.)
516 88 540 960
There are 16 prompts
current IoU is: 0.8694047331809998
Seok, iteration idx= 22 IoU = tensor(0.8694)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9491
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9331
Instance 3: Confidence=0.9178
Instance 4: Confidence=0.9059
Instance 5: Confidence=0.8131
tmp min: tensor(0.) tmp max: tensor(1.)
525 84 540 960
There are 19 prompts
current IoU is: 0.9013563990592957
Seok, iteration idx= 23 IoU = tensor(0.9014)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.7ms
Speed: 1.8ms preprocess, 24.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9306
Instance 2: Confidence=0.9102
Instance 3: Confidence=0.9030
Instance 4: Confidence=0.8677
Instance 5: Confidence=0.8433
tmp min: tensor(0.) tmp max: tensor(1.)
483 64 540 960
There are 16 prompts
current IoU is: 0.8867565989494324
Seok, iteration idx= 24 IoU = tensor(0.8868)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 2.8ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9404
Instance 2: Confidence=0.9285
Instance 3: Confidence=0.9185
Instance 4: Confidence=0.8826
tmp min: tensor(0.) tmp max: tensor(1.)
473 20 540 960
There are 14 prompts
current IoU is: 0.0010264901211485267
Seok, iteration idx= 25 IoU = tensor(0.0010)
SKIP, unacceptable sam prediction, IoU is tensor(0.0010)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 26.3ms
Speed: 1.5ms preprocess, 26.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9301
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.9115
Instance 4: Confidence=0.8082
Instance 5: Confidence=0.7248
tmp min: tensor(0.) tmp max: tensor(1.)
469 72 540 960
There are 16 prompts
current IoU is: 0.8022894859313965
Seok, iteration idx= 26 IoU = tensor(0.8023)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.7ms
Speed: 2.6ms preprocess, 24.7ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 8
Instance 0: Confidence=0.9402
Instance 1: Confidence=0.9296
Instance 2: Confidence=0.9254
Instance 3: Confidence=0.9197
Instance 4: Confidence=0.8924
Instance 5: Confidence=0.5797
Instance 6: Confidence=0.4707
Instance 7: Confidence=0.2998
tmp min: tensor(0.) tmp max: tensor(1.)
428 68 540 960
There are 15 prompts
current IoU is: 0.8825640678405762
Seok, iteration idx= 27 IoU = tensor(0.8826)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 3.0ms preprocess, 23.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9379
Instance 2: Confidence=0.9213
Instance 3: Confidence=0.9213
Instance 4: Confidence=0.8837
tmp min: tensor(0.) tmp max: tensor(1.)
407 88 540 960
There are 15 prompts
current IoU is: 0.9156925678253174
Seok, iteration idx= 28 IoU = tensor(0.9157)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.4ms preprocess, 24.2ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9453
Instance 1: Confidence=0.9352
Instance 2: Confidence=0.9312
Instance 3: Confidence=0.8691
Instance 4: Confidence=0.4903
tmp min: tensor(0.) tmp max: tensor(1.)
415 88 540 960
There are 14 prompts
current IoU is: 0.918144166469574
Seok, iteration idx= 29 IoU = tensor(0.9181)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.4ms
Speed: 1.9ms preprocess, 24.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9402
Instance 1: Confidence=0.9144
Instance 2: Confidence=0.9030
Instance 3: Confidence=0.8917
Instance 4: Confidence=0.8304
Instance 5: Confidence=0.7796
Instance 6: Confidence=0.4827
tmp min: tensor(0.) tmp max: tensor(1.)
397 92 540 960
There are 15 prompts
current IoU is: 0.8916527032852173
Seok, iteration idx= 30 IoU = tensor(0.8917)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 1.4ms preprocess, 22.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9310
Instance 1: Confidence=0.9039
Instance 2: Confidence=0.8684
Instance 3: Confidence=0.8642
Instance 4: Confidence=0.8209
Instance 5: Confidence=0.6953
tmp min: tensor(0.) tmp max: tensor(1.)
385 108 540 960
There are 17 prompts
current IoU is: 0.8155592679977417
Seok, iteration idx= 31 IoU = tensor(0.8156)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set4_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set4_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:42<00:00,  1.33s/it]
Testing psnr 27.89732500910759 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set4_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:29<00:00,  1.10it/s]
Testing psnr 3.1821391452103853 (avg)
train: coarse segmentation in 00:04:25
train: finish (eps time 00:04:25 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set4_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set5/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 39.29it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set5 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set5
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set5_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.8ms
Speed: 3.0ms preprocess, 20.8ms inference, 4.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.0ms
Speed: 1.4ms preprocess, 21.0ms inference, 2.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.0ms
Speed: 1.3ms preprocess, 21.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.3ms
Speed: 2.4ms preprocess, 21.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.7ms
Speed: 1.3ms preprocess, 20.7ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.8ms
Speed: 1.3ms preprocess, 20.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.5ms
Speed: 1.2ms preprocess, 22.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.8ms
Speed: 1.2ms preprocess, 20.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.1ms
Speed: 1.4ms preprocess, 21.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.2ms
Speed: 1.2ms preprocess, 21.2ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.2ms
Speed: 1.6ms preprocess, 21.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.1ms
Speed: 1.3ms preprocess, 22.1ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.3ms
Speed: 1.5ms preprocess, 21.3ms inference, 3.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.0ms
Speed: 1.3ms preprocess, 21.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 1.2ms preprocess, 22.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.4ms
Speed: 1.2ms preprocess, 21.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 1.3ms preprocess, 23.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.8ms
Speed: 1.3ms preprocess, 20.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.1ms
Speed: 1.3ms preprocess, 21.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.0ms
Speed: 1.4ms preprocess, 22.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.5ms
Speed: 1.3ms preprocess, 21.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.4ms
Speed: 1.3ms preprocess, 22.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.0ms
Speed: 1.3ms preprocess, 21.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.2ms
Speed: 1.2ms preprocess, 21.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 1.4ms preprocess, 20.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.8ms
Speed: 1.4ms preprocess, 20.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.7ms
Speed: 2.6ms preprocess, 21.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.7ms
Speed: 1.9ms preprocess, 21.7ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 1.7ms preprocess, 23.3ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 24
view_order: [29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.1ms
Speed: 1.4ms preprocess, 21.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 7
Instance 0: Confidence=0.9386
Instance 1: Confidence=0.9359
Instance 2: Confidence=0.9328
Instance 3: Confidence=0.9221
Instance 4: Confidence=0.8036
Instance 5: Confidence=0.7507
Instance 6: Confidence=0.2664
Selected instance: 0 (Confidence: 0.9386)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

329 76 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 15 prompts
current IoU is: 0.7754567265510559
Seok, iteration idx= 1 IoU = tensor(0.7755)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.8ms
Speed: 2.8ms preprocess, 24.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9552
Instance 1: Confidence=0.9328
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.9105
Instance 4: Confidence=0.8768
Instance 5: Confidence=0.6113
Selected instance: 1 (Confidence: 0.9328)
tmp min: tensor(0.) tmp max: tensor(1.)
340 48 540 960
There are 14 prompts
current IoU is: 0.8193416595458984
Seok, iteration idx= 2 IoU = tensor(0.8193)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 2.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9494
Instance 1: Confidence=0.9387
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.8958
Instance 4: Confidence=0.8815
Selected instance: 2 (Confidence: 0.9145)
tmp min: tensor(0.) tmp max: tensor(1.)
355 64 540 960
There are 15 prompts
current IoU is: 0.8580629229545593
Seok, iteration idx= 3 IoU = tensor(0.8581)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 26.7ms
Speed: 1.5ms preprocess, 26.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9337
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.8928
Instance 3: Confidence=0.7319
Instance 4: Confidence=0.6180
Instance 5: Confidence=0.4375
Selected instance: 3 (Confidence: 0.7319)
tmp min: tensor(0.) tmp max: tensor(1.)
368 136 540 960
There are 15 prompts
current IoU is: 0.8914704918861389
Seok, iteration idx= 4 IoU = tensor(0.8915)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 7
Instance 0: Confidence=0.9374
Instance 1: Confidence=0.9284
Instance 2: Confidence=0.9260
Instance 3: Confidence=0.9164
Instance 4: Confidence=0.9091
Instance 5: Confidence=0.5029
Instance 6: Confidence=0.2646
Selected instance: 4 (Confidence: 0.9091)
tmp min: tensor(0.) tmp max: tensor(1.)
392 112 540 960
There are 15 prompts
current IoU is: 0.7760791182518005
Seok, iteration idx= 5 IoU = tensor(0.7761)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 4.1ms preprocess, 23.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9348
Instance 1: Confidence=0.9341
Instance 2: Confidence=0.9295
Instance 3: Confidence=0.9290
Instance 4: Confidence=0.9118
Instance 5: Confidence=0.5306
Selected instance: 4 (Confidence: 0.9118)
tmp min: tensor(0.) tmp max: tensor(1.)
394 116 540 960
There are 13 prompts
current IoU is: 0.8581717014312744
Seok, iteration idx= 6 IoU = tensor(0.8582)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.2ms
Speed: 2.9ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9330
Instance 2: Confidence=0.9322
Instance 3: Confidence=0.9308
Instance 4: Confidence=0.8590
Instance 5: Confidence=0.5721
Instance 6: Confidence=0.3880
Selected instance: 4 (Confidence: 0.8590)
tmp min: tensor(0.) tmp max: tensor(1.)
411 88 540 960
There are 16 prompts
current IoU is: 0.884401261806488
Seok, iteration idx= 7 IoU = tensor(0.8844)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 2.5ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9482
Instance 1: Confidence=0.9339
Instance 2: Confidence=0.9185
Instance 3: Confidence=0.7674
Instance 4: Confidence=0.4578
Instance 5: Confidence=0.4412
Instance 6: Confidence=0.4175
Selected instance: 1 (Confidence: 0.9339)
tmp min: tensor(0.) tmp max: tensor(1.)
552 96 540 960
There are 15 prompts
current IoU is: 0.45453161001205444
Seok, iteration idx= 8 IoU = tensor(0.4545)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.9ms
Speed: 3.3ms preprocess, 22.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 4
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9331
Instance 2: Confidence=0.9069
Instance 3: Confidence=0.5795
Selected instance: 1 (Confidence: 0.9331)
tmp min: tensor(0.) tmp max: tensor(1.)
558 68 540 960
There are 15 prompts
current IoU is: 0.8410859107971191
Seok, iteration idx= 9 IoU = tensor(0.8411)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 25.0ms
Speed: 1.4ms preprocess, 25.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 4
Instance 0: Confidence=0.9524
Instance 1: Confidence=0.9516
Instance 2: Confidence=0.9286
Instance 3: Confidence=0.8979
Selected instance: 1 (Confidence: 0.9516)
tmp min: tensor(0.) tmp max: tensor(1.)
547 60 540 960
There are 14 prompts
current IoU is: 0.8490604162216187
Seok, iteration idx= 10 IoU = tensor(0.8491)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9476
Instance 2: Confidence=0.8963
Instance 3: Confidence=0.8785
Instance 4: Confidence=0.8033
Selected instance: 1 (Confidence: 0.9476)
tmp min: tensor(0.) tmp max: tensor(1.)
496 60 540 960
There are 14 prompts
current IoU is: 0.9135251641273499
Seok, iteration idx= 11 IoU = tensor(0.9135)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 7
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.7916
Instance 4: Confidence=0.7327
Instance 5: Confidence=0.4687
Instance 6: Confidence=0.2725
Selected instance: 1 (Confidence: 0.9421)
tmp min: tensor(0.) tmp max: tensor(1.)
486 36 540 960
There are 12 prompts
current IoU is: 0.9455079436302185
Seok, iteration idx= 12 IoU = tensor(0.9455)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9520
Instance 1: Confidence=0.9453
Instance 2: Confidence=0.9338
Instance 3: Confidence=0.8405
Instance 4: Confidence=0.7673
Selected instance: 1 (Confidence: 0.9453)
tmp min: tensor(0.) tmp max: tensor(1.)
495 40 540 960
There are 13 prompts
current IoU is: 0.9600046873092651
Seok, iteration idx= 13 IoU = tensor(0.9600)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.5ms
Speed: 2.4ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 8
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9499
Instance 2: Confidence=0.9467
Instance 3: Confidence=0.8013
Instance 4: Confidence=0.4372
Instance 5: Confidence=0.3440
Instance 6: Confidence=0.3215
Instance 7: Confidence=0.2739
Selected instance: 1 (Confidence: 0.9499)
tmp min: tensor(0.) tmp max: tensor(1.)
438 36 540 960
There are 14 prompts
current IoU is: 0.9600672125816345
Seok, iteration idx= 14 IoU = tensor(0.9601)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.0ms
Speed: 1.5ms preprocess, 25.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9465
Instance 2: Confidence=0.9439
Instance 3: Confidence=0.8874
Instance 4: Confidence=0.6249
Instance 5: Confidence=0.2727
Selected instance: 1 (Confidence: 0.9465)
tmp min: tensor(0.) tmp max: tensor(1.)
394 28 540 960
There are 13 prompts
current IoU is: 0.9573976993560791
Seok, iteration idx= 15 IoU = tensor(0.9574)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 3.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9385
Instance 3: Confidence=0.9341
Instance 4: Confidence=0.9008
Instance 5: Confidence=0.6692
Selected instance: 3 (Confidence: 0.9341)
tmp min: tensor(0.) tmp max: tensor(1.)
430 76 540 960
There are 15 prompts
current IoU is: 0.8354188799858093
Seok, iteration idx= 16 IoU = tensor(0.8354)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 5.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9584
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9329
Instance 3: Confidence=0.9113
Instance 4: Confidence=0.8125
Instance 5: Confidence=0.5363
Selected instance: 3 (Confidence: 0.9113)
tmp min: tensor(0.) tmp max: tensor(1.)
439 76 540 960
There are 16 prompts
current IoU is: 0.9236012697219849
Seok, iteration idx= 17 IoU = tensor(0.9236)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.7ms
Speed: 3.4ms preprocess, 24.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9408
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9217
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.7804
Instance 5: Confidence=0.3248
Selected instance: 2 (Confidence: 0.9217)
tmp min: tensor(0.) tmp max: tensor(1.)
459 64 540 960
There are 16 prompts
current IoU is: 0.9355560541152954
Seok, iteration idx= 18 IoU = tensor(0.9356)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.4ms
Speed: 2.4ms preprocess, 24.4ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9463
Instance 1: Confidence=0.9379
Instance 2: Confidence=0.9269
Instance 3: Confidence=0.9177
Instance 4: Confidence=0.8096
Instance 5: Confidence=0.5529
Selected instance: 3 (Confidence: 0.9177)
tmp min: tensor(0.) tmp max: tensor(1.)
466 68 540 960
There are 15 prompts
current IoU is: 0.929291844367981
Seok, iteration idx= 19 IoU = tensor(0.9293)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 3.4ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9490
Instance 1: Confidence=0.9483
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9231
Instance 4: Confidence=0.6808
Instance 5: Confidence=0.6357
Selected instance: 3 (Confidence: 0.9231)
tmp min: tensor(0.) tmp max: tensor(1.)
485 76 540 960
There are 13 prompts
current IoU is: 0.8931567668914795
Seok, iteration idx= 20 IoU = tensor(0.8932)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 3.1ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9424
Instance 1: Confidence=0.9364
Instance 2: Confidence=0.9296
Instance 3: Confidence=0.9162
Instance 4: Confidence=0.6830
Instance 5: Confidence=0.6813
Selected instance: 3 (Confidence: 0.9162)
tmp min: tensor(0.) tmp max: tensor(1.)
510 88 540 960
There are 16 prompts
current IoU is: 0.8872941732406616
Seok, iteration idx= 21 IoU = tensor(0.8873)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.0ms
Speed: 1.4ms preprocess, 25.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9605
Instance 1: Confidence=0.9404
Instance 2: Confidence=0.9341
Instance 3: Confidence=0.9266
Instance 4: Confidence=0.9189
Selected instance: 4 (Confidence: 0.9189)
tmp min: tensor(0.) tmp max: tensor(1.)
520 104 540 960
There are 16 prompts
current IoU is: 0.8672163486480713
Seok, iteration idx= 22 IoU = tensor(0.8672)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.1ms
Speed: 1.6ms preprocess, 25.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9216
Instance 3: Confidence=0.9211
Instance 4: Confidence=0.9179
Selected instance: 3 (Confidence: 0.9211)
tmp min: tensor(0.) tmp max: tensor(1.)
522 136 540 960
There are 15 prompts
current IoU is: 0.9248796701431274
Seok, iteration idx= 23 IoU = tensor(0.9249)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9499
Instance 1: Confidence=0.9476
Instance 2: Confidence=0.9344
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.7513
Instance 5: Confidence=0.3441
Selected instance: 0 (Confidence: 0.9499)
tmp min: tensor(0.) tmp max: tensor(1.)
414 52 540 960
There are 14 prompts
current IoU is: 0.9496119618415833
Seok, iteration idx= 24 IoU = tensor(0.9496)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.7ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9454
Instance 1: Confidence=0.9376
Instance 2: Confidence=0.9193
Instance 3: Confidence=0.8833
Instance 4: Confidence=0.8594
Instance 5: Confidence=0.7986
Selected instance: 0 (Confidence: 0.9454)
tmp min: tensor(0.) tmp max: tensor(1.)
370 64 540 960
There are 14 prompts
current IoU is: 0.9478684067726135
Seok, iteration idx= 25 IoU = tensor(0.9479)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 1.4ms preprocess, 24.5ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9414
Instance 1: Confidence=0.9300
Instance 2: Confidence=0.8414
Instance 3: Confidence=0.7600
Instance 4: Confidence=0.7093
Instance 5: Confidence=0.6956
Selected instance: 1 (Confidence: 0.9300)
tmp min: tensor(0.) tmp max: tensor(1.)
379 100 540 960
There are 11 prompts
current IoU is: 0.9497548341751099
Seok, iteration idx= 26 IoU = tensor(0.9498)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.3ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9378
Instance 1: Confidence=0.9341
Instance 2: Confidence=0.9259
Instance 3: Confidence=0.9210
Instance 4: Confidence=0.9059
Selected instance: 1 (Confidence: 0.9341)
tmp min: tensor(0.) tmp max: tensor(1.)
343 60 540 960
There are 14 prompts
current IoU is: 0.9103058576583862
Seok, iteration idx= 27 IoU = tensor(0.9103)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 2.4ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9140
Instance 3: Confidence=0.9125
Instance 4: Confidence=0.8638
Instance 5: Confidence=0.7469
Selected instance: 0 (Confidence: 0.9477)
tmp min: tensor(0.) tmp max: tensor(1.)
328 68 540 960
There are 15 prompts
current IoU is: 0.8879314064979553
Seok, iteration idx= 28 IoU = tensor(0.8879)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.9ms
Speed: 2.5ms preprocess, 24.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9382
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9224
Instance 3: Confidence=0.9112
Instance 4: Confidence=0.8582
Instance 5: Confidence=0.4778
Instance 6: Confidence=0.3251
Selected instance: 0 (Confidence: 0.9382)
tmp min: tensor(0.) tmp max: tensor(1.)
311 48 540 960
There are 16 prompts
current IoU is: 0.9233143925666809
Seok, iteration idx= 29 IoU = tensor(0.9233)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9496
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9297
Instance 3: Confidence=0.9274
Instance 4: Confidence=0.9144
Instance 5: Confidence=0.3458
Selected instance: 0 (Confidence: 0.9496)
tmp min: tensor(0.) tmp max: tensor(1.)
283 64 540 960
There are 16 prompts
current IoU is: 0.9408990144729614
Seok, iteration idx= 30 IoU = tensor(0.9409)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.3ms preprocess, 24.2ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9542
Instance 1: Confidence=0.9425
Instance 2: Confidence=0.9398
Instance 3: Confidence=0.9328
Instance 4: Confidence=0.9250
Instance 5: Confidence=0.7913
Selected instance: 0 (Confidence: 0.9542)
tmp min: tensor(0.) tmp max: tensor(1.)
310 56 540 960
There are 17 prompts
current IoU is: 0.933745265007019
Seok, iteration idx= 31 IoU = tensor(0.9337)
Selected Instance Confidence List: [tensor(0.9506), tensor(0.8407, device='cpu'), tensor(0.8647, device='cpu'), tensor(0.8806, device='cpu'), tensor(0.8276, device='cpu'), tensor(0.8293, device='cpu'), tensor(0.8796, device='cpu'), tensor(0.8742, device='cpu'), tensor(0.6463, device='cpu'), tensor(0.8779, device='cpu'), tensor(0.8901, device='cpu'), tensor(0.9272, device='cpu'), tensor(0.9442, device='cpu'), tensor(0.9541, device='cpu'), tensor(0.9560, device='cpu'), tensor(0.9531, device='cpu'), tensor(0.8749, device='cpu'), tensor(0.9187, device='cpu'), tensor(0.9300, device='cpu'), tensor(0.9246, device='cpu'), tensor(0.9051, device='cpu'), tensor(0.8988, device='cpu'), tensor(0.8879, device='cpu'), tensor(0.9234, device='cpu'), tensor(0.9497, device='cpu'), tensor(0.9469, device='cpu'), tensor(0.9418, device='cpu'), tensor(0.9198, device='cpu'), tensor(0.9118, device='cpu'), tensor(0.9293, device='cpu'), tensor(0.9444, device='cpu'), tensor(0.9419, device='cpu')]
Sorted Confidence Order: [tensor(0.9560, device='cpu'), tensor(0.9531, device='cpu'), tensor(0.9497, device='cpu'), tensor(0.9469, device='cpu'), tensor(0.9418, device='cpu'), tensor(0.9198, device='cpu'), tensor(0.9118, device='cpu'), tensor(0.9293, device='cpu'), tensor(0.9444, device='cpu'), tensor(0.9419, device='cpu'), tensor(0.9506), tensor(0.8407, device='cpu'), tensor(0.8647, device='cpu'), tensor(0.8806, device='cpu'), tensor(0.8276, device='cpu'), tensor(0.8293, device='cpu'), tensor(0.8796, device='cpu'), tensor(0.8742, device='cpu'), tensor(0.8749, device='cpu'), tensor(0.9187, device='cpu'), tensor(0.9300, device='cpu'), tensor(0.9246, device='cpu'), tensor(0.9051, device='cpu'), tensor(0.8988, device='cpu'), tensor(0.8879, device='cpu'), tensor(0.9234, device='cpu'), tensor(0.6463, device='cpu'), tensor(0.8779, device='cpu'), tensor(0.8901, device='cpu'), tensor(0.9272, device='cpu'), tensor(0.9442, device='cpu'), tensor(0.9541, device='cpu')]
sorted_indices: [14, 15, 24, 25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13]
Initial view (highest confidence): 15
New training order: [7, 8, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 9, 10, 11, 12, 13, 14, 15, 16, 1, 2, 3, 4, 5, 6]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.3ms
Speed: 1.3ms preprocess, 22.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.4ms preprocess, 24.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9465
Instance 2: Confidence=0.9439
Instance 3: Confidence=0.8874
Instance 4: Confidence=0.6249
Instance 5: Confidence=0.2727
tmp min: tensor(0.) tmp max: tensor(1.)
394 28 540 960
There are 13 prompts
current IoU is: 0.9609119892120361
Seok, iteration idx= 1 IoU = tensor(0.9609)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.6ms
Speed: 1.4ms preprocess, 24.6ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9499
Instance 1: Confidence=0.9476
Instance 2: Confidence=0.9344
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.7513
Instance 5: Confidence=0.3441
tmp min: tensor(0.) tmp max: tensor(1.)
414 52 540 960
There are 14 prompts
current IoU is: 0.9554952383041382
Seok, iteration idx= 2 IoU = tensor(0.9555)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 6
Instance 0: Confidence=0.9454
Instance 1: Confidence=0.9376
Instance 2: Confidence=0.9193
Instance 3: Confidence=0.8833
Instance 4: Confidence=0.8594
Instance 5: Confidence=0.7986
tmp min: tensor(0.) tmp max: tensor(1.)
370 64 540 960
There are 14 prompts
current IoU is: 0.9532817602157593
Seok, iteration idx= 3 IoU = tensor(0.9533)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.4ms
Speed: 2.5ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9414
Instance 1: Confidence=0.9300
Instance 2: Confidence=0.8414
Instance 3: Confidence=0.7600
Instance 4: Confidence=0.7093
Instance 5: Confidence=0.6956
tmp min: tensor(0.) tmp max: tensor(1.)
379 100 540 960
There are 11 prompts
current IoU is: 0.9482128620147705
Seok, iteration idx= 4 IoU = tensor(0.9482)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 3.0ms preprocess, 23.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9378
Instance 1: Confidence=0.9341
Instance 2: Confidence=0.9259
Instance 3: Confidence=0.9210
Instance 4: Confidence=0.9059
tmp min: tensor(0.) tmp max: tensor(1.)
343 60 540 960
There are 14 prompts
current IoU is: 0.9167994260787964
Seok, iteration idx= 5 IoU = tensor(0.9168)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.8ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9140
Instance 3: Confidence=0.9125
Instance 4: Confidence=0.8638
Instance 5: Confidence=0.7469
tmp min: tensor(0.) tmp max: tensor(1.)
328 68 540 960
There are 15 prompts
current IoU is: 0.9095161557197571
Seok, iteration idx= 6 IoU = tensor(0.9095)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 25.0ms
Speed: 1.4ms preprocess, 25.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9382
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9224
Instance 3: Confidence=0.9112
Instance 4: Confidence=0.8582
Instance 5: Confidence=0.4778
Instance 6: Confidence=0.3251
tmp min: tensor(0.) tmp max: tensor(1.)
311 48 540 960
There are 16 prompts
current IoU is: 0.934613049030304
Seok, iteration idx= 7 IoU = tensor(0.9346)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.0ms
Speed: 1.4ms preprocess, 25.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9496
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9297
Instance 3: Confidence=0.9274
Instance 4: Confidence=0.9144
Instance 5: Confidence=0.3458
tmp min: tensor(0.) tmp max: tensor(1.)
283 64 540 960
There are 16 prompts
current IoU is: 0.9488129615783691
Seok, iteration idx= 8 IoU = tensor(0.9488)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 26.2ms
Speed: 1.4ms preprocess, 26.2ms inference, 3.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9542
Instance 1: Confidence=0.9425
Instance 2: Confidence=0.9398
Instance 3: Confidence=0.9328
Instance 4: Confidence=0.9250
Instance 5: Confidence=0.7913
tmp min: tensor(0.) tmp max: tensor(1.)
310 56 540 960
There are 17 prompts
current IoU is: 0.9420036673545837
Seok, iteration idx= 9 IoU = tensor(0.9420)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.5ms
Speed: 2.4ms preprocess, 24.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 7
Instance 0: Confidence=0.9506
Instance 1: Confidence=0.9462
Instance 2: Confidence=0.9404
Instance 3: Confidence=0.9361
Instance 4: Confidence=0.9238
Instance 5: Confidence=0.5291
Instance 6: Confidence=0.4256
tmp min: tensor(0.) tmp max: tensor(1.)
342 32 540 960
There are 16 prompts
current IoU is: 0.9408731460571289
Seok, iteration idx= 10 IoU = tensor(0.9409)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.0ms
Speed: 2.6ms preprocess, 23.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9386
Instance 1: Confidence=0.9359
Instance 2: Confidence=0.9328
Instance 3: Confidence=0.9221
Instance 4: Confidence=0.8036
Instance 5: Confidence=0.7507
Instance 6: Confidence=0.2664
tmp min: tensor(0.) tmp max: tensor(1.)
329 76 540 960
There are 15 prompts
current IoU is: 0.9371852874755859
Seok, iteration idx= 11 IoU = tensor(0.9372)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9552
Instance 1: Confidence=0.9328
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.9105
Instance 4: Confidence=0.8768
Instance 5: Confidence=0.6113
tmp min: tensor(0.) tmp max: tensor(1.)
340 48 540 960
There are 14 prompts
current IoU is: 0.9339739680290222
Seok, iteration idx= 12 IoU = tensor(0.9340)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 1.6ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9494
Instance 1: Confidence=0.9387
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.8958
Instance 4: Confidence=0.8815
tmp min: tensor(0.) tmp max: tensor(1.)
355 64 540 960
There are 15 prompts
current IoU is: 0.9235915541648865
Seok, iteration idx= 13 IoU = tensor(0.9236)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 4.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9337
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.8928
Instance 3: Confidence=0.7319
Instance 4: Confidence=0.6180
Instance 5: Confidence=0.4375
tmp min: tensor(0.) tmp max: tensor(1.)
368 136 540 960
There are 15 prompts
current IoU is: 0.8971233367919922
Seok, iteration idx= 14 IoU = tensor(0.8971)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 3.4ms preprocess, 23.3ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 7
Instance 0: Confidence=0.9374
Instance 1: Confidence=0.9284
Instance 2: Confidence=0.9260
Instance 3: Confidence=0.9164
Instance 4: Confidence=0.9091
Instance 5: Confidence=0.5029
Instance 6: Confidence=0.2646
tmp min: tensor(0.) tmp max: tensor(1.)
392 112 540 960
There are 15 prompts
current IoU is: 0.9019686579704285
Seok, iteration idx= 15 IoU = tensor(0.9020)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 3.0ms preprocess, 23.9ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9348
Instance 1: Confidence=0.9341
Instance 2: Confidence=0.9295
Instance 3: Confidence=0.9290
Instance 4: Confidence=0.9118
Instance 5: Confidence=0.5306
tmp min: tensor(0.) tmp max: tensor(1.)
394 116 540 960
There are 13 prompts
current IoU is: 0.8801127672195435
Seok, iteration idx= 16 IoU = tensor(0.8801)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 7
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9330
Instance 2: Confidence=0.9322
Instance 3: Confidence=0.9308
Instance 4: Confidence=0.8590
Instance 5: Confidence=0.5721
Instance 6: Confidence=0.3880
tmp min: tensor(0.) tmp max: tensor(1.)
411 88 540 960
There are 16 prompts
current IoU is: 0.880286455154419
Seok, iteration idx= 17 IoU = tensor(0.8803)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9385
Instance 3: Confidence=0.9341
Instance 4: Confidence=0.9008
Instance 5: Confidence=0.6692
tmp min: tensor(0.) tmp max: tensor(1.)
430 76 540 960
There are 15 prompts
current IoU is: 0.8732214570045471
Seok, iteration idx= 18 IoU = tensor(0.8732)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.3ms
Speed: 1.4ms preprocess, 25.3ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9584
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9329
Instance 3: Confidence=0.9113
Instance 4: Confidence=0.8125
Instance 5: Confidence=0.5363
tmp min: tensor(0.) tmp max: tensor(1.)
439 76 540 960
There are 16 prompts
current IoU is: 0.9383573532104492
Seok, iteration idx= 19 IoU = tensor(0.9384)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.5ms
Speed: 1.3ms preprocess, 25.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9408
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9217
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.7804
Instance 5: Confidence=0.3248
tmp min: tensor(0.) tmp max: tensor(1.)
459 64 540 960
There are 16 prompts
current IoU is: 0.939732015132904
Seok, iteration idx= 20 IoU = tensor(0.9397)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 2.7ms preprocess, 24.5ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9463
Instance 1: Confidence=0.9379
Instance 2: Confidence=0.9269
Instance 3: Confidence=0.9177
Instance 4: Confidence=0.8096
Instance 5: Confidence=0.5529
tmp min: tensor(0.) tmp max: tensor(1.)
466 68 540 960
There are 15 prompts
current IoU is: 0.9359369874000549
Seok, iteration idx= 21 IoU = tensor(0.9359)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 3.0ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9490
Instance 1: Confidence=0.9483
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9231
Instance 4: Confidence=0.6808
Instance 5: Confidence=0.6357
tmp min: tensor(0.) tmp max: tensor(1.)
485 76 540 960
There are 13 prompts
current IoU is: 0.9195623397827148
Seok, iteration idx= 22 IoU = tensor(0.9196)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 3.4ms preprocess, 24.5ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9424
Instance 1: Confidence=0.9364
Instance 2: Confidence=0.9296
Instance 3: Confidence=0.9162
Instance 4: Confidence=0.6830
Instance 5: Confidence=0.6813
tmp min: tensor(0.) tmp max: tensor(1.)
510 88 540 960
There are 16 prompts
current IoU is: 0.9100567698478699
Seok, iteration idx= 23 IoU = tensor(0.9101)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 2.1ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9605
Instance 1: Confidence=0.9404
Instance 2: Confidence=0.9341
Instance 3: Confidence=0.9266
Instance 4: Confidence=0.9189
tmp min: tensor(0.) tmp max: tensor(1.)
520 104 540 960
There are 16 prompts
current IoU is: 0.8755768537521362
Seok, iteration idx= 24 IoU = tensor(0.8756)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.7ms preprocess, 23.5ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9216
Instance 3: Confidence=0.9211
Instance 4: Confidence=0.9179
tmp min: tensor(0.) tmp max: tensor(1.)
522 136 540 960
There are 15 prompts
current IoU is: 0.9287314414978027
Seok, iteration idx= 25 IoU = tensor(0.9287)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 25.1ms
Speed: 1.4ms preprocess, 25.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 7
Instance 0: Confidence=0.9482
Instance 1: Confidence=0.9339
Instance 2: Confidence=0.9185
Instance 3: Confidence=0.7674
Instance 4: Confidence=0.4578
Instance 5: Confidence=0.4412
Instance 6: Confidence=0.4175
tmp min: tensor(0.) tmp max: tensor(1.)
552 96 540 960
There are 15 prompts
current IoU is: 0.9401970505714417
Seok, iteration idx= 26 IoU = tensor(0.9402)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 4
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9331
Instance 2: Confidence=0.9069
Instance 3: Confidence=0.5795
tmp min: tensor(0.) tmp max: tensor(1.)
558 68 540 960
There are 15 prompts
current IoU is: 0.9500629901885986
Seok, iteration idx= 27 IoU = tensor(0.9501)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 4.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 4
Instance 0: Confidence=0.9524
Instance 1: Confidence=0.9516
Instance 2: Confidence=0.9286
Instance 3: Confidence=0.8979
tmp min: tensor(0.) tmp max: tensor(1.)
547 60 540 960
There are 14 prompts
current IoU is: 0.9449769258499146
Seok, iteration idx= 28 IoU = tensor(0.9450)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.3ms
Speed: 2.5ms preprocess, 24.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9476
Instance 2: Confidence=0.8963
Instance 3: Confidence=0.8785
Instance 4: Confidence=0.8033
tmp min: tensor(0.) tmp max: tensor(1.)
496 60 540 960
There are 14 prompts
current IoU is: 0.9487282633781433
Seok, iteration idx= 29 IoU = tensor(0.9487)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 25.8ms
Speed: 2.6ms preprocess, 25.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.7916
Instance 4: Confidence=0.7327
Instance 5: Confidence=0.4687
Instance 6: Confidence=0.2725
tmp min: tensor(0.) tmp max: tensor(1.)
486 36 540 960
There are 12 prompts
current IoU is: 0.9622519016265869
Seok, iteration idx= 30 IoU = tensor(0.9623)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.1ms
Speed: 2.8ms preprocess, 25.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9520
Instance 1: Confidence=0.9453
Instance 2: Confidence=0.9338
Instance 3: Confidence=0.8405
Instance 4: Confidence=0.7673
tmp min: tensor(0.) tmp max: tensor(1.)
495 40 540 960
There are 13 prompts
current IoU is: 0.963311493396759
Seok, iteration idx= 31 IoU = tensor(0.9633)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set5_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set5_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:43<00:00,  1.34s/it]
Testing psnr 27.851903662085533 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set5_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:28<00:00,  1.12it/s]
Testing psnr 3.381603555753827 (avg)
train: coarse segmentation in 00:04:47
train: finish (eps time 00:04:47 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set5_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set6/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 37.25it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set6 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set6
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set6_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.8ms
Speed: 3.2ms preprocess, 21.8ms inference, 4.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.7ms
Speed: 1.4ms preprocess, 20.7ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.9ms
Speed: 1.2ms preprocess, 20.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.8ms
Speed: 1.5ms preprocess, 21.8ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.7ms
Speed: 1.5ms preprocess, 20.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.4ms
Speed: 1.5ms preprocess, 21.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.5ms
Speed: 1.3ms preprocess, 21.5ms inference, 3.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.9ms
Speed: 1.4ms preprocess, 20.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.8ms
Speed: 1.4ms preprocess, 20.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.5ms
Speed: 1.5ms preprocess, 21.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 1.6ms preprocess, 22.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 1.9ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.7ms
Speed: 1.4ms preprocess, 21.7ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.9ms
Speed: 1.5ms preprocess, 21.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.5ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 1.8ms preprocess, 23.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 1.3ms preprocess, 22.2ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.9ms
Speed: 1.3ms preprocess, 21.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 1.3ms preprocess, 22.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 2.0ms preprocess, 23.8ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 1.3ms preprocess, 22.3ms inference, 3.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.6ms
Speed: 1.3ms preprocess, 21.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.3ms preprocess, 22.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.5ms
Speed: 2.2ms preprocess, 22.5ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.1ms
Speed: 1.3ms preprocess, 22.1ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.6ms
Speed: 2.4ms preprocess, 22.6ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 13
view_order: [14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.3ms
Speed: 1.1ms preprocess, 21.3ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 3
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.9273
Instance 2: Confidence=0.8225
Selected instance: 1 (Confidence: 0.9273)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

119 68 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 14 prompts
current IoU is: 0.8309932351112366
Seok, iteration idx= 1 IoU = tensor(0.8310)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.9ms
Speed: 1.4ms preprocess, 21.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 3
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9196
Instance 2: Confidence=0.5705
Selected instance: 1 (Confidence: 0.9196)
tmp min: tensor(0.) tmp max: tensor(1.)
146 116 540 960
There are 15 prompts
current IoU is: 0.8649058938026428
Seok, iteration idx= 2 IoU = tensor(0.8649)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.6ms preprocess, 22.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 2
Instance 0: Confidence=0.9475
Instance 1: Confidence=0.8862
Selected instance: 1 (Confidence: 0.8862)
tmp min: tensor(0.) tmp max: tensor(1.)
830 56 540 960
There are 17 prompts
current IoU is: 0.4100470542907715
Seok, iteration idx= 3 IoU = tensor(0.4100)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 1.6ms preprocess, 22.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 2
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9560
Selected instance: 1 (Confidence: 0.9560)
tmp min: tensor(0.) tmp max: tensor(1.)
814 48 540 960
There are 16 prompts
current IoU is: 0.6579076051712036
Seok, iteration idx= 4 IoU = tensor(0.6579)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9470
Selected instance: 1 (Confidence: 0.9470)
tmp min: tensor(0.) tmp max: tensor(1.)
820 80 540 960
There are 17 prompts
current IoU is: 0.812616229057312
Seok, iteration idx= 5 IoU = tensor(0.8126)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 1.3ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9518
Selected instance: 1 (Confidence: 0.9518)
tmp min: tensor(0.) tmp max: tensor(1.)
893 40 540 960
There are 15 prompts
current IoU is: 0.9403635263442993
Seok, iteration idx= 6 IoU = tensor(0.9404)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9422
Selected instance: 1 (Confidence: 0.9422)
tmp min: tensor(0.) tmp max: tensor(1.)
889 24 540 960
There are 13 prompts
current IoU is: 0.923221230506897
Seok, iteration idx= 7 IoU = tensor(0.9232)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.3ms
Speed: 1.4ms preprocess, 24.3ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9603
Instance 1: Confidence=0.9454
Selected instance: 1 (Confidence: 0.9454)
tmp min: tensor(0.) tmp max: tensor(1.)
886 0 540 960
There are 18 prompts
current IoU is: 0.94791179895401
Seok, iteration idx= 8 IoU = tensor(0.9479)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.2ms
Speed: 5.2ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9480
Selected instance: 1 (Confidence: 0.9480)
tmp min: tensor(0.) tmp max: tensor(1.)
865 0 540 960
There are 13 prompts
current IoU is: 0.9716821312904358
Seok, iteration idx= 9 IoU = tensor(0.9717)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9662
Instance 1: Confidence=0.8877
Selected instance: 1 (Confidence: 0.8877)
tmp min: tensor(0.) tmp max: tensor(1.)
882 0 540 960
There are 18 prompts
current IoU is: 0.9422873258590698
Seok, iteration idx= 10 IoU = tensor(0.9423)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9667
Instance 1: Confidence=0.9419
Selected instance: 1 (Confidence: 0.9419)
tmp min: tensor(0.) tmp max: tensor(1.)
818 0 540 960
There are 16 prompts
current IoU is: 0.9786619544029236
Seok, iteration idx= 11 IoU = tensor(0.9787)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9518
Selected instance: 0 (Confidence: 0.9593)
tmp min: tensor(0.) tmp max: tensor(1.)
668 0 540 960
There are 16 prompts
current IoU is: 0.9149783253669739
Seok, iteration idx= 12 IoU = tensor(0.9150)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 25.4ms
Speed: 2.5ms preprocess, 25.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9573
Instance 1: Confidence=0.9542
Selected instance: 0 (Confidence: 0.9573)
tmp min: tensor(0.) tmp max: tensor(1.)
555 0 540 960
There are 15 prompts
current IoU is: 0.9733433723449707
Seok, iteration idx= 13 IoU = tensor(0.9733)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 2.6ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9631
Instance 1: Confidence=0.9505
Selected instance: 0 (Confidence: 0.9631)
tmp min: tensor(0.) tmp max: tensor(1.)
452 0 540 960
There are 15 prompts
current IoU is: 0.974187433719635
Seok, iteration idx= 14 IoU = tensor(0.9742)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.8ms
Speed: 3.1ms preprocess, 24.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9450
Selected instance: 0 (Confidence: 0.9626)
tmp min: tensor(0.) tmp max: tensor(1.)
345 68 540 960
There are 15 prompts
current IoU is: 0.9610575437545776
Seok, iteration idx= 15 IoU = tensor(0.9611)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 25.0ms
Speed: 3.5ms preprocess, 25.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9604
Instance 1: Confidence=0.6440
Selected instance: 0 (Confidence: 0.9604)
tmp min: tensor(0.) tmp max: tensor(1.)
212 20 540 960
There are 13 prompts
current IoU is: 0.9548172950744629
Seok, iteration idx= 16 IoU = tensor(0.9548)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.7ms
Speed: 2.3ms preprocess, 22.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 1
Instance 0: Confidence=0.9642
Selected instance: 0 (Confidence: 0.9642)
tmp min: tensor(0.) tmp max: tensor(1.)
147 32 540 960
There are 14 prompts
current IoU is: 0.9582273364067078
Seok, iteration idx= 17 IoU = tensor(0.9582)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.9ms
Speed: 2.4ms preprocess, 22.9ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 3
Instance 0: Confidence=0.9669
Instance 1: Confidence=0.4821
Instance 2: Confidence=0.4394
Selected instance: 0 (Confidence: 0.9669)
tmp min: tensor(0.) tmp max: tensor(1.)
82 0 540 960
There are 14 prompts
current IoU is: 0.9508497714996338
Seok, iteration idx= 18 IoU = tensor(0.9508)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.6ms preprocess, 23.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9351
Instance 1: Confidence=0.9205
Selected instance: 0 (Confidence: 0.9351)
tmp min: tensor(0.) tmp max: tensor(1.)
574 100 540 960
There are 14 prompts
current IoU is: 0.6540918350219727
Seok, iteration idx= 19 IoU = tensor(0.6541)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.2ms
Speed: 1.4ms preprocess, 24.2ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 3
Instance 0: Confidence=0.9503
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.7235
Selected instance: 1 (Confidence: 0.9361)
tmp min: tensor(0.) tmp max: tensor(1.)
609 80 540 960
There are 15 prompts
current IoU is: 0.8668733239173889
Seok, iteration idx= 20 IoU = tensor(0.8669)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.7ms
Speed: 1.7ms preprocess, 24.7ms inference, 3.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 3
Instance 0: Confidence=0.9471
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.4658
Selected instance: 0 (Confidence: 0.9471)
tmp min: tensor(0.) tmp max: tensor(1.)
661 68 540 960
There are 16 prompts
current IoU is: 0.8548610210418701
Seok, iteration idx= 21 IoU = tensor(0.8549)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.9ms
Speed: 1.4ms preprocess, 21.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 2
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9457
Selected instance: 1 (Confidence: 0.9457)
tmp min: tensor(0.) tmp max: tensor(1.)
664 68 540 960
There are 17 prompts
current IoU is: 0.9243241548538208
Seok, iteration idx= 22 IoU = tensor(0.9243)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.6ms
Speed: 2.6ms preprocess, 21.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9676
Instance 1: Confidence=0.9445
Selected instance: 1 (Confidence: 0.9445)
tmp min: tensor(0.) tmp max: tensor(1.)
703 48 540 960
There are 14 prompts
current IoU is: 0.8782589435577393
Seok, iteration idx= 23 IoU = tensor(0.8783)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.8ms
Speed: 5.1ms preprocess, 21.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9700
Instance 1: Confidence=0.9385
Selected instance: 1 (Confidence: 0.9385)
tmp min: tensor(0.) tmp max: tensor(1.)
755 40 540 960
There are 16 prompts
current IoU is: 0.8976209163665771
Seok, iteration idx= 24 IoU = tensor(0.8976)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.9ms
Speed: 1.5ms preprocess, 21.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 3
Instance 0: Confidence=0.9535
Instance 1: Confidence=0.8235
Instance 2: Confidence=0.5369
Selected instance: 1 (Confidence: 0.8235)
tmp min: tensor(0.) tmp max: tensor(1.)
771 32 540 960
There are 18 prompts
current IoU is: 0.8112020492553711
Seok, iteration idx= 25 IoU = tensor(0.8112)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.7ms
Speed: 1.4ms preprocess, 21.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 3
Instance 0: Confidence=0.9589
Instance 1: Confidence=0.2834
Instance 2: Confidence=0.2770
Selected instance: 1 (Confidence: 0.2834)
tmp min: tensor(0.) tmp max: tensor(1.)
746 84 540 960
There are 13 prompts
current IoU is: 0.09972170740365982
Seok, iteration idx= 26 IoU = tensor(0.0997)
SKIP, unacceptable sam prediction, IoU is tensor(0.0997)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.5ms
Speed: 1.4ms preprocess, 21.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 2
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9059
Selected instance: 0 (Confidence: 0.9652)
tmp min: tensor(0.) tmp max: tensor(1.)
50 0 540 960
There are 16 prompts
current IoU is: 0.9658536314964294
Seok, iteration idx= 27 IoU = tensor(0.9659)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 2.5ms preprocess, 22.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 2
Instance 0: Confidence=0.9586
Instance 1: Confidence=0.9416
Selected instance: 0 (Confidence: 0.9586)
tmp min: tensor(0.) tmp max: tensor(1.)
2 4 540 960
There are 18 prompts
current IoU is: 0.9573845863342285
Seok, iteration idx= 28 IoU = tensor(0.9574)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.5ms
Speed: 2.7ms preprocess, 21.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 2
Instance 0: Confidence=0.9624
Instance 1: Confidence=0.9404
Selected instance: 0 (Confidence: 0.9624)
tmp min: tensor(0.) tmp max: tensor(1.)
2 0 540 960
There are 18 prompts
current IoU is: 0.9525996446609497
Seok, iteration idx= 29 IoU = tensor(0.9526)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.9ms
Speed: 2.9ms preprocess, 21.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 3
Instance 0: Confidence=0.9538
Instance 1: Confidence=0.9460
Instance 2: Confidence=0.5105
Selected instance: 0 (Confidence: 0.9538)
tmp min: tensor(0.) tmp max: tensor(1.)
2 0 540 960
There are 18 prompts
current IoU is: 0.9341681599617004
Seok, iteration idx= 30 IoU = tensor(0.9342)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.8ms
Speed: 1.4ms preprocess, 21.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 4
Instance 0: Confidence=0.9569
Instance 1: Confidence=0.9566
Instance 2: Confidence=0.8389
Instance 3: Confidence=0.3479
Selected instance: 0 (Confidence: 0.9569)
tmp min: tensor(0.) tmp max: tensor(1.)
26 20 540 960
There are 14 prompts
current IoU is: 0.9384289383888245
Seok, iteration idx= 31 IoU = tensor(0.9384)
Selected Instance Confidence List: [tensor(0.9441), tensor(0.8695, device='cpu'), tensor(0.8868, device='cpu'), tensor(0.6005, device='cpu'), tensor(0.7771, device='cpu'), tensor(0.8664, device='cpu'), tensor(0.9449, device='cpu'), tensor(0.9308, device='cpu'), tensor(0.9469, device='cpu'), tensor(0.9622, device='cpu'), tensor(0.9204, device='cpu'), tensor(0.9639, device='cpu'), tensor(0.9327, device='cpu'), tensor(0.9669, device='cpu'), tensor(0.9698, device='cpu'), tensor(0.9617, device='cpu'), tensor(0.9570, device='cpu'), tensor(0.9606, device='cpu'), tensor(0.9573, device='cpu'), tensor(0.7665, device='cpu'), tensor(0.8946, device='cpu'), tensor(0.8918, device='cpu'), tensor(0.9329, device='cpu'), tensor(0.9047, device='cpu'), tensor(0.9140, device='cpu'), tensor(0.8161, device='cpu'), tensor(0.3879, device='cpu'), tensor(0.9656, device='cpu'), tensor(0.9579, device='cpu'), tensor(0.9565, device='cpu'), tensor(0.9420, device='cpu'), tensor(0.9458, device='cpu')]
Sorted Confidence Order: [tensor(0.9698, device='cpu'), tensor(0.9669, device='cpu'), tensor(0.9327, device='cpu'), tensor(0.9639, device='cpu'), tensor(0.9204, device='cpu'), tensor(0.9622, device='cpu'), tensor(0.9469, device='cpu'), tensor(0.9308, device='cpu'), tensor(0.9449, device='cpu'), tensor(0.8664, device='cpu'), tensor(0.7771, device='cpu'), tensor(0.6005, device='cpu'), tensor(0.3879, device='cpu'), tensor(0.8161, device='cpu'), tensor(0.9140, device='cpu'), tensor(0.9047, device='cpu'), tensor(0.9329, device='cpu'), tensor(0.8918, device='cpu'), tensor(0.8946, device='cpu'), tensor(0.7665, device='cpu'), tensor(0.8868, device='cpu'), tensor(0.8695, device='cpu'), tensor(0.9441), tensor(0.9458, device='cpu'), tensor(0.9420, device='cpu'), tensor(0.9565, device='cpu'), tensor(0.9579, device='cpu'), tensor(0.9656, device='cpu'), tensor(0.9573, device='cpu'), tensor(0.9606, device='cpu'), tensor(0.9570, device='cpu'), tensor(0.9617, device='cpu')]
sorted_indices: [14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 26, 25, 24, 23, 22, 21, 20, 19, 2, 1, 0, 31, 30, 29, 28, 27, 18, 17, 16, 15]
Initial view (highest confidence): 15
New training order: [32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15, 14, 13, 12, 11, 10, 9, 36, 35, 34, 33]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.9ms
Speed: 1.3ms preprocess, 19.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.8ms
Speed: 1.2ms preprocess, 21.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 2
Instance 0: Confidence=0.9573
Instance 1: Confidence=0.9542
tmp min: tensor(0.) tmp max: tensor(1.)
555 0 540 960
There are 15 prompts
current IoU is: 0.9783763885498047
Seok, iteration idx= 1 IoU = tensor(0.9784)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.4ms
Speed: 3.3ms preprocess, 21.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 2
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9518
tmp min: tensor(0.) tmp max: tensor(1.)
668 0 540 960
There are 16 prompts
current IoU is: 0.9836165904998779
Seok, iteration idx= 2 IoU = tensor(0.9836)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.9ms
Speed: 3.1ms preprocess, 21.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 2
Instance 0: Confidence=0.9667
Instance 1: Confidence=0.9419
tmp min: tensor(0.) tmp max: tensor(1.)
818 0 540 960
There are 16 prompts
current IoU is: 0.9745975136756897
Seok, iteration idx= 3 IoU = tensor(0.9746)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.8ms
Speed: 1.3ms preprocess, 21.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 2
Instance 0: Confidence=0.9662
Instance 1: Confidence=0.8877
tmp min: tensor(0.) tmp max: tensor(1.)
882 0 540 960
There are 18 prompts
current IoU is: 0.9466166496276855
Seok, iteration idx= 4 IoU = tensor(0.9466)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.0ms
Speed: 1.4ms preprocess, 22.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9480
tmp min: tensor(0.) tmp max: tensor(1.)
865 0 540 960
There are 13 prompts
current IoU is: 0.9759013056755066
Seok, iteration idx= 5 IoU = tensor(0.9759)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9603
Instance 1: Confidence=0.9454
tmp min: tensor(0.) tmp max: tensor(1.)
886 0 540 960
There are 18 prompts
current IoU is: 0.9535395503044128
Seok, iteration idx= 6 IoU = tensor(0.9535)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.7ms
Speed: 3.0ms preprocess, 21.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9422
tmp min: tensor(0.) tmp max: tensor(1.)
889 24 540 960
There are 13 prompts
current IoU is: 0.9363056421279907
Seok, iteration idx= 7 IoU = tensor(0.9363)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 2.7ms preprocess, 22.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9518
tmp min: tensor(0.) tmp max: tensor(1.)
893 40 540 960
There are 15 prompts
current IoU is: 0.9599247574806213
Seok, iteration idx= 8 IoU = tensor(0.9599)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 3.6ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9470
tmp min: tensor(0.) tmp max: tensor(1.)
820 80 540 960
There are 17 prompts
current IoU is: 0.9519495368003845
Seok, iteration idx= 9 IoU = tensor(0.9519)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.7ms
Speed: 1.4ms preprocess, 21.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9560
tmp min: tensor(0.) tmp max: tensor(1.)
814 48 540 960
There are 16 prompts
current IoU is: 0.9009197354316711
Seok, iteration idx= 10 IoU = tensor(0.9009)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.6ms
Speed: 1.4ms preprocess, 21.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9475
Instance 1: Confidence=0.8862
tmp min: tensor(0.) tmp max: tensor(1.)
830 56 540 960
There are 17 prompts
current IoU is: 0.8247156143188477
Seok, iteration idx= 11 IoU = tensor(0.8247)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.7ms
Speed: 1.4ms preprocess, 21.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 3
Instance 0: Confidence=0.9589
Instance 1: Confidence=0.2834
Instance 2: Confidence=0.2770
tmp min: tensor(0.) tmp max: tensor(1.)
746 84 540 960
There are 13 prompts
current IoU is: 0.10453283786773682
Seok, iteration idx= 12 IoU = tensor(0.1045)
SKIP, unacceptable sam prediction, IoU is tensor(0.1045)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.2ms
Speed: 2.8ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 3
Instance 0: Confidence=0.9535
Instance 1: Confidence=0.8235
Instance 2: Confidence=0.5369
tmp min: tensor(0.) tmp max: tensor(1.)
771 32 540 960
There are 18 prompts
current IoU is: 0.870320737361908
Seok, iteration idx= 13 IoU = tensor(0.8703)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 2.9ms preprocess, 22.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9700
Instance 1: Confidence=0.9385
tmp min: tensor(0.) tmp max: tensor(1.)
755 40 540 960
There are 16 prompts
current IoU is: 0.905156135559082
Seok, iteration idx= 14 IoU = tensor(0.9052)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.7ms
Speed: 1.2ms preprocess, 21.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 2
Instance 0: Confidence=0.9676
Instance 1: Confidence=0.9445
tmp min: tensor(0.) tmp max: tensor(1.)
703 48 540 960
There are 14 prompts
current IoU is: 0.905369758605957
Seok, iteration idx= 15 IoU = tensor(0.9054)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.8ms
Speed: 1.2ms preprocess, 21.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9457
tmp min: tensor(0.) tmp max: tensor(1.)
664 68 540 960
There are 17 prompts
current IoU is: 0.944237232208252
Seok, iteration idx= 16 IoU = tensor(0.9442)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.9ms
Speed: 1.3ms preprocess, 21.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 3
Instance 0: Confidence=0.9471
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.4658
tmp min: tensor(0.) tmp max: tensor(1.)
661 68 540 960
There are 16 prompts
current IoU is: 0.9421034455299377
Seok, iteration idx= 17 IoU = tensor(0.9421)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 3
Instance 0: Confidence=0.9503
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.7235
tmp min: tensor(0.) tmp max: tensor(1.)
609 80 540 960
There are 15 prompts
current IoU is: 0.9292805790901184
Seok, iteration idx= 18 IoU = tensor(0.9293)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.0ms
Speed: 1.4ms preprocess, 22.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9351
Instance 1: Confidence=0.9205
tmp min: tensor(0.) tmp max: tensor(1.)
574 100 540 960
There are 14 prompts
current IoU is: 0.9245151877403259
Seok, iteration idx= 19 IoU = tensor(0.9245)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.9ms
Speed: 1.5ms preprocess, 21.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 3
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9196
Instance 2: Confidence=0.5705
tmp min: tensor(0.) tmp max: tensor(1.)
146 116 540 960
There are 15 prompts
current IoU is: 0.9541758894920349
Seok, iteration idx= 20 IoU = tensor(0.9542)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.7ms
Speed: 2.7ms preprocess, 21.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 3
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.9273
Instance 2: Confidence=0.8225
tmp min: tensor(0.) tmp max: tensor(1.)
119 68 540 960
There are 14 prompts
current IoU is: 0.9555112719535828
Seok, iteration idx= 21 IoU = tensor(0.9555)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.5ms
Speed: 2.3ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 4
Instance 0: Confidence=0.9441
Instance 1: Confidence=0.9413
Instance 2: Confidence=0.8401
Instance 3: Confidence=0.5010
tmp min: tensor(0.) tmp max: tensor(1.)
76 52 540 960
There are 13 prompts
current IoU is: 0.9614147543907166
Seok, iteration idx= 22 IoU = tensor(0.9614)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.1ms
Speed: 1.3ms preprocess, 22.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 4
Instance 0: Confidence=0.9569
Instance 1: Confidence=0.9566
Instance 2: Confidence=0.8389
Instance 3: Confidence=0.3479
tmp min: tensor(0.) tmp max: tensor(1.)
26 20 540 960
There are 14 prompts
current IoU is: 0.9447948932647705
Seok, iteration idx= 23 IoU = tensor(0.9448)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 3
Instance 0: Confidence=0.9538
Instance 1: Confidence=0.9460
Instance 2: Confidence=0.5105
tmp min: tensor(0.) tmp max: tensor(1.)
2 0 540 960
There are 18 prompts
current IoU is: 0.9424222111701965
Seok, iteration idx= 24 IoU = tensor(0.9424)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.9ms
Speed: 1.4ms preprocess, 21.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9624
Instance 1: Confidence=0.9404
tmp min: tensor(0.) tmp max: tensor(1.)
2 0 540 960
There are 18 prompts
current IoU is: 0.954929769039154
Seok, iteration idx= 25 IoU = tensor(0.9549)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.4ms
Speed: 2.6ms preprocess, 21.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 2
Instance 0: Confidence=0.9586
Instance 1: Confidence=0.9416
tmp min: tensor(0.) tmp max: tensor(1.)
2 4 540 960
There are 18 prompts
current IoU is: 0.9618200659751892
Seok, iteration idx= 26 IoU = tensor(0.9618)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 2.3ms preprocess, 23.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 2
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9059
tmp min: tensor(0.) tmp max: tensor(1.)
50 0 540 960
There are 16 prompts
current IoU is: 0.9705582857131958
Seok, iteration idx= 27 IoU = tensor(0.9706)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.1ms
Speed: 1.5ms preprocess, 22.1ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 3
Instance 0: Confidence=0.9669
Instance 1: Confidence=0.4821
Instance 2: Confidence=0.4394
tmp min: tensor(0.) tmp max: tensor(1.)
82 0 540 960
There are 14 prompts
current IoU is: 0.9547443389892578
Seok, iteration idx= 28 IoU = tensor(0.9547)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 1
Instance 0: Confidence=0.9642
tmp min: tensor(0.) tmp max: tensor(1.)
147 32 540 960
There are 14 prompts
current IoU is: 0.9606029391288757
Seok, iteration idx= 29 IoU = tensor(0.9606)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 2
Instance 0: Confidence=0.9604
Instance 1: Confidence=0.6440
tmp min: tensor(0.) tmp max: tensor(1.)
212 20 540 960
There are 13 prompts
current IoU is: 0.9493524432182312
Seok, iteration idx= 30 IoU = tensor(0.9494)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 1.4ms preprocess, 22.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9450
tmp min: tensor(0.) tmp max: tensor(1.)
345 68 540 960
There are 15 prompts
current IoU is: 0.9613038301467896
Seok, iteration idx= 31 IoU = tensor(0.9613)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set6_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set6_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:36<00:00,  1.14s/it]
Testing psnr 29.24417570233345 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set6_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:25<00:00,  1.23it/s]
Testing psnr 3.8844769075512886 (avg)
train: coarse segmentation in 16:51:16
train: finish (eps time 16:51:16 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set6_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set7/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 40.15it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set7 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set7
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set7_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.0ms
Speed: 2.9ms preprocess, 21.0ms inference, 3.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.8ms
Speed: 1.2ms preprocess, 22.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.8ms
Speed: 1.7ms preprocess, 22.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.2ms
Speed: 1.4ms preprocess, 24.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 1.3ms preprocess, 22.4ms inference, 3.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.0ms
Speed: 1.3ms preprocess, 24.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.9ms
Speed: 1.3ms preprocess, 21.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.3ms preprocess, 22.5ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.6ms
Speed: 1.2ms preprocess, 20.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 21.8ms
Speed: 1.9ms preprocess, 21.8ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.0ms
Speed: 1.2ms preprocess, 21.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.2ms
Speed: 1.2ms preprocess, 21.2ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 1.3ms preprocess, 22.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.6ms
Speed: 1.2ms preprocess, 20.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.3ms
Speed: 2.2ms preprocess, 20.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.8ms
Speed: 1.3ms preprocess, 20.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.8ms
Speed: 1.2ms preprocess, 20.8ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.1ms
Speed: 1.2ms preprocess, 21.1ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.8ms
Speed: 1.3ms preprocess, 20.8ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.2ms
Speed: 1.2ms preprocess, 21.2ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.9ms
Speed: 1.2ms preprocess, 20.9ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.6ms
Speed: 1.2ms preprocess, 21.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.3ms
Speed: 1.3ms preprocess, 20.3ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.2ms
Speed: 1.3ms preprocess, 21.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.7ms
Speed: 1.2ms preprocess, 21.7ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.3ms
Speed: 1.2ms preprocess, 20.3ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.6ms
Speed: 1.3ms preprocess, 21.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.5ms
Speed: 1.7ms preprocess, 23.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 30
view_order: [35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.0ms
Speed: 1.1ms preprocess, 22.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 2
Instance 0: Confidence=0.9563
Instance 1: Confidence=0.4461
Selected instance: 0 (Confidence: 0.9563)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

155 76 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 15 prompts
current IoU is: 0.7952982187271118
Seok, iteration idx= 1 IoU = tensor(0.7953)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 2.3ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 2
Instance 0: Confidence=0.9536
Instance 1: Confidence=0.9447
Selected instance: 0 (Confidence: 0.9536)
tmp min: tensor(0.) tmp max: tensor(1.)
713 108 540 960
There are 14 prompts
current IoU is: 0.5683237314224243
Seok, iteration idx= 2 IoU = tensor(0.5683)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.3ms
Speed: 4.2ms preprocess, 22.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 3
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.3825
Selected instance: 0 (Confidence: 0.9540)
tmp min: tensor(0.) tmp max: tensor(1.)
751 80 540 960
There are 16 prompts
current IoU is: 0.8528313040733337
Seok, iteration idx= 3 IoU = tensor(0.8528)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.7ms
Speed: 3.2ms preprocess, 24.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 3
Instance 0: Confidence=0.9624
Instance 1: Confidence=0.9555
Instance 2: Confidence=0.6049
Selected instance: 0 (Confidence: 0.9624)
tmp min: tensor(0.) tmp max: tensor(1.)
797 72 540 960
There are 16 prompts
current IoU is: 0.8516243100166321
Seok, iteration idx= 4 IoU = tensor(0.8516)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.7ms preprocess, 23.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9575
Selected instance: 0 (Confidence: 0.9618)
tmp min: tensor(0.) tmp max: tensor(1.)
780 68 540 960
There are 16 prompts
current IoU is: 0.8762749433517456
Seok, iteration idx= 5 IoU = tensor(0.8763)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.6ms
Speed: 3.3ms preprocess, 24.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9701
Instance 1: Confidence=0.9441
Selected instance: 0 (Confidence: 0.9701)
tmp min: tensor(0.) tmp max: tensor(1.)
815 48 540 960
There are 14 prompts
current IoU is: 0.8976013660430908
Seok, iteration idx= 6 IoU = tensor(0.8976)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 3
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.6308
Selected instance: 0 (Confidence: 0.9658)
tmp min: tensor(0.) tmp max: tensor(1.)
835 36 540 960
There are 15 prompts
current IoU is: 0.94793701171875
Seok, iteration idx= 7 IoU = tensor(0.9479)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9707
Instance 1: Confidence=0.9349
Selected instance: 0 (Confidence: 0.9707)
tmp min: tensor(0.) tmp max: tensor(1.)
804 28 540 960
There are 13 prompts
current IoU is: 0.9190042614936829
Seok, iteration idx= 8 IoU = tensor(0.9190)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9734
Instance 1: Confidence=0.9361
Selected instance: 0 (Confidence: 0.9734)
tmp min: tensor(0.) tmp max: tensor(1.)
776 4 540 960
There are 15 prompts
current IoU is: 0.9407151937484741
Seok, iteration idx= 9 IoU = tensor(0.9407)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 1
Instance 0: Confidence=0.9550
Selected instance: 0 (Confidence: 0.9550)
tmp min: tensor(0.) tmp max: tensor(1.)
184 64 540 960
There are 18 prompts
current IoU is: 0.8285183310508728
Seok, iteration idx= 10 IoU = tensor(0.8285)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 26.0ms
Speed: 1.4ms preprocess, 26.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 1
Instance 0: Confidence=0.9572
Selected instance: 0 (Confidence: 0.9572)
tmp min: tensor(0.) tmp max: tensor(1.)
186 72 540 960
There are 16 prompts
current IoU is: 0.848455548286438
Seok, iteration idx= 11 IoU = tensor(0.8485)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.0ms
Speed: 1.7ms preprocess, 23.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 3
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.8823
Instance 2: Confidence=0.4506
Selected instance: 0 (Confidence: 0.9594)
tmp min: tensor(0.) tmp max: tensor(1.)
214 64 540 960
There are 16 prompts
current IoU is: 0.8573117852210999
Seok, iteration idx= 12 IoU = tensor(0.8573)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9674
Instance 1: Confidence=0.6939
Selected instance: 0 (Confidence: 0.9674)
tmp min: tensor(0.) tmp max: tensor(1.)
230 68 540 960
There are 16 prompts
current IoU is: 0.8861342072486877
Seok, iteration idx= 13 IoU = tensor(0.8861)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.5ms
Speed: 1.5ms preprocess, 24.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9456
Instance 1: Confidence=0.8489
Selected instance: 0 (Confidence: 0.9456)
tmp min: tensor(0.) tmp max: tensor(1.)
268 80 540 960
There are 16 prompts
current IoU is: 0.8962336778640747
Seok, iteration idx= 14 IoU = tensor(0.8962)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.4ms
Speed: 2.8ms preprocess, 24.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 3
Instance 0: Confidence=0.9496
Instance 1: Confidence=0.8183
Instance 2: Confidence=0.3549
Selected instance: 0 (Confidence: 0.9496)
tmp min: tensor(0.) tmp max: tensor(1.)
312 96 540 960
There are 16 prompts
current IoU is: 0.8659129738807678
Seok, iteration idx= 15 IoU = tensor(0.8659)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.8ms
Speed: 3.0ms preprocess, 24.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 3
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9284
Instance 2: Confidence=0.7120
Selected instance: 0 (Confidence: 0.9486)
tmp min: tensor(0.) tmp max: tensor(1.)
338 112 540 960
There are 15 prompts
current IoU is: 0.854687511920929
Seok, iteration idx= 16 IoU = tensor(0.8547)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.2ms
Speed: 2.2ms preprocess, 24.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9430
Selected instance: 1 (Confidence: 0.9430)
tmp min: tensor(0.) tmp max: tensor(1.)
359 148 540 960
There are 15 prompts
current IoU is: 0.845177173614502
Seok, iteration idx= 17 IoU = tensor(0.8452)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.2ms
Speed: 3.0ms preprocess, 24.2ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9740
Instance 1: Confidence=0.9374
Selected instance: 0 (Confidence: 0.9740)
tmp min: tensor(0.) tmp max: tensor(1.)
783 48 540 960
There are 14 prompts
current IoU is: 0.9497595429420471
Seok, iteration idx= 18 IoU = tensor(0.9498)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 2.7ms preprocess, 22.1ms inference, 2.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9647
Instance 1: Confidence=0.9377
Selected instance: 0 (Confidence: 0.9647)
tmp min: tensor(0.) tmp max: tensor(1.)
703 48 540 960
There are 13 prompts
current IoU is: 0.9078148603439331
Seok, iteration idx= 19 IoU = tensor(0.9078)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.5ms
Speed: 2.5ms preprocess, 24.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9654
Instance 1: Confidence=0.9447
Selected instance: 0 (Confidence: 0.9654)
tmp min: tensor(0.) tmp max: tensor(1.)
674 84 540 960
There are 13 prompts
current IoU is: 0.9152718186378479
Seok, iteration idx= 20 IoU = tensor(0.9153)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 5.3ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9613
Instance 1: Confidence=0.9350
Selected instance: 0 (Confidence: 0.9613)
tmp min: tensor(0.) tmp max: tensor(1.)
616 48 540 960
There are 13 prompts
current IoU is: 0.8927371501922607
Seok, iteration idx= 21 IoU = tensor(0.8927)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.3ms
Speed: 3.9ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 1
Instance 0: Confidence=0.9570
Selected instance: 0 (Confidence: 0.9570)
tmp min: tensor(0.) tmp max: tensor(1.)
498 36 540 960
There are 14 prompts
current IoU is: 0.9010725021362305
Seok, iteration idx= 22 IoU = tensor(0.9011)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.7ms
Speed: 3.2ms preprocess, 23.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9596
Instance 1: Confidence=0.9353
Selected instance: 0 (Confidence: 0.9596)
tmp min: tensor(0.) tmp max: tensor(1.)
413 12 540 960
There are 16 prompts
current IoU is: 0.9394749402999878
Seok, iteration idx= 23 IoU = tensor(0.9395)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9272
Selected instance: 0 (Confidence: 0.9555)
tmp min: tensor(0.) tmp max: tensor(1.)
300 20 540 960
There are 14 prompts
current IoU is: 0.923822283744812
Seok, iteration idx= 24 IoU = tensor(0.9238)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9309
Selected instance: 0 (Confidence: 0.9518)
tmp min: tensor(0.) tmp max: tensor(1.)
238 12 540 960
There are 16 prompts
current IoU is: 0.93875652551651
Seok, iteration idx= 25 IoU = tensor(0.9388)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 2
Instance 0: Confidence=0.9582
Instance 1: Confidence=0.9248
Selected instance: 0 (Confidence: 0.9582)
tmp min: tensor(0.) tmp max: tensor(1.)
190 0 540 960
There are 15 prompts
current IoU is: 0.9345107674598694
Seok, iteration idx= 26 IoU = tensor(0.9345)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9183
Selected instance: 0 (Confidence: 0.9626)
tmp min: tensor(0.) tmp max: tensor(1.)
155 52 540 960
There are 15 prompts
current IoU is: 0.9543972611427307
Seok, iteration idx= 27 IoU = tensor(0.9544)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 2
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9258
Selected instance: 0 (Confidence: 0.9592)
tmp min: tensor(0.) tmp max: tensor(1.)
126 24 540 960
There are 15 prompts
current IoU is: 0.941739559173584
Seok, iteration idx= 28 IoU = tensor(0.9417)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.9ms preprocess, 23.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 2
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9293
Selected instance: 0 (Confidence: 0.9583)
tmp min: tensor(0.) tmp max: tensor(1.)
139 44 540 960
There are 14 prompts
current IoU is: 0.9350544810295105
Seok, iteration idx= 29 IoU = tensor(0.9351)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 25.0ms
Speed: 1.4ms preprocess, 25.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 2
Instance 0: Confidence=0.9606
Instance 1: Confidence=0.9400
Selected instance: 0 (Confidence: 0.9606)
tmp min: tensor(0.) tmp max: tensor(1.)
156 132 540 960
There are 16 prompts
current IoU is: 0.9216290712356567
Seok, iteration idx= 30 IoU = tensor(0.9216)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 3.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 2
Instance 0: Confidence=0.9601
Instance 1: Confidence=0.8530
Selected instance: 0 (Confidence: 0.9601)
tmp min: tensor(0.) tmp max: tensor(1.)
153 104 540 960
There are 14 prompts
current IoU is: 0.9336004853248596
Seok, iteration idx= 31 IoU = tensor(0.9336)
Selected Instance Confidence List: [tensor(0.9627), tensor(0.8597, device='cpu'), tensor(0.7224, device='cpu'), tensor(0.8933, device='cpu'), tensor(0.8959, device='cpu'), tensor(0.9105, device='cpu'), tensor(0.9266, device='cpu'), tensor(0.9551, device='cpu'), tensor(0.9397, device='cpu'), tensor(0.9538, device='cpu'), tensor(0.8791, device='cpu'), tensor(0.8919, device='cpu'), tensor(0.8981, device='cpu'), tensor(0.9186, device='cpu'), tensor(0.9160, device='cpu'), tensor(0.8994, device='cpu'), tensor(0.8923, device='cpu'), tensor(0.8843, device='cpu'), tensor(0.9595, device='cpu'), tensor(0.9306, device='cpu'), tensor(0.9353, device='cpu'), tensor(0.9202, device='cpu'), tensor(0.9234, device='cpu'), tensor(0.9475, device='cpu'), tensor(0.9365, device='cpu'), tensor(0.9440, device='cpu'), tensor(0.9440, device='cpu'), tensor(0.9577, device='cpu'), tensor(0.9487, device='cpu'), tensor(0.9444, device='cpu'), tensor(0.9372, device='cpu'), tensor(0.9442, device='cpu')]
Sorted Confidence Order: [tensor(0.9627), tensor(0.9442, device='cpu'), tensor(0.8597, device='cpu'), tensor(0.8791, device='cpu'), tensor(0.8919, device='cpu'), tensor(0.8981, device='cpu'), tensor(0.9186, device='cpu'), tensor(0.9160, device='cpu'), tensor(0.8994, device='cpu'), tensor(0.8923, device='cpu'), tensor(0.8843, device='cpu'), tensor(0.9372, device='cpu'), tensor(0.9444, device='cpu'), tensor(0.9487, device='cpu'), tensor(0.9577, device='cpu'), tensor(0.9440, device='cpu'), tensor(0.9440, device='cpu'), tensor(0.9365, device='cpu'), tensor(0.9475, device='cpu'), tensor(0.9234, device='cpu'), tensor(0.9202, device='cpu'), tensor(0.9353, device='cpu'), tensor(0.9306, device='cpu'), tensor(0.9595, device='cpu'), tensor(0.9538, device='cpu'), tensor(0.9397, device='cpu'), tensor(0.9551, device='cpu'), tensor(0.9266, device='cpu'), tensor(0.9105, device='cpu'), tensor(0.8959, device='cpu'), tensor(0.8933, device='cpu'), tensor(0.7224, device='cpu')]
sorted_indices: [0, 31, 1, 10, 11, 12, 13, 14, 15, 16, 17, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 9, 8, 7, 6, 5, 4, 3, 2]
Initial view (highest confidence): 1
New training order: [35, 34, 36, 9, 10, 11, 12, 13, 14, 15, 16, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.9ms
Speed: 1.3ms preprocess, 21.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 3.1ms preprocess, 23.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 2
Instance 0: Confidence=0.9601
Instance 1: Confidence=0.8530
tmp min: tensor(0.) tmp max: tensor(1.)
153 104 540 960
There are 14 prompts
current IoU is: 0.9303091168403625
Seok, iteration idx= 1 IoU = tensor(0.9303)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.8ms
Speed: 2.8ms preprocess, 24.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 2
Instance 0: Confidence=0.9563
Instance 1: Confidence=0.4461
tmp min: tensor(0.) tmp max: tensor(1.)
155 76 540 960
There are 15 prompts
current IoU is: 0.919704794883728
Seok, iteration idx= 2 IoU = tensor(0.9197)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.1ms
Speed: 3.0ms preprocess, 23.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 1
Instance 0: Confidence=0.9550
tmp min: tensor(0.) tmp max: tensor(1.)
184 64 540 960
There are 18 prompts
current IoU is: 0.9198456406593323
Seok, iteration idx= 3 IoU = tensor(0.9198)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 25.3ms
Speed: 4.1ms preprocess, 25.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 1
Instance 0: Confidence=0.9572
tmp min: tensor(0.) tmp max: tensor(1.)
186 72 540 960
There are 16 prompts
current IoU is: 0.9137300252914429
Seok, iteration idx= 4 IoU = tensor(0.9137)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.8ms
Speed: 2.6ms preprocess, 22.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 3
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.8823
Instance 2: Confidence=0.4506
tmp min: tensor(0.) tmp max: tensor(1.)
214 64 540 960
There are 16 prompts
current IoU is: 0.9090909361839294
Seok, iteration idx= 5 IoU = tensor(0.9091)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.8ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9674
Instance 1: Confidence=0.6939
tmp min: tensor(0.) tmp max: tensor(1.)
230 68 540 960
There are 16 prompts
current IoU is: 0.9190188646316528
Seok, iteration idx= 6 IoU = tensor(0.9190)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9456
Instance 1: Confidence=0.8489
tmp min: tensor(0.) tmp max: tensor(1.)
268 80 540 960
There are 16 prompts
current IoU is: 0.9126732349395752
Seok, iteration idx= 7 IoU = tensor(0.9127)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 3
Instance 0: Confidence=0.9496
Instance 1: Confidence=0.8183
Instance 2: Confidence=0.3549
tmp min: tensor(0.) tmp max: tensor(1.)
312 96 540 960
There are 16 prompts
current IoU is: 0.8953238129615784
Seok, iteration idx= 8 IoU = tensor(0.8953)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.2ms
Speed: 1.4ms preprocess, 24.2ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 3
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9284
Instance 2: Confidence=0.7120
tmp min: tensor(0.) tmp max: tensor(1.)
338 112 540 960
There are 15 prompts
current IoU is: 0.8890642523765564
Seok, iteration idx= 9 IoU = tensor(0.8891)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 25.1ms
Speed: 1.4ms preprocess, 25.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9430
tmp min: tensor(0.) tmp max: tensor(1.)
359 148 540 960
There are 15 prompts
current IoU is: 0.8845127820968628
Seok, iteration idx= 10 IoU = tensor(0.8845)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 25.1ms
Speed: 1.4ms preprocess, 25.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9606
Instance 1: Confidence=0.9400
tmp min: tensor(0.) tmp max: tensor(1.)
156 132 540 960
There are 16 prompts
current IoU is: 0.923305094242096
Seok, iteration idx= 11 IoU = tensor(0.9233)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9293
tmp min: tensor(0.) tmp max: tensor(1.)
139 44 540 960
There are 14 prompts
current IoU is: 0.9395578503608704
Seok, iteration idx= 12 IoU = tensor(0.9396)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.9ms
Speed: 1.4ms preprocess, 24.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9258
tmp min: tensor(0.) tmp max: tensor(1.)
126 24 540 960
There are 15 prompts
current IoU is: 0.9449504017829895
Seok, iteration idx= 13 IoU = tensor(0.9450)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9183
tmp min: tensor(0.) tmp max: tensor(1.)
155 52 540 960
There are 15 prompts
current IoU is: 0.9597347378730774
Seok, iteration idx= 14 IoU = tensor(0.9597)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 3.1ms preprocess, 23.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 2
Instance 0: Confidence=0.9582
Instance 1: Confidence=0.9248
tmp min: tensor(0.) tmp max: tensor(1.)
190 0 540 960
There are 15 prompts
current IoU is: 0.9408244490623474
Seok, iteration idx= 15 IoU = tensor(0.9408)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 2.4ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9309
tmp min: tensor(0.) tmp max: tensor(1.)
238 12 540 960
There are 16 prompts
current IoU is: 0.9521081447601318
Seok, iteration idx= 16 IoU = tensor(0.9521)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 2.8ms preprocess, 23.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9272
tmp min: tensor(0.) tmp max: tensor(1.)
300 20 540 960
There are 14 prompts
current IoU is: 0.9363969564437866
Seok, iteration idx= 17 IoU = tensor(0.9364)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 2.8ms preprocess, 23.8ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9596
Instance 1: Confidence=0.9353
tmp min: tensor(0.) tmp max: tensor(1.)
413 12 540 960
There are 16 prompts
current IoU is: 0.9531083703041077
Seok, iteration idx= 18 IoU = tensor(0.9531)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 24.3ms
Speed: 4.0ms preprocess, 24.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 1
Instance 0: Confidence=0.9570
tmp min: tensor(0.) tmp max: tensor(1.)
498 36 540 960
There are 14 prompts
current IoU is: 0.9208332896232605
Seok, iteration idx= 19 IoU = tensor(0.9208)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 2.3ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9613
Instance 1: Confidence=0.9350
tmp min: tensor(0.) tmp max: tensor(1.)
616 48 540 960
There are 13 prompts
current IoU is: 0.928062915802002
Seok, iteration idx= 20 IoU = tensor(0.9281)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9654
Instance 1: Confidence=0.9447
tmp min: tensor(0.) tmp max: tensor(1.)
674 84 540 960
There are 13 prompts
current IoU is: 0.9392631649971008
Seok, iteration idx= 21 IoU = tensor(0.9393)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.8ms
Speed: 1.5ms preprocess, 24.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 2
Instance 0: Confidence=0.9647
Instance 1: Confidence=0.9377
tmp min: tensor(0.) tmp max: tensor(1.)
703 48 540 960
There are 13 prompts
current IoU is: 0.9290595650672913
Seok, iteration idx= 22 IoU = tensor(0.9291)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 2.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9740
Instance 1: Confidence=0.9374
tmp min: tensor(0.) tmp max: tensor(1.)
783 48 540 960
There are 14 prompts
current IoU is: 0.9551591873168945
Seok, iteration idx= 23 IoU = tensor(0.9552)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 1.8ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9734
Instance 1: Confidence=0.9361
tmp min: tensor(0.) tmp max: tensor(1.)
776 4 540 960
There are 15 prompts
current IoU is: 0.9493577480316162
Seok, iteration idx= 24 IoU = tensor(0.9494)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9707
Instance 1: Confidence=0.9349
tmp min: tensor(0.) tmp max: tensor(1.)
804 28 540 960
There are 13 prompts
current IoU is: 0.9469184279441833
Seok, iteration idx= 25 IoU = tensor(0.9469)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.2ms
Speed: 1.4ms preprocess, 24.2ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 3
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.6308
tmp min: tensor(0.) tmp max: tensor(1.)
835 36 540 960
There are 15 prompts
current IoU is: 0.9567633271217346
Seok, iteration idx= 26 IoU = tensor(0.9568)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 2
Instance 0: Confidence=0.9701
Instance 1: Confidence=0.9441
tmp min: tensor(0.) tmp max: tensor(1.)
815 48 540 960
There are 14 prompts
current IoU is: 0.9402125477790833
Seok, iteration idx= 27 IoU = tensor(0.9402)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.2ms
Speed: 2.0ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 2
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9575
tmp min: tensor(0.) tmp max: tensor(1.)
780 68 540 960
There are 16 prompts
current IoU is: 0.946791410446167
Seok, iteration idx= 28 IoU = tensor(0.9468)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.8ms
Speed: 2.4ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 3
Instance 0: Confidence=0.9624
Instance 1: Confidence=0.9555
Instance 2: Confidence=0.6049
tmp min: tensor(0.) tmp max: tensor(1.)
797 72 540 960
There are 16 prompts
current IoU is: 0.9432342052459717
Seok, iteration idx= 29 IoU = tensor(0.9432)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.1ms
Speed: 1.5ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 3
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.3825
tmp min: tensor(0.) tmp max: tensor(1.)
751 80 540 960
There are 16 prompts
current IoU is: 0.938743531703949
Seok, iteration idx= 30 IoU = tensor(0.9387)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 2
Instance 0: Confidence=0.9536
Instance 1: Confidence=0.9447
tmp min: tensor(0.) tmp max: tensor(1.)
713 108 540 960
There are 14 prompts
current IoU is: 0.9252105951309204
Seok, iteration idx= 31 IoU = tensor(0.9252)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set7_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set7_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:41<00:00,  1.28s/it]
Testing psnr 29.035378023982048 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set7_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:28<00:00,  1.12it/s]
Testing psnr 4.082696009427309 (avg)
train: coarse segmentation in 00:04:06
train: finish (eps time 00:04:06 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set7_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set8/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 47.84it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set8 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set8
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set8_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.8ms
Speed: 2.8ms preprocess, 19.8ms inference, 3.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.8ms
Speed: 2.0ms preprocess, 20.8ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.8ms
Speed: 1.4ms preprocess, 21.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.7ms
Speed: 1.5ms preprocess, 20.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.9ms
Speed: 1.4ms preprocess, 20.9ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.1ms
Speed: 1.4ms preprocess, 21.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.0ms
Speed: 1.5ms preprocess, 21.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.9ms
Speed: 1.5ms preprocess, 21.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.5ms
Speed: 1.5ms preprocess, 21.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.9ms
Speed: 1.4ms preprocess, 20.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.9ms
Speed: 1.4ms preprocess, 20.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.0ms
Speed: 1.3ms preprocess, 21.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.0ms
Speed: 1.6ms preprocess, 22.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.2ms
Speed: 1.6ms preprocess, 21.2ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.4ms
Speed: 1.6ms preprocess, 21.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.8ms
Speed: 1.3ms preprocess, 20.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.9ms
Speed: 1.9ms preprocess, 20.9ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.0ms
Speed: 1.2ms preprocess, 21.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 1.2ms preprocess, 22.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.3ms
Speed: 1.3ms preprocess, 21.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.8ms
Speed: 1.3ms preprocess, 20.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.1ms
Speed: 1.4ms preprocess, 21.1ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.3ms
Speed: 1.4ms preprocess, 21.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.3ms
Speed: 1.4ms preprocess, 20.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.7ms
Speed: 1.3ms preprocess, 21.7ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.6ms
Speed: 1.5ms preprocess, 21.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.0ms
Speed: 1.4ms preprocess, 21.0ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.9ms
Speed: 1.5ms preprocess, 20.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.2ms
Speed: 1.6ms preprocess, 21.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.0ms
Speed: 1.7ms preprocess, 23.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 15
view_order: [16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 21.6ms
Speed: 1.3ms preprocess, 21.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 1
Instance 0: Confidence=0.9438
Selected instance: 0 (Confidence: 0.9438)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

400 40 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 15 prompts
current IoU is: 0.19162771105766296
Seok, iteration idx= 1 IoU = tensor(0.1916)
SKIP, unacceptable sam prediction, IoU is tensor(0.1916)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 1
Instance 0: Confidence=0.9419
Selected instance: 0 (Confidence: 0.9419)
tmp min: tensor(0.) tmp max: tensor(1.)
375 52 540 960
There are 16 prompts
current IoU is: 0.19287234544754028
Seok, iteration idx= 2 IoU = tensor(0.1929)
SKIP, unacceptable sam prediction, IoU is tensor(0.1929)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 2
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.7583
Selected instance: 1 (Confidence: 0.7583)
tmp min: tensor(0.) tmp max: tensor(1.)
431 116 540 960
current IoU is: 0.2643103301525116
Seok, iteration idx= 3 IoU = tensor(0.2643)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.3ms
Speed: 2.1ms preprocess, 24.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 2
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9110
Selected instance: 1 (Confidence: 0.9110)
tmp min: tensor(0.) tmp max: tensor(1.)
465 72 540 960
There are 15 prompts
current IoU is: 0.41477295756340027
Seok, iteration idx= 4 IoU = tensor(0.4148)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 25.4ms
Speed: 1.4ms preprocess, 25.4ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9398
Selected instance: 1 (Confidence: 0.9398)
tmp min: tensor(0.) tmp max: tensor(1.)
518 80 540 960
There are 15 prompts
current IoU is: 0.7882564663887024
Seok, iteration idx= 5 IoU = tensor(0.7883)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9348
Selected instance: 1 (Confidence: 0.9348)
tmp min: tensor(0.) tmp max: tensor(1.)
543 60 540 960
There are 16 prompts
current IoU is: 0.8662713170051575
Seok, iteration idx= 6 IoU = tensor(0.8663)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 2.9ms preprocess, 22.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9411
Selected instance: 1 (Confidence: 0.9411)
tmp min: tensor(0.) tmp max: tensor(1.)
567 72 540 960
There are 14 prompts
current IoU is: 0.8437914848327637
Seok, iteration idx= 7 IoU = tensor(0.8438)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 3.4ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9531
Instance 1: Confidence=0.9502
Selected instance: 1 (Confidence: 0.9502)
tmp min: tensor(0.) tmp max: tensor(1.)
639 60 540 960
There are 14 prompts
current IoU is: 0.8574811816215515
Seok, iteration idx= 8 IoU = tensor(0.8575)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.5ms
Speed: 3.2ms preprocess, 24.5ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9479
Selected instance: 0 (Confidence: 0.9518)
tmp min: tensor(0.) tmp max: tensor(1.)
695 36 540 960
There are 14 prompts
current IoU is: 0.8588083386421204
Seok, iteration idx= 9 IoU = tensor(0.8588)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.6ms
Speed: 1.6ms preprocess, 24.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9527
Instance 1: Confidence=0.9453
Selected instance: 0 (Confidence: 0.9527)
tmp min: tensor(0.) tmp max: tensor(1.)
683 72 540 960
There are 15 prompts
current IoU is: 0.8756764531135559
Seok, iteration idx= 10 IoU = tensor(0.8757)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9330
Selected instance: 0 (Confidence: 0.9554)
tmp min: tensor(0.) tmp max: tensor(1.)
721 40 540 960
There are 14 prompts
current IoU is: 0.907753050327301
Seok, iteration idx= 11 IoU = tensor(0.9078)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.8ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9514
Instance 1: Confidence=0.9420
Selected instance: 0 (Confidence: 0.9514)
tmp min: tensor(0.) tmp max: tensor(1.)
725 56 540 960
There are 13 prompts
current IoU is: 0.888425350189209
Seok, iteration idx= 12 IoU = tensor(0.8884)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.9ms
Speed: 1.4ms preprocess, 21.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9259
Selected instance: 0 (Confidence: 0.9526)
tmp min: tensor(0.) tmp max: tensor(1.)
704 124 540 960
There are 13 prompts
current IoU is: 0.8544201850891113
Seok, iteration idx= 13 IoU = tensor(0.8544)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.6ms
Speed: 1.8ms preprocess, 24.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 3
Instance 0: Confidence=0.9418
Instance 1: Confidence=0.9212
Instance 2: Confidence=0.5274
Selected instance: 0 (Confidence: 0.9418)
tmp min: tensor(0.) tmp max: tensor(1.)
758 92 540 960
There are 14 prompts
current IoU is: 0.8699175715446472
Seok, iteration idx= 14 IoU = tensor(0.8699)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 3
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.2551
Selected instance: 0 (Confidence: 0.9457)
tmp min: tensor(0.) tmp max: tensor(1.)
760 84 540 960
There are 14 prompts
current IoU is: 0.915635883808136
Seok, iteration idx= 15 IoU = tensor(0.9156)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9257
Selected instance: 0 (Confidence: 0.9385)
tmp min: tensor(0.) tmp max: tensor(1.)
806 68 540 960
There are 14 prompts
current IoU is: 0.7953546643257141
Seok, iteration idx= 16 IoU = tensor(0.7954)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.9ms
Speed: 1.7ms preprocess, 24.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9398
Instance 1: Confidence=0.8970
Selected instance: 1 (Confidence: 0.8970)
tmp min: tensor(0.) tmp max: tensor(1.)
239 92 540 960
There are 17 prompts
current IoU is: 0.740491509437561
Seok, iteration idx= 17 IoU = tensor(0.7405)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.4ms
Speed: 1.4ms preprocess, 24.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9516
Instance 1: Confidence=0.8899
Selected instance: 1 (Confidence: 0.8899)
tmp min: tensor(0.) tmp max: tensor(1.)
237 80 540 960
There are 16 prompts
current IoU is: 0.7991765141487122
Seok, iteration idx= 18 IoU = tensor(0.7992)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.8ms
Speed: 2.2ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 3
Instance 0: Confidence=0.9405
Instance 1: Confidence=0.9138
Instance 2: Confidence=0.4672
Selected instance: 1 (Confidence: 0.9138)
tmp min: tensor(0.) tmp max: tensor(1.)
249 72 540 960
There are 18 prompts
current IoU is: 0.8809628486633301
Seok, iteration idx= 19 IoU = tensor(0.8810)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.5ms
Speed: 2.3ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 3
Instance 0: Confidence=0.9450
Instance 1: Confidence=0.8929
Instance 2: Confidence=0.7195
Selected instance: 1 (Confidence: 0.8929)
tmp min: tensor(0.) tmp max: tensor(1.)
232 76 540 960
There are 18 prompts
current IoU is: 0.8504530191421509
Seok, iteration idx= 20 IoU = tensor(0.8505)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.3ms
Speed: 2.2ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 3
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9083
Instance 2: Confidence=0.7298
Selected instance: 1 (Confidence: 0.9083)
tmp min: tensor(0.) tmp max: tensor(1.)
254 52 540 960
There are 17 prompts
current IoU is: 0.8813695907592773
Seok, iteration idx= 21 IoU = tensor(0.8814)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 3
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.8985
Instance 2: Confidence=0.8365
Selected instance: 1 (Confidence: 0.8985)
tmp min: tensor(0.) tmp max: tensor(1.)
302 64 540 960
There are 17 prompts
current IoU is: 0.8290465474128723
Seok, iteration idx= 22 IoU = tensor(0.8290)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 2.6ms preprocess, 23.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.8323
Selected instance: 1 (Confidence: 0.8323)
tmp min: tensor(0.) tmp max: tensor(1.)
311 56 540 960
There are 17 prompts
current IoU is: 0.8644787073135376
Seok, iteration idx= 23 IoU = tensor(0.8645)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.7016
Selected instance: 1 (Confidence: 0.7016)
tmp min: tensor(0.) tmp max: tensor(1.)
317 64 540 960
There are 19 prompts
current IoU is: 0.5784350633621216
Seok, iteration idx= 24 IoU = tensor(0.5784)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9293
Instance 1: Confidence=0.9154
Selected instance: 1 (Confidence: 0.9154)
tmp min: tensor(0.) tmp max: tensor(1.)
803 40 540 960
There are 14 prompts
current IoU is: 0.8926595449447632
Seok, iteration idx= 25 IoU = tensor(0.8927)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.2ms
Speed: 1.3ms preprocess, 24.2ms inference, 3.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 2
Instance 0: Confidence=0.9417
Instance 1: Confidence=0.9213
Selected instance: 1 (Confidence: 0.9213)
tmp min: tensor(0.) tmp max: tensor(1.)
780 36 540 960
There are 14 prompts
current IoU is: 0.8935515880584717
Seok, iteration idx= 26 IoU = tensor(0.8936)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 4.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 3
Instance 0: Confidence=0.9340
Instance 1: Confidence=0.9279
Instance 2: Confidence=0.8775
Selected instance: 1 (Confidence: 0.9279)
tmp min: tensor(0.) tmp max: tensor(1.)
783 20 540 960
There are 15 prompts
current IoU is: 0.8671213388442993
Seok, iteration idx= 27 IoU = tensor(0.8671)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.7ms
Speed: 3.7ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 3
Instance 0: Confidence=0.9416
Instance 1: Confidence=0.9159
Instance 2: Confidence=0.5724
Selected instance: 1 (Confidence: 0.9159)
tmp min: tensor(0.) tmp max: tensor(1.)
756 16 540 960
There are 14 prompts
current IoU is: 0.9378070831298828
Seok, iteration idx= 28 IoU = tensor(0.9378)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.0ms
Speed: 2.5ms preprocess, 23.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 3
Instance 0: Confidence=0.9417
Instance 1: Confidence=0.9193
Instance 2: Confidence=0.8251
Selected instance: 1 (Confidence: 0.9193)
tmp min: tensor(0.) tmp max: tensor(1.)
697 24 540 960
There are 14 prompts
current IoU is: 0.9438294172286987
Seok, iteration idx= 29 IoU = tensor(0.9438)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.2ms
Speed: 2.8ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 3
Instance 0: Confidence=0.9349
Instance 1: Confidence=0.9199
Instance 2: Confidence=0.8269
Selected instance: 1 (Confidence: 0.9199)
tmp min: tensor(0.) tmp max: tensor(1.)
665 28 540 960
There are 17 prompts
current IoU is: 0.9274964332580566
Seok, iteration idx= 30 IoU = tensor(0.9275)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.3ms
Speed: 2.5ms preprocess, 24.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 3
Instance 0: Confidence=0.8907
Instance 1: Confidence=0.8869
Instance 2: Confidence=0.8282
Selected instance: 1 (Confidence: 0.8869)
tmp min: tensor(0.) tmp max: tensor(1.)
602 52 540 960
There are 15 prompts
current IoU is: 0.8797463178634644
Seok, iteration idx= 31 IoU = tensor(0.8797)
Selected Instance Confidence List: [tensor(0.8856), tensor(0.4925, device='cpu'), tensor(0.4925, device='cpu'), tensor(0.4756, device='cpu'), tensor(0.6132, device='cpu'), tensor(0.8489, device='cpu'), tensor(0.8937, device='cpu'), tensor(0.8827, device='cpu'), tensor(0.8946, device='cpu'), tensor(0.8960, device='cpu'), tensor(0.9065, device='cpu'), tensor(0.9268, device='cpu'), tensor(0.9136, device='cpu'), tensor(0.8937, device='cpu'), tensor(0.8987, device='cpu'), tensor(0.9277, device='cpu'), tensor(0.8526, device='cpu'), tensor(0.8031, device='cpu'), tensor(0.8355, device='cpu'), tensor(0.8941, device='cpu'), tensor(0.8674, device='cpu'), tensor(0.8922, device='cpu'), tensor(0.8568, device='cpu'), tensor(0.8516, device='cpu'), tensor(0.6277, device='cpu'), tensor(0.9018, device='cpu'), tensor(0.9046, device='cpu'), tensor(0.8914, device='cpu'), tensor(0.9291, device='cpu'), tensor(0.9340, device='cpu'), tensor(0.9244, device='cpu'), tensor(0.8826, device='cpu')]
Sorted Confidence Order: [tensor(0.9340, device='cpu'), tensor(0.9244, device='cpu'), tensor(0.8826, device='cpu'), tensor(0.8856), tensor(0.9291, device='cpu'), tensor(0.8914, device='cpu'), tensor(0.9046, device='cpu'), tensor(0.9018, device='cpu'), tensor(0.8526, device='cpu'), tensor(0.9277, device='cpu'), tensor(0.8987, device='cpu'), tensor(0.8937, device='cpu'), tensor(0.9136, device='cpu'), tensor(0.9268, device='cpu'), tensor(0.9065, device='cpu'), tensor(0.8960, device='cpu'), tensor(0.8946, device='cpu'), tensor(0.8827, device='cpu'), tensor(0.8937, device='cpu'), tensor(0.8489, device='cpu'), tensor(0.6132, device='cpu'), tensor(0.4756, device='cpu'), tensor(0.4925, device='cpu'), tensor(0.4925, device='cpu'), tensor(0.6277, device='cpu'), tensor(0.8516, device='cpu'), tensor(0.8568, device='cpu'), tensor(0.8922, device='cpu'), tensor(0.8674, device='cpu'), tensor(0.8941, device='cpu'), tensor(0.8355, device='cpu'), tensor(0.8031, device='cpu')]
sorted_indices: [29, 30, 31, 0, 28, 27, 26, 25, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 24, 23, 22, 21, 20, 19, 18, 17]
Initial view (highest confidence): 34
New training order: [13, 14, 15, 16, 12, 11, 10, 9, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.6ms
Speed: 1.3ms preprocess, 20.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.3ms
Speed: 3.1ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 3
Instance 0: Confidence=0.9349
Instance 1: Confidence=0.9199
Instance 2: Confidence=0.8269
tmp min: tensor(0.) tmp max: tensor(1.)
665 28 540 960
There are 17 prompts
current IoU is: 0.9265488386154175
Seok, iteration idx= 1 IoU = tensor(0.9265)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 3
Instance 0: Confidence=0.8907
Instance 1: Confidence=0.8869
Instance 2: Confidence=0.8282
tmp min: tensor(0.) tmp max: tensor(1.)
602 52 540 960
There are 15 prompts
current IoU is: 0.8858959078788757
Seok, iteration idx= 2 IoU = tensor(0.8859)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.5ms
Speed: 1.4ms preprocess, 24.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 4
Instance 0: Confidence=0.8856
Instance 1: Confidence=0.8280
Instance 2: Confidence=0.5240
Instance 3: Confidence=0.3985
tmp min: tensor(0.) tmp max: tensor(1.)
546 92 540 960
There are 14 prompts
current IoU is: 0.8916089534759521
Seok, iteration idx= 3 IoU = tensor(0.8916)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 3
Instance 0: Confidence=0.9416
Instance 1: Confidence=0.9159
Instance 2: Confidence=0.5724
tmp min: tensor(0.) tmp max: tensor(1.)
756 16 540 960
There are 14 prompts
current IoU is: 0.9415687322616577
Seok, iteration idx= 4 IoU = tensor(0.9416)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.0ms
Speed: 1.7ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 3
Instance 0: Confidence=0.9340
Instance 1: Confidence=0.9279
Instance 2: Confidence=0.8775
tmp min: tensor(0.) tmp max: tensor(1.)
783 20 540 960
There are 15 prompts
current IoU is: 0.9147780537605286
Seok, iteration idx= 5 IoU = tensor(0.9148)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 2.6ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9417
Instance 1: Confidence=0.9213
tmp min: tensor(0.) tmp max: tensor(1.)
780 36 540 960
There are 14 prompts
current IoU is: 0.908513605594635
Seok, iteration idx= 6 IoU = tensor(0.9085)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9293
Instance 1: Confidence=0.9154
tmp min: tensor(0.) tmp max: tensor(1.)
803 40 540 960
There are 14 prompts
current IoU is: 0.9493556618690491
Seok, iteration idx= 7 IoU = tensor(0.9494)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9257
tmp min: tensor(0.) tmp max: tensor(1.)
806 68 540 960
There are 14 prompts
current IoU is: 0.8569543361663818
Seok, iteration idx= 8 IoU = tensor(0.8570)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.5ms
Speed: 1.9ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 3
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.2551
tmp min: tensor(0.) tmp max: tensor(1.)
760 84 540 960
There are 14 prompts
current IoU is: 0.9490441083908081
Seok, iteration idx= 9 IoU = tensor(0.9490)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 3
Instance 0: Confidence=0.9418
Instance 1: Confidence=0.9212
Instance 2: Confidence=0.5274
tmp min: tensor(0.) tmp max: tensor(1.)
758 92 540 960
There are 14 prompts
current IoU is: 0.9377475380897522
Seok, iteration idx= 10 IoU = tensor(0.9377)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9259
tmp min: tensor(0.) tmp max: tensor(1.)
704 124 540 960
There are 13 prompts
current IoU is: 0.9242786765098572
Seok, iteration idx= 11 IoU = tensor(0.9243)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9514
Instance 1: Confidence=0.9420
tmp min: tensor(0.) tmp max: tensor(1.)
725 56 540 960
There are 13 prompts
current IoU is: 0.9197949171066284
Seok, iteration idx= 12 IoU = tensor(0.9198)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9330
tmp min: tensor(0.) tmp max: tensor(1.)
721 40 540 960
There are 14 prompts
current IoU is: 0.9245377779006958
Seok, iteration idx= 13 IoU = tensor(0.9245)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9527
Instance 1: Confidence=0.9453
tmp min: tensor(0.) tmp max: tensor(1.)
683 72 540 960
There are 15 prompts
current IoU is: 0.9182330965995789
Seok, iteration idx= 14 IoU = tensor(0.9182)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.5ms
Speed: 1.3ms preprocess, 24.5ms inference, 3.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 2
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9479
tmp min: tensor(0.) tmp max: tensor(1.)
695 36 540 960
There are 14 prompts
current IoU is: 0.9240873456001282
Seok, iteration idx= 15 IoU = tensor(0.9241)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.3ms
Speed: 3.2ms preprocess, 24.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9531
Instance 1: Confidence=0.9502
tmp min: tensor(0.) tmp max: tensor(1.)
639 60 540 960
There are 14 prompts
current IoU is: 0.9278407692909241
Seok, iteration idx= 16 IoU = tensor(0.9278)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 2.7ms preprocess, 23.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9411
tmp min: tensor(0.) tmp max: tensor(1.)
567 72 540 960
There are 14 prompts
current IoU is: 0.9160826206207275
Seok, iteration idx= 17 IoU = tensor(0.9161)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 3.0ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9348
tmp min: tensor(0.) tmp max: tensor(1.)
543 60 540 960
There are 16 prompts
current IoU is: 0.9381426572799683
Seok, iteration idx= 18 IoU = tensor(0.9381)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.1ms
Speed: 3.1ms preprocess, 24.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9398
tmp min: tensor(0.) tmp max: tensor(1.)
518 80 540 960
There are 15 prompts
current IoU is: 0.9190740585327148
Seok, iteration idx= 19 IoU = tensor(0.9191)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 25.7ms
Speed: 1.4ms preprocess, 25.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9110
tmp min: tensor(0.) tmp max: tensor(1.)
465 72 540 960
There are 15 prompts
current IoU is: 0.8913754820823669
Seok, iteration idx= 20 IoU = tensor(0.8914)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 2.5ms preprocess, 22.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.7583
tmp min: tensor(0.) tmp max: tensor(1.)
431 116 540 960
current IoU is: 0.7848489284515381
Seok, iteration idx= 21 IoU = tensor(0.7848)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 24.4ms
Speed: 1.4ms preprocess, 24.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 1
Instance 0: Confidence=0.9419
tmp min: tensor(0.) tmp max: tensor(1.)
375 52 540 960
There are 16 prompts
current IoU is: 0.03882584720849991
Seok, iteration idx= 22 IoU = tensor(0.0388)
SKIP, unacceptable sam prediction, IoU is tensor(0.0388)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.5ms
Speed: 1.8ms preprocess, 23.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 1
Instance 0: Confidence=0.9438
tmp min: tensor(0.) tmp max: tensor(1.)
400 40 540 960
There are 15 prompts
current IoU is: 0.0439419224858284
Seok, iteration idx= 23 IoU = tensor(0.0439)
SKIP, unacceptable sam prediction, IoU is tensor(0.0439)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.3ms
Speed: 3.2ms preprocess, 24.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.7016
tmp min: tensor(0.) tmp max: tensor(1.)
317 64 540 960
There are 19 prompts
current IoU is: 0.5747427344322205
Seok, iteration idx= 24 IoU = tensor(0.5747)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.9ms
Speed: 1.4ms preprocess, 24.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.8323
tmp min: tensor(0.) tmp max: tensor(1.)
311 56 540 960
There are 17 prompts
current IoU is: 0.8699833750724792
Seok, iteration idx= 25 IoU = tensor(0.8700)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 3
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.8985
Instance 2: Confidence=0.8365
tmp min: tensor(0.) tmp max: tensor(1.)
302 64 540 960
There are 17 prompts
current IoU is: 0.8726730942726135
Seok, iteration idx= 26 IoU = tensor(0.8727)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 3
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9083
Instance 2: Confidence=0.7298
tmp min: tensor(0.) tmp max: tensor(1.)
254 52 540 960
There are 17 prompts
current IoU is: 0.8968554735183716
Seok, iteration idx= 27 IoU = tensor(0.8969)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 3
Instance 0: Confidence=0.9450
Instance 1: Confidence=0.8929
Instance 2: Confidence=0.7195
tmp min: tensor(0.) tmp max: tensor(1.)
232 76 540 960
There are 18 prompts
current IoU is: 0.8744239211082458
Seok, iteration idx= 28 IoU = tensor(0.8744)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.4ms
Speed: 1.3ms preprocess, 24.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 3
Instance 0: Confidence=0.9405
Instance 1: Confidence=0.9138
Instance 2: Confidence=0.4672
tmp min: tensor(0.) tmp max: tensor(1.)
249 72 540 960
There are 18 prompts
current IoU is: 0.9140329957008362
Seok, iteration idx= 29 IoU = tensor(0.9140)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 2
Instance 0: Confidence=0.9516
Instance 1: Confidence=0.8899
tmp min: tensor(0.) tmp max: tensor(1.)
237 80 540 960
There are 16 prompts
current IoU is: 0.9140971302986145
Seok, iteration idx= 30 IoU = tensor(0.9141)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 25.8ms
Speed: 1.4ms preprocess, 25.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 2
Instance 0: Confidence=0.9398
Instance 1: Confidence=0.8970
tmp min: tensor(0.) tmp max: tensor(1.)
239 92 540 960
There are 17 prompts
current IoU is: 0.853181779384613
Seok, iteration idx= 31 IoU = tensor(0.8532)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set8_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set8_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:41<00:00,  1.31s/it]
Testing psnr 28.60439032316208 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set8_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:29<00:00,  1.09it/s]
Testing psnr 3.85938229970634 (avg)
train: coarse segmentation in 00:04:01
train: finish (eps time 00:04:02 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set8_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set9/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 44.96it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set9 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set9
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set9_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.2ms
Speed: 2.7ms preprocess, 21.2ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.7ms
Speed: 1.2ms preprocess, 21.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.9ms
Speed: 1.3ms preprocess, 21.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.7ms
Speed: 1.3ms preprocess, 21.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.1ms
Speed: 1.3ms preprocess, 22.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 2.1ms preprocess, 22.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 1.6ms preprocess, 22.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.8ms
Speed: 1.4ms preprocess, 21.8ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 1.3ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.3ms preprocess, 22.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.8ms
Speed: 1.2ms preprocess, 21.8ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.0ms
Speed: 1.4ms preprocess, 22.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.3ms
Speed: 1.4ms preprocess, 21.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.2ms
Speed: 1.3ms preprocess, 21.2ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.7ms
Speed: 1.2ms preprocess, 21.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.5ms
Speed: 1.9ms preprocess, 21.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.2ms
Speed: 1.2ms preprocess, 21.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.6ms
Speed: 1.3ms preprocess, 21.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.3ms
Speed: 1.3ms preprocess, 22.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.7ms
Speed: 1.2ms preprocess, 21.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.3ms
Speed: 1.5ms preprocess, 21.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.1ms
Speed: 1.3ms preprocess, 21.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.6ms
Speed: 1.2ms preprocess, 21.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.1ms
Speed: 1.3ms preprocess, 22.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.5ms
Speed: 1.2ms preprocess, 21.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.5ms
Speed: 1.3ms preprocess, 21.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.8ms
Speed: 1.3ms preprocess, 21.8ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.1ms
Speed: 1.3ms preprocess, 22.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.2ms preprocess, 22.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.9ms
Speed: 1.2ms preprocess, 21.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.6ms
Speed: 1.5ms preprocess, 21.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.8ms
Speed: 3.8ms preprocess, 22.8ms inference, 3.0ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.4ms
Speed: 1.1ms preprocess, 21.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9530
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.8797
Instance 4: Confidence=0.8281
Instance 5: Confidence=0.7251
Selected instance: 1 (Confidence: 0.9530)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

407 36 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 15 prompts
current IoU is: 0.8287090063095093
Seok, iteration idx= 1 IoU = tensor(0.8287)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 25.0ms
Speed: 1.5ms preprocess, 25.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 4
Instance 0: Confidence=0.9523
Instance 1: Confidence=0.9468
Instance 2: Confidence=0.9161
Instance 3: Confidence=0.8821
Selected instance: 0 (Confidence: 0.9523)
tmp min: tensor(0.) tmp max: tensor(1.)
382 60 540 960
There are 15 prompts
current IoU is: 0.7910518050193787
Seok, iteration idx= 2 IoU = tensor(0.7911)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 2.6ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9327
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9102
Instance 3: Confidence=0.8415
Instance 4: Confidence=0.7714
Selected instance: 0 (Confidence: 0.9327)
tmp min: tensor(0.) tmp max: tensor(1.)
369 100 540 960
There are 15 prompts
current IoU is: 0.834214985370636
Seok, iteration idx= 3 IoU = tensor(0.8342)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 2.6ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9506
Instance 2: Confidence=0.8723
Instance 3: Confidence=0.8416
Instance 4: Confidence=0.8138
Instance 5: Confidence=0.3145
Selected instance: 4 (Confidence: 0.8138)
tmp min: tensor(0.) tmp max: tensor(1.)
533 64 540 960
There are 14 prompts
current IoU is: 0.4242759346961975
Seok, iteration idx= 4 IoU = tensor(0.4243)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 3.5ms preprocess, 24.0ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 6
Instance 0: Confidence=0.9543
Instance 1: Confidence=0.9481
Instance 2: Confidence=0.8723
Instance 3: Confidence=0.8448
Instance 4: Confidence=0.8141
Instance 5: Confidence=0.7543
Selected instance: 5 (Confidence: 0.7543)
tmp min: tensor(0.) tmp max: tensor(1.)
517 68 540 960
There are 16 prompts
current IoU is: 0.7531989216804504
Seok, iteration idx= 5 IoU = tensor(0.7532)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.1ms
Speed: 4.9ms preprocess, 23.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 8
Instance 0: Confidence=0.9574
Instance 1: Confidence=0.9518
Instance 2: Confidence=0.8906
Instance 3: Confidence=0.8743
Instance 4: Confidence=0.6790
Instance 5: Confidence=0.4519
Instance 6: Confidence=0.3982
Instance 7: Confidence=0.2843
Selected instance: 4 (Confidence: 0.6790)
tmp min: tensor(0.) tmp max: tensor(1.)
534 104 540 960
There are 19 prompts
current IoU is: 0.7603892683982849
Seok, iteration idx= 6 IoU = tensor(0.7604)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9355
Instance 2: Confidence=0.9115
Instance 3: Confidence=0.8830
Instance 4: Confidence=0.7381
Instance 5: Confidence=0.7063
Selected instance: 4 (Confidence: 0.7381)
tmp min: tensor(0.) tmp max: tensor(1.)
610 92 540 960
There are 14 prompts
current IoU is: 0.4739779829978943
Seok, iteration idx= 7 IoU = tensor(0.4740)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9499
Instance 1: Confidence=0.9225
Instance 2: Confidence=0.9120
Instance 3: Confidence=0.9019
Instance 4: Confidence=0.8923
Selected instance: 3 (Confidence: 0.9019)
tmp min: tensor(0.) tmp max: tensor(1.)
602 64 540 960
There are 15 prompts
current IoU is: 0.7182921171188354
Seok, iteration idx= 8 IoU = tensor(0.7183)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 1.3ms preprocess, 24.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9663
Instance 1: Confidence=0.9506
Instance 2: Confidence=0.9380
Instance 3: Confidence=0.8953
Instance 4: Confidence=0.8884
Instance 5: Confidence=0.6212
Selected instance: 3 (Confidence: 0.8953)
tmp min: tensor(0.) tmp max: tensor(1.)
623 36 540 960
There are 17 prompts
current IoU is: 0.7883063554763794
Seok, iteration idx= 9 IoU = tensor(0.7883)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9406
Instance 2: Confidence=0.8957
Instance 3: Confidence=0.8788
Instance 4: Confidence=0.6792
Instance 5: Confidence=0.2540
Selected instance: 4 (Confidence: 0.6792)
tmp min: tensor(0.) tmp max: tensor(1.)
621 52 540 960
There are 17 prompts
current IoU is: 0.6031174063682556
Seok, iteration idx= 10 IoU = tensor(0.6031)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9677
Instance 1: Confidence=0.9541
Instance 2: Confidence=0.9076
Instance 3: Confidence=0.8270
Instance 4: Confidence=0.6917
Selected instance: 0 (Confidence: 0.9677)
tmp min: tensor(0.) tmp max: tensor(1.)
490 0 540 960
There are 14 prompts
current IoU is: 9.886209591059014e-05
Seok, iteration idx= 11 IoU = tensor(9.8862e-05)
SKIP, unacceptable sam prediction, IoU is tensor(9.8862e-05)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9664
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.8923
Instance 3: Confidence=0.6204
Instance 4: Confidence=0.4815
Instance 5: Confidence=0.4394
Selected instance: 3 (Confidence: 0.6204)
tmp min: tensor(0.) tmp max: tensor(1.)
719 8 540 960
There are 15 prompts
current IoU is: 0.5873118042945862
Seok, iteration idx= 12 IoU = tensor(0.5873)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.2ms
Speed: 1.5ms preprocess, 25.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9655
Instance 1: Confidence=0.9527
Instance 2: Confidence=0.9136
Instance 3: Confidence=0.8798
Instance 4: Confidence=0.8149
Instance 5: Confidence=0.6837
Selected instance: 2 (Confidence: 0.9136)
tmp min: tensor(0.) tmp max: tensor(1.)
678 48 540 960
There are 16 prompts
current IoU is: 0.8823233842849731
Seok, iteration idx= 13 IoU = tensor(0.8823)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9565
Instance 1: Confidence=0.9201
Instance 2: Confidence=0.9047
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.8364
Instance 5: Confidence=0.4276
Instance 6: Confidence=0.3358
Selected instance: 1 (Confidence: 0.9201)
tmp min: tensor(0.) tmp max: tensor(1.)
685 16 540 960
There are 15 prompts
current IoU is: 0.8953315615653992
Seok, iteration idx= 14 IoU = tensor(0.8953)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.9ms
Speed: 1.4ms preprocess, 24.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9601
Instance 1: Confidence=0.9222
Instance 2: Confidence=0.9087
Instance 3: Confidence=0.8744
Instance 4: Confidence=0.7555
Selected instance: 1 (Confidence: 0.9222)
tmp min: tensor(0.) tmp max: tensor(1.)
666 32 540 960
There are 16 prompts
current IoU is: 0.918807864189148
Seok, iteration idx= 15 IoU = tensor(0.9188)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 7
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9223
Instance 2: Confidence=0.9203
Instance 3: Confidence=0.8729
Instance 4: Confidence=0.7752
Instance 5: Confidence=0.6791
Instance 6: Confidence=0.3599
Selected instance: 2 (Confidence: 0.9203)
tmp min: tensor(0.) tmp max: tensor(1.)
615 104 540 960
There are 15 prompts
current IoU is: 0.9086776971817017
Seok, iteration idx= 16 IoU = tensor(0.9087)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.4ms
Speed: 3.1ms preprocess, 25.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9394
Instance 1: Confidence=0.9324
Instance 2: Confidence=0.9258
Instance 3: Confidence=0.9160
Instance 4: Confidence=0.9043
Selected instance: 1 (Confidence: 0.9324)
tmp min: tensor(0.) tmp max: tensor(1.)
609 72 540 960
There are 16 prompts
current IoU is: 0.9095960855484009
Seok, iteration idx= 17 IoU = tensor(0.9096)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.5ms
Speed: 3.7ms preprocess, 24.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 7
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9479
Instance 2: Confidence=0.9307
Instance 3: Confidence=0.9156
Instance 4: Confidence=0.8290
Instance 5: Confidence=0.7404
Instance 6: Confidence=0.3328
Selected instance: 1 (Confidence: 0.9479)
tmp min: tensor(0.) tmp max: tensor(1.)
589 68 540 960
There are 15 prompts
current IoU is: 0.950076699256897
Seok, iteration idx= 18 IoU = tensor(0.9501)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.2ms
Speed: 3.0ms preprocess, 23.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9400
Instance 2: Confidence=0.9397
Instance 3: Confidence=0.8820
Instance 4: Confidence=0.8574
Instance 5: Confidence=0.5968
Instance 6: Confidence=0.3960
Selected instance: 0 (Confidence: 0.9616)
tmp min: tensor(0.) tmp max: tensor(1.)
458 40 540 960
There are 15 prompts
current IoU is: 0.9590116143226624
Seok, iteration idx= 19 IoU = tensor(0.9590)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 25.6ms
Speed: 1.5ms preprocess, 25.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 7
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9180
Instance 3: Confidence=0.8806
Instance 4: Confidence=0.7796
Instance 5: Confidence=0.4945
Instance 6: Confidence=0.4307
Selected instance: 5 (Confidence: 0.4945)
tmp min: tensor(0.) tmp max: tensor(1.)
397 92 540 960
There are 16 prompts
current IoU is: 0.6021021008491516
Seok, iteration idx= 20 IoU = tensor(0.6021)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.7ms
Speed: 2.6ms preprocess, 24.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9511
Instance 2: Confidence=0.9189
Instance 3: Confidence=0.8933
Instance 4: Confidence=0.8605
Instance 5: Confidence=0.8161
Selected instance: 4 (Confidence: 0.8605)
tmp min: tensor(0.) tmp max: tensor(1.)
401 76 540 960
There are 15 prompts
current IoU is: 0.8672625422477722
Seok, iteration idx= 21 IoU = tensor(0.8673)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9659
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.9025
Instance 4: Confidence=0.8976
Instance 5: Confidence=0.8199
Selected instance: 3 (Confidence: 0.9025)
tmp min: tensor(0.) tmp max: tensor(1.)
419 68 540 960
There are 16 prompts
current IoU is: 0.8527340292930603
Seok, iteration idx= 22 IoU = tensor(0.8527)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.8ms
Speed: 1.4ms preprocess, 24.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 7
Instance 0: Confidence=0.9650
Instance 1: Confidence=0.9498
Instance 2: Confidence=0.9253
Instance 3: Confidence=0.8752
Instance 4: Confidence=0.6702
Instance 5: Confidence=0.4329
Instance 6: Confidence=0.3059
Selected instance: 3 (Confidence: 0.8752)
tmp min: tensor(0.) tmp max: tensor(1.)
410 68 540 960
There are 17 prompts
current IoU is: 0.8564584255218506
Seok, iteration idx= 23 IoU = tensor(0.8565)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 8
Instance 0: Confidence=0.9547
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9168
Instance 3: Confidence=0.9027
Instance 4: Confidence=0.7627
Instance 5: Confidence=0.3927
Instance 6: Confidence=0.3073
Instance 7: Confidence=0.2968
Selected instance: 4 (Confidence: 0.7627)
tmp min: tensor(0.) tmp max: tensor(1.)
441 48 540 960
There are 17 prompts
current IoU is: 0.7546077370643616
Seok, iteration idx= 24 IoU = tensor(0.7546)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.7ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9214
Instance 2: Confidence=0.9091
Instance 3: Confidence=0.8954
Instance 4: Confidence=0.8457
Instance 5: Confidence=0.6131
Selected instance: 5 (Confidence: 0.6131)
tmp min: tensor(0.) tmp max: tensor(1.)
466 60 540 960
There are 15 prompts
current IoU is: 0.453644722700119
Seok, iteration idx= 25 IoU = tensor(0.4536)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.5ms
Speed: 1.5ms preprocess, 25.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9614
Instance 1: Confidence=0.9360
Instance 2: Confidence=0.9196
Instance 3: Confidence=0.8601
Instance 4: Confidence=0.8506
Instance 5: Confidence=0.4255
Selected instance: 5 (Confidence: 0.4255)
tmp min: tensor(0.) tmp max: tensor(1.)
518 108 540 960
There are 14 prompts
current IoU is: 0.4278704524040222
Seok, iteration idx= 26 IoU = tensor(0.4279)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 1.8ms preprocess, 23.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 7
Instance 0: Confidence=0.9614
Instance 1: Confidence=0.9443
Instance 2: Confidence=0.9363
Instance 3: Confidence=0.7233
Instance 4: Confidence=0.5203
Instance 5: Confidence=0.3875
Instance 6: Confidence=0.3196
Selected instance: 4 (Confidence: 0.5203)
tmp min: tensor(0.) tmp max: tensor(1.)
448 44 540 960
current IoU is: 0.6030431389808655
Seok, iteration idx= 27 IoU = tensor(0.6030)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.4ms
Speed: 1.4ms preprocess, 25.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9562
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.9215
Instance 3: Confidence=0.8554
Instance 4: Confidence=0.7123
Selected instance: 1 (Confidence: 0.9509)
tmp min: tensor(0.) tmp max: tensor(1.)
574 20 540 960
There are 17 prompts
current IoU is: 0.9188401699066162
Seok, iteration idx= 28 IoU = tensor(0.9188)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.0ms
Speed: 1.7ms preprocess, 25.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9559
Instance 1: Confidence=0.9326
Instance 2: Confidence=0.9255
Instance 3: Confidence=0.8958
Instance 4: Confidence=0.8174
Instance 5: Confidence=0.2734
Selected instance: 0 (Confidence: 0.9559)
tmp min: tensor(0.) tmp max: tensor(1.)
531 16 540 960
There are 16 prompts
current IoU is: 0.9378583431243896
Seok, iteration idx= 29 IoU = tensor(0.9379)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9356
Instance 2: Confidence=0.9105
Instance 3: Confidence=0.8693
Instance 4: Confidence=0.7860
Instance 5: Confidence=0.4345
Instance 6: Confidence=0.2986
Selected instance: 0 (Confidence: 0.9583)
tmp min: tensor(0.) tmp max: tensor(1.)
506 4 540 960
There are 16 prompts
current IoU is: 0.9567477703094482
Seok, iteration idx= 30 IoU = tensor(0.9567)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9608
Instance 1: Confidence=0.9245
Instance 2: Confidence=0.9014
Instance 3: Confidence=0.8902
Instance 4: Confidence=0.8448
Selected instance: 0 (Confidence: 0.9608)
tmp min: tensor(0.) tmp max: tensor(1.)
468 4 540 960
current IoU is: 0.9108945727348328
Seok, iteration idx= 31 IoU = tensor(0.9109)
Selected Instance Confidence List: [tensor(0.9628), tensor(0.8784, device='cpu'), tensor(0.8555, device='cpu'), tensor(0.8736, device='cpu'), tensor(0.5801, device='cpu'), tensor(0.7536, device='cpu'), tensor(0.7278, device='cpu'), tensor(0.5796, device='cpu'), tensor(0.7917, device='cpu'), tensor(0.8311, device='cpu'), tensor(0.6336, device='cpu'), tensor(0.3871, device='cpu'), tensor(0.6005, device='cpu'), tensor(0.8948, device='cpu'), tensor(0.9052, device='cpu'), tensor(0.9202, device='cpu'), tensor(0.9133, device='cpu'), tensor(0.9187, device='cpu'), tensor(0.9492, device='cpu'), tensor(0.9601, device='cpu'), tensor(0.5591, device='cpu'), tensor(0.8646, device='cpu'), tensor(0.8726, device='cpu'), tensor(0.8640, device='cpu'), tensor(0.7578, device='cpu'), tensor(0.5174, device='cpu'), tensor(0.4269, device='cpu'), tensor(0.5700, device='cpu'), tensor(0.9317, device='cpu'), tensor(0.9451, device='cpu'), tensor(0.9574, device='cpu'), tensor(0.9308, device='cpu')]
Sorted Confidence Order: [tensor(0.9628), tensor(0.8784, device='cpu'), tensor(0.8555, device='cpu'), tensor(0.8736, device='cpu'), tensor(0.9308, device='cpu'), tensor(0.9574, device='cpu'), tensor(0.9451, device='cpu'), tensor(0.9317, device='cpu'), tensor(0.9601, device='cpu'), tensor(0.9492, device='cpu'), tensor(0.9187, device='cpu'), tensor(0.9133, device='cpu'), tensor(0.9202, device='cpu'), tensor(0.9052, device='cpu'), tensor(0.8948, device='cpu'), tensor(0.6005, device='cpu'), tensor(0.3871, device='cpu'), tensor(0.6336, device='cpu'), tensor(0.8311, device='cpu'), tensor(0.7917, device='cpu'), tensor(0.5796, device='cpu'), tensor(0.7278, device='cpu'), tensor(0.7536, device='cpu'), tensor(0.5801, device='cpu'), tensor(0.5700, device='cpu'), tensor(0.4269, device='cpu'), tensor(0.5174, device='cpu'), tensor(0.7578, device='cpu'), tensor(0.8640, device='cpu'), tensor(0.8726, device='cpu'), tensor(0.8646, device='cpu'), tensor(0.5591, device='cpu')]
sorted_indices: [0, 1, 2, 3, 31, 30, 29, 28, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 27, 26, 25, 24, 23, 22, 21, 20]
Initial view (highest confidence): 1
New training order: [13, 14, 15, 16, 12, 11, 10, 9, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.5ms
Speed: 1.7ms preprocess, 21.5ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 2.9ms preprocess, 23.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9530
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.8797
Instance 4: Confidence=0.8281
Instance 5: Confidence=0.7251
tmp min: tensor(0.) tmp max: tensor(1.)
407 36 540 960
There are 15 prompts
current IoU is: 0.9432588815689087
Seok, iteration idx= 1 IoU = tensor(0.9433)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.3ms
Speed: 3.4ms preprocess, 24.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 4
Instance 0: Confidence=0.9523
Instance 1: Confidence=0.9468
Instance 2: Confidence=0.9161
Instance 3: Confidence=0.8821
tmp min: tensor(0.) tmp max: tensor(1.)
382 60 540 960
There are 15 prompts
current IoU is: 0.8960726261138916
Seok, iteration idx= 2 IoU = tensor(0.8961)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9327
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9102
Instance 3: Confidence=0.8415
Instance 4: Confidence=0.7714
tmp min: tensor(0.) tmp max: tensor(1.)
369 100 540 960
There are 15 prompts
current IoU is: 0.907776415348053
Seok, iteration idx= 3 IoU = tensor(0.9078)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.5ms
Speed: 1.7ms preprocess, 24.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9608
Instance 1: Confidence=0.9245
Instance 2: Confidence=0.9014
Instance 3: Confidence=0.8902
Instance 4: Confidence=0.8448
tmp min: tensor(0.) tmp max: tensor(1.)
468 4 540 960
current IoU is: 0.9107636213302612
Seok, iteration idx= 4 IoU = tensor(0.9108)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.4ms
Speed: 1.4ms preprocess, 24.4ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9356
Instance 2: Confidence=0.9105
Instance 3: Confidence=0.8693
Instance 4: Confidence=0.7860
Instance 5: Confidence=0.4345
Instance 6: Confidence=0.2986
tmp min: tensor(0.) tmp max: tensor(1.)
506 4 540 960
There are 16 prompts
current IoU is: 0.9602357149124146
Seok, iteration idx= 5 IoU = tensor(0.9602)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9559
Instance 1: Confidence=0.9326
Instance 2: Confidence=0.9255
Instance 3: Confidence=0.8958
Instance 4: Confidence=0.8174
Instance 5: Confidence=0.2734
tmp min: tensor(0.) tmp max: tensor(1.)
531 16 540 960
There are 16 prompts
current IoU is: 0.9550975561141968
Seok, iteration idx= 6 IoU = tensor(0.9551)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.5ms
Speed: 1.4ms preprocess, 24.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9562
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.9215
Instance 3: Confidence=0.8554
Instance 4: Confidence=0.7123
tmp min: tensor(0.) tmp max: tensor(1.)
574 20 540 960
There are 17 prompts
current IoU is: 0.925629734992981
Seok, iteration idx= 7 IoU = tensor(0.9256)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.3ms
Speed: 2.1ms preprocess, 24.3ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9400
Instance 2: Confidence=0.9397
Instance 3: Confidence=0.8820
Instance 4: Confidence=0.8574
Instance 5: Confidence=0.5968
Instance 6: Confidence=0.3960
tmp min: tensor(0.) tmp max: tensor(1.)
458 40 540 960
There are 15 prompts
current IoU is: 0.9617051482200623
Seok, iteration idx= 8 IoU = tensor(0.9617)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.3ms
Speed: 2.5ms preprocess, 24.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 7
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9479
Instance 2: Confidence=0.9307
Instance 3: Confidence=0.9156
Instance 4: Confidence=0.8290
Instance 5: Confidence=0.7404
Instance 6: Confidence=0.3328
tmp min: tensor(0.) tmp max: tensor(1.)
589 68 540 960
There are 15 prompts
current IoU is: 0.9587780833244324
Seok, iteration idx= 9 IoU = tensor(0.9588)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 2.8ms preprocess, 22.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9394
Instance 1: Confidence=0.9324
Instance 2: Confidence=0.9258
Instance 3: Confidence=0.9160
Instance 4: Confidence=0.9043
tmp min: tensor(0.) tmp max: tensor(1.)
609 72 540 960
There are 16 prompts
current IoU is: 0.9430236220359802
Seok, iteration idx= 10 IoU = tensor(0.9430)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 25.2ms
Speed: 2.9ms preprocess, 25.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9223
Instance 2: Confidence=0.9203
Instance 3: Confidence=0.8729
Instance 4: Confidence=0.7752
Instance 5: Confidence=0.6791
Instance 6: Confidence=0.3599
tmp min: tensor(0.) tmp max: tensor(1.)
615 104 540 960
There are 15 prompts
current IoU is: 0.9359450340270996
Seok, iteration idx= 11 IoU = tensor(0.9359)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 2.2ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9601
Instance 1: Confidence=0.9222
Instance 2: Confidence=0.9087
Instance 3: Confidence=0.8744
Instance 4: Confidence=0.7555
tmp min: tensor(0.) tmp max: tensor(1.)
666 32 540 960
There are 16 prompts
current IoU is: 0.9453596472740173
Seok, iteration idx= 12 IoU = tensor(0.9454)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 25.2ms
Speed: 1.7ms preprocess, 25.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 7
Instance 0: Confidence=0.9565
Instance 1: Confidence=0.9201
Instance 2: Confidence=0.9047
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.8364
Instance 5: Confidence=0.4276
Instance 6: Confidence=0.3358
tmp min: tensor(0.) tmp max: tensor(1.)
685 16 540 960
There are 15 prompts
current IoU is: 0.9385145902633667
Seok, iteration idx= 13 IoU = tensor(0.9385)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9655
Instance 1: Confidence=0.9527
Instance 2: Confidence=0.9136
Instance 3: Confidence=0.8798
Instance 4: Confidence=0.8149
Instance 5: Confidence=0.6837
tmp min: tensor(0.) tmp max: tensor(1.)
678 48 540 960
There are 16 prompts
current IoU is: 0.934216320514679
Seok, iteration idx= 14 IoU = tensor(0.9342)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9664
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.8923
Instance 3: Confidence=0.6204
Instance 4: Confidence=0.4815
Instance 5: Confidence=0.4394
tmp min: tensor(0.) tmp max: tensor(1.)
719 8 540 960
There are 15 prompts
current IoU is: 0.8483805656433105
Seok, iteration idx= 15 IoU = tensor(0.8484)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9677
Instance 1: Confidence=0.9541
Instance 2: Confidence=0.9076
Instance 3: Confidence=0.8270
Instance 4: Confidence=0.6917
tmp min: tensor(0.) tmp max: tensor(1.)
490 0 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 16 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9406
Instance 2: Confidence=0.8957
Instance 3: Confidence=0.8788
Instance 4: Confidence=0.6792
Instance 5: Confidence=0.2540
tmp min: tensor(0.) tmp max: tensor(1.)
621 52 540 960
There are 17 prompts
current IoU is: 0.7891718745231628
Seok, iteration idx= 17 IoU = tensor(0.7892)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9663
Instance 1: Confidence=0.9506
Instance 2: Confidence=0.9380
Instance 3: Confidence=0.8953
Instance 4: Confidence=0.8884
Instance 5: Confidence=0.6212
tmp min: tensor(0.) tmp max: tensor(1.)
623 36 540 960
There are 17 prompts
current IoU is: 0.8761281967163086
Seok, iteration idx= 18 IoU = tensor(0.8761)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.0ms
Speed: 1.5ms preprocess, 25.0ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9499
Instance 1: Confidence=0.9225
Instance 2: Confidence=0.9120
Instance 3: Confidence=0.9019
Instance 4: Confidence=0.8923
tmp min: tensor(0.) tmp max: tensor(1.)
602 64 540 960
There are 15 prompts
current IoU is: 0.8573204278945923
Seok, iteration idx= 19 IoU = tensor(0.8573)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9355
Instance 2: Confidence=0.9115
Instance 3: Confidence=0.8830
Instance 4: Confidence=0.7381
Instance 5: Confidence=0.7063
tmp min: tensor(0.) tmp max: tensor(1.)
610 92 540 960
There are 14 prompts
current IoU is: 0.6965547800064087
Seok, iteration idx= 20 IoU = tensor(0.6966)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.0ms
Speed: 2.8ms preprocess, 24.0ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 8
Instance 0: Confidence=0.9574
Instance 1: Confidence=0.9518
Instance 2: Confidence=0.8906
Instance 3: Confidence=0.8743
Instance 4: Confidence=0.6790
Instance 5: Confidence=0.4519
Instance 6: Confidence=0.3982
Instance 7: Confidence=0.2843
tmp min: tensor(0.) tmp max: tensor(1.)
534 104 540 960
There are 19 prompts
current IoU is: 0.859673798084259
Seok, iteration idx= 21 IoU = tensor(0.8597)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 3.0ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9543
Instance 1: Confidence=0.9481
Instance 2: Confidence=0.8723
Instance 3: Confidence=0.8448
Instance 4: Confidence=0.8141
Instance 5: Confidence=0.7543
tmp min: tensor(0.) tmp max: tensor(1.)
517 68 540 960
There are 16 prompts
current IoU is: 0.8649311065673828
Seok, iteration idx= 22 IoU = tensor(0.8649)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.7ms
Speed: 2.5ms preprocess, 24.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9506
Instance 2: Confidence=0.8723
Instance 3: Confidence=0.8416
Instance 4: Confidence=0.8138
Instance 5: Confidence=0.3145
tmp min: tensor(0.) tmp max: tensor(1.)
533 64 540 960
There are 18 prompts
current IoU is: 0.7696228623390198
Seok, iteration idx= 23 IoU = tensor(0.7696)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 2.8ms preprocess, 23.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 7
Instance 0: Confidence=0.9614
Instance 1: Confidence=0.9443
Instance 2: Confidence=0.9363
Instance 3: Confidence=0.7233
Instance 4: Confidence=0.5203
Instance 5: Confidence=0.3875
Instance 6: Confidence=0.3196
tmp min: tensor(0.) tmp max: tensor(1.)
448 44 540 960
current IoU is: 0.6582620143890381
Seok, iteration idx= 24 IoU = tensor(0.6583)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.6ms
Speed: 2.5ms preprocess, 24.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9614
Instance 1: Confidence=0.9360
Instance 2: Confidence=0.9196
Instance 3: Confidence=0.8601
Instance 4: Confidence=0.8506
Instance 5: Confidence=0.4255
tmp min: tensor(0.) tmp max: tensor(1.)
518 108 540 960
There are 14 prompts
current IoU is: 0.46903619170188904
Seok, iteration idx= 25 IoU = tensor(0.4690)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.1ms
Speed: 3.0ms preprocess, 25.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9214
Instance 2: Confidence=0.9091
Instance 3: Confidence=0.8954
Instance 4: Confidence=0.8457
Instance 5: Confidence=0.6131
tmp min: tensor(0.) tmp max: tensor(1.)
466 60 540 960
There are 15 prompts
current IoU is: 0.5518672466278076
Seok, iteration idx= 26 IoU = tensor(0.5519)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 8
Instance 0: Confidence=0.9547
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9168
Instance 3: Confidence=0.9027
Instance 4: Confidence=0.7627
Instance 5: Confidence=0.3927
Instance 6: Confidence=0.3073
Instance 7: Confidence=0.2968
tmp min: tensor(0.) tmp max: tensor(1.)
441 48 540 960
There are 17 prompts
current IoU is: 0.7830299735069275
Seok, iteration idx= 27 IoU = tensor(0.7830)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 7
Instance 0: Confidence=0.9650
Instance 1: Confidence=0.9498
Instance 2: Confidence=0.9253
Instance 3: Confidence=0.8752
Instance 4: Confidence=0.6702
Instance 5: Confidence=0.4329
Instance 6: Confidence=0.3059
tmp min: tensor(0.) tmp max: tensor(1.)
410 68 540 960
There are 17 prompts
current IoU is: 0.8719920516014099
Seok, iteration idx= 28 IoU = tensor(0.8720)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.7ms
Speed: 1.4ms preprocess, 24.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9659
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.9025
Instance 4: Confidence=0.8976
Instance 5: Confidence=0.8199
tmp min: tensor(0.) tmp max: tensor(1.)
419 68 540 960
There are 16 prompts
current IoU is: 0.8838358521461487
Seok, iteration idx= 29 IoU = tensor(0.8838)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9511
Instance 2: Confidence=0.9189
Instance 3: Confidence=0.8933
Instance 4: Confidence=0.8605
Instance 5: Confidence=0.8161
tmp min: tensor(0.) tmp max: tensor(1.)
401 76 540 960
There are 15 prompts
current IoU is: 0.8942060470581055
Seok, iteration idx= 30 IoU = tensor(0.8942)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 7
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9180
Instance 3: Confidence=0.8806
Instance 4: Confidence=0.7796
Instance 5: Confidence=0.4945
Instance 6: Confidence=0.4307
tmp min: tensor(0.) tmp max: tensor(1.)
397 92 540 960
There are 16 prompts
current IoU is: 0.7047424912452698
Seok, iteration idx= 31 IoU = tensor(0.7047)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set9_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set9_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:41<00:00,  1.31s/it]
Testing psnr 27.148047611117363 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set9_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:29<00:00,  1.08it/s]
Testing psnr 3.0834035854786634 (avg)
train: coarse segmentation in 00:04:05
train: finish (eps time 00:04:06 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set9_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set10/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 42.85it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set10 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set10
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set10_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.4ms
Speed: 2.6ms preprocess, 21.4ms inference, 3.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.1ms
Speed: 1.2ms preprocess, 20.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.8ms
Speed: 1.2ms preprocess, 21.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.9ms
Speed: 1.2ms preprocess, 19.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.7ms
Speed: 1.2ms preprocess, 21.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.7ms
Speed: 1.5ms preprocess, 21.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.9ms
Speed: 2.0ms preprocess, 20.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.6ms preprocess, 20.5ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.8ms
Speed: 1.5ms preprocess, 20.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.6ms
Speed: 1.3ms preprocess, 21.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 19.8ms
Speed: 1.5ms preprocess, 19.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 1.5ms preprocess, 20.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.0ms
Speed: 1.5ms preprocess, 22.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.6ms
Speed: 1.2ms preprocess, 20.6ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.6ms
Speed: 1.5ms preprocess, 20.6ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 1.5ms preprocess, 20.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.3ms
Speed: 1.8ms preprocess, 20.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.2ms
Speed: 2.1ms preprocess, 20.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.7ms
Speed: 1.5ms preprocess, 21.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.1ms
Speed: 1.4ms preprocess, 21.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.6ms
Speed: 1.2ms preprocess, 20.6ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 1.3ms preprocess, 20.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.9ms preprocess, 20.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.8ms
Speed: 1.4ms preprocess, 19.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.1ms
Speed: 1.9ms preprocess, 20.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.1ms
Speed: 1.3ms preprocess, 21.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.2ms
Speed: 1.3ms preprocess, 21.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 21.7ms
Speed: 2.5ms preprocess, 21.7ms inference, 4.0ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.1ms
Speed: 1.1ms preprocess, 21.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9428
Instance 1: Confidence=0.9198
Instance 2: Confidence=0.8951
Instance 3: Confidence=0.8149
Instance 4: Confidence=0.7098
Instance 5: Confidence=0.4333
Selected instance: 0 (Confidence: 0.9428)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

423 36 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.8522403240203857
Seok, iteration idx= 1 IoU = tensor(0.8522)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 8
Instance 0: Confidence=0.9484
Instance 1: Confidence=0.9271
Instance 2: Confidence=0.9025
Instance 3: Confidence=0.7065
Instance 4: Confidence=0.5530
Instance 5: Confidence=0.4350
Instance 6: Confidence=0.2934
Instance 7: Confidence=0.2923
Selected instance: 0 (Confidence: 0.9484)
tmp min: tensor(0.) tmp max: tensor(1.)
407 56 540 960
There are 17 prompts
current IoU is: 0.7905104756355286
Seok, iteration idx= 2 IoU = tensor(0.7905)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9401
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.7368
Instance 4: Confidence=0.3522
Selected instance: 0 (Confidence: 0.9401)
tmp min: tensor(0.) tmp max: tensor(1.)
393 96 540 960
There are 18 prompts
current IoU is: 0.8488537073135376
Seok, iteration idx= 3 IoU = tensor(0.8489)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 2.6ms preprocess, 22.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9338
Instance 1: Confidence=0.9123
Instance 2: Confidence=0.8407
Instance 3: Confidence=0.4946
Instance 4: Confidence=0.4087
Instance 5: Confidence=0.3586
Selected instance: 3 (Confidence: 0.4946)
tmp min: tensor(0.) tmp max: tensor(1.)
532 56 540 960
There are 16 prompts
current IoU is: 0.34827661514282227
Seok, iteration idx= 4 IoU = tensor(0.3483)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.8207
Instance 3: Confidence=0.7721
Instance 4: Confidence=0.7155
Selected instance: 3 (Confidence: 0.7721)
tmp min: tensor(0.) tmp max: tensor(1.)
504 60 540 960
There are 11 prompts
current IoU is: 0.8451053500175476
Seok, iteration idx= 5 IoU = tensor(0.8451)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 3.3ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9373
Instance 1: Confidence=0.9227
Instance 2: Confidence=0.8916
Instance 3: Confidence=0.8082
Instance 4: Confidence=0.3235
Selected instance: 4 (Confidence: 0.3235)
tmp min: tensor(0.) tmp max: tensor(1.)
517 100 540 960
There are 12 prompts
current IoU is: 0.7248353958129883
Seok, iteration idx= 6 IoU = tensor(0.7248)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.6ms
Speed: 3.2ms preprocess, 21.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9313
Instance 1: Confidence=0.8929
Instance 2: Confidence=0.8629
Instance 3: Confidence=0.8365
Instance 4: Confidence=0.7943
Instance 5: Confidence=0.7689
Instance 6: Confidence=0.3691
Selected instance: 6 (Confidence: 0.3691)
tmp min: tensor(0.) tmp max: tensor(1.)
567 50 540 960
There are 15 prompts
current IoU is: 0.6713480353355408
Seok, iteration idx= 7 IoU = tensor(0.6713)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 4.7ms preprocess, 23.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9403
Instance 1: Confidence=0.9039
Instance 2: Confidence=0.8857
Instance 3: Confidence=0.8587
Instance 4: Confidence=0.7733
Selected instance: 4 (Confidence: 0.7733)
tmp min: tensor(0.) tmp max: tensor(1.)
563 76 540 960
There are 16 prompts
current IoU is: 0.4564347267150879
Seok, iteration idx= 8 IoU = tensor(0.4564)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.6ms
Speed: 2.5ms preprocess, 23.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 8
Instance 0: Confidence=0.9461
Instance 1: Confidence=0.9275
Instance 2: Confidence=0.9187
Instance 3: Confidence=0.7332
Instance 4: Confidence=0.5451
Instance 5: Confidence=0.3224
Instance 6: Confidence=0.3072
Instance 7: Confidence=0.2709
Selected instance: 7 (Confidence: 0.2709)
tmp min: tensor(0.) tmp max: tensor(1.)
583 108 540 960
There are 14 prompts
current IoU is: 0.2805708646774292
Seok, iteration idx= 9 IoU = tensor(0.2806)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.8ms
Speed: 1.4ms preprocess, 24.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9400
Instance 2: Confidence=0.8922
Instance 3: Confidence=0.7839
Instance 4: Confidence=0.7346
Instance 5: Confidence=0.6675
Selected instance: 3 (Confidence: 0.7839)
tmp min: tensor(0.) tmp max: tensor(1.)
594 44 540 960
There are 14 prompts
current IoU is: 0.27789387106895447
Seok, iteration idx= 10 IoU = tensor(0.2779)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.7ms
Speed: 1.6ms preprocess, 24.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9128
Instance 2: Confidence=0.8616
Instance 3: Confidence=0.7378
Instance 4: Confidence=0.4551
Selected instance: 3 (Confidence: 0.7378)
tmp min: tensor(0.) tmp max: tensor(1.)
641 24 540 960
There are 19 prompts
current IoU is: 0.7833251357078552
Seok, iteration idx= 11 IoU = tensor(0.7833)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.3ms preprocess, 22.7ms inference, 3.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9553
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.8795
Instance 3: Confidence=0.5983
Instance 4: Confidence=0.4742
Selected instance: 2 (Confidence: 0.8795)
tmp min: tensor(0.) tmp max: tensor(1.)
665 0 540 960
There are 17 prompts
current IoU is: 0.7919088006019592
Seok, iteration idx= 12 IoU = tensor(0.7919)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.4ms
Speed: 1.8ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 8
Instance 0: Confidence=0.9589
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.8897
Instance 3: Confidence=0.8221
Instance 4: Confidence=0.7976
Instance 5: Confidence=0.7491
Instance 6: Confidence=0.3801
Instance 7: Confidence=0.2839
Selected instance: 2 (Confidence: 0.8897)
tmp min: tensor(0.) tmp max: tensor(1.)
623 44 540 960
There are 16 prompts
current IoU is: 0.8533979654312134
Seok, iteration idx= 13 IoU = tensor(0.8534)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9545
Instance 1: Confidence=0.9200
Instance 2: Confidence=0.8959
Instance 3: Confidence=0.8240
Instance 4: Confidence=0.8171
Instance 5: Confidence=0.3278
Selected instance: 2 (Confidence: 0.8959)
tmp min: tensor(0.) tmp max: tensor(1.)
628 12 540 960
There are 15 prompts
current IoU is: 0.8985187411308289
Seok, iteration idx= 14 IoU = tensor(0.8985)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.3ms
Speed: 1.3ms preprocess, 25.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9534
Instance 1: Confidence=0.9170
Instance 2: Confidence=0.9081
Instance 3: Confidence=0.7840
Instance 4: Confidence=0.7586
Selected instance: 1 (Confidence: 0.9170)
tmp min: tensor(0.) tmp max: tensor(1.)
612 28 540 960
There are 19 prompts
current IoU is: 0.923448383808136
Seok, iteration idx= 15 IoU = tensor(0.9234)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9128
Instance 2: Confidence=0.9021
Instance 3: Confidence=0.7538
Instance 4: Confidence=0.6958
Instance 5: Confidence=0.4477
Selected instance: 2 (Confidence: 0.9021)
tmp min: tensor(0.) tmp max: tensor(1.)
570 100 540 960
There are 14 prompts
current IoU is: 0.9029200673103333
Seok, iteration idx= 16 IoU = tensor(0.9029)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9349
Instance 2: Confidence=0.8948
Instance 3: Confidence=0.8225
Instance 4: Confidence=0.7823
Selected instance: 0 (Confidence: 0.9358)
tmp min: tensor(0.) tmp max: tensor(1.)
569 68 540 960
There are 16 prompts
current IoU is: 0.9048561453819275
Seok, iteration idx= 17 IoU = tensor(0.9049)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.9ms
Speed: 2.6ms preprocess, 24.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9343
Instance 1: Confidence=0.9156
Instance 2: Confidence=0.8866
Instance 3: Confidence=0.8747
Instance 4: Confidence=0.7347
Instance 5: Confidence=0.5717
Selected instance: 0 (Confidence: 0.9343)
tmp min: tensor(0.) tmp max: tensor(1.)
555 64 540 960
There are 15 prompts
current IoU is: 0.9435809254646301
Seok, iteration idx= 18 IoU = tensor(0.9436)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.7ms
Speed: 2.9ms preprocess, 24.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9327
Instance 2: Confidence=0.8889
Instance 3: Confidence=0.8410
Instance 4: Confidence=0.7670
Instance 5: Confidence=0.3930
Instance 6: Confidence=0.3173
Selected instance: 0 (Confidence: 0.9486)
tmp min: tensor(0.) tmp max: tensor(1.)
562 36 540 960
There are 15 prompts
current IoU is: 0.9435630440711975
Seok, iteration idx= 19 IoU = tensor(0.9436)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.1ms
Speed: 2.4ms preprocess, 25.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9357
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.8987
Instance 3: Confidence=0.8981
Instance 4: Confidence=0.8441
Instance 5: Confidence=0.7465
Selected instance: 4 (Confidence: 0.8441)
tmp min: tensor(0.) tmp max: tensor(1.)
403 88 540 960
There are 15 prompts
current IoU is: 0.48571428656578064
Seok, iteration idx= 20 IoU = tensor(0.4857)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.8ms
Speed: 2.9ms preprocess, 24.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9505
Instance 1: Confidence=0.9323
Instance 2: Confidence=0.8850
Instance 3: Confidence=0.8476
Instance 4: Confidence=0.6034
Instance 5: Confidence=0.3047
Selected instance: 4 (Confidence: 0.6034)
tmp min: tensor(0.) tmp max: tensor(1.)
418 64 540 960
There are 19 prompts
current IoU is: 0.6791979670524597
Seok, iteration idx= 21 IoU = tensor(0.6792)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 2.8ms preprocess, 22.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 7
Instance 0: Confidence=0.9535
Instance 1: Confidence=0.9077
Instance 2: Confidence=0.8941
Instance 3: Confidence=0.7788
Instance 4: Confidence=0.7653
Instance 5: Confidence=0.6566
Instance 6: Confidence=0.4216
Selected instance: 4 (Confidence: 0.7653)
tmp min: tensor(0.) tmp max: tensor(1.)
433 60 540 960
There are 19 prompts
current IoU is: 0.8039576411247253
Seok, iteration idx= 22 IoU = tensor(0.8040)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 1.3ms preprocess, 22.9ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 7
Instance 0: Confidence=0.9425
Instance 1: Confidence=0.9028
Instance 2: Confidence=0.8830
Instance 3: Confidence=0.8673
Instance 4: Confidence=0.8513
Instance 5: Confidence=0.6991
Instance 6: Confidence=0.4623
Selected instance: 4 (Confidence: 0.8513)
tmp min: tensor(0.) tmp max: tensor(1.)
425 56 540 960
There are 19 prompts
current IoU is: 0.7236089706420898
Seok, iteration idx= 23 IoU = tensor(0.7236)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9449
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9027
Instance 3: Confidence=0.8698
Instance 4: Confidence=0.7552
Instance 5: Confidence=0.5370
Selected instance: 4 (Confidence: 0.7552)
tmp min: tensor(0.) tmp max: tensor(1.)
435 40 540 960
There are 12 prompts
current IoU is: 0.5596068501472473
Seok, iteration idx= 24 IoU = tensor(0.5596)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.3ms
Speed: 1.3ms preprocess, 24.3ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9103
Instance 2: Confidence=0.9077
Instance 3: Confidence=0.8864
Instance 4: Confidence=0.3265
Selected instance: 4 (Confidence: 0.3265)
tmp min: tensor(0.) tmp max: tensor(1.)
434 100 540 960
There are 15 prompts
current IoU is: 0.31888890266418457
Seok, iteration idx= 25 IoU = tensor(0.3189)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9350
Instance 1: Confidence=0.9340
Instance 2: Confidence=0.8964
Instance 3: Confidence=0.8023
Instance 4: Confidence=0.4329
Selected instance: 4 (Confidence: 0.4329)
tmp min: tensor(0.) tmp max: tensor(1.)
518 96 540 960
There are 16 prompts
current IoU is: 0.4569053053855896
Seok, iteration idx= 26 IoU = tensor(0.4569)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 4
Instance 0: Confidence=0.9348
Instance 1: Confidence=0.9073
Instance 2: Confidence=0.9057
Instance 3: Confidence=0.7642
Selected instance: 3 (Confidence: 0.7642)
tmp min: tensor(0.) tmp max: tensor(1.)
494 40 540 960
There are 15 prompts
current IoU is: 0.54230135679245
Seok, iteration idx= 27 IoU = tensor(0.5423)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 1.5ms preprocess, 24.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9387
Instance 1: Confidence=0.9300
Instance 2: Confidence=0.9169
Instance 3: Confidence=0.6203
Instance 4: Confidence=0.5186
Instance 5: Confidence=0.2775
Selected instance: 0 (Confidence: 0.9387)
tmp min: tensor(0.) tmp max: tensor(1.)
550 16 540 960
There are 13 prompts
current IoU is: 0.9432243704795837
Seok, iteration idx= 28 IoU = tensor(0.9432)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.6ms
Speed: 1.5ms preprocess, 23.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 8
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9200
Instance 2: Confidence=0.9052
Instance 3: Confidence=0.5757
Instance 4: Confidence=0.3700
Instance 5: Confidence=0.3422
Instance 6: Confidence=0.3060
Instance 7: Confidence=0.2816
Selected instance: 0 (Confidence: 0.9445)
tmp min: tensor(0.) tmp max: tensor(1.)
512 16 540 960
There are 17 prompts
current IoU is: 0.9590159058570862
Seok, iteration idx= 29 IoU = tensor(0.9590)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9051
Instance 2: Confidence=0.9033
Instance 3: Confidence=0.8099
Instance 4: Confidence=0.2907
Selected instance: 0 (Confidence: 0.9583)
tmp min: tensor(0.) tmp max: tensor(1.)
489 8 540 960
There are 15 prompts
current IoU is: 0.9586600661277771
Seok, iteration idx= 30 IoU = tensor(0.9587)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.4ms
Speed: 2.1ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9487
Instance 1: Confidence=0.9292
Instance 2: Confidence=0.8816
Instance 3: Confidence=0.8691
Instance 4: Confidence=0.7868
Instance 5: Confidence=0.2647
Selected instance: 0 (Confidence: 0.9487)
tmp min: tensor(0.) tmp max: tensor(1.)
466 4 540 960
There are 14 prompts
current IoU is: 0.9630783796310425
Seok, iteration idx= 31 IoU = tensor(0.9631)
Selected Instance Confidence List: [tensor(0.9370), tensor(0.8885, device='cpu'), tensor(0.8537, device='cpu'), tensor(0.8854, device='cpu'), tensor(0.4068, device='cpu'), tensor(0.8159, device='cpu'), tensor(0.5643, device='cpu'), tensor(0.6662, device='cpu'), tensor(0.5832, device='cpu'), tensor(0.3788, device='cpu'), tensor(0.4803, device='cpu'), tensor(0.7651, device='cpu'), tensor(0.8269, device='cpu'), tensor(0.8679, device='cpu'), tensor(0.8975, device='cpu'), tensor(0.9209, device='cpu'), tensor(0.9026, device='cpu'), tensor(0.9172, device='cpu'), tensor(0.9399, device='cpu'), tensor(0.9456, device='cpu'), tensor(0.6291, device='cpu'), tensor(0.6489, device='cpu'), tensor(0.7885, device='cpu'), tensor(0.7747, device='cpu'), tensor(0.6379, device='cpu'), tensor(0.3801, device='cpu'), tensor(0.4473, device='cpu'), tensor(0.6311, device='cpu'), tensor(0.9414, device='cpu'), tensor(0.9532, device='cpu'), tensor(0.9585, device='cpu'), tensor(0.9573, device='cpu')]
Sorted Confidence Order: [tensor(0.9585, device='cpu'), tensor(0.9532, device='cpu'), tensor(0.9414, device='cpu'), tensor(0.9456, device='cpu'), tensor(0.9399, device='cpu'), tensor(0.9172, device='cpu'), tensor(0.9026, device='cpu'), tensor(0.9209, device='cpu'), tensor(0.8975, device='cpu'), tensor(0.8679, device='cpu'), tensor(0.8269, device='cpu'), tensor(0.7651, device='cpu'), tensor(0.4803, device='cpu'), tensor(0.3788, device='cpu'), tensor(0.5832, device='cpu'), tensor(0.6662, device='cpu'), tensor(0.5643, device='cpu'), tensor(0.8159, device='cpu'), tensor(0.4068, device='cpu'), tensor(0.6311, device='cpu'), tensor(0.4473, device='cpu'), tensor(0.3801, device='cpu'), tensor(0.6379, device='cpu'), tensor(0.7747, device='cpu'), tensor(0.7885, device='cpu'), tensor(0.6489, device='cpu'), tensor(0.6291, device='cpu'), tensor(0.8854, device='cpu'), tensor(0.8537, device='cpu'), tensor(0.8885, device='cpu'), tensor(0.9370), tensor(0.9573, device='cpu')]
sorted_indices: [30, 29, 28, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 27, 26, 25, 24, 23, 22, 21, 20, 3, 2, 1, 0, 31]
Initial view (highest confidence): 35
New training order: [11, 10, 9, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15, 14, 13, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.0ms
Speed: 1.8ms preprocess, 21.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.3ms
Speed: 1.3ms preprocess, 24.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 8
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9200
Instance 2: Confidence=0.9052
Instance 3: Confidence=0.5757
Instance 4: Confidence=0.3700
Instance 5: Confidence=0.3422
Instance 6: Confidence=0.3060
Instance 7: Confidence=0.2816
tmp min: tensor(0.) tmp max: tensor(1.)
512 16 540 960
There are 17 prompts
current IoU is: 0.968151867389679
Seok, iteration idx= 1 IoU = tensor(0.9682)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 3.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9387
Instance 1: Confidence=0.9300
Instance 2: Confidence=0.9169
Instance 3: Confidence=0.6203
Instance 4: Confidence=0.5186
Instance 5: Confidence=0.2775
tmp min: tensor(0.) tmp max: tensor(1.)
550 16 540 960
There are 13 prompts
current IoU is: 0.9552354216575623
Seok, iteration idx= 2 IoU = tensor(0.9552)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 1.3ms preprocess, 23.1ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 7
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9327
Instance 2: Confidence=0.8889
Instance 3: Confidence=0.8410
Instance 4: Confidence=0.7670
Instance 5: Confidence=0.3930
Instance 6: Confidence=0.3173
tmp min: tensor(0.) tmp max: tensor(1.)
562 36 540 960
There are 15 prompts
current IoU is: 0.9565742015838623
Seok, iteration idx= 3 IoU = tensor(0.9566)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.2ms
Speed: 1.4ms preprocess, 25.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9343
Instance 1: Confidence=0.9156
Instance 2: Confidence=0.8866
Instance 3: Confidence=0.8747
Instance 4: Confidence=0.7347
Instance 5: Confidence=0.5717
tmp min: tensor(0.) tmp max: tensor(1.)
555 64 540 960
There are 15 prompts
current IoU is: 0.9540128111839294
Seok, iteration idx= 4 IoU = tensor(0.9540)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.4ms preprocess, 24.2ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9349
Instance 2: Confidence=0.8948
Instance 3: Confidence=0.8225
Instance 4: Confidence=0.7823
tmp min: tensor(0.) tmp max: tensor(1.)
569 68 540 960
There are 16 prompts
current IoU is: 0.9479263424873352
Seok, iteration idx= 5 IoU = tensor(0.9479)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 4.5ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9128
Instance 2: Confidence=0.9021
Instance 3: Confidence=0.7538
Instance 4: Confidence=0.6958
Instance 5: Confidence=0.4477
tmp min: tensor(0.) tmp max: tensor(1.)
570 100 540 960
There are 14 prompts
current IoU is: 0.9142320156097412
Seok, iteration idx= 6 IoU = tensor(0.9142)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 2.9ms preprocess, 24.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9534
Instance 1: Confidence=0.9170
Instance 2: Confidence=0.9081
Instance 3: Confidence=0.7840
Instance 4: Confidence=0.7586
tmp min: tensor(0.) tmp max: tensor(1.)
612 28 540 960
There are 19 prompts
current IoU is: 0.9538009762763977
Seok, iteration idx= 7 IoU = tensor(0.9538)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 2.4ms preprocess, 22.8ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9545
Instance 1: Confidence=0.9200
Instance 2: Confidence=0.8959
Instance 3: Confidence=0.8240
Instance 4: Confidence=0.8171
Instance 5: Confidence=0.3278
tmp min: tensor(0.) tmp max: tensor(1.)
628 12 540 960
There are 15 prompts
current IoU is: 0.9273462295532227
Seok, iteration idx= 8 IoU = tensor(0.9273)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.9ms
Speed: 1.4ms preprocess, 24.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 8
Instance 0: Confidence=0.9589
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.8897
Instance 3: Confidence=0.8221
Instance 4: Confidence=0.7976
Instance 5: Confidence=0.7491
Instance 6: Confidence=0.3801
Instance 7: Confidence=0.2839
tmp min: tensor(0.) tmp max: tensor(1.)
623 44 540 960
There are 16 prompts
current IoU is: 0.9196703433990479
Seok, iteration idx= 9 IoU = tensor(0.9197)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9553
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.8795
Instance 3: Confidence=0.5983
Instance 4: Confidence=0.4742
tmp min: tensor(0.) tmp max: tensor(1.)
665 0 540 960
There are 17 prompts
current IoU is: 0.9051085114479065
Seok, iteration idx= 10 IoU = tensor(0.9051)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9128
Instance 2: Confidence=0.8616
Instance 3: Confidence=0.7378
Instance 4: Confidence=0.4551
tmp min: tensor(0.) tmp max: tensor(1.)
641 24 540 960
There are 19 prompts
current IoU is: 0.8706323504447937
Seok, iteration idx= 11 IoU = tensor(0.8706)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9400
Instance 2: Confidence=0.8922
Instance 3: Confidence=0.7839
Instance 4: Confidence=0.7346
Instance 5: Confidence=0.6675
tmp min: tensor(0.) tmp max: tensor(1.)
594 44 540 960
There are 14 prompts
current IoU is: 0.5729496479034424
Seok, iteration idx= 12 IoU = tensor(0.5729)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 8
Instance 0: Confidence=0.9461
Instance 1: Confidence=0.9275
Instance 2: Confidence=0.9187
Instance 3: Confidence=0.7332
Instance 4: Confidence=0.5451
Instance 5: Confidence=0.3224
Instance 6: Confidence=0.3072
Instance 7: Confidence=0.2709
tmp min: tensor(0.) tmp max: tensor(1.)
583 108 540 960
There are 14 prompts
current IoU is: 0.4920721650123596
Seok, iteration idx= 13 IoU = tensor(0.4921)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9403
Instance 1: Confidence=0.9039
Instance 2: Confidence=0.8857
Instance 3: Confidence=0.8587
Instance 4: Confidence=0.7733
tmp min: tensor(0.) tmp max: tensor(1.)
563 76 540 960
There are 16 prompts
current IoU is: 0.7520793080329895
Seok, iteration idx= 14 IoU = tensor(0.7521)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.7ms
Speed: 2.6ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 7
Instance 0: Confidence=0.9313
Instance 1: Confidence=0.8929
Instance 2: Confidence=0.8629
Instance 3: Confidence=0.8365
Instance 4: Confidence=0.7943
Instance 5: Confidence=0.7689
Instance 6: Confidence=0.3691
tmp min: tensor(0.) tmp max: tensor(1.)
567 50 540 960
There are 15 prompts
current IoU is: 0.835433304309845
Seok, iteration idx= 15 IoU = tensor(0.8354)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 3.5ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9373
Instance 1: Confidence=0.9227
Instance 2: Confidence=0.8916
Instance 3: Confidence=0.8082
Instance 4: Confidence=0.3235
tmp min: tensor(0.) tmp max: tensor(1.)
517 100 540 960
There are 12 prompts
current IoU is: 0.714218258857727
Seok, iteration idx= 16 IoU = tensor(0.7142)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 2.5ms preprocess, 22.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.8207
Instance 3: Confidence=0.7721
Instance 4: Confidence=0.7155
tmp min: tensor(0.) tmp max: tensor(1.)
504 60 540 960
There are 11 prompts
current IoU is: 0.7245007753372192
Seok, iteration idx= 17 IoU = tensor(0.7245)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 2.9ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9338
Instance 1: Confidence=0.9123
Instance 2: Confidence=0.8407
Instance 3: Confidence=0.4946
Instance 4: Confidence=0.4087
Instance 5: Confidence=0.3586
tmp min: tensor(0.) tmp max: tensor(1.)
532 56 540 960
There are 16 prompts
current IoU is: 0.702203631401062
Seok, iteration idx= 18 IoU = tensor(0.7022)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.4ms
Speed: 2.7ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 4
Instance 0: Confidence=0.9348
Instance 1: Confidence=0.9073
Instance 2: Confidence=0.9057
Instance 3: Confidence=0.7642
tmp min: tensor(0.) tmp max: tensor(1.)
494 40 540 960
There are 15 prompts
current IoU is: 0.5811231732368469
Seok, iteration idx= 19 IoU = tensor(0.5811)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 2.4ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 5
Instance 0: Confidence=0.9350
Instance 1: Confidence=0.9340
Instance 2: Confidence=0.8964
Instance 3: Confidence=0.8023
Instance 4: Confidence=0.4329
tmp min: tensor(0.) tmp max: tensor(1.)
518 96 540 960
There are 16 prompts
current IoU is: 0.5233348608016968
Seok, iteration idx= 20 IoU = tensor(0.5233)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 2.1ms preprocess, 24.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9103
Instance 2: Confidence=0.9077
Instance 3: Confidence=0.8864
Instance 4: Confidence=0.3265
tmp min: tensor(0.) tmp max: tensor(1.)
434 100 540 960
There are 15 prompts
current IoU is: 0.35704323649406433
Seok, iteration idx= 21 IoU = tensor(0.3570)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9449
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9027
Instance 3: Confidence=0.8698
Instance 4: Confidence=0.7552
Instance 5: Confidence=0.5370
tmp min: tensor(0.) tmp max: tensor(1.)
435 40 540 960
There are 12 prompts
current IoU is: 0.661740243434906
Seok, iteration idx= 22 IoU = tensor(0.6617)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 7
Instance 0: Confidence=0.9425
Instance 1: Confidence=0.9028
Instance 2: Confidence=0.8830
Instance 3: Confidence=0.8673
Instance 4: Confidence=0.8513
Instance 5: Confidence=0.6991
Instance 6: Confidence=0.4623
tmp min: tensor(0.) tmp max: tensor(1.)
425 56 540 960
There are 19 prompts
current IoU is: 0.6706942915916443
Seok, iteration idx= 23 IoU = tensor(0.6707)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 7
Instance 0: Confidence=0.9535
Instance 1: Confidence=0.9077
Instance 2: Confidence=0.8941
Instance 3: Confidence=0.7788
Instance 4: Confidence=0.7653
Instance 5: Confidence=0.6566
Instance 6: Confidence=0.4216
tmp min: tensor(0.) tmp max: tensor(1.)
433 60 540 960
There are 19 prompts
current IoU is: 0.8177490234375
Seok, iteration idx= 24 IoU = tensor(0.8177)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9505
Instance 1: Confidence=0.9323
Instance 2: Confidence=0.8850
Instance 3: Confidence=0.8476
Instance 4: Confidence=0.6034
Instance 5: Confidence=0.3047
tmp min: tensor(0.) tmp max: tensor(1.)
418 64 540 960
There are 19 prompts
current IoU is: 0.7739003896713257
Seok, iteration idx= 25 IoU = tensor(0.7739)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9357
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.8987
Instance 3: Confidence=0.8981
Instance 4: Confidence=0.8441
Instance 5: Confidence=0.7465
tmp min: tensor(0.) tmp max: tensor(1.)
403 88 540 960
There are 15 prompts
current IoU is: 0.5530086159706116
Seok, iteration idx= 26 IoU = tensor(0.5530)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 3.3ms preprocess, 24.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9401
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.7368
Instance 4: Confidence=0.3522
tmp min: tensor(0.) tmp max: tensor(1.)
393 96 540 960
There are 18 prompts
current IoU is: 0.9147731065750122
Seok, iteration idx= 27 IoU = tensor(0.9148)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.2ms
Speed: 3.0ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 8
Instance 0: Confidence=0.9484
Instance 1: Confidence=0.9271
Instance 2: Confidence=0.9025
Instance 3: Confidence=0.7065
Instance 4: Confidence=0.5530
Instance 5: Confidence=0.4350
Instance 6: Confidence=0.2934
Instance 7: Confidence=0.2923
tmp min: tensor(0.) tmp max: tensor(1.)
407 56 540 960
There are 17 prompts
current IoU is: 0.9053107500076294
Seok, iteration idx= 28 IoU = tensor(0.9053)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 2.9ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9428
Instance 1: Confidence=0.9198
Instance 2: Confidence=0.8951
Instance 3: Confidence=0.8149
Instance 4: Confidence=0.7098
Instance 5: Confidence=0.4333
tmp min: tensor(0.) tmp max: tensor(1.)
423 36 540 960
There are 16 prompts
current IoU is: 0.9501970410346985
Seok, iteration idx= 29 IoU = tensor(0.9502)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 9
Instance 0: Confidence=0.9370
Instance 1: Confidence=0.9310
Instance 2: Confidence=0.9182
Instance 3: Confidence=0.7854
Instance 4: Confidence=0.6226
Instance 5: Confidence=0.5370
Instance 6: Confidence=0.5030
Instance 7: Confidence=0.4030
Instance 8: Confidence=0.3007
tmp min: tensor(0.) tmp max: tensor(1.)
435 16 540 960
There are 13 prompts
current IoU is: 0.9573563933372498
Seok, iteration idx= 30 IoU = tensor(0.9574)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9487
Instance 1: Confidence=0.9292
Instance 2: Confidence=0.8816
Instance 3: Confidence=0.8691
Instance 4: Confidence=0.7868
Instance 5: Confidence=0.2647
tmp min: tensor(0.) tmp max: tensor(1.)
466 4 540 960
There are 14 prompts
current IoU is: 0.9663710594177246
Seok, iteration idx= 31 IoU = tensor(0.9664)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set10_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set10_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:42<00:00,  1.32s/it]
Testing psnr 27.642518803477287 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set10_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:29<00:00,  1.09it/s]
Testing psnr 3.062669290229678 (avg)
train: coarse segmentation in 00:04:00
train: finish (eps time 00:04:00 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set10_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set11/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 42.89it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set11 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set11
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set11_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 2.9ms preprocess, 23.1ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.1ms
Speed: 1.3ms preprocess, 21.1ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.8ms
Speed: 1.3ms preprocess, 21.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.3ms
Speed: 1.3ms preprocess, 20.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.1ms
Speed: 1.4ms preprocess, 20.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.8ms preprocess, 22.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.2ms preprocess, 20.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.8ms
Speed: 1.8ms preprocess, 21.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 1.3ms preprocess, 20.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.8ms
Speed: 1.3ms preprocess, 20.8ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.2ms preprocess, 20.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 1.4ms preprocess, 20.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.6ms
Speed: 1.3ms preprocess, 19.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.1ms
Speed: 1.3ms preprocess, 20.1ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.1ms
Speed: 1.3ms preprocess, 21.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.0ms
Speed: 1.3ms preprocess, 22.0ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.7ms
Speed: 1.3ms preprocess, 20.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.8ms
Speed: 1.3ms preprocess, 21.8ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.0ms
Speed: 1.3ms preprocess, 21.0ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.6ms
Speed: 1.2ms preprocess, 20.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.6ms
Speed: 1.2ms preprocess, 21.6ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.0ms
Speed: 1.3ms preprocess, 21.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 2.0ms preprocess, 20.2ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.1ms
Speed: 1.3ms preprocess, 21.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 1.2ms preprocess, 22.1ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.0ms
Speed: 1.3ms preprocess, 21.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.9ms
Speed: 1.2ms preprocess, 20.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.8ms
Speed: 1.3ms preprocess, 21.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 22.8ms
Speed: 2.5ms preprocess, 22.8ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 10
view_order: [11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.0ms
Speed: 1.2ms preprocess, 21.0ms inference, 3.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9456
Instance 2: Confidence=0.9313
Instance 3: Confidence=0.8808
Instance 4: Confidence=0.8715
Instance 5: Confidence=0.8483
Selected instance: 1 (Confidence: 0.9456)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

244 44 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.8211997747421265
Seok, iteration idx= 1 IoU = tensor(0.8212)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 2.9ms preprocess, 23.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 7
Instance 0: Confidence=0.9597
Instance 1: Confidence=0.9420
Instance 2: Confidence=0.9354
Instance 3: Confidence=0.8429
Instance 4: Confidence=0.8336
Instance 5: Confidence=0.6522
Instance 6: Confidence=0.4532
Selected instance: 1 (Confidence: 0.9420)
tmp min: tensor(0.) tmp max: tensor(1.)
217 60 540 960
There are 15 prompts
current IoU is: 0.8335052132606506
Seok, iteration idx= 2 IoU = tensor(0.8335)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 3.3ms preprocess, 22.5ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9577
Instance 1: Confidence=0.9560
Instance 2: Confidence=0.9503
Instance 3: Confidence=0.8193
Instance 4: Confidence=0.7426
Selected instance: 2 (Confidence: 0.9503)
tmp min: tensor(0.) tmp max: tensor(1.)
229 80 540 960
There are 16 prompts
current IoU is: 0.852169930934906
Seok, iteration idx= 3 IoU = tensor(0.8522)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 3.1ms preprocess, 22.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9427
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9067
Instance 4: Confidence=0.8978
Instance 5: Confidence=0.6321
Selected instance: 2 (Confidence: 0.9145)
tmp min: tensor(0.) tmp max: tensor(1.)
234 100 540 960
There are 14 prompts
current IoU is: 0.8475825190544128
Seok, iteration idx= 4 IoU = tensor(0.8476)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 3.0ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9471
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.9224
Instance 4: Confidence=0.8923
Selected instance: 2 (Confidence: 0.9240)
tmp min: tensor(0.) tmp max: tensor(1.)
248 136 540 960
There are 17 prompts
current IoU is: 0.8816304802894592
Seok, iteration idx= 5 IoU = tensor(0.8816)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9479
Instance 2: Confidence=0.9416
Instance 3: Confidence=0.8988
Instance 4: Confidence=0.8421
Selected instance: 4 (Confidence: 0.8421)
tmp min: tensor(0.) tmp max: tensor(1.)
679 88 540 960
There are 19 prompts
current IoU is: 0.27515503764152527
Seok, iteration idx= 6 IoU = tensor(0.2752)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.5ms
Speed: 1.6ms preprocess, 24.5ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9253
Instance 2: Confidence=0.8717
Instance 3: Confidence=0.8405
Instance 4: Confidence=0.5369
Instance 5: Confidence=0.3214
Instance 6: Confidence=0.2665
Selected instance: 3 (Confidence: 0.8405)
tmp min: tensor(0.) tmp max: tensor(1.)
645 92 540 960
There are 16 prompts
current IoU is: 0.5046809315681458
Seok, iteration idx= 7 IoU = tensor(0.5047)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.4ms
Speed: 1.5ms preprocess, 24.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9245
Instance 2: Confidence=0.9200
Instance 3: Confidence=0.7033
Instance 4: Confidence=0.6931
Selected instance: 3 (Confidence: 0.7033)
tmp min: tensor(0.) tmp max: tensor(1.)
660 132 540 960
There are 16 prompts
current IoU is: 0.480572372674942
Seok, iteration idx= 8 IoU = tensor(0.4806)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.9ms
Speed: 2.8ms preprocess, 24.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9556
Instance 1: Confidence=0.9451
Instance 2: Confidence=0.9042
Instance 3: Confidence=0.7678
Instance 4: Confidence=0.6133
Instance 5: Confidence=0.3890
Selected instance: 4 (Confidence: 0.6133)
tmp min: tensor(0.) tmp max: tensor(1.)
720 88 540 960
There are 15 prompts
current IoU is: 0.3244379162788391
Seok, iteration idx= 9 IoU = tensor(0.3244)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 3.0ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9671
Instance 1: Confidence=0.9570
Instance 2: Confidence=0.9262
Instance 3: Confidence=0.8464
Instance 4: Confidence=0.6664
Selected instance: 2 (Confidence: 0.9262)
tmp min: tensor(0.) tmp max: tensor(1.)
725 80 540 960
There are 15 prompts
current IoU is: 0.6542743444442749
Seok, iteration idx= 10 IoU = tensor(0.6543)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.3ms
Speed: 3.0ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9659
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9171
Instance 3: Confidence=0.8072
Instance 4: Confidence=0.7156
Instance 5: Confidence=0.4521
Instance 6: Confidence=0.3306
Selected instance: 2 (Confidence: 0.9171)
tmp min: tensor(0.) tmp max: tensor(1.)
739 56 540 960
There are 14 prompts
current IoU is: 0.8485755920410156
Seok, iteration idx= 11 IoU = tensor(0.8486)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.5ms
Speed: 3.1ms preprocess, 24.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 7
Instance 0: Confidence=0.9631
Instance 1: Confidence=0.9326
Instance 2: Confidence=0.9224
Instance 3: Confidence=0.8920
Instance 4: Confidence=0.8891
Instance 5: Confidence=0.5450
Instance 6: Confidence=0.4295
Selected instance: 2 (Confidence: 0.9224)
tmp min: tensor(0.) tmp max: tensor(1.)
730 68 540 960
There are 13 prompts
current IoU is: 0.8683173656463623
Seok, iteration idx= 12 IoU = tensor(0.8683)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 3.1ms preprocess, 22.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9710
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9314
Instance 3: Confidence=0.9307
Instance 4: Confidence=0.7829
Instance 5: Confidence=0.5400
Selected instance: 1 (Confidence: 0.9317)
tmp min: tensor(0.) tmp max: tensor(1.)
788 48 540 960
There are 14 prompts
current IoU is: 0.9124559164047241
Seok, iteration idx= 13 IoU = tensor(0.9125)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.1ms
Speed: 2.4ms preprocess, 23.1ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 8
Instance 0: Confidence=0.9684
Instance 1: Confidence=0.9498
Instance 2: Confidence=0.9438
Instance 3: Confidence=0.8761
Instance 4: Confidence=0.7452
Instance 5: Confidence=0.5554
Instance 6: Confidence=0.4846
Instance 7: Confidence=0.4124
Selected instance: 2 (Confidence: 0.9438)
tmp min: tensor(0.) tmp max: tensor(1.)
789 24 540 960
There are 14 prompts
current IoU is: 0.9264553785324097
Seok, iteration idx= 14 IoU = tensor(0.9265)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 2.6ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 7
Instance 0: Confidence=0.9550
Instance 1: Confidence=0.9468
Instance 2: Confidence=0.9211
Instance 3: Confidence=0.8658
Instance 4: Confidence=0.3527
Instance 5: Confidence=0.3313
Instance 6: Confidence=0.2660
Selected instance: 1 (Confidence: 0.9468)
tmp min: tensor(0.) tmp max: tensor(1.)
705 68 540 960
There are 15 prompts
current IoU is: 0.904308557510376
Seok, iteration idx= 15 IoU = tensor(0.9043)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 3.0ms preprocess, 22.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9542
Instance 1: Confidence=0.9452
Instance 2: Confidence=0.8901
Instance 3: Confidence=0.8789
Instance 4: Confidence=0.8606
Instance 5: Confidence=0.7636
Selected instance: 1 (Confidence: 0.9452)
tmp min: tensor(0.) tmp max: tensor(1.)
679 32 540 960
There are 16 prompts
current IoU is: 0.9323820471763611
Seok, iteration idx= 16 IoU = tensor(0.9324)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 2.5ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9487
Instance 1: Confidence=0.9423
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.8932
Instance 4: Confidence=0.8345
Instance 5: Confidence=0.7952
Selected instance: 1 (Confidence: 0.9423)
tmp min: tensor(0.) tmp max: tensor(1.)
618 52 540 960
There are 16 prompts
current IoU is: 0.9110294580459595
Seok, iteration idx= 17 IoU = tensor(0.9110)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 2.6ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9577
Instance 1: Confidence=0.9502
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8409
Instance 4: Confidence=0.8097
Selected instance: 1 (Confidence: 0.9502)
tmp min: tensor(0.) tmp max: tensor(1.)
519 132 540 960
There are 16 prompts
current IoU is: 0.9403434991836548
Seok, iteration idx= 18 IoU = tensor(0.9403)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9568
Instance 1: Confidence=0.9337
Instance 2: Confidence=0.9183
Instance 3: Confidence=0.9098
Instance 4: Confidence=0.7857
Instance 5: Confidence=0.4356
Instance 6: Confidence=0.2723
Selected instance: 0 (Confidence: 0.9568)
tmp min: tensor(0.) tmp max: tensor(1.)
463 96 540 960
There are 17 prompts
current IoU is: 0.8960700631141663
Seok, iteration idx= 19 IoU = tensor(0.8961)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 2.9ms preprocess, 23.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 7
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9389
Instance 2: Confidence=0.9162
Instance 3: Confidence=0.9079
Instance 4: Confidence=0.8868
Instance 5: Confidence=0.5165
Instance 6: Confidence=0.4232
Selected instance: 0 (Confidence: 0.9616)
tmp min: tensor(0.) tmp max: tensor(1.)
417 96 540 960
There are 16 prompts
current IoU is: 0.938532829284668
Seok, iteration idx= 20 IoU = tensor(0.9385)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 7
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9321
Instance 2: Confidence=0.9290
Instance 3: Confidence=0.9221
Instance 4: Confidence=0.8640
Instance 5: Confidence=0.7488
Instance 6: Confidence=0.3407
Selected instance: 0 (Confidence: 0.9579)
tmp min: tensor(0.) tmp max: tensor(1.)
401 60 540 960
There are 14 prompts
current IoU is: 0.9508084654808044
Seok, iteration idx= 21 IoU = tensor(0.9508)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9415
Instance 1: Confidence=0.9146
Instance 2: Confidence=0.9040
Instance 3: Confidence=0.8978
Instance 4: Confidence=0.8853
Instance 5: Confidence=0.3458
Selected instance: 5 (Confidence: 0.3458)
tmp min: tensor(0.) tmp max: tensor(1.)
473 128 540 960
There are 14 prompts
current IoU is: 0.18492509424686432
Seok, iteration idx= 22 IoU = tensor(0.1849)
SKIP, unacceptable sam prediction, IoU is tensor(0.1849)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 8
Instance 0: Confidence=0.9570
Instance 1: Confidence=0.9254
Instance 2: Confidence=0.9230
Instance 3: Confidence=0.9228
Instance 4: Confidence=0.9172
Instance 5: Confidence=0.5296
Instance 6: Confidence=0.4528
Instance 7: Confidence=0.3554
Selected instance: 6 (Confidence: 0.4528)
tmp min: tensor(0.) tmp max: tensor(1.)
526 100 540 960
There are 14 prompts
current IoU is: 0.46988949179649353
Seok, iteration idx= 23 IoU = tensor(0.4699)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9401
Instance 1: Confidence=0.9391
Instance 2: Confidence=0.9293
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9041
Instance 5: Confidence=0.8093
Selected instance: 5 (Confidence: 0.8093)
tmp min: tensor(0.) tmp max: tensor(1.)
542 96 540 960
There are 16 prompts
current IoU is: 0.656083881855011
Seok, iteration idx= 24 IoU = tensor(0.6561)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9441
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9204
Instance 3: Confidence=0.8937
Instance 4: Confidence=0.8811
Instance 5: Confidence=0.6694
Selected instance: 4 (Confidence: 0.8811)
tmp min: tensor(0.) tmp max: tensor(1.)
539 92 540 960
There are 16 prompts
current IoU is: 0.7070161700248718
Seok, iteration idx= 25 IoU = tensor(0.7070)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.2ms
Speed: 3.1ms preprocess, 24.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 4
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9497
Instance 2: Confidence=0.9269
Instance 3: Confidence=0.9004
Selected instance: 3 (Confidence: 0.9004)
tmp min: tensor(0.) tmp max: tensor(1.)
567 76 540 960
There are 14 prompts
current IoU is: 0.7196747660636902
Seok, iteration idx= 26 IoU = tensor(0.7197)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.1ms
Speed: 2.2ms preprocess, 24.1ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 8
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9354
Instance 2: Confidence=0.9341
Instance 3: Confidence=0.8591
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.6447
Instance 6: Confidence=0.4165
Instance 7: Confidence=0.2997
Selected instance: 4 (Confidence: 0.8415)
tmp min: tensor(0.) tmp max: tensor(1.)
618 76 540 960
There are 18 prompts
current IoU is: 0.6380744576454163
Seok, iteration idx= 27 IoU = tensor(0.6381)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 2.4ms preprocess, 23.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9518
Instance 2: Confidence=0.9162
Instance 3: Confidence=0.8995
Instance 4: Confidence=0.8007
Instance 5: Confidence=0.7572
Selected instance: 5 (Confidence: 0.7572)
tmp min: tensor(0.) tmp max: tensor(1.)
615 68 540 960
There are 17 prompts
current IoU is: 0.7365392446517944
Seok, iteration idx= 28 IoU = tensor(0.7365)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 2.9ms preprocess, 23.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9464
Instance 1: Confidence=0.9412
Instance 2: Confidence=0.9307
Instance 3: Confidence=0.8961
Instance 4: Confidence=0.8483
Selected instance: 0 (Confidence: 0.9464)
tmp min: tensor(0.) tmp max: tensor(1.)
550 0 540 960
There are 16 prompts
current IoU is: 0.002969004213809967
Seok, iteration idx= 29 IoU = tensor(0.0030)
SKIP, unacceptable sam prediction, IoU is tensor(0.0030)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.7ms
Speed: 2.5ms preprocess, 24.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9355
Instance 1: Confidence=0.9264
Instance 2: Confidence=0.9218
Instance 3: Confidence=0.8835
Instance 4: Confidence=0.8732
Instance 5: Confidence=0.7672
Instance 6: Confidence=0.3035
Selected instance: 1 (Confidence: 0.9264)
tmp min: tensor(0.) tmp max: tensor(1.)
361 44 540 960
There are 16 prompts
current IoU is: 0.9580481648445129
Seok, iteration idx= 30 IoU = tensor(0.9580)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 3.4ms preprocess, 22.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9406
Instance 2: Confidence=0.9377
Instance 3: Confidence=0.8722
Instance 4: Confidence=0.2874
Selected instance: 0 (Confidence: 0.9435)
tmp min: tensor(0.) tmp max: tensor(1.)
295 48 540 960
There are 17 prompts
current IoU is: 0.9326261281967163
Seok, iteration idx= 31 IoU = tensor(0.9326)
Selected Instance Confidence List: [tensor(0.9466), tensor(0.8710, device='cpu'), tensor(0.8769, device='cpu'), tensor(0.8914, device='cpu'), tensor(0.8744, device='cpu'), tensor(0.8986, device='cpu'), tensor(0.5020, device='cpu'), tensor(0.6390, device='cpu'), tensor(0.5697, device='cpu'), tensor(0.4400, device='cpu'), tensor(0.7630, device='cpu'), tensor(0.8760, device='cpu'), tensor(0.8899, device='cpu'), tensor(0.9201, device='cpu'), tensor(0.9334, device='cpu'), tensor(0.9213, device='cpu'), tensor(0.9375, device='cpu'), tensor(0.9236, device='cpu'), tensor(0.9443, device='cpu'), tensor(0.9204, device='cpu'), tensor(0.9477, device='cpu'), tensor(0.9536, device='cpu'), tensor(0.3768, device='cpu'), tensor(0.4630, device='cpu'), tensor(0.7174, device='cpu'), tensor(0.7767, device='cpu'), tensor(0.7920, device='cpu'), tensor(0.7194, device='cpu'), tensor(0.7448, device='cpu'), tensor(0.3804, device='cpu'), tensor(0.9454, device='cpu'), tensor(0.9370, device='cpu')]
Sorted Confidence Order: [tensor(0.9536, device='cpu'), tensor(0.9477, device='cpu'), tensor(0.9204, device='cpu'), tensor(0.9454, device='cpu'), tensor(0.9370, device='cpu'), tensor(0.9466), tensor(0.8710, device='cpu'), tensor(0.8769, device='cpu'), tensor(0.8914, device='cpu'), tensor(0.8744, device='cpu'), tensor(0.8986, device='cpu'), tensor(0.9443, device='cpu'), tensor(0.9236, device='cpu'), tensor(0.9375, device='cpu'), tensor(0.9213, device='cpu'), tensor(0.9334, device='cpu'), tensor(0.9201, device='cpu'), tensor(0.8899, device='cpu'), tensor(0.8760, device='cpu'), tensor(0.7630, device='cpu'), tensor(0.4400, device='cpu'), tensor(0.5697, device='cpu'), tensor(0.6390, device='cpu'), tensor(0.5020, device='cpu'), tensor(0.3804, device='cpu'), tensor(0.7448, device='cpu'), tensor(0.7194, device='cpu'), tensor(0.7920, device='cpu'), tensor(0.7767, device='cpu'), tensor(0.7174, device='cpu'), tensor(0.4630, device='cpu'), tensor(0.3768, device='cpu')]
sorted_indices: [21, 20, 19, 30, 31, 0, 1, 2, 3, 4, 5, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 29, 28, 27, 26, 25, 24, 23, 22]
Initial view (highest confidence): 26
New training order: [36, 35, 34, 9, 10, 11, 12, 13, 14, 15, 16, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.5ms
Speed: 1.3ms preprocess, 21.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.0ms
Speed: 1.3ms preprocess, 24.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 7
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9389
Instance 2: Confidence=0.9162
Instance 3: Confidence=0.9079
Instance 4: Confidence=0.8868
Instance 5: Confidence=0.5165
Instance 6: Confidence=0.4232
tmp min: tensor(0.) tmp max: tensor(1.)
417 96 540 960
There are 16 prompts
current IoU is: 0.9468507766723633
Seok, iteration idx= 1 IoU = tensor(0.9469)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.5ms
Speed: 1.6ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 7
Instance 0: Confidence=0.9568
Instance 1: Confidence=0.9337
Instance 2: Confidence=0.9183
Instance 3: Confidence=0.9098
Instance 4: Confidence=0.7857
Instance 5: Confidence=0.4356
Instance 6: Confidence=0.2723
tmp min: tensor(0.) tmp max: tensor(1.)
463 96 540 960
There are 17 prompts
current IoU is: 0.8990219831466675
Seok, iteration idx= 2 IoU = tensor(0.8990)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.1ms
Speed: 2.8ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 7
Instance 0: Confidence=0.9355
Instance 1: Confidence=0.9264
Instance 2: Confidence=0.9218
Instance 3: Confidence=0.8835
Instance 4: Confidence=0.8732
Instance 5: Confidence=0.7672
Instance 6: Confidence=0.3035
tmp min: tensor(0.) tmp max: tensor(1.)
361 44 540 960
There are 16 prompts
current IoU is: 0.962081789970398
Seok, iteration idx= 3 IoU = tensor(0.9621)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9406
Instance 2: Confidence=0.9377
Instance 3: Confidence=0.8722
Instance 4: Confidence=0.2874
tmp min: tensor(0.) tmp max: tensor(1.)
295 48 540 960
There are 17 prompts
current IoU is: 0.9340115189552307
Seok, iteration idx= 4 IoU = tensor(0.9340)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 9
Instance 0: Confidence=0.9466
Instance 1: Confidence=0.9334
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.8262
Instance 4: Confidence=0.6424
Instance 5: Confidence=0.5983
Instance 6: Confidence=0.5834
Instance 7: Confidence=0.2999
Instance 8: Confidence=0.2600
tmp min: tensor(0.) tmp max: tensor(1.)
272 40 540 960
There are 14 prompts
current IoU is: 0.953997015953064
Seok, iteration idx= 5 IoU = tensor(0.9540)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.8ms
Speed: 1.8ms preprocess, 24.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9456
Instance 2: Confidence=0.9313
Instance 3: Confidence=0.8808
Instance 4: Confidence=0.8715
Instance 5: Confidence=0.8483
tmp min: tensor(0.) tmp max: tensor(1.)
244 44 540 960
There are 16 prompts
current IoU is: 0.9566190242767334
Seok, iteration idx= 6 IoU = tensor(0.9566)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.2ms
Speed: 1.4ms preprocess, 24.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9597
Instance 1: Confidence=0.9420
Instance 2: Confidence=0.9354
Instance 3: Confidence=0.8429
Instance 4: Confidence=0.8336
Instance 5: Confidence=0.6522
Instance 6: Confidence=0.4532
tmp min: tensor(0.) tmp max: tensor(1.)
217 60 540 960
There are 15 prompts
current IoU is: 0.9544143080711365
Seok, iteration idx= 7 IoU = tensor(0.9544)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.6ms
Speed: 1.4ms preprocess, 24.6ms inference, 3.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9577
Instance 1: Confidence=0.9560
Instance 2: Confidence=0.9503
Instance 3: Confidence=0.8193
Instance 4: Confidence=0.7426
tmp min: tensor(0.) tmp max: tensor(1.)
229 80 540 960
There are 16 prompts
current IoU is: 0.9311922192573547
Seok, iteration idx= 8 IoU = tensor(0.9312)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 4.4ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9427
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9067
Instance 4: Confidence=0.8978
Instance 5: Confidence=0.6321
tmp min: tensor(0.) tmp max: tensor(1.)
234 100 540 960
There are 14 prompts
current IoU is: 0.9255211353302002
Seok, iteration idx= 9 IoU = tensor(0.9255)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.6ms
Speed: 3.3ms preprocess, 24.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9471
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.9224
Instance 4: Confidence=0.8923
tmp min: tensor(0.) tmp max: tensor(1.)
248 136 540 960
There are 17 prompts
current IoU is: 0.9162531495094299
Seok, iteration idx= 10 IoU = tensor(0.9163)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.9ms
Speed: 1.4ms preprocess, 24.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9577
Instance 1: Confidence=0.9502
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8409
Instance 4: Confidence=0.8097
tmp min: tensor(0.) tmp max: tensor(1.)
519 132 540 960
There are 16 prompts
current IoU is: 0.9417842626571655
Seok, iteration idx= 11 IoU = tensor(0.9418)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9487
Instance 1: Confidence=0.9423
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.8932
Instance 4: Confidence=0.8345
Instance 5: Confidence=0.7952
tmp min: tensor(0.) tmp max: tensor(1.)
618 52 540 960
There are 16 prompts
current IoU is: 0.9156314134597778
Seok, iteration idx= 12 IoU = tensor(0.9156)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 1.9ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9542
Instance 1: Confidence=0.9452
Instance 2: Confidence=0.8901
Instance 3: Confidence=0.8789
Instance 4: Confidence=0.8606
Instance 5: Confidence=0.7636
tmp min: tensor(0.) tmp max: tensor(1.)
679 32 540 960
There are 16 prompts
current IoU is: 0.9382358193397522
Seok, iteration idx= 13 IoU = tensor(0.9382)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9550
Instance 1: Confidence=0.9468
Instance 2: Confidence=0.9211
Instance 3: Confidence=0.8658
Instance 4: Confidence=0.3527
Instance 5: Confidence=0.3313
Instance 6: Confidence=0.2660
tmp min: tensor(0.) tmp max: tensor(1.)
705 68 540 960
There are 15 prompts
current IoU is: 0.9319649934768677
Seok, iteration idx= 14 IoU = tensor(0.9320)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 8
Instance 0: Confidence=0.9684
Instance 1: Confidence=0.9498
Instance 2: Confidence=0.9438
Instance 3: Confidence=0.8761
Instance 4: Confidence=0.7452
Instance 5: Confidence=0.5554
Instance 6: Confidence=0.4846
Instance 7: Confidence=0.4124
tmp min: tensor(0.) tmp max: tensor(1.)
789 24 540 960
There are 14 prompts
current IoU is: 0.9597949981689453
Seok, iteration idx= 15 IoU = tensor(0.9598)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 27.0ms
Speed: 1.4ms preprocess, 27.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9710
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9314
Instance 3: Confidence=0.9307
Instance 4: Confidence=0.7829
Instance 5: Confidence=0.5400
tmp min: tensor(0.) tmp max: tensor(1.)
788 48 540 960
There are 14 prompts
current IoU is: 0.934177577495575
Seok, iteration idx= 16 IoU = tensor(0.9342)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 7
Instance 0: Confidence=0.9631
Instance 1: Confidence=0.9326
Instance 2: Confidence=0.9224
Instance 3: Confidence=0.8920
Instance 4: Confidence=0.8891
Instance 5: Confidence=0.5450
Instance 6: Confidence=0.4295
tmp min: tensor(0.) tmp max: tensor(1.)
730 68 540 960
There are 13 prompts
current IoU is: 0.9248368740081787
Seok, iteration idx= 17 IoU = tensor(0.9248)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 2.0ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 7
Instance 0: Confidence=0.9659
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9171
Instance 3: Confidence=0.8072
Instance 4: Confidence=0.7156
Instance 5: Confidence=0.4521
Instance 6: Confidence=0.3306
tmp min: tensor(0.) tmp max: tensor(1.)
739 56 540 960
There are 14 prompts
current IoU is: 0.8833252191543579
Seok, iteration idx= 18 IoU = tensor(0.8833)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.4ms preprocess, 24.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9671
Instance 1: Confidence=0.9570
Instance 2: Confidence=0.9262
Instance 3: Confidence=0.8464
Instance 4: Confidence=0.6664
tmp min: tensor(0.) tmp max: tensor(1.)
725 80 540 960
There are 15 prompts
current IoU is: 0.8234091997146606
Seok, iteration idx= 19 IoU = tensor(0.8234)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.5ms preprocess, 24.1ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9556
Instance 1: Confidence=0.9451
Instance 2: Confidence=0.9042
Instance 3: Confidence=0.7678
Instance 4: Confidence=0.6133
Instance 5: Confidence=0.3890
tmp min: tensor(0.) tmp max: tensor(1.)
720 88 540 960
There are 15 prompts
current IoU is: 0.7742658853530884
Seok, iteration idx= 20 IoU = tensor(0.7743)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.0ms
Speed: 2.6ms preprocess, 25.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9245
Instance 2: Confidence=0.9200
Instance 3: Confidence=0.7033
Instance 4: Confidence=0.6931
tmp min: tensor(0.) tmp max: tensor(1.)
660 132 540 960
There are 16 prompts
current IoU is: 0.7419168949127197
Seok, iteration idx= 21 IoU = tensor(0.7419)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 25.1ms
Speed: 2.6ms preprocess, 25.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 7
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9253
Instance 2: Confidence=0.8717
Instance 3: Confidence=0.8405
Instance 4: Confidence=0.5369
Instance 5: Confidence=0.3214
Instance 6: Confidence=0.2665
tmp min: tensor(0.) tmp max: tensor(1.)
645 92 540 960
There are 16 prompts
current IoU is: 0.7789291143417358
Seok, iteration idx= 22 IoU = tensor(0.7789)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 2.6ms preprocess, 24.0ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9479
Instance 2: Confidence=0.9416
Instance 3: Confidence=0.8988
Instance 4: Confidence=0.8421
tmp min: tensor(0.) tmp max: tensor(1.)
679 88 540 960
There are 19 prompts
current IoU is: 0.5127049684524536
Seok, iteration idx= 23 IoU = tensor(0.5127)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 2.4ms preprocess, 24.1ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9464
Instance 1: Confidence=0.9412
Instance 2: Confidence=0.9307
Instance 3: Confidence=0.8961
Instance 4: Confidence=0.8483
tmp min: tensor(0.) tmp max: tensor(1.)
550 0 540 960
There are 16 prompts
current IoU is: 0.0025670151226222515
Seok, iteration idx= 24 IoU = tensor(0.0026)
SKIP, unacceptable sam prediction, IoU is tensor(0.0026)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 2.5ms preprocess, 23.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9518
Instance 2: Confidence=0.9162
Instance 3: Confidence=0.8995
Instance 4: Confidence=0.8007
Instance 5: Confidence=0.7572
tmp min: tensor(0.) tmp max: tensor(1.)
615 68 540 960
There are 17 prompts
current IoU is: 0.7567696571350098
Seok, iteration idx= 25 IoU = tensor(0.7568)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.8ms
Speed: 2.2ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 8
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9354
Instance 2: Confidence=0.9341
Instance 3: Confidence=0.8591
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.6447
Instance 6: Confidence=0.4165
Instance 7: Confidence=0.2997
tmp min: tensor(0.) tmp max: tensor(1.)
618 76 540 960
There are 18 prompts
current IoU is: 0.6904292106628418
Seok, iteration idx= 26 IoU = tensor(0.6904)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.2ms
Speed: 1.4ms preprocess, 24.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 4
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9497
Instance 2: Confidence=0.9269
Instance 3: Confidence=0.9004
tmp min: tensor(0.) tmp max: tensor(1.)
567 76 540 960
There are 14 prompts
current IoU is: 0.7757025361061096
Seok, iteration idx= 27 IoU = tensor(0.7757)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 1.8ms preprocess, 22.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9441
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9204
Instance 3: Confidence=0.8937
Instance 4: Confidence=0.8811
Instance 5: Confidence=0.6694
tmp min: tensor(0.) tmp max: tensor(1.)
539 92 540 960
There are 16 prompts
current IoU is: 0.7997970581054688
Seok, iteration idx= 28 IoU = tensor(0.7998)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.6ms preprocess, 23.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9401
Instance 1: Confidence=0.9391
Instance 2: Confidence=0.9293
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9041
Instance 5: Confidence=0.8093
tmp min: tensor(0.) tmp max: tensor(1.)
542 96 540 960
There are 16 prompts
current IoU is: 0.8305214047431946
Seok, iteration idx= 29 IoU = tensor(0.8305)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.6ms
Speed: 1.4ms preprocess, 24.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 8
Instance 0: Confidence=0.9570
Instance 1: Confidence=0.9254
Instance 2: Confidence=0.9230
Instance 3: Confidence=0.9228
Instance 4: Confidence=0.9172
Instance 5: Confidence=0.5296
Instance 6: Confidence=0.4528
Instance 7: Confidence=0.3554
tmp min: tensor(0.) tmp max: tensor(1.)
526 100 540 960
There are 14 prompts
current IoU is: 0.6568201780319214
Seok, iteration idx= 30 IoU = tensor(0.6568)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9415
Instance 1: Confidence=0.9146
Instance 2: Confidence=0.9040
Instance 3: Confidence=0.8978
Instance 4: Confidence=0.8853
Instance 5: Confidence=0.3458
tmp min: tensor(0.) tmp max: tensor(1.)
473 128 540 960
There are 14 prompts
current IoU is: 0.2557142972946167
Seok, iteration idx= 31 IoU = tensor(0.2557)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set11_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set11_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:42<00:00,  1.33s/it]
Testing psnr 26.62242643535137 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set11_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:29<00:00,  1.09it/s]
Testing psnr 3.310410655103624 (avg)
train: coarse segmentation in 00:05:14
train: finish (eps time 00:05:15 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set11_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set12/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 38.61it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set12 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set12
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set12_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.6ms
Speed: 2.9ms preprocess, 25.6ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 26.1ms
Speed: 1.3ms preprocess, 26.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.3ms preprocess, 24.0ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.5ms preprocess, 20.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.6ms
Speed: 2.1ms preprocess, 21.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.5ms
Speed: 1.4ms preprocess, 21.5ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.0ms
Speed: 1.5ms preprocess, 21.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.5ms
Speed: 1.5ms preprocess, 21.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.3ms
Speed: 1.4ms preprocess, 21.3ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.0ms
Speed: 1.4ms preprocess, 21.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.2ms
Speed: 1.4ms preprocess, 21.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.8ms
Speed: 1.3ms preprocess, 21.8ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.8ms
Speed: 1.4ms preprocess, 20.8ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.6ms
Speed: 1.7ms preprocess, 20.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.8ms
Speed: 1.5ms preprocess, 20.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.4ms
Speed: 1.5ms preprocess, 20.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.5ms
Speed: 1.4ms preprocess, 21.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.4ms
Speed: 1.4ms preprocess, 20.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 1.6ms preprocess, 22.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.5ms preprocess, 20.5ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.9ms
Speed: 1.4ms preprocess, 20.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.6ms
Speed: 2.0ms preprocess, 20.6ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.5ms
Speed: 1.6ms preprocess, 20.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.4ms preprocess, 20.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.1ms
Speed: 1.4ms preprocess, 21.1ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 1.4ms preprocess, 20.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 2.4ms preprocess, 23.5ms inference, 3.5ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 20
view_order: [25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.7ms
Speed: 2.0ms preprocess, 21.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 4
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.8929
Instance 3: Confidence=0.7493
Selected instance: 0 (Confidence: 0.9367)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

464 52 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 13 prompts
current IoU is: 0.8216957449913025
Seok, iteration idx= 1 IoU = tensor(0.8217)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 2.5ms preprocess, 22.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9285
Instance 1: Confidence=0.8933
Instance 2: Confidence=0.8802
Instance 3: Confidence=0.7548
Instance 4: Confidence=0.6740
Instance 5: Confidence=0.4509
Selected instance: 2 (Confidence: 0.8802)
tmp min: tensor(0.) tmp max: tensor(1.)
448 64 540 960
There are 16 prompts
current IoU is: 0.8195018768310547
Seok, iteration idx= 2 IoU = tensor(0.8195)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9410
Instance 1: Confidence=0.9132
Instance 2: Confidence=0.8935
Instance 3: Confidence=0.8732
Instance 4: Confidence=0.5436
Selected instance: 4 (Confidence: 0.5436)
tmp min: tensor(0.) tmp max: tensor(1.)
454 84 540 960
There are 13 prompts
current IoU is: 0.4164774715900421
Seok, iteration idx= 3 IoU = tensor(0.4165)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9265
Instance 1: Confidence=0.9139
Instance 2: Confidence=0.8982
Instance 3: Confidence=0.8130
Instance 4: Confidence=0.7903
Selected instance: 4 (Confidence: 0.7903)
tmp min: tensor(0.) tmp max: tensor(1.)
498 32 540 960
current IoU is: 0.5123111009597778
Seok, iteration idx= 4 IoU = tensor(0.5123)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.5ms
Speed: 1.4ms preprocess, 21.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9261
Instance 2: Confidence=0.9165
Instance 3: Confidence=0.8297
Instance 4: Confidence=0.7494
Selected instance: 4 (Confidence: 0.7494)
tmp min: tensor(0.) tmp max: tensor(1.)
470 72 540 960
There are 18 prompts
current IoU is: 0.6662313342094421
Seok, iteration idx= 5 IoU = tensor(0.6662)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 2.5ms preprocess, 22.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9550
Instance 1: Confidence=0.9480
Instance 2: Confidence=0.9431
Instance 3: Confidence=0.9207
Instance 4: Confidence=0.5784
Selected instance: 4 (Confidence: 0.5784)
tmp min: tensor(0.) tmp max: tensor(1.)
473 44 540 960
There are 12 prompts
current IoU is: 0.40608012676239014
Seok, iteration idx= 6 IoU = tensor(0.4061)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.0ms
Speed: 3.3ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 4
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.8809
Selected instance: 2 (Confidence: 0.9333)
tmp min: tensor(0.) tmp max: tensor(1.)
499 20 540 960
There are 13 prompts
current IoU is: 0.012597787193953991
Seok, iteration idx= 7 IoU = tensor(0.0126)
SKIP, unacceptable sam prediction, IoU is tensor(0.0126)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.6ms
Speed: 2.5ms preprocess, 24.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9471
Instance 2: Confidence=0.9431
Instance 3: Confidence=0.6623
Instance 4: Confidence=0.2560
Selected instance: 4 (Confidence: 0.2560)
tmp min: tensor(0.) tmp max: tensor(1.)
483 160 540 960
There are 18 prompts
current IoU is: 0.12723255157470703
Seok, iteration idx= 8 IoU = tensor(0.1272)
SKIP, unacceptable sam prediction, IoU is tensor(0.1272)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 2.5ms preprocess, 22.2ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9649
Instance 1: Confidence=0.9461
Instance 2: Confidence=0.9441
Instance 3: Confidence=0.8727
Instance 4: Confidence=0.7388
Instance 5: Confidence=0.3397
Selected instance: 3 (Confidence: 0.8727)
tmp min: tensor(0.) tmp max: tensor(1.)
466 108 540 960
current IoU is: 0.5318893194198608
Seok, iteration idx= 9 IoU = tensor(0.5319)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.8ms
Speed: 2.6ms preprocess, 21.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9661
Instance 1: Confidence=0.9528
Instance 2: Confidence=0.9436
Instance 3: Confidence=0.9059
Instance 4: Confidence=0.7484
Selected instance: 3 (Confidence: 0.9059)
tmp min: tensor(0.) tmp max: tensor(1.)
455 108 540 960
There are 15 prompts
current IoU is: 0.7948145866394043
Seok, iteration idx= 10 IoU = tensor(0.7948)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.0ms
Speed: 2.8ms preprocess, 22.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9573
Instance 1: Confidence=0.9485
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.9090
Instance 4: Confidence=0.9048
Selected instance: 3 (Confidence: 0.9090)
tmp min: tensor(0.) tmp max: tensor(1.)
462 84 540 960
There are 16 prompts
current IoU is: 0.86366868019104
Seok, iteration idx= 11 IoU = tensor(0.8637)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9406
Instance 3: Confidence=0.9326
Instance 4: Confidence=0.8584
Selected instance: 2 (Confidence: 0.9406)
tmp min: tensor(0.) tmp max: tensor(1.)
476 100 540 960
There are 15 prompts
current IoU is: 0.8850719332695007
Seok, iteration idx= 12 IoU = tensor(0.8851)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 2.4ms preprocess, 22.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9605
Instance 1: Confidence=0.9523
Instance 2: Confidence=0.9335
Instance 3: Confidence=0.9316
Instance 4: Confidence=0.8775
Selected instance: 2 (Confidence: 0.9335)
tmp min: tensor(0.) tmp max: tensor(1.)
482 80 540 960
There are 15 prompts
current IoU is: 0.8947650194168091
Seok, iteration idx= 13 IoU = tensor(0.8948)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.9ms
Speed: 1.6ms preprocess, 24.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9609
Instance 1: Confidence=0.9444
Instance 2: Confidence=0.9416
Instance 3: Confidence=0.9373
Instance 4: Confidence=0.9147
Selected instance: 3 (Confidence: 0.9373)
tmp min: tensor(0.) tmp max: tensor(1.)
489 72 540 960
There are 16 prompts
current IoU is: 0.8452852368354797
Seok, iteration idx= 14 IoU = tensor(0.8453)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9470
Instance 1: Confidence=0.9424
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9360
Instance 4: Confidence=0.9339
Selected instance: 4 (Confidence: 0.9339)
tmp min: tensor(0.) tmp max: tensor(1.)
460 72 540 960
There are 13 prompts
current IoU is: 0.8796826004981995
Seok, iteration idx= 15 IoU = tensor(0.8797)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9436
Instance 3: Confidence=0.9424
Instance 4: Confidence=0.9320
Selected instance: 4 (Confidence: 0.9320)
tmp min: tensor(0.) tmp max: tensor(1.)
463 52 540 960
There are 15 prompts
current IoU is: 0.923650860786438
Seok, iteration idx= 16 IoU = tensor(0.9237)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9525
Instance 2: Confidence=0.9508
Instance 3: Confidence=0.9356
Instance 4: Confidence=0.9341
Selected instance: 3 (Confidence: 0.9356)
tmp min: tensor(0.) tmp max: tensor(1.)
496 52 540 960
There are 12 prompts
current IoU is: 0.9203158617019653
Seok, iteration idx= 17 IoU = tensor(0.9203)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.4ms
Speed: 1.4ms preprocess, 24.4ms inference, 5.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9560
Instance 1: Confidence=0.9556
Instance 2: Confidence=0.9446
Instance 3: Confidence=0.9356
Instance 4: Confidence=0.9297
Selected instance: 4 (Confidence: 0.9297)
tmp min: tensor(0.) tmp max: tensor(1.)
471 48 540 960
There are 15 prompts
current IoU is: 0.9280157089233398
Seok, iteration idx= 18 IoU = tensor(0.9280)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9584
Instance 1: Confidence=0.9531
Instance 2: Confidence=0.9364
Instance 3: Confidence=0.9357
Instance 4: Confidence=0.8459
Selected instance: 2 (Confidence: 0.9364)
tmp min: tensor(0.) tmp max: tensor(1.)
450 44 540 960
There are 12 prompts
current IoU is: 0.9377611875534058
Seok, iteration idx= 19 IoU = tensor(0.9378)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 5
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9486
Instance 2: Confidence=0.9481
Instance 3: Confidence=0.9425
Instance 4: Confidence=0.9152
Selected instance: 4 (Confidence: 0.9152)
tmp min: tensor(0.) tmp max: tensor(1.)
470 64 540 960
There are 13 prompts
current IoU is: 0.9159086346626282
Seok, iteration idx= 20 IoU = tensor(0.9159)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 3.2ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9641
Instance 1: Confidence=0.9486
Instance 2: Confidence=0.9464
Instance 3: Confidence=0.9459
Instance 4: Confidence=0.9247
Selected instance: 4 (Confidence: 0.9247)
tmp min: tensor(0.) tmp max: tensor(1.)
460 64 540 960
There are 12 prompts
current IoU is: 0.9226305484771729
Seok, iteration idx= 21 IoU = tensor(0.9226)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.5ms
Speed: 1.5ms preprocess, 24.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.9499
Instance 3: Confidence=0.9484
Instance 4: Confidence=0.9239
Selected instance: 4 (Confidence: 0.9239)
tmp min: tensor(0.) tmp max: tensor(1.)
459 56 540 960
There are 14 prompts
current IoU is: 0.9113767743110657
Seok, iteration idx= 22 IoU = tensor(0.9114)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 3.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9541
Instance 1: Confidence=0.9507
Instance 2: Confidence=0.9499
Instance 3: Confidence=0.9434
Instance 4: Confidence=0.9244
Selected instance: 4 (Confidence: 0.9244)
tmp min: tensor(0.) tmp max: tensor(1.)
459 56 540 960
There are 12 prompts
current IoU is: 0.9240895509719849
Seok, iteration idx= 23 IoU = tensor(0.9241)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.6ms
Speed: 4.7ms preprocess, 24.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9393
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.9061
Selected instance: 4 (Confidence: 0.9061)
tmp min: tensor(0.) tmp max: tensor(1.)
454 68 540 960
There are 14 prompts
current IoU is: 0.9067028164863586
Seok, iteration idx= 24 IoU = tensor(0.9067)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.5ms
Speed: 2.7ms preprocess, 24.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9574
Instance 1: Confidence=0.9514
Instance 2: Confidence=0.9313
Instance 3: Confidence=0.9223
Instance 4: Confidence=0.9072
Selected instance: 4 (Confidence: 0.9072)
tmp min: tensor(0.) tmp max: tensor(1.)
467 80 540 960
There are 16 prompts
current IoU is: 0.8798571228981018
Seok, iteration idx= 25 IoU = tensor(0.8799)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 3.2ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9655
Instance 1: Confidence=0.9410
Instance 2: Confidence=0.9096
Instance 3: Confidence=0.9021
Instance 4: Confidence=0.8728
Selected instance: 4 (Confidence: 0.8728)
tmp min: tensor(0.) tmp max: tensor(1.)
459 100 540 960
There are 16 prompts
current IoU is: 0.8340561389923096
Seok, iteration idx= 26 IoU = tensor(0.8341)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.6ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9578
Instance 1: Confidence=0.9251
Instance 2: Confidence=0.8965
Instance 3: Confidence=0.8850
Instance 4: Confidence=0.8000
Instance 5: Confidence=0.6041
Selected instance: 5 (Confidence: 0.6041)
tmp min: tensor(0.) tmp max: tensor(1.)
465 128 540 960
There are 15 prompts
current IoU is: 0.7737651467323303
Seok, iteration idx= 27 IoU = tensor(0.7738)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9413
Instance 3: Confidence=0.9286
Instance 4: Confidence=0.8911
Instance 5: Confidence=0.8629
Selected instance: 2 (Confidence: 0.9413)
tmp min: tensor(0.) tmp max: tensor(1.)
480 68 540 960
There are 13 prompts
current IoU is: 0.9321032762527466
Seok, iteration idx= 28 IoU = tensor(0.9321)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 1.3ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9563
Instance 1: Confidence=0.9416
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.9166
Instance 4: Confidence=0.6422
Instance 5: Confidence=0.3537
Instance 6: Confidence=0.3190
Selected instance: 3 (Confidence: 0.9166)
tmp min: tensor(0.) tmp max: tensor(1.)
454 76 540 960
There are 13 prompts
current IoU is: 0.9098125696182251
Seok, iteration idx= 29 IoU = tensor(0.9098)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9407
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9287
Instance 3: Confidence=0.9253
Instance 4: Confidence=0.5503
Instance 5: Confidence=0.4910
Selected instance: 1 (Confidence: 0.9303)
tmp min: tensor(0.) tmp max: tensor(1.)
464 112 540 960
There are 12 prompts
current IoU is: 0.9372000694274902
Seok, iteration idx= 30 IoU = tensor(0.9372)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 3.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9480
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.9271
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9137
Instance 5: Confidence=0.4320
Selected instance: 1 (Confidence: 0.9348)
tmp min: tensor(0.) tmp max: tensor(1.)
470 68 540 960
There are 15 prompts
current IoU is: 0.9135139584541321
Seok, iteration idx= 31 IoU = tensor(0.9135)
Selected Instance Confidence List: [tensor(0.9241), tensor(0.8677, device='cpu'), tensor(0.8438, device='cpu'), tensor(0.4673, device='cpu'), tensor(0.6235, device='cpu'), tensor(0.6995, device='cpu'), tensor(0.4750, device='cpu'), tensor(0.3809, device='cpu'), tensor(0.3872, device='cpu'), tensor(0.6682, device='cpu'), tensor(0.8392, device='cpu'), tensor(0.8818, device='cpu'), tensor(0.9073, device='cpu'), tensor(0.9103, device='cpu'), tensor(0.8821, device='cpu'), tensor(0.9014, device='cpu'), tensor(0.9270, device='cpu'), tensor(0.9264, device='cpu'), tensor(0.9287, device='cpu'), tensor(0.9372, device='cpu'), tensor(0.9156, device='cpu'), tensor(0.9234, device='cpu'), tensor(0.9164, device='cpu'), tensor(0.9242, device='cpu'), tensor(0.9065, device='cpu'), tensor(0.8908, device='cpu'), tensor(0.8495, device='cpu'), tensor(0.7450, device='cpu'), tensor(0.9358, device='cpu'), tensor(0.9125, device='cpu'), tensor(0.9344, device='cpu'), tensor(0.9220, device='cpu')]
Sorted Confidence Order: [tensor(0.9372, device='cpu'), tensor(0.9287, device='cpu'), tensor(0.9264, device='cpu'), tensor(0.9270, device='cpu'), tensor(0.9014, device='cpu'), tensor(0.8821, device='cpu'), tensor(0.9103, device='cpu'), tensor(0.9073, device='cpu'), tensor(0.9358, device='cpu'), tensor(0.9125, device='cpu'), tensor(0.9344, device='cpu'), tensor(0.9220, device='cpu'), tensor(0.9241), tensor(0.8677, device='cpu'), tensor(0.8438, device='cpu'), tensor(0.4673, device='cpu'), tensor(0.6235, device='cpu'), tensor(0.6995, device='cpu'), tensor(0.4750, device='cpu'), tensor(0.3809, device='cpu'), tensor(0.3872, device='cpu'), tensor(0.6682, device='cpu'), tensor(0.8392, device='cpu'), tensor(0.8818, device='cpu'), tensor(0.9156, device='cpu'), tensor(0.9234, device='cpu'), tensor(0.9164, device='cpu'), tensor(0.9242, device='cpu'), tensor(0.9065, device='cpu'), tensor(0.8908, device='cpu'), tensor(0.8495, device='cpu'), tensor(0.7450, device='cpu')]
sorted_indices: [19, 18, 17, 16, 15, 14, 13, 12, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 20, 21, 22, 23, 24, 25, 26, 27]
Initial view (highest confidence): 24
New training order: [8, 7, 6, 5, 4, 3, 2, 1, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 9, 10, 11, 12, 13, 14, 15, 16]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.7ms
Speed: 1.4ms preprocess, 21.7ms inference, 24.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9560
Instance 1: Confidence=0.9556
Instance 2: Confidence=0.9446
Instance 3: Confidence=0.9356
Instance 4: Confidence=0.9297
tmp min: tensor(0.) tmp max: tensor(1.)
471 48 540 960
There are 15 prompts
current IoU is: 0.9468582272529602
Seok, iteration idx= 1 IoU = tensor(0.9469)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.8ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 5
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9525
Instance 2: Confidence=0.9508
Instance 3: Confidence=0.9356
Instance 4: Confidence=0.9341
tmp min: tensor(0.) tmp max: tensor(1.)
496 52 540 960
There are 12 prompts
current IoU is: 0.9402276873588562
Seok, iteration idx= 2 IoU = tensor(0.9402)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9436
Instance 3: Confidence=0.9424
Instance 4: Confidence=0.9320
tmp min: tensor(0.) tmp max: tensor(1.)
463 52 540 960
There are 15 prompts
current IoU is: 0.9385098814964294
Seok, iteration idx= 3 IoU = tensor(0.9385)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 3.0ms preprocess, 22.9ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9470
Instance 1: Confidence=0.9424
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9360
Instance 4: Confidence=0.9339
tmp min: tensor(0.) tmp max: tensor(1.)
460 72 540 960
There are 13 prompts
current IoU is: 0.9354218244552612
Seok, iteration idx= 4 IoU = tensor(0.9354)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 2.6ms preprocess, 23.1ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9609
Instance 1: Confidence=0.9444
Instance 2: Confidence=0.9416
Instance 3: Confidence=0.9373
Instance 4: Confidence=0.9147
tmp min: tensor(0.) tmp max: tensor(1.)
489 72 540 960
There are 16 prompts
current IoU is: 0.9357836842536926
Seok, iteration idx= 5 IoU = tensor(0.9358)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 3.8ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9605
Instance 1: Confidence=0.9523
Instance 2: Confidence=0.9335
Instance 3: Confidence=0.9316
Instance 4: Confidence=0.8775
tmp min: tensor(0.) tmp max: tensor(1.)
482 80 540 960
There are 15 prompts
current IoU is: 0.9196199178695679
Seok, iteration idx= 6 IoU = tensor(0.9196)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 3.6ms preprocess, 23.6ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9406
Instance 3: Confidence=0.9326
Instance 4: Confidence=0.8584
tmp min: tensor(0.) tmp max: tensor(1.)
476 100 540 960
There are 15 prompts
current IoU is: 0.9049112796783447
Seok, iteration idx= 7 IoU = tensor(0.9049)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9413
Instance 3: Confidence=0.9286
Instance 4: Confidence=0.8911
Instance 5: Confidence=0.8629
tmp min: tensor(0.) tmp max: tensor(1.)
480 68 540 960
There are 13 prompts
current IoU is: 0.9446011185646057
Seok, iteration idx= 8 IoU = tensor(0.9446)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 7
Instance 0: Confidence=0.9563
Instance 1: Confidence=0.9416
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.9166
Instance 4: Confidence=0.6422
Instance 5: Confidence=0.3537
Instance 6: Confidence=0.3190
tmp min: tensor(0.) tmp max: tensor(1.)
454 76 540 960
There are 13 prompts
current IoU is: 0.9145342707633972
Seok, iteration idx= 9 IoU = tensor(0.9145)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9407
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9287
Instance 3: Confidence=0.9253
Instance 4: Confidence=0.5503
Instance 5: Confidence=0.4910
tmp min: tensor(0.) tmp max: tensor(1.)
464 112 540 960
There are 12 prompts
current IoU is: 0.9365328550338745
Seok, iteration idx= 10 IoU = tensor(0.9365)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.2ms
Speed: 1.8ms preprocess, 25.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9480
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.9271
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9137
Instance 5: Confidence=0.4320
tmp min: tensor(0.) tmp max: tensor(1.)
470 68 540 960
There are 15 prompts
current IoU is: 0.9317151308059692
Seok, iteration idx= 11 IoU = tensor(0.9317)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 7
Instance 0: Confidence=0.9241
Instance 1: Confidence=0.9137
Instance 2: Confidence=0.8986
Instance 3: Confidence=0.8831
Instance 4: Confidence=0.8546
Instance 5: Confidence=0.7726
Instance 6: Confidence=0.2917
tmp min: tensor(0.) tmp max: tensor(1.)
467 76 540 960
There are 17 prompts
current IoU is: 0.9144238233566284
Seok, iteration idx= 12 IoU = tensor(0.9144)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.1ms
Speed: 3.7ms preprocess, 23.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 4
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.8929
Instance 3: Confidence=0.7493
tmp min: tensor(0.) tmp max: tensor(1.)
464 52 540 960
There are 13 prompts
current IoU is: 0.924130916595459
Seok, iteration idx= 13 IoU = tensor(0.9241)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 2.8ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9285
Instance 1: Confidence=0.8933
Instance 2: Confidence=0.8802
Instance 3: Confidence=0.7548
Instance 4: Confidence=0.6740
Instance 5: Confidence=0.4509
tmp min: tensor(0.) tmp max: tensor(1.)
448 64 540 960
There are 16 prompts
current IoU is: 0.91788649559021
Seok, iteration idx= 14 IoU = tensor(0.9179)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 2.2ms preprocess, 24.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9410
Instance 1: Confidence=0.9132
Instance 2: Confidence=0.8935
Instance 3: Confidence=0.8732
Instance 4: Confidence=0.5436
tmp min: tensor(0.) tmp max: tensor(1.)
454 84 540 960
There are 13 prompts
current IoU is: 0.7616926431655884
Seok, iteration idx= 15 IoU = tensor(0.7617)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9265
Instance 1: Confidence=0.9139
Instance 2: Confidence=0.8982
Instance 3: Confidence=0.8130
Instance 4: Confidence=0.7903
tmp min: tensor(0.) tmp max: tensor(1.)
498 32 540 960
current IoU is: 0.717046856880188
Seok, iteration idx= 16 IoU = tensor(0.7170)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9261
Instance 2: Confidence=0.9165
Instance 3: Confidence=0.8297
Instance 4: Confidence=0.7494
tmp min: tensor(0.) tmp max: tensor(1.)
470 72 540 960
There are 18 prompts
current IoU is: 0.8306801915168762
Seok, iteration idx= 17 IoU = tensor(0.8307)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.3ms preprocess, 24.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9550
Instance 1: Confidence=0.9480
Instance 2: Confidence=0.9431
Instance 3: Confidence=0.9207
Instance 4: Confidence=0.5784
tmp min: tensor(0.) tmp max: tensor(1.)
473 44 540 960
There are 12 prompts
current IoU is: 0.4761236011981964
Seok, iteration idx= 18 IoU = tensor(0.4761)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.2ms
Speed: 3.3ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 4
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.8809
tmp min: tensor(0.) tmp max: tensor(1.)
499 20 540 960
There are 13 prompts
current IoU is: 0.014219415374100208
Seok, iteration idx= 19 IoU = tensor(0.0142)
SKIP, unacceptable sam prediction, IoU is tensor(0.0142)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 5
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9471
Instance 2: Confidence=0.9431
Instance 3: Confidence=0.6623
Instance 4: Confidence=0.2560
tmp min: tensor(0.) tmp max: tensor(1.)
483 160 540 960
There are 18 prompts
current IoU is: 0.3226160705089569
Seok, iteration idx= 20 IoU = tensor(0.3226)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 3.2ms preprocess, 23.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9649
Instance 1: Confidence=0.9461
Instance 2: Confidence=0.9441
Instance 3: Confidence=0.8727
Instance 4: Confidence=0.7388
Instance 5: Confidence=0.3397
tmp min: tensor(0.) tmp max: tensor(1.)
466 108 540 960
current IoU is: 0.8969240188598633
Seok, iteration idx= 21 IoU = tensor(0.8969)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 3.3ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9661
Instance 1: Confidence=0.9528
Instance 2: Confidence=0.9436
Instance 3: Confidence=0.9059
Instance 4: Confidence=0.7484
tmp min: tensor(0.) tmp max: tensor(1.)
455 108 540 960
There are 15 prompts
current IoU is: 0.9079203605651855
Seok, iteration idx= 22 IoU = tensor(0.9079)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 2.9ms preprocess, 23.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9573
Instance 1: Confidence=0.9485
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.9090
Instance 4: Confidence=0.9048
tmp min: tensor(0.) tmp max: tensor(1.)
462 84 540 960
There are 16 prompts
current IoU is: 0.9066829085350037
Seok, iteration idx= 23 IoU = tensor(0.9067)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 3.3ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9486
Instance 2: Confidence=0.9481
Instance 3: Confidence=0.9425
Instance 4: Confidence=0.9152
tmp min: tensor(0.) tmp max: tensor(1.)
470 64 540 960
There are 13 prompts
current IoU is: 0.936772346496582
Seok, iteration idx= 24 IoU = tensor(0.9368)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.0ms
Speed: 2.9ms preprocess, 25.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9641
Instance 1: Confidence=0.9486
Instance 2: Confidence=0.9464
Instance 3: Confidence=0.9459
Instance 4: Confidence=0.9247
tmp min: tensor(0.) tmp max: tensor(1.)
460 64 540 960
There are 12 prompts
current IoU is: 0.9409230351448059
Seok, iteration idx= 25 IoU = tensor(0.9409)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.2ms
Speed: 1.4ms preprocess, 25.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.9499
Instance 3: Confidence=0.9484
Instance 4: Confidence=0.9239
tmp min: tensor(0.) tmp max: tensor(1.)
459 56 540 960
There are 14 prompts
current IoU is: 0.9329044818878174
Seok, iteration idx= 26 IoU = tensor(0.9329)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.6ms
Speed: 1.4ms preprocess, 24.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9541
Instance 1: Confidence=0.9507
Instance 2: Confidence=0.9499
Instance 3: Confidence=0.9434
Instance 4: Confidence=0.9244
tmp min: tensor(0.) tmp max: tensor(1.)
459 56 540 960
There are 12 prompts
current IoU is: 0.9447215795516968
Seok, iteration idx= 27 IoU = tensor(0.9447)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.4ms
Speed: 1.4ms preprocess, 25.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9393
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.9061
tmp min: tensor(0.) tmp max: tensor(1.)
454 68 540 960
There are 14 prompts
current IoU is: 0.9209529161453247
Seok, iteration idx= 28 IoU = tensor(0.9210)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9574
Instance 1: Confidence=0.9514
Instance 2: Confidence=0.9313
Instance 3: Confidence=0.9223
Instance 4: Confidence=0.9072
tmp min: tensor(0.) tmp max: tensor(1.)
467 80 540 960
There are 16 prompts
current IoU is: 0.8977946639060974
Seok, iteration idx= 29 IoU = tensor(0.8978)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9655
Instance 1: Confidence=0.9410
Instance 2: Confidence=0.9096
Instance 3: Confidence=0.9021
Instance 4: Confidence=0.8728
tmp min: tensor(0.) tmp max: tensor(1.)
459 100 540 960
There are 16 prompts
current IoU is: 0.8510224223136902
Seok, iteration idx= 30 IoU = tensor(0.8510)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.9ms
Speed: 1.4ms preprocess, 24.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9578
Instance 1: Confidence=0.9251
Instance 2: Confidence=0.8965
Instance 3: Confidence=0.8850
Instance 4: Confidence=0.8000
Instance 5: Confidence=0.6041
tmp min: tensor(0.) tmp max: tensor(1.)
465 128 540 960
There are 15 prompts
current IoU is: 0.8209820985794067
Seok, iteration idx= 31 IoU = tensor(0.8210)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set12_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set12_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:43<00:00,  1.35s/it]
Testing psnr 27.958649843931198 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set12_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:29<00:00,  1.09it/s]
Testing psnr 3.3100634161382914 (avg)
train: coarse segmentation in 02:56:10
train: finish (eps time 02:56:11 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set12_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set13/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 47.15it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set13 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set13
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set13_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 19.9ms
Speed: 3.2ms preprocess, 19.9ms inference, 2.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.4ms
Speed: 1.2ms preprocess, 20.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 21.6ms
Speed: 1.3ms preprocess, 21.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.9ms
Speed: 1.2ms preprocess, 20.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.0ms
Speed: 1.3ms preprocess, 22.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.2ms
Speed: 1.3ms preprocess, 20.2ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.4ms
Speed: 1.2ms preprocess, 20.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.3ms
Speed: 1.2ms preprocess, 20.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.9ms
Speed: 1.2ms preprocess, 20.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.7ms
Speed: 1.3ms preprocess, 19.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.7ms
Speed: 1.3ms preprocess, 21.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.2ms
Speed: 1.2ms preprocess, 22.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.2ms
Speed: 1.3ms preprocess, 20.2ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.6ms
Speed: 1.2ms preprocess, 20.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.3ms
Speed: 1.4ms preprocess, 20.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.9ms
Speed: 1.3ms preprocess, 19.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.6ms
Speed: 1.2ms preprocess, 20.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.5ms
Speed: 1.2ms preprocess, 21.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.9ms
Speed: 1.2ms preprocess, 19.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.1ms
Speed: 1.3ms preprocess, 21.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.7ms
Speed: 1.3ms preprocess, 20.7ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.2ms
Speed: 1.3ms preprocess, 20.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.9ms
Speed: 1.3ms preprocess, 19.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.1ms
Speed: 1.4ms preprocess, 20.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 1.3ms preprocess, 20.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.2ms preprocess, 20.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.2ms preprocess, 20.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.2ms
Speed: 3.7ms preprocess, 21.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 25
view_order: [30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.6ms
Speed: 1.2ms preprocess, 20.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9473
Instance 1: Confidence=0.9204
Instance 2: Confidence=0.9187
Instance 3: Confidence=0.9093
Instance 4: Confidence=0.7686
Selected instance: 2 (Confidence: 0.9187)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

955 124 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 15 prompts
current IoU is: 0.7058976888656616
Seok, iteration idx= 1 IoU = tensor(0.7059)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.1ms
Speed: 2.9ms preprocess, 22.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 4
Instance 0: Confidence=0.9493
Instance 1: Confidence=0.9198
Instance 2: Confidence=0.9132
Instance 3: Confidence=0.8117
Selected instance: 0 (Confidence: 0.9493)
tmp min: tensor(0.) tmp max: tensor(1.)
816 48 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 2 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.8ms
Speed: 1.7ms preprocess, 21.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9467
Instance 1: Confidence=0.9218
Instance 2: Confidence=0.9005
Instance 3: Confidence=0.8803
Instance 4: Confidence=0.8561
Selected instance: 0 (Confidence: 0.9467)
tmp min: tensor(0.) tmp max: tensor(1.)
797 112 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 3 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9544
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9241
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.7200
Selected instance: 0 (Confidence: 0.9544)
tmp min: tensor(0.) tmp max: tensor(1.)
866 80 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 4 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.9ms
Speed: 3.2ms preprocess, 21.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9280
Instance 2: Confidence=0.9266
Instance 3: Confidence=0.9235
Instance 4: Confidence=0.7901
Selected instance: 0 (Confidence: 0.9430)
tmp min: tensor(0.) tmp max: tensor(1.)
867 68 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 5 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 2.6ms preprocess, 22.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9459
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9226
Instance 3: Confidence=0.9140
Instance 4: Confidence=0.6220
Selected instance: 0 (Confidence: 0.9459)
tmp min: tensor(0.) tmp max: tensor(1.)
923 44 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 6 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 24.1ms
Speed: 2.8ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 1
Instance 0: Confidence=0.9169
Selected instance: 0 (Confidence: 0.9169)
tmp min: tensor(0.) tmp max: tensor(1.)
200 88 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 7 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.5ms
Speed: 1.5ms preprocess, 22.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 1
Instance 0: Confidence=0.9297
Selected instance: 0 (Confidence: 0.9297)
tmp min: tensor(0.) tmp max: tensor(1.)
208 76 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 8 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.0ms
Speed: 1.3ms preprocess, 22.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 1
Instance 0: Confidence=0.9227
Selected instance: 0 (Confidence: 0.9227)
tmp min: tensor(0.) tmp max: tensor(1.)
220 68 540 960
There are 15 prompts
current IoU is: 0.0011423735413700342
Seok, iteration idx= 9 IoU = tensor(0.0011)
SKIP, unacceptable sam prediction, IoU is tensor(0.0011)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.5ms
Speed: 1.3ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 1
Instance 0: Confidence=0.9274
Selected instance: 0 (Confidence: 0.9274)
tmp min: tensor(0.) tmp max: tensor(1.)
226 68 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 10 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 1
Instance 0: Confidence=0.9171
Selected instance: 0 (Confidence: 0.9171)
tmp min: tensor(0.) tmp max: tensor(1.)
239 48 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 11 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 1
Instance 0: Confidence=0.9199
Selected instance: 0 (Confidence: 0.9199)
tmp min: tensor(0.) tmp max: tensor(1.)
296 60 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 12 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 3.0ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9370
Instance 1: Confidence=0.9239
Selected instance: 0 (Confidence: 0.9370)
tmp min: tensor(0.) tmp max: tensor(1.)
2 100 540 960
There are 19 prompts
current IoU is: 0.6055564284324646
Seok, iteration idx= 13 IoU = tensor(0.6056)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 3.0ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9040
Selected instance: 0 (Confidence: 0.9483)
tmp min: tensor(0.) tmp max: tensor(1.)
48 116 540 960
There are 16 prompts
current IoU is: 0.687727689743042
Seok, iteration idx= 14 IoU = tensor(0.6877)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.4ms
Speed: 3.8ms preprocess, 22.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 4
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9207
Instance 2: Confidence=0.8929
Instance 3: Confidence=0.5436
Selected instance: 0 (Confidence: 0.9460)
tmp min: tensor(0.) tmp max: tensor(1.)
929 16 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 15 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.6ms
Speed: 2.9ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 3
Instance 0: Confidence=0.9560
Instance 1: Confidence=0.8635
Instance 2: Confidence=0.7620
Selected instance: 0 (Confidence: 0.9560)
tmp min: tensor(0.) tmp max: tensor(1.)
922 4 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 16 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9567
Instance 1: Confidence=0.7969
Selected instance: 0 (Confidence: 0.9567)
tmp min: tensor(0.) tmp max: tensor(1.)
881 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 17 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.9ms
Speed: 2.9ms preprocess, 21.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 3
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.7888
Instance 2: Confidence=0.4837
Selected instance: 0 (Confidence: 0.9593)
tmp min: tensor(0.) tmp max: tensor(1.)
848 0 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 18 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 4
Instance 0: Confidence=0.9485
Instance 1: Confidence=0.7439
Instance 2: Confidence=0.5048
Instance 3: Confidence=0.2655
Selected instance: 0 (Confidence: 0.9485)
tmp min: tensor(0.) tmp max: tensor(1.)
754 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 19 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 1.3ms preprocess, 22.4ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9561
Instance 1: Confidence=0.6777
Selected instance: 0 (Confidence: 0.9561)
tmp min: tensor(0.) tmp max: tensor(1.)
691 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 20 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9415
Instance 1: Confidence=0.7778
Selected instance: 0 (Confidence: 0.9415)
tmp min: tensor(0.) tmp max: tensor(1.)
611 12 540 960
There are 14 prompts
current IoU is: 9.611423593014479e-05
Seok, iteration idx= 21 IoU = tensor(9.6114e-05)
SKIP, unacceptable sam prediction, IoU is tensor(9.6114e-05)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 1.5ms preprocess, 22.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 2
Instance 0: Confidence=0.9420
Instance 1: Confidence=0.8016
Selected instance: 0 (Confidence: 0.9420)
tmp min: tensor(0.) tmp max: tensor(1.)
535 56 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 22 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 2.5ms preprocess, 22.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9039
Selected instance: 0 (Confidence: 0.9435)
tmp min: tensor(0.) tmp max: tensor(1.)
158 100 540 960
There are 15 prompts
current IoU is: 0.754240870475769
Seok, iteration idx= 23 IoU = tensor(0.7542)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 3.4ms preprocess, 22.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9440
Instance 1: Confidence=0.9201
Selected instance: 0 (Confidence: 0.9440)
tmp min: tensor(0.) tmp max: tensor(1.)
198 120 540 960
There are 16 prompts
current IoU is: 0.810888946056366
Seok, iteration idx= 24 IoU = tensor(0.8109)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 2.8ms preprocess, 22.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9452
Instance 1: Confidence=0.9129
Selected instance: 0 (Confidence: 0.9452)
tmp min: tensor(0.) tmp max: tensor(1.)
259 148 540 960
There are 15 prompts
current IoU is: 0.7800606489181519
Seok, iteration idx= 25 IoU = tensor(0.7801)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.4ms
Speed: 2.9ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 3
Instance 0: Confidence=0.9407
Instance 1: Confidence=0.9229
Instance 2: Confidence=0.9179
Selected instance: 0 (Confidence: 0.9407)
tmp min: tensor(0.) tmp max: tensor(1.)
371 96 540 960
There are 15 prompts
current IoU is: 0.7532523274421692
Seok, iteration idx= 26 IoU = tensor(0.7533)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.7ms
Speed: 2.4ms preprocess, 23.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 3
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9345
Instance 2: Confidence=0.9300
Selected instance: 1 (Confidence: 0.9345)
tmp min: tensor(0.) tmp max: tensor(1.)
485 112 540 960
There are 16 prompts
current IoU is: 0.7533950805664062
Seok, iteration idx= 27 IoU = tensor(0.7534)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.2ms
Speed: 3.7ms preprocess, 22.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 4
Instance 0: Confidence=0.9410
Instance 1: Confidence=0.9318
Instance 2: Confidence=0.9127
Instance 3: Confidence=0.5230
Selected instance: 2 (Confidence: 0.9127)
tmp min: tensor(0.) tmp max: tensor(1.)
542 96 540 960
There are 13 prompts
current IoU is: 0.8086941242218018
Seok, iteration idx= 28 IoU = tensor(0.8087)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.9ms
Speed: 3.2ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 4
Instance 0: Confidence=0.9267
Instance 1: Confidence=0.9262
Instance 2: Confidence=0.9231
Instance 3: Confidence=0.4524
Selected instance: 3 (Confidence: 0.4524)
tmp min: tensor(0.) tmp max: tensor(1.)
613 108 540 960
There are 15 prompts
current IoU is: 0.5249795317649841
Seok, iteration idx= 29 IoU = tensor(0.5250)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.6ms
Speed: 3.2ms preprocess, 23.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 4
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9273
Instance 2: Confidence=0.9198
Instance 3: Confidence=0.7961
Selected instance: 0 (Confidence: 0.9367)
tmp min: tensor(0.) tmp max: tensor(1.)
707 52 540 960
There are 13 prompts
current IoU is: 0.006575226318091154
Seok, iteration idx= 30 IoU = tensor(0.0066)
SKIP, unacceptable sam prediction, IoU is tensor(0.0066)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9217
Instance 2: Confidence=0.9215
Instance 3: Confidence=0.9189
Instance 4: Confidence=0.8922
Selected instance: 1 (Confidence: 0.9217)
tmp min: tensor(0.) tmp max: tensor(1.)
840 76 540 960
There are 14 prompts
current IoU is: 0.7992064952850342
Seok, iteration idx= 31 IoU = tensor(0.7992)
Selected Instance Confidence List: [tensor(0.9408), tensor(0.7910, device='cpu'), tensor(0.3797, device='cpu'), tensor(0.3787, device='cpu'), tensor(0.3818, device='cpu'), tensor(0.3772, device='cpu'), tensor(0.3784, device='cpu'), tensor(0.3667, device='cpu'), tensor(0.3719, device='cpu'), tensor(0.3698, device='cpu'), tensor(0.3710, device='cpu'), tensor(0.3668, device='cpu'), tensor(0.3680, device='cpu'), tensor(0.7381, device='cpu'), tensor(0.7920, device='cpu'), tensor(0.3784, device='cpu'), tensor(0.3824, device='cpu'), tensor(0.3827, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3794, device='cpu'), tensor(0.3824, device='cpu'), tensor(0.3767, device='cpu'), tensor(0.3768, device='cpu'), tensor(0.8299, device='cpu'), tensor(0.8642, device='cpu'), tensor(0.8461, device='cpu'), tensor(0.8282, device='cpu'), tensor(0.8258, device='cpu'), tensor(0.8503, device='cpu'), tensor(0.4959, device='cpu'), tensor(0.3786, device='cpu'), tensor(0.8482, device='cpu')]
Sorted Confidence Order: [tensor(0.9408), tensor(0.8482, device='cpu'), tensor(0.3786, device='cpu'), tensor(0.4959, device='cpu'), tensor(0.8503, device='cpu'), tensor(0.8258, device='cpu'), tensor(0.8282, device='cpu'), tensor(0.8461, device='cpu'), tensor(0.8642, device='cpu'), tensor(0.8299, device='cpu'), tensor(0.7920, device='cpu'), tensor(0.7381, device='cpu'), tensor(0.3680, device='cpu'), tensor(0.3668, device='cpu'), tensor(0.3710, device='cpu'), tensor(0.3698, device='cpu'), tensor(0.3719, device='cpu'), tensor(0.3667, device='cpu'), tensor(0.3768, device='cpu'), tensor(0.3767, device='cpu'), tensor(0.3824, device='cpu'), tensor(0.3794, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3827, device='cpu'), tensor(0.3824, device='cpu'), tensor(0.3784, device='cpu'), tensor(0.3784, device='cpu'), tensor(0.3772, device='cpu'), tensor(0.3818, device='cpu'), tensor(0.3787, device='cpu'), tensor(0.3797, device='cpu'), tensor(0.7910, device='cpu')]
sorted_indices: [0, 31, 30, 29, 28, 27, 26, 25, 24, 23, 14, 13, 12, 11, 10, 9, 8, 7, 22, 21, 20, 19, 18, 17, 16, 15, 6, 5, 4, 3, 2, 1]
Initial view (highest confidence): 1
New training order: [30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15, 14, 13, 12, 11, 10, 9, 36, 35, 34, 33, 32, 31]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.4ms preprocess, 20.4ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9217
Instance 2: Confidence=0.9215
Instance 3: Confidence=0.9189
Instance 4: Confidence=0.8922
tmp min: tensor(0.) tmp max: tensor(1.)
840 76 540 960
There are 14 prompts
current IoU is: 0.7484450340270996
Seok, iteration idx= 1 IoU = tensor(0.7484)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.2ms
Speed: 3.8ms preprocess, 22.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 4
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9273
Instance 2: Confidence=0.9198
Instance 3: Confidence=0.7961
tmp min: tensor(0.) tmp max: tensor(1.)
707 52 540 960
There are 13 prompts
current IoU is: 0.005592524539679289
Seok, iteration idx= 2 IoU = tensor(0.0056)
SKIP, unacceptable sam prediction, IoU is tensor(0.0056)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 4
Instance 0: Confidence=0.9267
Instance 1: Confidence=0.9262
Instance 2: Confidence=0.9231
Instance 3: Confidence=0.4524
tmp min: tensor(0.) tmp max: tensor(1.)
613 108 540 960
There are 15 prompts
current IoU is: 0.5575379133224487
Seok, iteration idx= 3 IoU = tensor(0.5575)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.4ms
Speed: 1.3ms preprocess, 22.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 4
Instance 0: Confidence=0.9410
Instance 1: Confidence=0.9318
Instance 2: Confidence=0.9127
Instance 3: Confidence=0.5230
tmp min: tensor(0.) tmp max: tensor(1.)
542 96 540 960
There are 13 prompts
current IoU is: 0.7857393622398376
Seok, iteration idx= 4 IoU = tensor(0.7857)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.8ms
Speed: 1.3ms preprocess, 22.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 3
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9345
Instance 2: Confidence=0.9300
tmp min: tensor(0.) tmp max: tensor(1.)
485 112 540 960
There are 16 prompts
current IoU is: 0.7484594583511353
Seok, iteration idx= 5 IoU = tensor(0.7485)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 3
Instance 0: Confidence=0.9407
Instance 1: Confidence=0.9229
Instance 2: Confidence=0.9179
tmp min: tensor(0.) tmp max: tensor(1.)
371 96 540 960
There are 15 prompts
current IoU is: 0.7672250270843506
Seok, iteration idx= 6 IoU = tensor(0.7672)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9452
Instance 1: Confidence=0.9129
tmp min: tensor(0.) tmp max: tensor(1.)
259 148 540 960
There are 15 prompts
current IoU is: 0.7960066795349121
Seok, iteration idx= 7 IoU = tensor(0.7960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 1.6ms preprocess, 22.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9440
Instance 1: Confidence=0.9201
tmp min: tensor(0.) tmp max: tensor(1.)
198 120 540 960
There are 16 prompts
current IoU is: 0.8407941460609436
Seok, iteration idx= 8 IoU = tensor(0.8408)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9039
tmp min: tensor(0.) tmp max: tensor(1.)
158 100 540 960
There are 15 prompts
current IoU is: 0.8409839868545532
Seok, iteration idx= 9 IoU = tensor(0.8410)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9040
tmp min: tensor(0.) tmp max: tensor(1.)
48 116 540 960
There are 16 prompts
current IoU is: 0.7987767457962036
Seok, iteration idx= 10 IoU = tensor(0.7988)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 3.5ms preprocess, 22.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9370
Instance 1: Confidence=0.9239
tmp min: tensor(0.) tmp max: tensor(1.)
2 100 540 960
There are 19 prompts
current IoU is: 0.6927290558815002
Seok, iteration idx= 11 IoU = tensor(0.6927)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.9ms
Speed: 2.4ms preprocess, 23.9ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 1
Instance 0: Confidence=0.9199
tmp min: tensor(0.) tmp max: tensor(1.)
296 60 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 12 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.1ms
Speed: 2.5ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 1
Instance 0: Confidence=0.9171
tmp min: tensor(0.) tmp max: tensor(1.)
239 48 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 13 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.2ms
Speed: 2.4ms preprocess, 22.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 1
Instance 0: Confidence=0.9274
tmp min: tensor(0.) tmp max: tensor(1.)
226 68 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 14 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 1
Instance 0: Confidence=0.9227
tmp min: tensor(0.) tmp max: tensor(1.)
220 68 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 15 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 1
Instance 0: Confidence=0.9297
tmp min: tensor(0.) tmp max: tensor(1.)
208 76 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 16 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 1
Instance 0: Confidence=0.9169
tmp min: tensor(0.) tmp max: tensor(1.)
200 88 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 17 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 1.6ms preprocess, 22.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9420
Instance 1: Confidence=0.8016
tmp min: tensor(0.) tmp max: tensor(1.)
535 56 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 18 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9415
Instance 1: Confidence=0.7778
tmp min: tensor(0.) tmp max: tensor(1.)
611 12 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 19 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9561
Instance 1: Confidence=0.6777
tmp min: tensor(0.) tmp max: tensor(1.)
691 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 20 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 4
Instance 0: Confidence=0.9485
Instance 1: Confidence=0.7439
Instance 2: Confidence=0.5048
Instance 3: Confidence=0.2655
tmp min: tensor(0.) tmp max: tensor(1.)
754 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 21 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.8ms
Speed: 2.3ms preprocess, 22.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 3
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.7888
Instance 2: Confidence=0.4837
tmp min: tensor(0.) tmp max: tensor(1.)
848 0 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 22 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.7ms
Speed: 2.7ms preprocess, 23.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9567
Instance 1: Confidence=0.7969
tmp min: tensor(0.) tmp max: tensor(1.)
881 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 23 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.6ms
Speed: 3.4ms preprocess, 23.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 3
Instance 0: Confidence=0.9560
Instance 1: Confidence=0.8635
Instance 2: Confidence=0.7620
tmp min: tensor(0.) tmp max: tensor(1.)
922 4 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 24 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 4
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9207
Instance 2: Confidence=0.8929
Instance 3: Confidence=0.5436
tmp min: tensor(0.) tmp max: tensor(1.)
929 16 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 25 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9459
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9226
Instance 3: Confidence=0.9140
Instance 4: Confidence=0.6220
tmp min: tensor(0.) tmp max: tensor(1.)
923 44 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 26 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9280
Instance 2: Confidence=0.9266
Instance 3: Confidence=0.9235
Instance 4: Confidence=0.7901
tmp min: tensor(0.) tmp max: tensor(1.)
867 68 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 27 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.6ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9544
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9241
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.7200
tmp min: tensor(0.) tmp max: tensor(1.)
866 80 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 28 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9467
Instance 1: Confidence=0.9218
Instance 2: Confidence=0.9005
Instance 3: Confidence=0.8803
Instance 4: Confidence=0.8561
tmp min: tensor(0.) tmp max: tensor(1.)
797 112 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 29 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 4
Instance 0: Confidence=0.9493
Instance 1: Confidence=0.9198
Instance 2: Confidence=0.9132
Instance 3: Confidence=0.8117
tmp min: tensor(0.) tmp max: tensor(1.)
816 48 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 30 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9473
Instance 1: Confidence=0.9204
Instance 2: Confidence=0.9187
Instance 3: Confidence=0.9093
Instance 4: Confidence=0.7686
tmp min: tensor(0.) tmp max: tensor(1.)
955 124 540 960
There are 15 prompts
current IoU is: 0.7926136255264282
Seok, iteration idx= 31 IoU = tensor(0.7926)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set13_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set13_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.23s/it]
Testing psnr 29.099098816514015 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set13_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:26<00:00,  1.20it/s]
Testing psnr 3.5549439396709204 (avg)
train: coarse segmentation in 00:04:12
train: finish (eps time 00:04:12 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set13_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
