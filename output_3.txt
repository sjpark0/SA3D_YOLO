Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set1/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 35.84it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set1 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set1
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set1_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 3.1ms preprocess, 20.2ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.7ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 1.2ms preprocess, 20.7ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.5ms preprocess, 18.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.1ms
Speed: 1.8ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.8ms
Speed: 1.2ms preprocess, 19.8ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.3ms
Speed: 1.3ms preprocess, 19.3ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.2ms
Speed: 1.4ms preprocess, 19.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.6ms
Speed: 2.0ms preprocess, 18.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.4ms
Speed: 1.4ms preprocess, 19.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.9ms
Speed: 3.8ms preprocess, 22.9ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 20
view_order: [25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.7ms
Speed: 2.0ms preprocess, 20.7ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9656
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8572
Instance 5: Confidence=0.7074
Selected instance: 2 (Confidence: 0.9333)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

474 48 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 15 prompts
current IoU is: 0.7801403403282166
Seok, iteration idx= 1 IoU = tensor(0.7801)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.7ms preprocess, 23.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9558
Instance 1: Confidence=0.9384
Instance 2: Confidence=0.9350
Instance 3: Confidence=0.9330
Instance 4: Confidence=0.8556
Instance 5: Confidence=0.8479
Selected instance: 2 (Confidence: 0.9350)
tmp min: tensor(0.) tmp max: tensor(1.)
428 60 540 960
There are 17 prompts
current IoU is: 0.8204696178436279
Seok, iteration idx= 2 IoU = tensor(0.8205)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9492
Instance 1: Confidence=0.9473
Instance 2: Confidence=0.8976
Instance 3: Confidence=0.8878
Instance 4: Confidence=0.7385
Selected instance: 0 (Confidence: 0.9492)
tmp min: tensor(0.) tmp max: tensor(1.)
435 52 540 960
There are 16 prompts
current IoU is: 0.9037865996360779
Seok, iteration idx= 3 IoU = tensor(0.9038)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.8ms
Speed: 1.6ms preprocess, 21.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9493
Instance 1: Confidence=0.9481
Instance 2: Confidence=0.9454
Instance 3: Confidence=0.8710
Instance 4: Confidence=0.5295
Instance 5: Confidence=0.5013
Selected instance: 0 (Confidence: 0.9493)
tmp min: tensor(0.) tmp max: tensor(1.)
434 28 540 960
There are 15 prompts
current IoU is: 0.932615339756012
Seok, iteration idx= 4 IoU = tensor(0.9326)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.0ms
Speed: 1.5ms preprocess, 22.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9719
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9354
Instance 3: Confidence=0.8589
Instance 4: Confidence=0.5243
Selected instance: 1 (Confidence: 0.9575)
tmp min: tensor(0.) tmp max: tensor(1.)
385 76 540 960
There are 19 prompts
current IoU is: 0.942866861820221
Seok, iteration idx= 5 IoU = tensor(0.9429)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 1.3ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9585
Instance 2: Confidence=0.9417
Instance 3: Confidence=0.9039
Instance 4: Confidence=0.8364
Instance 5: Confidence=0.4622
Selected instance: 1 (Confidence: 0.9585)
tmp min: tensor(0.) tmp max: tensor(1.)
374 44 540 960
There are 18 prompts
current IoU is: 0.8863539695739746
Seok, iteration idx= 6 IoU = tensor(0.8864)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.3ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9523
Instance 2: Confidence=0.9520
Instance 3: Confidence=0.8925
Instance 4: Confidence=0.6584
Selected instance: 1 (Confidence: 0.9523)
tmp min: tensor(0.) tmp max: tensor(1.)
368 60 540 960
There are 15 prompts
current IoU is: 0.9091528058052063
Seok, iteration idx= 7 IoU = tensor(0.9092)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9462
Instance 2: Confidence=0.9264
Instance 3: Confidence=0.8582
Instance 4: Confidence=0.8035
Instance 5: Confidence=0.7958
Instance 6: Confidence=0.3784
Selected instance: 0 (Confidence: 0.9607)
tmp min: tensor(0.) tmp max: tensor(1.)
353 136 540 960
There are 16 prompts
current IoU is: 0.9130512475967407
Seok, iteration idx= 8 IoU = tensor(0.9131)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.0ms
Speed: 1.3ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 4
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9397
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.9188
Selected instance: 1 (Confidence: 0.9397)
tmp min: tensor(0.) tmp max: tensor(1.)
348 108 540 960
There are 16 prompts
current IoU is: 0.8765360713005066
Seok, iteration idx= 9 IoU = tensor(0.8765)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 4
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9233
Instance 2: Confidence=0.8993
Instance 3: Confidence=0.7667
Selected instance: 2 (Confidence: 0.8993)
tmp min: tensor(0.) tmp max: tensor(1.)
354 72 540 960
There are 15 prompts
current IoU is: 0.09102606773376465
Seok, iteration idx= 10 IoU = tensor(0.0910)
SKIP, unacceptable sam prediction, IoU is tensor(0.0910)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.9ms
Speed: 2.8ms preprocess, 21.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9608
Instance 1: Confidence=0.9321
Instance 2: Confidence=0.9267
Instance 3: Confidence=0.6191
Instance 4: Confidence=0.4317
Instance 5: Confidence=0.4099
Selected instance: 3 (Confidence: 0.6191)
tmp min: tensor(0.) tmp max: tensor(1.)
367 160 540 960
There are 15 prompts
current IoU is: 0.8416465520858765
Seok, iteration idx= 11 IoU = tensor(0.8416)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 3.4ms preprocess, 20.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9405
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9210
Instance 5: Confidence=0.9140
Selected instance: 2 (Confidence: 0.9405)
tmp min: tensor(0.) tmp max: tensor(1.)
569 108 540 960
There are 14 prompts
current IoU is: 0.8377143740653992
Seok, iteration idx= 12 IoU = tensor(0.8377)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.7ms
Speed: 2.8ms preprocess, 21.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9598
Instance 1: Confidence=0.9502
Instance 2: Confidence=0.9318
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9104
Instance 5: Confidence=0.8862
Selected instance: 1 (Confidence: 0.9502)
tmp min: tensor(0.) tmp max: tensor(1.)
585 88 540 960
There are 14 prompts
current IoU is: 0.719426691532135
Seok, iteration idx= 13 IoU = tensor(0.7194)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 2.8ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.9447
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.7582
Instance 5: Confidence=0.7479
Instance 6: Confidence=0.3858
Selected instance: 1 (Confidence: 0.9509)
tmp min: tensor(0.) tmp max: tensor(1.)
605 80 540 960
There are 15 prompts
current IoU is: 0.8046863079071045
Seok, iteration idx= 14 IoU = tensor(0.8047)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.6ms
Speed: 4.2ms preprocess, 21.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 7
Instance 0: Confidence=0.9569
Instance 1: Confidence=0.9488
Instance 2: Confidence=0.9424
Instance 3: Confidence=0.9368
Instance 4: Confidence=0.3790
Instance 5: Confidence=0.3706
Instance 6: Confidence=0.3087
Selected instance: 1 (Confidence: 0.9488)
tmp min: tensor(0.) tmp max: tensor(1.)
583 76 540 960
There are 16 prompts
current IoU is: 0.8537001609802246
Seok, iteration idx= 15 IoU = tensor(0.8537)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 4.0ms preprocess, 22.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9515
Instance 2: Confidence=0.9465
Instance 3: Confidence=0.9285
Instance 4: Confidence=0.5979
Selected instance: 1 (Confidence: 0.9515)
tmp min: tensor(0.) tmp max: tensor(1.)
592 60 540 960
There are 16 prompts
current IoU is: 0.9091463685035706
Seok, iteration idx= 16 IoU = tensor(0.9091)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.3ms preprocess, 23.7ms inference, 3.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9450
Instance 2: Confidence=0.9402
Instance 3: Confidence=0.9285
Instance 4: Confidence=0.6814
Selected instance: 0 (Confidence: 0.9486)
tmp min: tensor(0.) tmp max: tensor(1.)
617 56 540 960
There are 15 prompts
current IoU is: 0.902948260307312
Seok, iteration idx= 17 IoU = tensor(0.9029)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 8
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9512
Instance 2: Confidence=0.9320
Instance 3: Confidence=0.9235
Instance 4: Confidence=0.8462
Instance 5: Confidence=0.5823
Instance 6: Confidence=0.4505
Instance 7: Confidence=0.2670
Selected instance: 2 (Confidence: 0.9320)
tmp min: tensor(0.) tmp max: tensor(1.)
588 52 540 960
There are 12 prompts
current IoU is: 0.903803825378418
Seok, iteration idx= 18 IoU = tensor(0.9038)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 1.3ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9517
Instance 2: Confidence=0.9480
Instance 3: Confidence=0.9387
Instance 4: Confidence=0.9152
Instance 5: Confidence=0.5453
Instance 6: Confidence=0.3526
Selected instance: 1 (Confidence: 0.9517)
tmp min: tensor(0.) tmp max: tensor(1.)
567 40 540 960
There are 13 prompts
current IoU is: 0.9277846217155457
Seok, iteration idx= 19 IoU = tensor(0.9278)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 2.6ms preprocess, 22.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9603
Instance 1: Confidence=0.9415
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9376
Instance 4: Confidence=0.7264
Instance 5: Confidence=0.3404
Selected instance: 1 (Confidence: 0.9415)
tmp min: tensor(0.) tmp max: tensor(1.)
343 68 540 960
There are 14 prompts
current IoU is: 0.8999799489974976
Seok, iteration idx= 20 IoU = tensor(0.9000)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.8ms preprocess, 23.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9516
Instance 1: Confidence=0.9497
Instance 2: Confidence=0.9427
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.3692
Selected instance: 0 (Confidence: 0.9516)
tmp min: tensor(0.) tmp max: tensor(1.)
331 72 540 960
There are 14 prompts
current IoU is: 0.9047800898551941
Seok, iteration idx= 21 IoU = tensor(0.9048)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.3ms
Speed: 1.9ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 4
Instance 0: Confidence=0.9620
Instance 1: Confidence=0.9516
Instance 2: Confidence=0.9441
Instance 3: Confidence=0.8590
Selected instance: 1 (Confidence: 0.9516)
tmp min: tensor(0.) tmp max: tensor(1.)
339 64 540 960
There are 11 prompts
current IoU is: 0.9136657118797302
Seok, iteration idx= 22 IoU = tensor(0.9137)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.1ms
Speed: 3.2ms preprocess, 23.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 4
Instance 0: Confidence=0.9596
Instance 1: Confidence=0.9460
Instance 2: Confidence=0.9159
Instance 3: Confidence=0.3852
Selected instance: 1 (Confidence: 0.9460)
tmp min: tensor(0.) tmp max: tensor(1.)
344 64 540 960
There are 14 prompts
current IoU is: 0.9237084984779358
Seok, iteration idx= 23 IoU = tensor(0.9237)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 2.5ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9604
Instance 1: Confidence=0.9048
Instance 2: Confidence=0.8323
Instance 3: Confidence=0.7273
Instance 4: Confidence=0.5794
Instance 5: Confidence=0.3322
Selected instance: 5 (Confidence: 0.3322)
tmp min: tensor(0.) tmp max: tensor(1.)
302 168 540 960
There are 16 prompts
current IoU is: 0.7474139332771301
Seok, iteration idx= 24 IoU = tensor(0.7474)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 2.7ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9554
Instance 2: Confidence=0.9503
Instance 3: Confidence=0.9088
Instance 4: Confidence=0.2799
Instance 5: Confidence=0.2793
Selected instance: 4 (Confidence: 0.2799)
tmp min: tensor(0.) tmp max: tensor(1.)
408 100 540 960
There are 14 prompts
current IoU is: 0.6382075548171997
Seok, iteration idx= 25 IoU = tensor(0.6382)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.6ms
Speed: 1.4ms preprocess, 24.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9443
Instance 1: Confidence=0.9402
Instance 2: Confidence=0.9050
Instance 3: Confidence=0.8995
Instance 4: Confidence=0.8411
Instance 5: Confidence=0.8070
Selected instance: 5 (Confidence: 0.8070)
tmp min: tensor(0.) tmp max: tensor(1.)
386 108 540 960
There are 17 prompts
current IoU is: 0.5950893759727478
Seok, iteration idx= 26 IoU = tensor(0.5951)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9572
Instance 1: Confidence=0.9524
Instance 2: Confidence=0.9424
Instance 3: Confidence=0.9414
Instance 4: Confidence=0.8698
Selected instance: 4 (Confidence: 0.8698)
tmp min: tensor(0.) tmp max: tensor(1.)
393 148 540 960
There are 13 prompts
current IoU is: 0.6605821251869202
Seok, iteration idx= 27 IoU = tensor(0.6606)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 7
Instance 0: Confidence=0.9549
Instance 1: Confidence=0.9432
Instance 2: Confidence=0.9343
Instance 3: Confidence=0.9288
Instance 4: Confidence=0.8839
Instance 5: Confidence=0.5460
Instance 6: Confidence=0.2770
Selected instance: 1 (Confidence: 0.9432)
tmp min: tensor(0.) tmp max: tensor(1.)
592 68 540 960
There are 14 prompts
current IoU is: 0.9281212687492371
Seok, iteration idx= 28 IoU = tensor(0.9281)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.9376
Instance 2: Confidence=0.9306
Instance 3: Confidence=0.8279
Instance 4: Confidence=0.7871
Instance 5: Confidence=0.3723
Instance 6: Confidence=0.2568
Selected instance: 0 (Confidence: 0.9384)
tmp min: tensor(0.) tmp max: tensor(1.)
536 76 540 960
There are 15 prompts
current IoU is: 0.926722526550293
Seok, iteration idx= 29 IoU = tensor(0.9267)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.3ms preprocess, 23.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9439
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9349
Instance 3: Confidence=0.8851
Instance 4: Confidence=0.5107
Selected instance: 1 (Confidence: 0.9353)
tmp min: tensor(0.) tmp max: tensor(1.)
546 108 540 960
There are 13 prompts
current IoU is: 0.9296859502792358
Seok, iteration idx= 30 IoU = tensor(0.9297)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9620
Instance 1: Confidence=0.9385
Instance 2: Confidence=0.9375
Instance 3: Confidence=0.9245
Instance 4: Confidence=0.8593
Selected instance: 2 (Confidence: 0.9375)
tmp min: tensor(0.) tmp max: tensor(1.)
533 72 540 960
There are 15 prompts
current IoU is: 0.9491866230964661
Seok, iteration idx= 31 IoU = tensor(0.9492)
Selected Instance Confidence List: [tensor(0.9180), tensor(0.8414, device='cpu'), tensor(0.8663, device='cpu'), tensor(0.9219, device='cpu'), tensor(0.9393, device='cpu'), tensor(0.9487, device='cpu'), tensor(0.9152, device='cpu'), tensor(0.9264, device='cpu'), tensor(0.9321, device='cpu'), tensor(0.9018, device='cpu'), tensor(0.4143, device='cpu'), tensor(0.7526, device='cpu'), tensor(0.8788, device='cpu'), tensor(0.8117, device='cpu'), tensor(0.8632, device='cpu'), tensor(0.8917, device='cpu'), tensor(0.9261, device='cpu'), tensor(0.9212, device='cpu'), tensor(0.9151, device='cpu'), tensor(0.9373, device='cpu'), tensor(0.9166, device='cpu'), tensor(0.9235, device='cpu'), tensor(0.9288, device='cpu'), tensor(0.9326, device='cpu'), tensor(0.6757, device='cpu'), tensor(0.4949, device='cpu'), tensor(0.6798, device='cpu'), tensor(0.7443, device='cpu'), tensor(0.9342, device='cpu'), tensor(0.9314, device='cpu'), tensor(0.9319, device='cpu'), tensor(0.9445, device='cpu')]
Sorted Confidence Order: [tensor(0.9487, device='cpu'), tensor(0.9393, device='cpu'), tensor(0.9219, device='cpu'), tensor(0.8663, device='cpu'), tensor(0.8414, device='cpu'), tensor(0.9180), tensor(0.9445, device='cpu'), tensor(0.9319, device='cpu'), tensor(0.9314, device='cpu'), tensor(0.9342, device='cpu'), tensor(0.9373, device='cpu'), tensor(0.9151, device='cpu'), tensor(0.9212, device='cpu'), tensor(0.9261, device='cpu'), tensor(0.8917, device='cpu'), tensor(0.8632, device='cpu'), tensor(0.8117, device='cpu'), tensor(0.8788, device='cpu'), tensor(0.7443, device='cpu'), tensor(0.6798, device='cpu'), tensor(0.4949, device='cpu'), tensor(0.6757, device='cpu'), tensor(0.9326, device='cpu'), tensor(0.9288, device='cpu'), tensor(0.9235, device='cpu'), tensor(0.9166, device='cpu'), tensor(0.7526, device='cpu'), tensor(0.4143, device='cpu'), tensor(0.9018, device='cpu'), tensor(0.9321, device='cpu'), tensor(0.9264, device='cpu'), tensor(0.9152, device='cpu')]
sorted_indices: [5, 4, 3, 2, 1, 0, 31, 30, 29, 28, 19, 18, 17, 16, 15, 14, 13, 12, 27, 26, 25, 24, 23, 22, 21, 20, 11, 10, 9, 8, 7, 6]
Initial view (highest confidence): 6
New training order: [30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15, 14, 13, 12, 11, 10, 9, 36, 35, 34, 33, 32, 31]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.8ms
Speed: 1.3ms preprocess, 19.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9493
Instance 1: Confidence=0.9481
Instance 2: Confidence=0.9454
Instance 3: Confidence=0.8710
Instance 4: Confidence=0.5295
Instance 5: Confidence=0.5013
tmp min: tensor(0.) tmp max: tensor(1.)
434 28 540 960
There are 15 prompts
current IoU is: 0.9550114870071411
Seok, iteration idx= 1 IoU = tensor(0.9550)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.6ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 5
Instance 0: Confidence=0.9492
Instance 1: Confidence=0.9473
Instance 2: Confidence=0.8976
Instance 3: Confidence=0.8878
Instance 4: Confidence=0.7385
tmp min: tensor(0.) tmp max: tensor(1.)
435 52 540 960
There are 16 prompts
current IoU is: 0.961188554763794
Seok, iteration idx= 2 IoU = tensor(0.9612)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.8ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 6
Instance 0: Confidence=0.9558
Instance 1: Confidence=0.9384
Instance 2: Confidence=0.9350
Instance 3: Confidence=0.9330
Instance 4: Confidence=0.8556
Instance 5: Confidence=0.8479
tmp min: tensor(0.) tmp max: tensor(1.)
428 60 540 960
There are 17 prompts
current IoU is: 0.9385752081871033
Seok, iteration idx= 3 IoU = tensor(0.9386)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 3.6ms preprocess, 22.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9656
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8572
Instance 5: Confidence=0.7074
tmp min: tensor(0.) tmp max: tensor(1.)
474 48 540 960
There are 15 prompts
current IoU is: 0.944348156452179
Seok, iteration idx= 4 IoU = tensor(0.9443)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.8ms
Speed: 3.6ms preprocess, 22.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 8
Instance 0: Confidence=0.9529
Instance 1: Confidence=0.9375
Instance 2: Confidence=0.9180
Instance 3: Confidence=0.9101
Instance 4: Confidence=0.8697
Instance 5: Confidence=0.7282
Instance 6: Confidence=0.3680
Instance 7: Confidence=0.3032
tmp min: tensor(0.) tmp max: tensor(1.)
503 68 540 960
There are 15 prompts
current IoU is: 0.9317982196807861
Seok, iteration idx= 5 IoU = tensor(0.9318)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 1.8ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9620
Instance 1: Confidence=0.9385
Instance 2: Confidence=0.9375
Instance 3: Confidence=0.9245
Instance 4: Confidence=0.8593
tmp min: tensor(0.) tmp max: tensor(1.)
533 72 540 960
There are 15 prompts
current IoU is: 0.9492580890655518
Seok, iteration idx= 6 IoU = tensor(0.9493)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 2.6ms preprocess, 22.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9439
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9349
Instance 3: Confidence=0.8851
Instance 4: Confidence=0.5107
tmp min: tensor(0.) tmp max: tensor(1.)
546 108 540 960
There are 13 prompts
current IoU is: 0.9363953471183777
Seok, iteration idx= 7 IoU = tensor(0.9364)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 2.6ms preprocess, 22.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.9376
Instance 2: Confidence=0.9306
Instance 3: Confidence=0.8279
Instance 4: Confidence=0.7871
Instance 5: Confidence=0.3723
Instance 6: Confidence=0.2568
tmp min: tensor(0.) tmp max: tensor(1.)
536 76 540 960
There are 15 prompts
current IoU is: 0.9332016110420227
Seok, iteration idx= 8 IoU = tensor(0.9332)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.7ms
Speed: 3.2ms preprocess, 22.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 7
Instance 0: Confidence=0.9549
Instance 1: Confidence=0.9432
Instance 2: Confidence=0.9343
Instance 3: Confidence=0.9288
Instance 4: Confidence=0.8839
Instance 5: Confidence=0.5460
Instance 6: Confidence=0.2770
tmp min: tensor(0.) tmp max: tensor(1.)
592 68 540 960
There are 14 prompts
current IoU is: 0.9291759729385376
Seok, iteration idx= 9 IoU = tensor(0.9292)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 2.9ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 7
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9517
Instance 2: Confidence=0.9480
Instance 3: Confidence=0.9387
Instance 4: Confidence=0.9152
Instance 5: Confidence=0.5453
Instance 6: Confidence=0.3526
tmp min: tensor(0.) tmp max: tensor(1.)
567 40 540 960
There are 13 prompts
current IoU is: 0.9367769956588745
Seok, iteration idx= 10 IoU = tensor(0.9368)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.0ms
Speed: 2.8ms preprocess, 22.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 8
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9512
Instance 2: Confidence=0.9320
Instance 3: Confidence=0.9235
Instance 4: Confidence=0.8462
Instance 5: Confidence=0.5823
Instance 6: Confidence=0.4505
Instance 7: Confidence=0.2670
tmp min: tensor(0.) tmp max: tensor(1.)
588 52 540 960
There are 12 prompts
current IoU is: 0.9233591556549072
Seok, iteration idx= 11 IoU = tensor(0.9234)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 3.5ms preprocess, 23.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9450
Instance 2: Confidence=0.9402
Instance 3: Confidence=0.9285
Instance 4: Confidence=0.6814
tmp min: tensor(0.) tmp max: tensor(1.)
617 56 540 960
There are 15 prompts
current IoU is: 0.9261196255683899
Seok, iteration idx= 12 IoU = tensor(0.9261)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 2.9ms preprocess, 23.7ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9515
Instance 2: Confidence=0.9465
Instance 3: Confidence=0.9285
Instance 4: Confidence=0.5979
tmp min: tensor(0.) tmp max: tensor(1.)
592 60 540 960
There are 16 prompts
current IoU is: 0.9325032234191895
Seok, iteration idx= 13 IoU = tensor(0.9325)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9569
Instance 1: Confidence=0.9488
Instance 2: Confidence=0.9424
Instance 3: Confidence=0.9368
Instance 4: Confidence=0.3790
Instance 5: Confidence=0.3706
Instance 6: Confidence=0.3087
tmp min: tensor(0.) tmp max: tensor(1.)
583 76 540 960
There are 16 prompts
current IoU is: 0.9180899858474731
Seok, iteration idx= 14 IoU = tensor(0.9181)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 1.3ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 7
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.9447
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.7582
Instance 5: Confidence=0.7479
Instance 6: Confidence=0.3858
tmp min: tensor(0.) tmp max: tensor(1.)
605 80 540 960
There are 15 prompts
current IoU is: 0.9206667542457581
Seok, iteration idx= 15 IoU = tensor(0.9207)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9598
Instance 1: Confidence=0.9502
Instance 2: Confidence=0.9318
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9104
Instance 5: Confidence=0.8862
tmp min: tensor(0.) tmp max: tensor(1.)
585 88 540 960
There are 14 prompts
current IoU is: 0.924085795879364
Seok, iteration idx= 16 IoU = tensor(0.9241)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.3ms preprocess, 23.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9405
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9210
Instance 5: Confidence=0.9140
tmp min: tensor(0.) tmp max: tensor(1.)
569 108 540 960
There are 14 prompts
current IoU is: 0.8925299048423767
Seok, iteration idx= 17 IoU = tensor(0.8925)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9572
Instance 1: Confidence=0.9524
Instance 2: Confidence=0.9424
Instance 3: Confidence=0.9414
Instance 4: Confidence=0.8698
tmp min: tensor(0.) tmp max: tensor(1.)
393 148 540 960
There are 13 prompts
current IoU is: 0.8447432518005371
Seok, iteration idx= 18 IoU = tensor(0.8447)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.7ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9443
Instance 1: Confidence=0.9402
Instance 2: Confidence=0.9050
Instance 3: Confidence=0.8995
Instance 4: Confidence=0.8411
Instance 5: Confidence=0.8070
tmp min: tensor(0.) tmp max: tensor(1.)
386 108 540 960
There are 17 prompts
current IoU is: 0.6189967393875122
Seok, iteration idx= 19 IoU = tensor(0.6190)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 2.9ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9554
Instance 2: Confidence=0.9503
Instance 3: Confidence=0.9088
Instance 4: Confidence=0.2799
Instance 5: Confidence=0.2793
tmp min: tensor(0.) tmp max: tensor(1.)
408 100 540 960
There are 14 prompts
current IoU is: 0.6382268667221069
Seok, iteration idx= 20 IoU = tensor(0.6382)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9604
Instance 1: Confidence=0.9048
Instance 2: Confidence=0.8323
Instance 3: Confidence=0.7273
Instance 4: Confidence=0.5794
Instance 5: Confidence=0.3322
tmp min: tensor(0.) tmp max: tensor(1.)
302 168 540 960
There are 16 prompts
current IoU is: 0.779089629650116
Seok, iteration idx= 21 IoU = tensor(0.7791)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.3ms
Speed: 1.4ms preprocess, 22.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 4
Instance 0: Confidence=0.9596
Instance 1: Confidence=0.9460
Instance 2: Confidence=0.9159
Instance 3: Confidence=0.3852
tmp min: tensor(0.) tmp max: tensor(1.)
344 64 540 960
There are 14 prompts
current IoU is: 0.9381611943244934
Seok, iteration idx= 22 IoU = tensor(0.9382)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.2ms
Speed: 3.1ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 4
Instance 0: Confidence=0.9620
Instance 1: Confidence=0.9516
Instance 2: Confidence=0.9441
Instance 3: Confidence=0.8590
tmp min: tensor(0.) tmp max: tensor(1.)
339 64 540 960
There are 11 prompts
current IoU is: 0.9307932257652283
Seok, iteration idx= 23 IoU = tensor(0.9308)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 3.5ms preprocess, 23.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9516
Instance 1: Confidence=0.9497
Instance 2: Confidence=0.9427
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.3692
tmp min: tensor(0.) tmp max: tensor(1.)
331 72 540 960
There are 14 prompts
current IoU is: 0.9307199120521545
Seok, iteration idx= 24 IoU = tensor(0.9307)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 2.9ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9603
Instance 1: Confidence=0.9415
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9376
Instance 4: Confidence=0.7264
Instance 5: Confidence=0.3404
tmp min: tensor(0.) tmp max: tensor(1.)
343 68 540 960
There are 14 prompts
current IoU is: 0.9075457453727722
Seok, iteration idx= 25 IoU = tensor(0.9075)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9608
Instance 1: Confidence=0.9321
Instance 2: Confidence=0.9267
Instance 3: Confidence=0.6191
Instance 4: Confidence=0.4317
Instance 5: Confidence=0.4099
tmp min: tensor(0.) tmp max: tensor(1.)
367 160 540 960
There are 15 prompts
current IoU is: 0.8873887062072754
Seok, iteration idx= 26 IoU = tensor(0.8874)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.1ms
Speed: 1.5ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 4
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9233
Instance 2: Confidence=0.8993
Instance 3: Confidence=0.7667
tmp min: tensor(0.) tmp max: tensor(1.)
354 72 540 960
There are 15 prompts
current IoU is: 0.08971814066171646
Seok, iteration idx= 27 IoU = tensor(0.0897)
SKIP, unacceptable sam prediction, IoU is tensor(0.0897)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.8ms
Speed: 1.6ms preprocess, 23.8ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 4
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9397
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.9188
tmp min: tensor(0.) tmp max: tensor(1.)
348 108 540 960
There are 16 prompts
current IoU is: 0.9086347818374634
Seok, iteration idx= 28 IoU = tensor(0.9086)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 2.3ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9462
Instance 2: Confidence=0.9264
Instance 3: Confidence=0.8582
Instance 4: Confidence=0.8035
Instance 5: Confidence=0.7958
Instance 6: Confidence=0.3784
tmp min: tensor(0.) tmp max: tensor(1.)
353 136 540 960
There are 16 prompts
current IoU is: 0.9387337565422058
Seok, iteration idx= 29 IoU = tensor(0.9387)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9523
Instance 2: Confidence=0.9520
Instance 3: Confidence=0.8925
Instance 4: Confidence=0.6584
tmp min: tensor(0.) tmp max: tensor(1.)
368 60 540 960
There are 15 prompts
current IoU is: 0.926770031452179
Seok, iteration idx= 30 IoU = tensor(0.9268)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.8ms preprocess, 24.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9585
Instance 2: Confidence=0.9417
Instance 3: Confidence=0.9039
Instance 4: Confidence=0.8364
Instance 5: Confidence=0.4622
tmp min: tensor(0.) tmp max: tensor(1.)
374 44 540 960
There are 18 prompts
current IoU is: 0.934982180595398
Seok, iteration idx= 31 IoU = tensor(0.9350)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set1_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set1_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.25s/it]
Testing psnr 28.20988915860653 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set1_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.16it/s]
Testing psnr 3.3885365957394242 (avg)
train: coarse segmentation in 00:04:05
train: finish (eps time 00:04:06 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set1_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set2/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 45.85it/s]
Loaded image data (540, 960, 3, 32) [        540         960      752.26]
Loaded ./data/360_v2/Set2 1.2440621357132549 85.66757164363565
UserWarning: Optimal rotation is not uniquely or poorly defined for the given sets of vectors.
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960      752.26] ./data/360_v2/Set2
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.2539947867393494
original far 19.433752059936523
NEAR FAR 0 2.2590632
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.0105, -0.9112, -0.8033])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7333, 0.8326, 0.9405])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set2_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.2ms
Speed: 2.7ms preprocess, 19.2ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.1ms
Speed: 1.2ms preprocess, 20.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.6ms
Speed: 1.2ms preprocess, 19.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.6ms
Speed: 1.3ms preprocess, 19.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.5ms
Speed: 1.2ms preprocess, 19.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.6ms
Speed: 1.2ms preprocess, 19.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.7ms
Speed: 1.7ms preprocess, 18.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.8ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.7ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.4ms
Speed: 1.6ms preprocess, 19.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.2ms
Speed: 1.7ms preprocess, 19.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.4ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.1ms
Speed: 1.2ms preprocess, 20.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.0ms
Speed: 1.3ms preprocess, 20.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.8ms
Speed: 1.3ms preprocess, 19.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.5ms
Speed: 1.8ms preprocess, 21.5ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 1.4ms preprocess, 20.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9300
Instance 3: Confidence=0.8918
Instance 4: Confidence=0.8458
Instance 5: Confidence=0.3819
Selected instance: 1 (Confidence: 0.9407)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

940 20 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 13 prompts
current IoU is: 0.7492199540138245
Seok, iteration idx= 1 IoU = tensor(0.7492)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 3.4ms preprocess, 22.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 5
Instance 0: Confidence=0.9629
Instance 1: Confidence=0.9472
Instance 2: Confidence=0.9233
Instance 3: Confidence=0.8755
Instance 4: Confidence=0.7944
Selected instance: 0 (Confidence: 0.9629)
tmp min: tensor(0.) tmp max: tensor(1.)
852 44 540 960
There are 14 prompts
current IoU is: 0.5350648760795593
Seok, iteration idx= 2 IoU = tensor(0.5351)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.0ms
Speed: 2.3ms preprocess, 21.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.8868
Instance 4: Confidence=0.7933
Selected instance: 0 (Confidence: 0.9497)
tmp min: tensor(0.) tmp max: tensor(1.)
772 76 540 960
There are 13 prompts
current IoU is: 0.9237868785858154
Seok, iteration idx= 3 IoU = tensor(0.9238)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 3.0ms preprocess, 22.8ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9409
Instance 3: Confidence=0.9232
Instance 4: Confidence=0.7056
Instance 5: Confidence=0.5562
Selected instance: 2 (Confidence: 0.9409)
tmp min: tensor(0.) tmp max: tensor(1.)
281 80 540 960
There are 15 prompts
current IoU is: 0.6475564241409302
Seok, iteration idx= 4 IoU = tensor(0.6476)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9383
Instance 3: Confidence=0.8695
Instance 4: Confidence=0.6814
Selected instance: 2 (Confidence: 0.9383)
tmp min: tensor(0.) tmp max: tensor(1.)
295 92 540 960
There are 14 prompts
current IoU is: 0.7238948941230774
Seok, iteration idx= 5 IoU = tensor(0.7239)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 1.6ms preprocess, 22.2ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9612
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8944
Instance 4: Confidence=0.5440
Instance 5: Confidence=0.3031
Selected instance: 2 (Confidence: 0.9414)
tmp min: tensor(0.) tmp max: tensor(1.)
336 124 540 960
There are 17 prompts
current IoU is: 0.7907750010490417
Seok, iteration idx= 6 IoU = tensor(0.7908)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 1.9ms preprocess, 22.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9577
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.8692
Instance 4: Confidence=0.8435
Instance 5: Confidence=0.2911
Selected instance: 5 (Confidence: 0.2911)
tmp min: tensor(0.) tmp max: tensor(1.)
400 76 540 960
There are 16 prompts
current IoU is: 0.824705183506012
Seok, iteration idx= 7 IoU = tensor(0.8247)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.8ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9609
Instance 2: Confidence=0.9381
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9067
Instance 5: Confidence=0.8774
Selected instance: 5 (Confidence: 0.8774)
tmp min: tensor(0.) tmp max: tensor(1.)
466 88 540 960
There are 13 prompts
current IoU is: 0.7402902841567993
Seok, iteration idx= 8 IoU = tensor(0.7403)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9636
Instance 1: Confidence=0.9628
Instance 2: Confidence=0.9492
Instance 3: Confidence=0.9315
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.3011
Selected instance: 2 (Confidence: 0.9492)
tmp min: tensor(0.) tmp max: tensor(1.)
469 24 540 960
There are 13 prompts
current IoU is: 0.0008497079252265394
Seok, iteration idx= 9 IoU = tensor(0.0008)
SKIP, unacceptable sam prediction, IoU is tensor(0.0008)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.0ms
Speed: 1.6ms preprocess, 22.0ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 7
Instance 0: Confidence=0.9600
Instance 1: Confidence=0.9489
Instance 2: Confidence=0.9429
Instance 3: Confidence=0.9350
Instance 4: Confidence=0.7563
Instance 5: Confidence=0.5645
Instance 6: Confidence=0.3526
Selected instance: 4 (Confidence: 0.7563)
tmp min: tensor(0.) tmp max: tensor(1.)
533 84 540 960
There are 16 prompts
current IoU is: 0.8691523671150208
Seok, iteration idx= 10 IoU = tensor(0.8692)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.7ms
Speed: 2.5ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9504
Instance 3: Confidence=0.7410
Instance 4: Confidence=0.5533
Instance 5: Confidence=0.5528
Instance 6: Confidence=0.3753
Selected instance: 4 (Confidence: 0.5533)
tmp min: tensor(0.) tmp max: tensor(1.)
590 128 540 960
There are 13 prompts
current IoU is: 0.768201470375061
Seok, iteration idx= 11 IoU = tensor(0.7682)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.4ms
Speed: 1.4ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9540
Instance 2: Confidence=0.9500
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9019
Instance 5: Confidence=0.7190
Selected instance: 5 (Confidence: 0.7190)
tmp min: tensor(0.) tmp max: tensor(1.)
684 48 540 960
There are 12 prompts
current IoU is: 0.5076923370361328
Seok, iteration idx= 12 IoU = tensor(0.5077)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.4ms
Speed: 3.4ms preprocess, 24.4ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9389
Instance 3: Confidence=0.9388
Instance 4: Confidence=0.9250
Selected instance: 2 (Confidence: 0.9389)
tmp min: tensor(0.) tmp max: tensor(1.)
687 48 540 960
There are 16 prompts
current IoU is: 0.0020137715619057417
Seok, iteration idx= 13 IoU = tensor(0.0020)
SKIP, unacceptable sam prediction, IoU is tensor(0.0020)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.8ms
Speed: 3.3ms preprocess, 21.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9248
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9204
Instance 5: Confidence=0.5236
Instance 6: Confidence=0.2980
Selected instance: 5 (Confidence: 0.5236)
tmp min: tensor(0.) tmp max: tensor(1.)
748 56 540 960
There are 13 prompts
current IoU is: 0.43072858452796936
Seok, iteration idx= 14 IoU = tensor(0.4307)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 3.0ms preprocess, 24.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.9090
Instance 5: Confidence=0.8731
Selected instance: 5 (Confidence: 0.8731)
tmp min: tensor(0.) tmp max: tensor(1.)
759 68 540 960
There are 17 prompts
current IoU is: 0.7804408669471741
Seok, iteration idx= 15 IoU = tensor(0.7804)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 2.5ms preprocess, 22.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9339
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9057
Instance 5: Confidence=0.8295
Selected instance: 3 (Confidence: 0.9181)
tmp min: tensor(0.) tmp max: tensor(1.)
768 128 540 960
There are 15 prompts
current IoU is: 0.8863447308540344
Seok, iteration idx= 16 IoU = tensor(0.8863)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.2ms
Speed: 2.3ms preprocess, 21.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9287
Instance 4: Confidence=0.9237
Selected instance: 1 (Confidence: 0.9477)
tmp min: tensor(0.) tmp max: tensor(1.)
848 104 540 960
There are 12 prompts
current IoU is: 0.9219534993171692
Seok, iteration idx= 17 IoU = tensor(0.9220)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 1.6ms preprocess, 22.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9501
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9253
Instance 3: Confidence=0.9167
Instance 4: Confidence=0.9130
Instance 5: Confidence=0.7570
Selected instance: 0 (Confidence: 0.9501)
tmp min: tensor(0.) tmp max: tensor(1.)
867 96 540 960
There are 12 prompts
current IoU is: 0.9296137690544128
Seok, iteration idx= 18 IoU = tensor(0.9296)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.0ms
Speed: 1.4ms preprocess, 22.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9468
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9173
Instance 3: Confidence=0.9139
Instance 4: Confidence=0.9082
Instance 5: Confidence=0.8839
Selected instance: 0 (Confidence: 0.9468)
tmp min: tensor(0.) tmp max: tensor(1.)
924 80 540 960
There are 12 prompts
current IoU is: 0.9255550503730774
Seok, iteration idx= 19 IoU = tensor(0.9256)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9123
Instance 4: Confidence=0.8140
Instance 5: Confidence=0.7047
Selected instance: 1 (Confidence: 0.9288)
tmp min: tensor(0.) tmp max: tensor(1.)
100 88 540 960
There are 15 prompts
current IoU is: 0.9058114290237427
Seok, iteration idx= 20 IoU = tensor(0.9058)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9382
Instance 3: Confidence=0.9325
Instance 4: Confidence=0.8753
Selected instance: 2 (Confidence: 0.9382)
tmp min: tensor(0.) tmp max: tensor(1.)
83 80 540 960
There are 15 prompts
current IoU is: 0.9056850075721741
Seok, iteration idx= 21 IoU = tensor(0.9057)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.7ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9564
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9442
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.9084
Selected instance: 1 (Confidence: 0.9446)
tmp min: tensor(0.) tmp max: tensor(1.)
95 72 540 960
There are 16 prompts
current IoU is: 0.9233474135398865
Seok, iteration idx= 22 IoU = tensor(0.9233)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 1.7ms preprocess, 22.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9426
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9157
Instance 4: Confidence=0.8987
Instance 5: Confidence=0.8984
Selected instance: 1 (Confidence: 0.9426)
tmp min: tensor(0.) tmp max: tensor(1.)
91 72 540 960
There are 16 prompts
current IoU is: 0.9284123182296753
Seok, iteration idx= 23 IoU = tensor(0.9284)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 2.1ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9580
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9340
Instance 3: Confidence=0.9104
Instance 4: Confidence=0.8875
Selected instance: 1 (Confidence: 0.9429)
tmp min: tensor(0.) tmp max: tensor(1.)
109 56 540 960
There are 15 prompts
current IoU is: 0.9240741729736328
Seok, iteration idx= 24 IoU = tensor(0.9241)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.4ms
Speed: 2.1ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9439
Instance 2: Confidence=0.9419
Instance 3: Confidence=0.9107
Instance 4: Confidence=0.8744
Instance 5: Confidence=0.8606
Selected instance: 2 (Confidence: 0.9419)
tmp min: tensor(0.) tmp max: tensor(1.)
177 68 540 960
There are 14 prompts
current IoU is: 0.9237626791000366
Seok, iteration idx= 25 IoU = tensor(0.9238)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9461
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9423
Instance 3: Confidence=0.8899
Instance 4: Confidence=0.8821
Instance 5: Confidence=0.8120
Selected instance: 4 (Confidence: 0.8821)
tmp min: tensor(0.) tmp max: tensor(1.)
191 64 540 960
There are 14 prompts
current IoU is: 0.8707596659660339
Seok, iteration idx= 26 IoU = tensor(0.8708)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 2.5ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9428
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.8651
Instance 4: Confidence=0.8009
Instance 5: Confidence=0.6158
Selected instance: 3 (Confidence: 0.8651)
tmp min: tensor(0.) tmp max: tensor(1.)
233 80 540 960
There are 15 prompts
current IoU is: 0.8492395877838135
Seok, iteration idx= 27 IoU = tensor(0.8492)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 3.1ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9324
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9186
Instance 3: Confidence=0.9152
Instance 4: Confidence=0.9005
Instance 5: Confidence=0.7954
Selected instance: 1 (Confidence: 0.9269)
tmp min: tensor(0.) tmp max: tensor(1.)
947 64 540 960
There are 16 prompts
current IoU is: 0.8922867774963379
Seok, iteration idx= 28 IoU = tensor(0.8923)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 3.0ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9442
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8480
Instance 4: Confidence=0.7411
Instance 5: Confidence=0.4972
Instance 6: Confidence=0.3251
Selected instance: 3 (Confidence: 0.8480)
tmp min: tensor(0.) tmp max: tensor(1.)
956 152 540 960
There are 17 prompts
current IoU is: 0.9341951608657837
Seok, iteration idx= 29 IoU = tensor(0.9342)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.0ms
Speed: 2.7ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9406
Instance 1: Confidence=0.9192
Instance 2: Confidence=0.8926
Instance 3: Confidence=0.8394
Instance 4: Confidence=0.4365
Instance 5: Confidence=0.4170
Instance 6: Confidence=0.3318
Selected instance: 3 (Confidence: 0.8394)
tmp min: tensor(0.) tmp max: tensor(1.)
956 200 540 960
There are 16 prompts
current IoU is: 0.9414758086204529
Seok, iteration idx= 30 IoU = tensor(0.9415)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.2ms
Speed: 3.1ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 7
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9065
Instance 2: Confidence=0.7635
Instance 3: Confidence=0.5051
Instance 4: Confidence=0.4478
Instance 5: Confidence=0.4426
Instance 6: Confidence=0.2696
Selected instance: 2 (Confidence: 0.7635)
tmp min: tensor(0.) tmp max: tensor(1.)
952 268 540 960
There are 13 prompts
current IoU is: 0.9139499664306641
Seok, iteration idx= 31 IoU = tensor(0.9139)
Selected Instance Confidence List: [tensor(0.9153), tensor(0.8258, device='cpu'), tensor(0.7062, device='cpu'), tensor(0.9342, device='cpu'), tensor(0.7649, device='cpu'), tensor(0.8097, device='cpu'), tensor(0.8510, device='cpu'), tensor(0.7598, device='cpu'), tensor(0.7951, device='cpu'), tensor(0.3854, device='cpu'), tensor(0.8240, device='cpu'), tensor(0.6823, device='cpu'), tensor(0.5922, device='cpu'), tensor(0.3783, device='cpu'), tensor(0.4679, device='cpu'), tensor(0.8175, device='cpu'), tensor(0.8990, device='cpu'), tensor(0.9322, device='cpu'), tensor(0.9378, device='cpu'), tensor(0.9341, device='cpu'), tensor(0.9150, device='cpu'), tensor(0.9187, device='cpu'), tensor(0.9318, device='cpu'), tensor(0.9341, device='cpu'), tensor(0.9316, device='cpu'), tensor(0.9310, device='cpu'), tensor(0.8753, device='cpu'), tensor(0.8556, device='cpu'), tensor(0.9061, device='cpu'), tensor(0.8997, device='cpu'), tensor(0.9006, device='cpu'), tensor(0.8538, device='cpu')]
Sorted Confidence Order: [tensor(0.9378, device='cpu'), tensor(0.9322, device='cpu'), tensor(0.9341, device='cpu'), tensor(0.9061, device='cpu'), tensor(0.8997, device='cpu'), tensor(0.9006, device='cpu'), tensor(0.8538, device='cpu'), tensor(0.9153), tensor(0.8258, device='cpu'), tensor(0.7062, device='cpu'), tensor(0.9342, device='cpu'), tensor(0.8990, device='cpu'), tensor(0.8175, device='cpu'), tensor(0.4679, device='cpu'), tensor(0.3783, device='cpu'), tensor(0.5922, device='cpu'), tensor(0.6823, device='cpu'), tensor(0.8240, device='cpu'), tensor(0.3854, device='cpu'), tensor(0.7951, device='cpu'), tensor(0.7598, device='cpu'), tensor(0.8510, device='cpu'), tensor(0.8097, device='cpu'), tensor(0.7649, device='cpu'), tensor(0.8556, device='cpu'), tensor(0.8753, device='cpu'), tensor(0.9310, device='cpu'), tensor(0.9316, device='cpu'), tensor(0.9341, device='cpu'), tensor(0.9318, device='cpu'), tensor(0.9187, device='cpu'), tensor(0.9150, device='cpu')]
sorted_indices: [18, 17, 19, 28, 29, 30, 31, 0, 1, 2, 3, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 27, 26, 25, 24, 23, 22, 21, 20]
Initial view (highest confidence): 23
New training order: [35, 34, 36, 9, 10, 11, 12, 13, 14, 15, 16, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 1.3ms preprocess, 20.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.7ms
Speed: 1.6ms preprocess, 24.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9287
Instance 4: Confidence=0.9237
tmp min: tensor(0.) tmp max: tensor(1.)
848 104 540 960
There are 12 prompts
current IoU is: 0.91801518201828
Seok, iteration idx= 1 IoU = tensor(0.9180)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.6ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9468
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9173
Instance 3: Confidence=0.9139
Instance 4: Confidence=0.9082
Instance 5: Confidence=0.8839
tmp min: tensor(0.) tmp max: tensor(1.)
924 80 540 960
There are 12 prompts
current IoU is: 0.9371830821037292
Seok, iteration idx= 2 IoU = tensor(0.9372)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.8ms preprocess, 23.8ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 6
Instance 0: Confidence=0.9324
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9186
Instance 3: Confidence=0.9152
Instance 4: Confidence=0.9005
Instance 5: Confidence=0.7954
tmp min: tensor(0.) tmp max: tensor(1.)
947 64 540 960
There are 16 prompts
current IoU is: 0.8830526471138
Seok, iteration idx= 3 IoU = tensor(0.8831)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.6ms
Speed: 1.4ms preprocess, 24.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 7
Instance 0: Confidence=0.9442
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8480
Instance 4: Confidence=0.7411
Instance 5: Confidence=0.4972
Instance 6: Confidence=0.3251
tmp min: tensor(0.) tmp max: tensor(1.)
956 152 540 960
There are 17 prompts
current IoU is: 0.9312825202941895
Seok, iteration idx= 4 IoU = tensor(0.9313)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.6ms
Speed: 1.4ms preprocess, 24.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 7
Instance 0: Confidence=0.9406
Instance 1: Confidence=0.9192
Instance 2: Confidence=0.8926
Instance 3: Confidence=0.8394
Instance 4: Confidence=0.4365
Instance 5: Confidence=0.4170
Instance 6: Confidence=0.3318
tmp min: tensor(0.) tmp max: tensor(1.)
956 200 540 960
There are 16 prompts
current IoU is: 0.9436306357383728
Seok, iteration idx= 5 IoU = tensor(0.9436)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.9ms
Speed: 1.4ms preprocess, 21.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 7
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9065
Instance 2: Confidence=0.7635
Instance 3: Confidence=0.5051
Instance 4: Confidence=0.4478
Instance 5: Confidence=0.4426
Instance 6: Confidence=0.2696
tmp min: tensor(0.) tmp max: tensor(1.)
952 268 540 960
There are 13 prompts
current IoU is: 0.9122873544692993
Seok, iteration idx= 6 IoU = tensor(0.9123)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.2ms
Speed: 2.8ms preprocess, 23.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 8
Instance 0: Confidence=0.9377
Instance 1: Confidence=0.9249
Instance 2: Confidence=0.9153
Instance 3: Confidence=0.7253
Instance 4: Confidence=0.7085
Instance 5: Confidence=0.4352
Instance 6: Confidence=0.3452
Instance 7: Confidence=0.2772
tmp min: tensor(0.) tmp max: tensor(1.)
949 36 540 960
There are 17 prompts
current IoU is: 0.9430734515190125
Seok, iteration idx= 7 IoU = tensor(0.9431)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9300
Instance 3: Confidence=0.8918
Instance 4: Confidence=0.8458
Instance 5: Confidence=0.3819
tmp min: tensor(0.) tmp max: tensor(1.)
940 20 540 960
There are 13 prompts
current IoU is: 0.9590668678283691
Seok, iteration idx= 8 IoU = tensor(0.9591)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9629
Instance 1: Confidence=0.9472
Instance 2: Confidence=0.9233
Instance 3: Confidence=0.8755
Instance 4: Confidence=0.7944
tmp min: tensor(0.) tmp max: tensor(1.)
852 44 540 960
There are 14 prompts
current IoU is: 0.9628028869628906
Seok, iteration idx= 9 IoU = tensor(0.9628)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.8868
Instance 4: Confidence=0.7933
tmp min: tensor(0.) tmp max: tensor(1.)
772 76 540 960
There are 13 prompts
current IoU is: 0.9303472638130188
Seok, iteration idx= 10 IoU = tensor(0.9303)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 1.6ms preprocess, 22.5ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9339
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9057
Instance 5: Confidence=0.8295
tmp min: tensor(0.) tmp max: tensor(1.)
768 128 540 960
There are 15 prompts
current IoU is: 0.8770289421081543
Seok, iteration idx= 11 IoU = tensor(0.8770)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.8ms
Speed: 2.4ms preprocess, 21.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.9090
Instance 5: Confidence=0.8731
tmp min: tensor(0.) tmp max: tensor(1.)
759 68 540 960
There are 17 prompts
current IoU is: 0.8689615726470947
Seok, iteration idx= 12 IoU = tensor(0.8690)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9248
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9204
Instance 5: Confidence=0.5236
Instance 6: Confidence=0.2980
tmp min: tensor(0.) tmp max: tensor(1.)
748 56 540 960
There are 13 prompts
current IoU is: 0.7377049326896667
Seok, iteration idx= 13 IoU = tensor(0.7377)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.6ms preprocess, 22.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9389
Instance 3: Confidence=0.9388
Instance 4: Confidence=0.9250
tmp min: tensor(0.) tmp max: tensor(1.)
687 48 540 960
There are 16 prompts
current IoU is: 0.00278029078617692
Seok, iteration idx= 14 IoU = tensor(0.0028)
SKIP, unacceptable sam prediction, IoU is tensor(0.0028)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.7ms
Speed: 3.4ms preprocess, 21.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9540
Instance 2: Confidence=0.9500
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9019
Instance 5: Confidence=0.7190
tmp min: tensor(0.) tmp max: tensor(1.)
684 48 540 960
There are 12 prompts
current IoU is: 0.8143396377563477
Seok, iteration idx= 15 IoU = tensor(0.8143)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 3.4ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 7
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9504
Instance 3: Confidence=0.7410
Instance 4: Confidence=0.5533
Instance 5: Confidence=0.5528
Instance 6: Confidence=0.3753
tmp min: tensor(0.) tmp max: tensor(1.)
590 128 540 960
There are 13 prompts
current IoU is: 0.8177589774131775
Seok, iteration idx= 16 IoU = tensor(0.8178)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 2.9ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 7
Instance 0: Confidence=0.9600
Instance 1: Confidence=0.9489
Instance 2: Confidence=0.9429
Instance 3: Confidence=0.9350
Instance 4: Confidence=0.7563
Instance 5: Confidence=0.5645
Instance 6: Confidence=0.3526
tmp min: tensor(0.) tmp max: tensor(1.)
533 84 540 960
There are 16 prompts
current IoU is: 0.8726321458816528
Seok, iteration idx= 17 IoU = tensor(0.8726)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 3.2ms preprocess, 24.1ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9636
Instance 1: Confidence=0.9628
Instance 2: Confidence=0.9492
Instance 3: Confidence=0.9315
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.3011
tmp min: tensor(0.) tmp max: tensor(1.)
469 24 540 960
There are 13 prompts
current IoU is: 0.0007439346518367529
Seok, iteration idx= 18 IoU = tensor(0.0007)
SKIP, unacceptable sam prediction, IoU is tensor(0.0007)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9609
Instance 2: Confidence=0.9381
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9067
Instance 5: Confidence=0.8774
tmp min: tensor(0.) tmp max: tensor(1.)
466 88 540 960
There are 13 prompts
current IoU is: 0.787385106086731
Seok, iteration idx= 19 IoU = tensor(0.7874)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9577
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.8692
Instance 4: Confidence=0.8435
Instance 5: Confidence=0.2911
tmp min: tensor(0.) tmp max: tensor(1.)
400 76 540 960
There are 16 prompts
current IoU is: 0.8330981731414795
Seok, iteration idx= 20 IoU = tensor(0.8331)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.7ms preprocess, 23.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9612
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8944
Instance 4: Confidence=0.5440
Instance 5: Confidence=0.3031
tmp min: tensor(0.) tmp max: tensor(1.)
336 124 540 960
There are 17 prompts
current IoU is: 0.9078013896942139
Seok, iteration idx= 21 IoU = tensor(0.9078)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.6ms
Speed: 1.5ms preprocess, 25.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9383
Instance 3: Confidence=0.8695
Instance 4: Confidence=0.6814
tmp min: tensor(0.) tmp max: tensor(1.)
295 92 540 960
There are 14 prompts
current IoU is: 0.9074136018753052
Seok, iteration idx= 22 IoU = tensor(0.9074)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.6ms preprocess, 23.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9409
Instance 3: Confidence=0.9232
Instance 4: Confidence=0.7056
Instance 5: Confidence=0.5562
tmp min: tensor(0.) tmp max: tensor(1.)
281 80 540 960
There are 15 prompts
current IoU is: 0.929222047328949
Seok, iteration idx= 23 IoU = tensor(0.9292)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 42.9ms
Speed: 3.6ms preprocess, 42.9ms inference, 10.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9580
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9340
Instance 3: Confidence=0.9104
Instance 4: Confidence=0.8875
tmp min: tensor(0.) tmp max: tensor(1.)
819 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 24 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 37.1ms
Speed: 7.7ms preprocess, 37.1ms inference, 9.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9300
Instance 3: Confidence=0.8918
Instance 4: Confidence=0.8458
Instance 5: Confidence=0.3819
tmp min: tensor(0.) tmp max: tensor(1.)
940 20 540 960
Exception on /_dash-update-component [POST]
Traceback (most recent call last):
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/flask/app.py", line 2073, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/flask/app.py", line 1518, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/flask/app.py", line 1516, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/flask/app.py", line 1502, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/dash/dash.py", line 1261, in dispatch
    ctx.run(
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/dash/_callback.py", line 440, in add_context
    output_value = func(*func_args, **func_kwargs)  # %% callback invoked %%
  File "/home/lab/SA3D_YOLO/lib/gui.py", line 569, in start_training
    rgb, sam_prompt, is_finished = self.Seg3d.train_step(self.train_idx)
  File "/home/lab/SA3D_YOLO/lib/sam3d.py", line 264, in train_step
    sam_seg_show = self.prompt_and_inverse(idx, HW, seg_m, yolo_m, dual_seg_m, depth)
  File "/home/lab/SA3D_YOLO/lib/sam3d.py", line 185, in prompt_and_inverse
    loss, sam_seg_show = self.prompting_coarse(H, W, seg_m, yolo_m, idx, index_matrix, num_obj)
  File "/home/lab/SA3D_YOLO/lib/sam3d.py", line 434, in prompting_coarse
    prompt_points, input_label = mask_to_prompt(predictor = self.predictor, rendered_mask_score = seg_m_for_prompt[:,:,num][:,:,None],
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/lab/SA3D_YOLO/lib/self_prompting.py", line 47, in mask_to_prompt
    previous_masks, previous_scores, previous_logits = predictor.predict(
  File "/home/lab/SA3D_YOLO/dependencies/sam_ckpt/segment-anything/segment_anything/predictor.py", line 134, in predict
    raise RuntimeError("An image must be set with .set_image(...) before mask prediction.")
RuntimeError: An image must be set with .set_image(...) before mask prediction.
ERROR:lib.gui:Exception on /_dash-update-component [POST]
Traceback (most recent call last):
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/flask/app.py", line 2073, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/flask/app.py", line 1518, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/flask/app.py", line 1516, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/flask/app.py", line 1502, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/dash/dash.py", line 1261, in dispatch
    ctx.run(
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/dash/_callback.py", line 440, in add_context
    output_value = func(*func_args, **func_kwargs)  # %% callback invoked %%
  File "/home/lab/SA3D_YOLO/lib/gui.py", line 569, in start_training
    rgb, sam_prompt, is_finished = self.Seg3d.train_step(self.train_idx)
  File "/home/lab/SA3D_YOLO/lib/sam3d.py", line 264, in train_step
    sam_seg_show = self.prompt_and_inverse(idx, HW, seg_m, yolo_m, dual_seg_m, depth)
  File "/home/lab/SA3D_YOLO/lib/sam3d.py", line 185, in prompt_and_inverse
    loss, sam_seg_show = self.prompting_coarse(H, W, seg_m, yolo_m, idx, index_matrix, num_obj)
  File "/home/lab/SA3D_YOLO/lib/sam3d.py", line 434, in prompting_coarse
    prompt_points, input_label = mask_to_prompt(predictor = self.predictor, rendered_mask_score = seg_m_for_prompt[:,:,num][:,:,None],
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/lab/SA3D_YOLO/lib/self_prompting.py", line 47, in mask_to_prompt
    previous_masks, previous_scores, previous_logits = predictor.predict(
  File "/home/lab/SA3D_YOLO/dependencies/sam_ckpt/segment-anything/segment_anything/predictor.py", line 134, in predict
    raise RuntimeError("An image must be set with .set_image(...) before mask prediction.")
RuntimeError: An image must be set with .set_image(...) before mask prediction.

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 3.2ms preprocess, 22.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 5
Instance 0: Confidence=0.9629
Instance 1: Confidence=0.9472
Instance 2: Confidence=0.9233
Instance 3: Confidence=0.8755
Instance 4: Confidence=0.7944
tmp min: tensor(0.) tmp max: tensor(1.)
852 44 540 960
There are 14 prompts
current IoU is: 0.9639057517051697
Seok, iteration idx= 2 IoU = tensor(0.9639)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 2.7ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.8868
Instance 4: Confidence=0.7933
tmp min: tensor(0.) tmp max: tensor(1.)
772 76 540 960
There are 13 prompts
current IoU is: 0.9316934943199158
Seok, iteration idx= 3 IoU = tensor(0.9317)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.6ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9409
Instance 3: Confidence=0.9232
Instance 4: Confidence=0.7056
Instance 5: Confidence=0.5562
tmp min: tensor(0.) tmp max: tensor(1.)
281 80 540 960
There are 15 prompts
current IoU is: 0.9307119846343994
Seok, iteration idx= 4 IoU = tensor(0.9307)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.4ms preprocess, 22.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9383
Instance 3: Confidence=0.8695
Instance 4: Confidence=0.6814
tmp min: tensor(0.) tmp max: tensor(1.)
295 92 540 960
There are 14 prompts
current IoU is: 0.910011351108551
Seok, iteration idx= 5 IoU = tensor(0.9100)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 1.8ms preprocess, 23.4ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9612
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8944
Instance 4: Confidence=0.5440
Instance 5: Confidence=0.3031
tmp min: tensor(0.) tmp max: tensor(1.)
336 124 540 960
There are 17 prompts
current IoU is: 0.9086123704910278
Seok, iteration idx= 6 IoU = tensor(0.9086)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9577
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.8692
Instance 4: Confidence=0.8435
Instance 5: Confidence=0.2911
tmp min: tensor(0.) tmp max: tensor(1.)
400 76 540 960
There are 16 prompts
current IoU is: 0.8338368535041809
Seok, iteration idx= 7 IoU = tensor(0.8338)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 2.2ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9609
Instance 2: Confidence=0.9381
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9067
Instance 5: Confidence=0.8774
tmp min: tensor(0.) tmp max: tensor(1.)
466 88 540 960
There are 13 prompts
current IoU is: 0.7898702621459961
Seok, iteration idx= 8 IoU = tensor(0.7899)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.4ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9636
Instance 1: Confidence=0.9628
Instance 2: Confidence=0.9492
Instance 3: Confidence=0.9315
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.3011
tmp min: tensor(0.) tmp max: tensor(1.)
469 24 540 960
There are 13 prompts
current IoU is: 0.0007439798209816217
Seok, iteration idx= 9 IoU = tensor(0.0007)
SKIP, unacceptable sam prediction, IoU is tensor(0.0007)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.5ms
Speed: 2.3ms preprocess, 21.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 7
Instance 0: Confidence=0.9600
Instance 1: Confidence=0.9489
Instance 2: Confidence=0.9429
Instance 3: Confidence=0.9350
Instance 4: Confidence=0.7563
Instance 5: Confidence=0.5645
Instance 6: Confidence=0.3526
tmp min: tensor(0.) tmp max: tensor(1.)
533 84 540 960
There are 16 prompts
current IoU is: 0.8768054246902466
Seok, iteration idx= 10 IoU = tensor(0.8768)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9504
Instance 3: Confidence=0.7410
Instance 4: Confidence=0.5533
Instance 5: Confidence=0.5528
Instance 6: Confidence=0.3753
tmp min: tensor(0.) tmp max: tensor(1.)
590 128 540 960
There are 13 prompts
current IoU is: 0.8192974925041199
Seok, iteration idx= 11 IoU = tensor(0.8193)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.6ms preprocess, 24.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9540
Instance 2: Confidence=0.9500
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9019
Instance 5: Confidence=0.7190
tmp min: tensor(0.) tmp max: tensor(1.)
684 48 540 960
There are 12 prompts
current IoU is: 0.8181818127632141
Seok, iteration idx= 12 IoU = tensor(0.8182)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9389
Instance 3: Confidence=0.9388
Instance 4: Confidence=0.9250
tmp min: tensor(0.) tmp max: tensor(1.)
687 48 540 960
There are 16 prompts
current IoU is: 0.002739181276410818
Seok, iteration idx= 13 IoU = tensor(0.0027)
SKIP, unacceptable sam prediction, IoU is tensor(0.0027)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9248
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9204
Instance 5: Confidence=0.5236
Instance 6: Confidence=0.2980
tmp min: tensor(0.) tmp max: tensor(1.)
748 56 540 960
There are 13 prompts
current IoU is: 0.7590603828430176
Seok, iteration idx= 14 IoU = tensor(0.7591)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.9090
Instance 5: Confidence=0.8731
tmp min: tensor(0.) tmp max: tensor(1.)
759 68 540 960
There are 17 prompts
current IoU is: 0.8711746335029602
Seok, iteration idx= 15 IoU = tensor(0.8712)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 2.6ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9339
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9057
Instance 5: Confidence=0.8295
tmp min: tensor(0.) tmp max: tensor(1.)
768 128 540 960
There are 15 prompts
current IoU is: 0.8879287838935852
Seok, iteration idx= 16 IoU = tensor(0.8879)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9287
Instance 4: Confidence=0.9237
tmp min: tensor(0.) tmp max: tensor(1.)
848 104 540 960
There are 12 prompts
current IoU is: 0.9183379411697388
Seok, iteration idx= 17 IoU = tensor(0.9183)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 2.5ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9501
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9253
Instance 3: Confidence=0.9167
Instance 4: Confidence=0.9130
Instance 5: Confidence=0.7570
tmp min: tensor(0.) tmp max: tensor(1.)
867 96 540 960
There are 12 prompts
current IoU is: 0.9478275179862976
Seok, iteration idx= 18 IoU = tensor(0.9478)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 2.7ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9468
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9173
Instance 3: Confidence=0.9139
Instance 4: Confidence=0.9082
Instance 5: Confidence=0.8839
tmp min: tensor(0.) tmp max: tensor(1.)
924 80 540 960
There are 12 prompts
current IoU is: 0.943605363368988
Seok, iteration idx= 19 IoU = tensor(0.9436)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 2.8ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9123
Instance 4: Confidence=0.8140
Instance 5: Confidence=0.7047
tmp min: tensor(0.) tmp max: tensor(1.)
100 88 540 960
There are 15 prompts
current IoU is: 0.9140959978103638
Seok, iteration idx= 20 IoU = tensor(0.9141)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.6ms
Speed: 2.9ms preprocess, 21.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9382
Instance 3: Confidence=0.9325
Instance 4: Confidence=0.8753
tmp min: tensor(0.) tmp max: tensor(1.)
83 80 540 960
There are 15 prompts
current IoU is: 0.930777370929718
Seok, iteration idx= 21 IoU = tensor(0.9308)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 2.7ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9564
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9442
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.9084
tmp min: tensor(0.) tmp max: tensor(1.)
95 72 540 960
There are 16 prompts
current IoU is: 0.9403417110443115
Seok, iteration idx= 22 IoU = tensor(0.9403)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.9ms preprocess, 24.2ms inference, 3.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9426
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9157
Instance 4: Confidence=0.8987
Instance 5: Confidence=0.8984
tmp min: tensor(0.) tmp max: tensor(1.)
91 72 540 960
There are 16 prompts
current IoU is: 0.936886191368103
Seok, iteration idx= 23 IoU = tensor(0.9369)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.6ms
Speed: 1.7ms preprocess, 25.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9580
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9340
Instance 3: Confidence=0.9104
Instance 4: Confidence=0.8875
tmp min: tensor(0.) tmp max: tensor(1.)
109 56 540 960
There are 15 prompts
current IoU is: 0.9353641867637634
Seok, iteration idx= 24 IoU = tensor(0.9354)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9439
Instance 2: Confidence=0.9419
Instance 3: Confidence=0.9107
Instance 4: Confidence=0.8744
Instance 5: Confidence=0.8606
tmp min: tensor(0.) tmp max: tensor(1.)
177 68 540 960
There are 14 prompts
current IoU is: 0.9276670217514038
Seok, iteration idx= 25 IoU = tensor(0.9277)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9461
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9423
Instance 3: Confidence=0.8899
Instance 4: Confidence=0.8821
Instance 5: Confidence=0.8120
tmp min: tensor(0.) tmp max: tensor(1.)
191 64 540 960
There are 14 prompts
current IoU is: 0.8926043510437012
Seok, iteration idx= 26 IoU = tensor(0.8926)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.4ms
Speed: 1.4ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9428
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.8651
Instance 4: Confidence=0.8009
Instance 5: Confidence=0.6158
tmp min: tensor(0.) tmp max: tensor(1.)
233 80 540 960
There are 15 prompts
current IoU is: 0.8559275269508362
Seok, iteration idx= 27 IoU = tensor(0.8559)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9324
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9186
Instance 3: Confidence=0.9152
Instance 4: Confidence=0.9005
Instance 5: Confidence=0.7954
tmp min: tensor(0.) tmp max: tensor(1.)
947 64 540 960
There are 16 prompts
current IoU is: 0.8878936767578125
Seok, iteration idx= 28 IoU = tensor(0.8879)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 1.6ms preprocess, 23.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9442
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8480
Instance 4: Confidence=0.7411
Instance 5: Confidence=0.4972
Instance 6: Confidence=0.3251
tmp min: tensor(0.) tmp max: tensor(1.)
956 152 540 960
There are 17 prompts
current IoU is: 0.9333606362342834
Seok, iteration idx= 29 IoU = tensor(0.9334)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.6ms
Speed: 2.6ms preprocess, 21.6ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9406
Instance 1: Confidence=0.9192
Instance 2: Confidence=0.8926
Instance 3: Confidence=0.8394
Instance 4: Confidence=0.4365
Instance 5: Confidence=0.4170
Instance 6: Confidence=0.3318
tmp min: tensor(0.) tmp max: tensor(1.)
956 200 540 960
There are 16 prompts
current IoU is: 0.9449709057807922
Seok, iteration idx= 30 IoU = tensor(0.9450)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 7
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9065
Instance 2: Confidence=0.7635
Instance 3: Confidence=0.5051
Instance 4: Confidence=0.4478
Instance 5: Confidence=0.4426
Instance 6: Confidence=0.2696
tmp min: tensor(0.) tmp max: tensor(1.)
952 268 540 960
There are 13 prompts
current IoU is: 0.9147999286651611
Seok, iteration idx= 31 IoU = tensor(0.9148)
Selected Instance Confidence List: [tensor(0.9153), tensor(0.8258, device='cpu'), tensor(0.7062, device='cpu'), tensor(0.9342, device='cpu'), tensor(0.7649, device='cpu'), tensor(0.8097, device='cpu'), tensor(0.8510, device='cpu'), tensor(0.7598, device='cpu'), tensor(0.7951, device='cpu'), tensor(0.3854, device='cpu'), tensor(0.8240, device='cpu'), tensor(0.6823, device='cpu'), tensor(0.5922, device='cpu'), tensor(0.3783, device='cpu'), tensor(0.4679, device='cpu'), tensor(0.8175, device='cpu'), tensor(0.8990, device='cpu'), tensor(0.9322, device='cpu'), tensor(0.9378, device='cpu'), tensor(0.9341, device='cpu'), tensor(0.9150, device='cpu'), tensor(0.9187, device='cpu'), tensor(0.9318, device='cpu'), tensor(0.9341, device='cpu'), tensor(0.9316, device='cpu'), tensor(0.9310, device='cpu'), tensor(0.8753, device='cpu'), tensor(0.8556, device='cpu'), tensor(0.9061, device='cpu'), tensor(0.8997, device='cpu'), tensor(0.9006, device='cpu'), tensor(0.8538, device='cpu')]
Sorted Confidence Order: [tensor(0.9378, device='cpu'), tensor(0.9322, device='cpu'), tensor(0.9341, device='cpu'), tensor(0.9061, device='cpu'), tensor(0.8997, device='cpu'), tensor(0.9006, device='cpu'), tensor(0.8538, device='cpu'), tensor(0.9153), tensor(0.8258, device='cpu'), tensor(0.7062, device='cpu'), tensor(0.9342, device='cpu'), tensor(0.8990, device='cpu'), tensor(0.8175, device='cpu'), tensor(0.4679, device='cpu'), tensor(0.3783, device='cpu'), tensor(0.5922, device='cpu'), tensor(0.6823, device='cpu'), tensor(0.8240, device='cpu'), tensor(0.3854, device='cpu'), tensor(0.7951, device='cpu'), tensor(0.7598, device='cpu'), tensor(0.8510, device='cpu'), tensor(0.8097, device='cpu'), tensor(0.7649, device='cpu'), tensor(0.8556, device='cpu'), tensor(0.8753, device='cpu'), tensor(0.9310, device='cpu'), tensor(0.9316, device='cpu'), tensor(0.9341, device='cpu'), tensor(0.9318, device='cpu'), tensor(0.9187, device='cpu'), tensor(0.9150, device='cpu')]
sorted_indices: [18, 17, 19, 28, 29, 30, 31, 0, 1, 2, 3, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 27, 26, 25, 24, 23, 22, 21, 20]
Initial view (highest confidence): 23
New training order: [35, 34, 36, 9, 10, 11, 12, 13, 14, 15, 16, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.1ms
Speed: 1.3ms preprocess, 20.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 2.1ms preprocess, 22.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9287
Instance 4: Confidence=0.9237
tmp min: tensor(0.) tmp max: tensor(1.)
848 104 540 960
There are 12 prompts
current IoU is: 0.9184536337852478
Seok, iteration idx= 1 IoU = tensor(0.9185)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 2.8ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9468
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9173
Instance 3: Confidence=0.9139
Instance 4: Confidence=0.9082
Instance 5: Confidence=0.8839
tmp min: tensor(0.) tmp max: tensor(1.)
924 80 540 960
There are 12 prompts
current IoU is: 0.9452792406082153
Seok, iteration idx= 2 IoU = tensor(0.9453)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 3.7ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 6
Instance 0: Confidence=0.9324
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9186
Instance 3: Confidence=0.9152
Instance 4: Confidence=0.9005
Instance 5: Confidence=0.7954
tmp min: tensor(0.) tmp max: tensor(1.)
947 64 540 960
There are 16 prompts
current IoU is: 0.8856682181358337
Seok, iteration idx= 3 IoU = tensor(0.8857)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.5ms
Speed: 3.7ms preprocess, 21.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 7
Instance 0: Confidence=0.9442
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8480
Instance 4: Confidence=0.7411
Instance 5: Confidence=0.4972
Instance 6: Confidence=0.3251
tmp min: tensor(0.) tmp max: tensor(1.)
956 152 540 960
There are 17 prompts
current IoU is: 0.9327794909477234
Seok, iteration idx= 4 IoU = tensor(0.9328)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 3.0ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 7
Instance 0: Confidence=0.9406
Instance 1: Confidence=0.9192
Instance 2: Confidence=0.8926
Instance 3: Confidence=0.8394
Instance 4: Confidence=0.4365
Instance 5: Confidence=0.4170
Instance 6: Confidence=0.3318
tmp min: tensor(0.) tmp max: tensor(1.)
956 200 540 960
There are 16 prompts
current IoU is: 0.9458611011505127
Seok, iteration idx= 5 IoU = tensor(0.9459)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.9ms
Speed: 2.9ms preprocess, 21.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 7
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9065
Instance 2: Confidence=0.7635
Instance 3: Confidence=0.5051
Instance 4: Confidence=0.4478
Instance 5: Confidence=0.4426
Instance 6: Confidence=0.2696
tmp min: tensor(0.) tmp max: tensor(1.)
952 268 540 960
There are 13 prompts
current IoU is: 0.9136412143707275
Seok, iteration idx= 6 IoU = tensor(0.9136)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.4ms
Speed: 2.7ms preprocess, 22.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 8
Instance 0: Confidence=0.9377
Instance 1: Confidence=0.9249
Instance 2: Confidence=0.9153
Instance 3: Confidence=0.7253
Instance 4: Confidence=0.7085
Instance 5: Confidence=0.4352
Instance 6: Confidence=0.3452
Instance 7: Confidence=0.2772
tmp min: tensor(0.) tmp max: tensor(1.)
949 36 540 960
There are 17 prompts
current IoU is: 0.9435960054397583
Seok, iteration idx= 7 IoU = tensor(0.9436)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 3.0ms preprocess, 23.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9300
Instance 3: Confidence=0.8918
Instance 4: Confidence=0.8458
Instance 5: Confidence=0.3819
tmp min: tensor(0.) tmp max: tensor(1.)
940 20 540 960
There are 13 prompts
current IoU is: 0.9591214060783386
Seok, iteration idx= 8 IoU = tensor(0.9591)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.7ms
Speed: 1.4ms preprocess, 25.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9629
Instance 1: Confidence=0.9472
Instance 2: Confidence=0.9233
Instance 3: Confidence=0.8755
Instance 4: Confidence=0.7944
tmp min: tensor(0.) tmp max: tensor(1.)
852 44 540 960
There are 14 prompts
current IoU is: 0.9643256068229675
Seok, iteration idx= 9 IoU = tensor(0.9643)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.8868
Instance 4: Confidence=0.7933
tmp min: tensor(0.) tmp max: tensor(1.)
772 76 540 960
There are 13 prompts
current IoU is: 0.9318904876708984
Seok, iteration idx= 10 IoU = tensor(0.9319)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.4ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9339
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9057
Instance 5: Confidence=0.8295
tmp min: tensor(0.) tmp max: tensor(1.)
768 128 540 960
There are 15 prompts
current IoU is: 0.8853633999824524
Seok, iteration idx= 11 IoU = tensor(0.8854)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 3.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9407
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.9090
Instance 5: Confidence=0.8731
tmp min: tensor(0.) tmp max: tensor(1.)
759 68 540 960
There are 17 prompts
current IoU is: 0.8699358701705933
Seok, iteration idx= 12 IoU = tensor(0.8699)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.0ms
Speed: 1.6ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9474
Instance 2: Confidence=0.9248
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9204
Instance 5: Confidence=0.5236
Instance 6: Confidence=0.2980
tmp min: tensor(0.) tmp max: tensor(1.)
748 56 540 960
There are 13 prompts
current IoU is: 0.7511674165725708
Seok, iteration idx= 13 IoU = tensor(0.7512)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 2.0ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9389
Instance 3: Confidence=0.9388
Instance 4: Confidence=0.9250
tmp min: tensor(0.) tmp max: tensor(1.)
687 48 540 960
There are 16 prompts
current IoU is: 0.002758651040494442
Seok, iteration idx= 14 IoU = tensor(0.0028)
SKIP, unacceptable sam prediction, IoU is tensor(0.0028)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.7ms preprocess, 23.5ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9540
Instance 2: Confidence=0.9500
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9019
Instance 5: Confidence=0.7190
tmp min: tensor(0.) tmp max: tensor(1.)
684 48 540 960
There are 12 prompts
current IoU is: 0.8220015168190002
Seok, iteration idx= 15 IoU = tensor(0.8220)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 7
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9504
Instance 3: Confidence=0.7410
Instance 4: Confidence=0.5533
Instance 5: Confidence=0.5528
Instance 6: Confidence=0.3753
tmp min: tensor(0.) tmp max: tensor(1.)
590 128 540 960
There are 13 prompts
current IoU is: 0.8184511065483093
Seok, iteration idx= 16 IoU = tensor(0.8185)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.1ms
Speed: 1.4ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 7
Instance 0: Confidence=0.9600
Instance 1: Confidence=0.9489
Instance 2: Confidence=0.9429
Instance 3: Confidence=0.9350
Instance 4: Confidence=0.7563
Instance 5: Confidence=0.5645
Instance 6: Confidence=0.3526
tmp min: tensor(0.) tmp max: tensor(1.)
533 84 540 960
There are 16 prompts
current IoU is: 0.8743099570274353
Seok, iteration idx= 17 IoU = tensor(0.8743)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 25.1ms
Speed: 1.7ms preprocess, 25.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9636
Instance 1: Confidence=0.9628
Instance 2: Confidence=0.9492
Instance 3: Confidence=0.9315
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.3011
tmp min: tensor(0.) tmp max: tensor(1.)
469 24 540 960
There are 13 prompts
current IoU is: 0.0007287744665518403
Seok, iteration idx= 18 IoU = tensor(0.0007)
SKIP, unacceptable sam prediction, IoU is tensor(0.0007)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9609
Instance 2: Confidence=0.9381
Instance 3: Confidence=0.9365
Instance 4: Confidence=0.9067
Instance 5: Confidence=0.8774
tmp min: tensor(0.) tmp max: tensor(1.)
466 88 540 960
There are 13 prompts
current IoU is: 0.7895397543907166
Seok, iteration idx= 19 IoU = tensor(0.7895)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 1.4ms preprocess, 24.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9577
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.8692
Instance 4: Confidence=0.8435
Instance 5: Confidence=0.2911
tmp min: tensor(0.) tmp max: tensor(1.)
400 76 540 960
There are 16 prompts
current IoU is: 0.8338033556938171
Seok, iteration idx= 20 IoU = tensor(0.8338)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 2.9ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9612
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8944
Instance 4: Confidence=0.5440
Instance 5: Confidence=0.3031
tmp min: tensor(0.) tmp max: tensor(1.)
336 124 540 960
There are 17 prompts
current IoU is: 0.9080140590667725
Seok, iteration idx= 21 IoU = tensor(0.9080)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 3.3ms preprocess, 22.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9575
Instance 2: Confidence=0.9383
Instance 3: Confidence=0.8695
Instance 4: Confidence=0.6814
tmp min: tensor(0.) tmp max: tensor(1.)
295 92 540 960
There are 14 prompts
current IoU is: 0.9082794785499573
Seok, iteration idx= 22 IoU = tensor(0.9083)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 2.9ms preprocess, 22.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9409
Instance 3: Confidence=0.9232
Instance 4: Confidence=0.7056
Instance 5: Confidence=0.5562
tmp min: tensor(0.) tmp max: tensor(1.)
281 80 540 960
There are 15 prompts
current IoU is: 0.9297759532928467
Seok, iteration idx= 23 IoU = tensor(0.9298)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 2.6ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9428
Instance 2: Confidence=0.9324
Instance 3: Confidence=0.8651
Instance 4: Confidence=0.8009
Instance 5: Confidence=0.6158
tmp min: tensor(0.) tmp max: tensor(1.)
233 80 540 960
There are 15 prompts
current IoU is: 0.8585010170936584
Seok, iteration idx= 24 IoU = tensor(0.8585)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.4ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9461
Instance 1: Confidence=0.9430
Instance 2: Confidence=0.9423
Instance 3: Confidence=0.8899
Instance 4: Confidence=0.8821
Instance 5: Confidence=0.8120
tmp min: tensor(0.) tmp max: tensor(1.)
191 64 540 960
There are 14 prompts
current IoU is: 0.8919512033462524
Seok, iteration idx= 25 IoU = tensor(0.8920)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 1.7ms preprocess, 22.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9439
Instance 2: Confidence=0.9419
Instance 3: Confidence=0.9107
Instance 4: Confidence=0.8744
Instance 5: Confidence=0.8606
tmp min: tensor(0.) tmp max: tensor(1.)
177 68 540 960
There are 14 prompts
current IoU is: 0.9287260174751282
Seok, iteration idx= 26 IoU = tensor(0.9287)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9580
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9340
Instance 3: Confidence=0.9104
Instance 4: Confidence=0.8875
tmp min: tensor(0.) tmp max: tensor(1.)
109 56 540 960
There are 15 prompts
current IoU is: 0.9373998641967773
Seok, iteration idx= 27 IoU = tensor(0.9374)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.5ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9581
Instance 1: Confidence=0.9426
Instance 2: Confidence=0.9399
Instance 3: Confidence=0.9157
Instance 4: Confidence=0.8987
Instance 5: Confidence=0.8984
tmp min: tensor(0.) tmp max: tensor(1.)
91 72 540 960
There are 16 prompts
current IoU is: 0.9384222626686096
Seok, iteration idx= 28 IoU = tensor(0.9384)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.3ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9564
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.9442
Instance 3: Confidence=0.9409
Instance 4: Confidence=0.9084
tmp min: tensor(0.) tmp max: tensor(1.)
95 72 540 960
There are 16 prompts
current IoU is: 0.9417549967765808
Seok, iteration idx= 29 IoU = tensor(0.9418)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9382
Instance 3: Confidence=0.9325
Instance 4: Confidence=0.8753
tmp min: tensor(0.) tmp max: tensor(1.)
83 80 540 960
There are 15 prompts
current IoU is: 0.9321385622024536
Seok, iteration idx= 30 IoU = tensor(0.9321)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.4ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9123
Instance 4: Confidence=0.8140
Instance 5: Confidence=0.7047
tmp min: tensor(0.) tmp max: tensor(1.)
100 88 540 960
There are 15 prompts
current IoU is: 0.9121137261390686
Seok, iteration idx= 31 IoU = tensor(0.9121)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set2_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set2_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.24s/it]
Testing psnr 28.1736521422863 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set2_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.16it/s]
Testing psnr 3.1711321882903576 (avg)
train: coarse segmentation in 00:10:13
train: finish (eps time 00:10:13 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set2_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set3/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 45.80it/s]
Loaded image data (540, 960, 3, 32) [        540         960      752.34]
Loaded ./data/360_v2/Set3 1.7761290072006928 55.6629549596001
UserWarning: Optimal rotation is not uniquely or poorly defined for the given sets of vectors.
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960      752.34] ./data/360_v2/Set3
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.36282292306423186
original far 12.634090423583984
NEAR FAR 0 2.2571032
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-0.9373, -0.8730, -0.7720])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.6911, 0.7554, 0.8564])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set3_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.6ms
Speed: 2.6ms preprocess, 19.6ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.4ms
Speed: 1.2ms preprocess, 18.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.5ms
Speed: 1.3ms preprocess, 18.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.1ms
Speed: 1.3ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.4ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.3ms
Speed: 1.5ms preprocess, 19.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.5ms
Speed: 1.4ms preprocess, 18.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.4ms preprocess, 19.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.5ms
Speed: 1.3ms preprocess, 18.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.2ms
Speed: 1.4ms preprocess, 19.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.5ms
Speed: 1.3ms preprocess, 18.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.3ms
Speed: 1.3ms preprocess, 19.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.5ms
Speed: 1.3ms preprocess, 18.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.5ms
Speed: 1.2ms preprocess, 18.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.5ms
Speed: 1.2ms preprocess, 18.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.4ms
Speed: 1.5ms preprocess, 19.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.5ms
Speed: 1.2ms preprocess, 19.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.5ms
Speed: 1.2ms preprocess, 18.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.5ms
Speed: 1.2ms preprocess, 18.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.2ms
Speed: 2.9ms preprocess, 21.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.7ms
Speed: 1.3ms preprocess, 19.7ms inference, 3.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9418
Instance 2: Confidence=0.9238
Instance 3: Confidence=0.9103
Instance 4: Confidence=0.8137
Instance 5: Confidence=0.3678
Selected instance: 2 (Confidence: 0.9238)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

260 56 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 15 prompts
current IoU is: 0.8192120790481567
Seok, iteration idx= 1 IoU = tensor(0.8192)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 4.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9432
Instance 1: Confidence=0.9382
Instance 2: Confidence=0.9229
Instance 3: Confidence=0.9166
Instance 4: Confidence=0.8470
Instance 5: Confidence=0.8422
Selected instance: 2 (Confidence: 0.9229)
tmp min: tensor(0.) tmp max: tensor(1.)
268 76 540 960
There are 16 prompts
current IoU is: 0.777642011642456
Seok, iteration idx= 2 IoU = tensor(0.7776)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9398
Instance 1: Confidence=0.9287
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.8930
Instance 4: Confidence=0.8873
Selected instance: 2 (Confidence: 0.9172)
tmp min: tensor(0.) tmp max: tensor(1.)
278 116 540 960
There are 17 prompts
current IoU is: 0.8550633192062378
Seok, iteration idx= 3 IoU = tensor(0.8551)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 1.7ms preprocess, 22.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 7
Instance 0: Confidence=0.9443
Instance 1: Confidence=0.9263
Instance 2: Confidence=0.9112
Instance 3: Confidence=0.8529
Instance 4: Confidence=0.7917
Instance 5: Confidence=0.5320
Instance 6: Confidence=0.4048
Selected instance: 5 (Confidence: 0.5320)
tmp min: tensor(0.) tmp max: tensor(1.)
662 60 540 960
current IoU is: 0.43767109513282776
Seok, iteration idx= 4 IoU = tensor(0.4377)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.5ms
Speed: 1.4ms preprocess, 22.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 8
Instance 0: Confidence=0.9391
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9228
Instance 3: Confidence=0.8782
Instance 4: Confidence=0.6843
Instance 5: Confidence=0.5397
Instance 6: Confidence=0.5218
Instance 7: Confidence=0.3399
Selected instance: 5 (Confidence: 0.5397)
tmp min: tensor(0.) tmp max: tensor(1.)
679 104 540 960
There are 18 prompts
current IoU is: 0.20332440733909607
Seok, iteration idx= 5 IoU = tensor(0.2033)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.7ms preprocess, 23.8ms inference, 3.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9437
Instance 1: Confidence=0.9314
Instance 2: Confidence=0.9091
Instance 3: Confidence=0.8747
Instance 4: Confidence=0.8331
Selected instance: 4 (Confidence: 0.8331)
tmp min: tensor(0.) tmp max: tensor(1.)
677 100 540 960
There are 16 prompts
current IoU is: 0.5556209683418274
Seok, iteration idx= 6 IoU = tensor(0.5556)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9220
Instance 1: Confidence=0.9218
Instance 2: Confidence=0.9069
Instance 3: Confidence=0.9049
Instance 4: Confidence=0.9018
Instance 5: Confidence=0.8183
Selected instance: 2 (Confidence: 0.9069)
tmp min: tensor(0.) tmp max: tensor(1.)
681 52 540 960
There are 13 prompts
current IoU is: 0.7495230436325073
Seok, iteration idx= 7 IoU = tensor(0.7495)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 2.9ms preprocess, 22.9ms inference, 3.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.8996
Instance 3: Confidence=0.8888
Instance 4: Confidence=0.8676
Selected instance: 3 (Confidence: 0.8888)
tmp min: tensor(0.) tmp max: tensor(1.)
679 48 540 960
There are 15 prompts
current IoU is: 0.8762165904045105
Seok, iteration idx= 8 IoU = tensor(0.8762)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.0ms
Speed: 1.5ms preprocess, 22.0ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9476
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.8890
Instance 3: Confidence=0.8363
Instance 4: Confidence=0.8338
Selected instance: 4 (Confidence: 0.8338)
tmp min: tensor(0.) tmp max: tensor(1.)
679 20 540 960
There are 16 prompts
current IoU is: 0.8817747235298157
Seok, iteration idx= 9 IoU = tensor(0.8818)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 1.4ms preprocess, 24.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9144
Instance 2: Confidence=0.9064
Instance 3: Confidence=0.9036
Instance 4: Confidence=0.8918
Instance 5: Confidence=0.8164
Selected instance: 1 (Confidence: 0.9144)
tmp min: tensor(0.) tmp max: tensor(1.)
661 28 540 960
There are 15 prompts
current IoU is: 0.9241893291473389
Seok, iteration idx= 10 IoU = tensor(0.9242)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.9ms
Speed: 1.4ms preprocess, 21.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9670
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9256
Instance 3: Confidence=0.8502
Instance 4: Confidence=0.8407
Instance 5: Confidence=0.5675
Instance 6: Confidence=0.2603
Selected instance: 1 (Confidence: 0.9288)
tmp min: tensor(0.) tmp max: tensor(1.)
697 8 540 960
There are 14 prompts
current IoU is: 0.9539573192596436
Seok, iteration idx= 11 IoU = tensor(0.9540)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.7ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9585
Instance 1: Confidence=0.9275
Instance 2: Confidence=0.9113
Instance 3: Confidence=0.9041
Instance 4: Confidence=0.8095
Selected instance: 1 (Confidence: 0.9275)
tmp min: tensor(0.) tmp max: tensor(1.)
673 0 540 960
There are 14 prompts
current IoU is: 0.9448097348213196
Seok, iteration idx= 12 IoU = tensor(0.9448)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.6ms
Speed: 1.7ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 4
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9405
Instance 2: Confidence=0.9168
Instance 3: Confidence=0.8296
Selected instance: 1 (Confidence: 0.9405)
tmp min: tensor(0.) tmp max: tensor(1.)
614 28 540 960
There are 13 prompts
current IoU is: 0.9435372352600098
Seok, iteration idx= 13 IoU = tensor(0.9435)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9529
Instance 1: Confidence=0.9514
Instance 2: Confidence=0.9135
Instance 3: Confidence=0.9119
Instance 4: Confidence=0.3781
Selected instance: 1 (Confidence: 0.9514)
tmp min: tensor(0.) tmp max: tensor(1.)
576 0 540 960
There are 16 prompts
current IoU is: 0.9612693190574646
Seok, iteration idx= 14 IoU = tensor(0.9613)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9456
Instance 1: Confidence=0.9262
Instance 2: Confidence=0.8959
Instance 3: Confidence=0.8348
Instance 4: Confidence=0.6141
Instance 5: Confidence=0.3271
Selected instance: 0 (Confidence: 0.9456)
tmp min: tensor(0.) tmp max: tensor(1.)
536 16 540 960
There are 15 prompts
current IoU is: 0.9692564010620117
Seok, iteration idx= 15 IoU = tensor(0.9693)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.1ms
Speed: 1.4ms preprocess, 22.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9397
Instance 2: Confidence=0.9054
Instance 3: Confidence=0.8999
Instance 4: Confidence=0.8815
Instance 5: Confidence=0.8617
Selected instance: 1 (Confidence: 0.9397)
tmp min: tensor(0.) tmp max: tensor(1.)
460 100 540 960
There are 13 prompts
current IoU is: 0.9596834778785706
Seok, iteration idx= 16 IoU = tensor(0.9597)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9502
Instance 1: Confidence=0.9332
Instance 2: Confidence=0.9264
Instance 3: Confidence=0.9254
Instance 4: Confidence=0.9229
Instance 5: Confidence=0.5863
Selected instance: 0 (Confidence: 0.9502)
tmp min: tensor(0.) tmp max: tensor(1.)
409 64 540 960
There are 12 prompts
current IoU is: 0.9658035039901733
Seok, iteration idx= 17 IoU = tensor(0.9658)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 1.8ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9502
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9259
Instance 3: Confidence=0.9246
Instance 4: Confidence=0.7572
Selected instance: 0 (Confidence: 0.9502)
tmp min: tensor(0.) tmp max: tensor(1.)
373 68 540 960
There are 12 prompts
current IoU is: 0.9591028094291687
Seok, iteration idx= 18 IoU = tensor(0.9591)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 1.6ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9451
Instance 2: Confidence=0.9205
Instance 3: Confidence=0.8957
Instance 4: Confidence=0.7199
Instance 5: Confidence=0.6674
Instance 6: Confidence=0.4065
Selected instance: 0 (Confidence: 0.9579)
tmp min: tensor(0.) tmp max: tensor(1.)
360 32 540 960
There are 13 prompts
current IoU is: 0.9594311714172363
Seok, iteration idx= 19 IoU = tensor(0.9594)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 2.2ms preprocess, 23.3ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9306
Instance 1: Confidence=0.9305
Instance 2: Confidence=0.9199
Instance 3: Confidence=0.9194
Instance 4: Confidence=0.9074
Instance 5: Confidence=0.8918
Selected instance: 2 (Confidence: 0.9199)
tmp min: tensor(0.) tmp max: tensor(1.)
510 100 540 960
There are 16 prompts
current IoU is: 0.8679832220077515
Seok, iteration idx= 20 IoU = tensor(0.8680)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 2.8ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9305
Instance 1: Confidence=0.9276
Instance 2: Confidence=0.9191
Instance 3: Confidence=0.8996
Instance 4: Confidence=0.8552
Instance 5: Confidence=0.8230
Selected instance: 5 (Confidence: 0.8230)
tmp min: tensor(0.) tmp max: tensor(1.)
537 76 540 960
There are 16 prompts
current IoU is: 0.7795882225036621
Seok, iteration idx= 21 IoU = tensor(0.7796)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 8
Instance 0: Confidence=0.9374
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9352
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.5537
Instance 5: Confidence=0.3907
Instance 6: Confidence=0.3726
Instance 7: Confidence=0.3383
Selected instance: 5 (Confidence: 0.3907)
tmp min: tensor(0.) tmp max: tensor(1.)
602 120 540 960
There are 11 prompts
current IoU is: 0.13934850692749023
Seok, iteration idx= 22 IoU = tensor(0.1393)
SKIP, unacceptable sam prediction, IoU is tensor(0.1393)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9308
Instance 2: Confidence=0.9301
Instance 3: Confidence=0.9154
Instance 4: Confidence=0.8041
Selected instance: 4 (Confidence: 0.8041)
tmp min: tensor(0.) tmp max: tensor(1.)
578 68 540 960
There are 18 prompts
current IoU is: 0.8245547413825989
Seok, iteration idx= 23 IoU = tensor(0.8246)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 2.2ms preprocess, 22.8ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9390
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9113
Instance 3: Confidence=0.9079
Instance 4: Confidence=0.8845
Selected instance: 4 (Confidence: 0.8845)
tmp min: tensor(0.) tmp max: tensor(1.)
586 48 540 960
There are 18 prompts
current IoU is: 0.8198094367980957
Seok, iteration idx= 24 IoU = tensor(0.8198)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9429
Instance 1: Confidence=0.9358
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.8998
Instance 4: Confidence=0.8047
Instance 5: Confidence=0.7897
Selected instance: 3 (Confidence: 0.8998)
tmp min: tensor(0.) tmp max: tensor(1.)
620 48 540 960
There are 15 prompts
current IoU is: 0.8431277275085449
Seok, iteration idx= 25 IoU = tensor(0.8431)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9544
Instance 1: Confidence=0.9382
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.9165
Instance 4: Confidence=0.9129
Selected instance: 1 (Confidence: 0.9382)
tmp min: tensor(0.) tmp max: tensor(1.)
619 40 540 960
There are 15 prompts
current IoU is: 0.8138757348060608
Seok, iteration idx= 26 IoU = tensor(0.8139)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 1.6ms preprocess, 22.2ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9328
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.9281
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8874
Instance 5: Confidence=0.8685
Selected instance: 4 (Confidence: 0.8874)
tmp min: tensor(0.) tmp max: tensor(1.)
623 28 540 960
current IoU is: 0.7475355863571167
Seok, iteration idx= 27 IoU = tensor(0.7475)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 7
Instance 0: Confidence=0.9433
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.9262
Instance 3: Confidence=0.9099
Instance 4: Confidence=0.9046
Instance 5: Confidence=0.7494
Instance 6: Confidence=0.2752
Selected instance: 1 (Confidence: 0.9320)
tmp min: tensor(0.) tmp max: tensor(1.)
337 16 540 960
There are 13 prompts
current IoU is: 0.9347298741340637
Seok, iteration idx= 28 IoU = tensor(0.9347)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 3.5ms preprocess, 22.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9436
Instance 2: Confidence=0.9257
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9060
Instance 5: Confidence=0.4599
Selected instance: 0 (Confidence: 0.9447)
tmp min: tensor(0.) tmp max: tensor(1.)
292 16 540 960
There are 16 prompts
current IoU is: 0.9245160222053528
Seok, iteration idx= 29 IoU = tensor(0.9245)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 3.2ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9418
Instance 2: Confidence=0.9267
Instance 3: Confidence=0.9179
Instance 4: Confidence=0.8670
Selected instance: 0 (Confidence: 0.9594)
tmp min: tensor(0.) tmp max: tensor(1.)
276 12 540 960
There are 17 prompts
current IoU is: 0.9418879747390747
Seok, iteration idx= 30 IoU = tensor(0.9419)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 2.8ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9559
Instance 1: Confidence=0.9546
Instance 2: Confidence=0.9364
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.8237
Instance 5: Confidence=0.3776
Selected instance: 0 (Confidence: 0.9559)
tmp min: tensor(0.) tmp max: tensor(1.)
252 16 540 960
There are 17 prompts
current IoU is: 0.9413121938705444
Seok, iteration idx= 31 IoU = tensor(0.9413)
Selected Instance Confidence List: [tensor(0.9111), tensor(0.8610, device='cpu'), tensor(0.8357, device='cpu'), tensor(0.8799, device='cpu'), tensor(0.4754, device='cpu'), tensor(0.3891, device='cpu'), tensor(0.6666, device='cpu'), tensor(0.8125, device='cpu'), tensor(0.8813, device='cpu'), tensor(0.8626, device='cpu'), tensor(0.9203, device='cpu'), tensor(0.9439, device='cpu'), tensor(0.9379, device='cpu'), tensor(0.9423, device='cpu'), tensor(0.9573, device='cpu'), tensor(0.9598, device='cpu'), tensor(0.9517, device='cpu'), tensor(0.9596, device='cpu'), tensor(0.9556, device='cpu'), tensor(0.9588, device='cpu'), tensor(0.8887, device='cpu'), tensor(0.7969, device='cpu'), tensor(0.3828, device='cpu'), tensor(0.8164, device='cpu'), tensor(0.8457, device='cpu'), tensor(0.8658, device='cpu'), tensor(0.8636, device='cpu'), tensor(0.8035, device='cpu'), tensor(0.9336, device='cpu'), tensor(0.9326, device='cpu'), tensor(0.9489, device='cpu'), tensor(0.9471, device='cpu')]
Sorted Confidence Order: [tensor(0.9598, device='cpu'), tensor(0.9573, device='cpu'), tensor(0.9423, device='cpu'), tensor(0.9379, device='cpu'), tensor(0.9439, device='cpu'), tensor(0.9203, device='cpu'), tensor(0.8626, device='cpu'), tensor(0.8813, device='cpu'), tensor(0.8125, device='cpu'), tensor(0.6666, device='cpu'), tensor(0.3891, device='cpu'), tensor(0.4754, device='cpu'), tensor(0.8035, device='cpu'), tensor(0.8636, device='cpu'), tensor(0.8658, device='cpu'), tensor(0.8457, device='cpu'), tensor(0.8164, device='cpu'), tensor(0.3828, device='cpu'), tensor(0.7969, device='cpu'), tensor(0.8887, device='cpu'), tensor(0.8799, device='cpu'), tensor(0.8357, device='cpu'), tensor(0.8610, device='cpu'), tensor(0.9111), tensor(0.9471, device='cpu'), tensor(0.9489, device='cpu'), tensor(0.9326, device='cpu'), tensor(0.9336, device='cpu'), tensor(0.9588, device='cpu'), tensor(0.9556, device='cpu'), tensor(0.9596, device='cpu'), tensor(0.9517, device='cpu')]
sorted_indices: [15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 27, 26, 25, 24, 23, 22, 21, 20, 3, 2, 1, 0, 31, 30, 29, 28, 19, 18, 17, 16]
Initial view (highest confidence): 16
New training order: [32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15, 14, 13, 12, 11, 10, 9, 36, 35, 34, 33]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.5ms
Speed: 1.3ms preprocess, 19.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 3.1ms preprocess, 23.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9529
Instance 1: Confidence=0.9514
Instance 2: Confidence=0.9135
Instance 3: Confidence=0.9119
Instance 4: Confidence=0.3781
tmp min: tensor(0.) tmp max: tensor(1.)
576 0 540 960
There are 16 prompts
current IoU is: 0.9626134037971497
Seok, iteration idx= 1 IoU = tensor(0.9626)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.1ms
Speed: 2.6ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 4
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9405
Instance 2: Confidence=0.9168
Instance 3: Confidence=0.8296
tmp min: tensor(0.) tmp max: tensor(1.)
614 28 540 960
There are 13 prompts
current IoU is: 0.953196108341217
Seok, iteration idx= 2 IoU = tensor(0.9532)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 2.6ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9585
Instance 1: Confidence=0.9275
Instance 2: Confidence=0.9113
Instance 3: Confidence=0.9041
Instance 4: Confidence=0.8095
tmp min: tensor(0.) tmp max: tensor(1.)
673 0 540 960
There are 14 prompts
current IoU is: 0.9616245627403259
Seok, iteration idx= 3 IoU = tensor(0.9616)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.8ms
Speed: 3.2ms preprocess, 21.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 7
Instance 0: Confidence=0.9670
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9256
Instance 3: Confidence=0.8502
Instance 4: Confidence=0.8407
Instance 5: Confidence=0.5675
Instance 6: Confidence=0.2603
tmp min: tensor(0.) tmp max: tensor(1.)
697 8 540 960
There are 14 prompts
current IoU is: 0.9661943316459656
Seok, iteration idx= 4 IoU = tensor(0.9662)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 3.3ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9144
Instance 2: Confidence=0.9064
Instance 3: Confidence=0.9036
Instance 4: Confidence=0.8918
Instance 5: Confidence=0.8164
tmp min: tensor(0.) tmp max: tensor(1.)
661 28 540 960
There are 15 prompts
current IoU is: 0.9618518948554993
Seok, iteration idx= 5 IoU = tensor(0.9619)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 3.4ms preprocess, 22.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9476
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.8890
Instance 3: Confidence=0.8363
Instance 4: Confidence=0.8338
tmp min: tensor(0.) tmp max: tensor(1.)
679 20 540 960
There are 16 prompts
current IoU is: 0.9559552669525146
Seok, iteration idx= 6 IoU = tensor(0.9560)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 2.4ms preprocess, 23.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.8996
Instance 3: Confidence=0.8888
Instance 4: Confidence=0.8676
tmp min: tensor(0.) tmp max: tensor(1.)
679 48 540 960
There are 15 prompts
current IoU is: 0.932510256767273
Seok, iteration idx= 7 IoU = tensor(0.9325)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 4.8ms preprocess, 22.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9220
Instance 1: Confidence=0.9218
Instance 2: Confidence=0.9069
Instance 3: Confidence=0.9049
Instance 4: Confidence=0.9018
Instance 5: Confidence=0.8183
tmp min: tensor(0.) tmp max: tensor(1.)
681 52 540 960
There are 13 prompts
current IoU is: 0.9431375861167908
Seok, iteration idx= 8 IoU = tensor(0.9431)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 3.0ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9437
Instance 1: Confidence=0.9314
Instance 2: Confidence=0.9091
Instance 3: Confidence=0.8747
Instance 4: Confidence=0.8331
tmp min: tensor(0.) tmp max: tensor(1.)
677 100 540 960
There are 16 prompts
current IoU is: 0.8985415101051331
Seok, iteration idx= 9 IoU = tensor(0.8985)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.3ms
Speed: 2.7ms preprocess, 22.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 8
Instance 0: Confidence=0.9391
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9228
Instance 3: Confidence=0.8782
Instance 4: Confidence=0.6843
Instance 5: Confidence=0.5397
Instance 6: Confidence=0.5218
Instance 7: Confidence=0.3399
tmp min: tensor(0.) tmp max: tensor(1.)
679 104 540 960
There are 18 prompts
current IoU is: 0.7967602610588074
Seok, iteration idx= 10 IoU = tensor(0.7968)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 2.9ms preprocess, 22.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9443
Instance 1: Confidence=0.9263
Instance 2: Confidence=0.9112
Instance 3: Confidence=0.8529
Instance 4: Confidence=0.7917
Instance 5: Confidence=0.5320
Instance 6: Confidence=0.4048
tmp min: tensor(0.) tmp max: tensor(1.)
661 60 540 960
current IoU is: 0.5702106356620789
Seok, iteration idx= 11 IoU = tensor(0.5702)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 3.3ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9328
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.9281
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8874
Instance 5: Confidence=0.8685
tmp min: tensor(0.) tmp max: tensor(1.)
623 28 540 960
current IoU is: 0.7610887289047241
Seok, iteration idx= 12 IoU = tensor(0.7611)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 2.8ms preprocess, 23.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9544
Instance 1: Confidence=0.9382
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.9165
Instance 4: Confidence=0.9129
tmp min: tensor(0.) tmp max: tensor(1.)
619 40 540 960
There are 15 prompts
current IoU is: 0.8618022203445435
Seok, iteration idx= 13 IoU = tensor(0.8618)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 2.5ms preprocess, 23.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9429
Instance 1: Confidence=0.9358
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.8998
Instance 4: Confidence=0.8047
Instance 5: Confidence=0.7897
tmp min: tensor(0.) tmp max: tensor(1.)
620 48 540 960
There are 15 prompts
current IoU is: 0.8775458931922913
Seok, iteration idx= 14 IoU = tensor(0.8775)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.6ms preprocess, 23.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9390
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9113
Instance 3: Confidence=0.9079
Instance 4: Confidence=0.8845
tmp min: tensor(0.) tmp max: tensor(1.)
586 48 540 960
There are 18 prompts
current IoU is: 0.87662672996521
Seok, iteration idx= 15 IoU = tensor(0.8766)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9308
Instance 2: Confidence=0.9301
Instance 3: Confidence=0.9154
Instance 4: Confidence=0.8041
tmp min: tensor(0.) tmp max: tensor(1.)
578 68 540 960
There are 18 prompts
current IoU is: 0.8667566180229187
Seok, iteration idx= 16 IoU = tensor(0.8668)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.8ms
Speed: 1.7ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 8
Instance 0: Confidence=0.9374
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9352
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.5537
Instance 5: Confidence=0.3907
Instance 6: Confidence=0.3726
Instance 7: Confidence=0.3383
tmp min: tensor(0.) tmp max: tensor(1.)
602 120 540 960
There are 11 prompts
current IoU is: 0.21777591109275818
Seok, iteration idx= 17 IoU = tensor(0.2178)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9305
Instance 1: Confidence=0.9276
Instance 2: Confidence=0.9191
Instance 3: Confidence=0.8996
Instance 4: Confidence=0.8552
Instance 5: Confidence=0.8230
tmp min: tensor(0.) tmp max: tensor(1.)
537 76 540 960
There are 16 prompts
current IoU is: 0.8283385634422302
Seok, iteration idx= 18 IoU = tensor(0.8283)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.6ms preprocess, 23.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9306
Instance 1: Confidence=0.9305
Instance 2: Confidence=0.9199
Instance 3: Confidence=0.9194
Instance 4: Confidence=0.9074
Instance 5: Confidence=0.8918
tmp min: tensor(0.) tmp max: tensor(1.)
510 100 540 960
There are 16 prompts
current IoU is: 0.8867353200912476
Seok, iteration idx= 19 IoU = tensor(0.8867)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.6ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 5
Instance 0: Confidence=0.9398
Instance 1: Confidence=0.9287
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.8930
Instance 4: Confidence=0.8873
tmp min: tensor(0.) tmp max: tensor(1.)
278 116 540 960
There are 17 prompts
current IoU is: 0.8945676684379578
Seok, iteration idx= 20 IoU = tensor(0.8946)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 2.1ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9432
Instance 1: Confidence=0.9382
Instance 2: Confidence=0.9229
Instance 3: Confidence=0.9166
Instance 4: Confidence=0.8470
Instance 5: Confidence=0.8422
tmp min: tensor(0.) tmp max: tensor(1.)
268 76 540 960
There are 16 prompts
current IoU is: 0.9083781242370605
Seok, iteration idx= 21 IoU = tensor(0.9084)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.5ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9418
Instance 2: Confidence=0.9238
Instance 3: Confidence=0.9103
Instance 4: Confidence=0.8137
Instance 5: Confidence=0.3678
tmp min: tensor(0.) tmp max: tensor(1.)
260 56 540 960
There are 15 prompts
current IoU is: 0.9362594485282898
Seok, iteration idx= 22 IoU = tensor(0.9363)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.7ms
Speed: 1.7ms preprocess, 23.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 8
Instance 0: Confidence=0.9478
Instance 1: Confidence=0.9216
Instance 2: Confidence=0.9111
Instance 3: Confidence=0.8634
Instance 4: Confidence=0.7675
Instance 5: Confidence=0.6778
Instance 6: Confidence=0.3866
Instance 7: Confidence=0.3368
tmp min: tensor(0.) tmp max: tensor(1.)
246 32 540 960
There are 16 prompts
current IoU is: 0.9302428960800171
Seok, iteration idx= 23 IoU = tensor(0.9302)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 2.7ms preprocess, 22.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9559
Instance 1: Confidence=0.9546
Instance 2: Confidence=0.9364
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.8237
Instance 5: Confidence=0.3776
tmp min: tensor(0.) tmp max: tensor(1.)
252 16 540 960
There are 17 prompts
current IoU is: 0.9458773732185364
Seok, iteration idx= 24 IoU = tensor(0.9459)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.8ms
Speed: 1.4ms preprocess, 24.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9418
Instance 2: Confidence=0.9267
Instance 3: Confidence=0.9179
Instance 4: Confidence=0.8670
tmp min: tensor(0.) tmp max: tensor(1.)
276 12 540 960
There are 17 prompts
current IoU is: 0.9556586146354675
Seok, iteration idx= 25 IoU = tensor(0.9557)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.7ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9436
Instance 2: Confidence=0.9257
Instance 3: Confidence=0.9181
Instance 4: Confidence=0.9060
Instance 5: Confidence=0.4599
tmp min: tensor(0.) tmp max: tensor(1.)
292 16 540 960
There are 16 prompts
current IoU is: 0.9517327547073364
Seok, iteration idx= 26 IoU = tensor(0.9517)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 1.4ms preprocess, 23.1ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 7
Instance 0: Confidence=0.9433
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.9262
Instance 3: Confidence=0.9099
Instance 4: Confidence=0.9046
Instance 5: Confidence=0.7494
Instance 6: Confidence=0.2752
tmp min: tensor(0.) tmp max: tensor(1.)
337 16 540 960
There are 13 prompts
current IoU is: 0.9365857839584351
Seok, iteration idx= 27 IoU = tensor(0.9366)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 7
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9451
Instance 2: Confidence=0.9205
Instance 3: Confidence=0.8957
Instance 4: Confidence=0.7199
Instance 5: Confidence=0.6674
Instance 6: Confidence=0.4065
tmp min: tensor(0.) tmp max: tensor(1.)
360 32 540 960
There are 13 prompts
current IoU is: 0.9640094041824341
Seok, iteration idx= 28 IoU = tensor(0.9640)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 2.1ms preprocess, 22.1ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9502
Instance 1: Confidence=0.9373
Instance 2: Confidence=0.9259
Instance 3: Confidence=0.9246
Instance 4: Confidence=0.7572
tmp min: tensor(0.) tmp max: tensor(1.)
373 68 540 960
There are 12 prompts
current IoU is: 0.9622176885604858
Seok, iteration idx= 29 IoU = tensor(0.9622)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.7ms
Speed: 1.6ms preprocess, 24.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9502
Instance 1: Confidence=0.9332
Instance 2: Confidence=0.9264
Instance 3: Confidence=0.9254
Instance 4: Confidence=0.9229
Instance 5: Confidence=0.5863
tmp min: tensor(0.) tmp max: tensor(1.)
409 64 540 960
There are 12 prompts
current IoU is: 0.9671478867530823
Seok, iteration idx= 30 IoU = tensor(0.9671)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9397
Instance 2: Confidence=0.9054
Instance 3: Confidence=0.8999
Instance 4: Confidence=0.8815
Instance 5: Confidence=0.8617
tmp min: tensor(0.) tmp max: tensor(1.)
460 100 540 960
There are 13 prompts
current IoU is: 0.9629765748977661
Seok, iteration idx= 31 IoU = tensor(0.9630)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set3_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set3_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:40<00:00,  1.27s/it]
Testing psnr 28.415960371494293 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set3_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.15it/s]
Testing psnr 3.2786920852959156 (avg)
train: coarse segmentation in 00:03:44
train: finish (eps time 00:03:45 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set3_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set4/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 43.68it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set4 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set4
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set4_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.3ms
Speed: 2.7ms preprocess, 20.3ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.4ms
Speed: 1.5ms preprocess, 19.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.7ms
Speed: 1.7ms preprocess, 19.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.6ms
Speed: 1.4ms preprocess, 19.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.9ms
Speed: 1.2ms preprocess, 19.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.5ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.6ms
Speed: 1.9ms preprocess, 19.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.0ms
Speed: 1.5ms preprocess, 19.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.1ms
Speed: 1.5ms preprocess, 19.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.4ms
Speed: 1.5ms preprocess, 19.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.5ms preprocess, 18.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.8ms
Speed: 1.2ms preprocess, 19.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.0ms
Speed: 1.3ms preprocess, 20.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.2ms
Speed: 1.3ms preprocess, 19.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.2ms
Speed: 1.4ms preprocess, 19.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.5ms
Speed: 1.2ms preprocess, 19.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.6ms
Speed: 1.4ms preprocess, 19.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.0ms
Speed: 1.5ms preprocess, 19.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.5ms preprocess, 18.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 10 persons, 19.5ms
Speed: 1.4ms preprocess, 19.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 10 persons, 20.4ms
Speed: 1.7ms preprocess, 20.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 31
view_order: [36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.7ms
Speed: 1.3ms preprocess, 21.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9310
Instance 1: Confidence=0.9039
Instance 2: Confidence=0.8684
Instance 3: Confidence=0.8642
Instance 4: Confidence=0.8209
Instance 5: Confidence=0.6953
Selected instance: 4 (Confidence: 0.8209)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

283 104 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 19 prompts
current IoU is: 0.35237985849380493
Seok, iteration idx= 1 IoU = tensor(0.3524)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.4ms
Speed: 3.0ms preprocess, 22.4ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 7
Instance 0: Confidence=0.9402
Instance 1: Confidence=0.9144
Instance 2: Confidence=0.9030
Instance 3: Confidence=0.8917
Instance 4: Confidence=0.8304
Instance 5: Confidence=0.7796
Instance 6: Confidence=0.4827
Selected instance: 5 (Confidence: 0.7796)
tmp min: tensor(0.) tmp max: tensor(1.)
277 92 540 960
current IoU is: 0.7569347023963928
Seok, iteration idx= 2 IoU = tensor(0.7569)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.2ms
Speed: 2.8ms preprocess, 21.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9453
Instance 1: Confidence=0.9352
Instance 2: Confidence=0.9312
Instance 3: Confidence=0.8691
Instance 4: Confidence=0.4903
Selected instance: 0 (Confidence: 0.9453)
tmp min: tensor(0.) tmp max: tensor(1.)
306 48 540 960
There are 17 prompts
current IoU is: 0.011972308158874512
Seok, iteration idx= 3 IoU = tensor(0.0120)
SKIP, unacceptable sam prediction, IoU is tensor(0.0120)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.0ms
Speed: 2.6ms preprocess, 21.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9379
Instance 2: Confidence=0.9213
Instance 3: Confidence=0.9213
Instance 4: Confidence=0.8837
Selected instance: 2 (Confidence: 0.9213)
tmp min: tensor(0.) tmp max: tensor(1.)
407 88 540 960
There are 15 prompts
current IoU is: 0.002531908918172121
Seok, iteration idx= 4 IoU = tensor(0.0025)
SKIP, unacceptable sam prediction, IoU is tensor(0.0025)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.3ms
Speed: 1.4ms preprocess, 22.3ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 8
Instance 0: Confidence=0.9402
Instance 1: Confidence=0.9296
Instance 2: Confidence=0.9254
Instance 3: Confidence=0.9197
Instance 4: Confidence=0.8924
Instance 5: Confidence=0.5797
Instance 6: Confidence=0.4707
Instance 7: Confidence=0.2998
Selected instance: 5 (Confidence: 0.5797)
tmp min: tensor(0.) tmp max: tensor(1.)
303 88 540 960
current IoU is: 0.3687760829925537
Seok, iteration idx= 5 IoU = tensor(0.3688)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 3.1ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9301
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.9115
Instance 4: Confidence=0.8082
Instance 5: Confidence=0.7248
Selected instance: 5 (Confidence: 0.7248)
tmp min: tensor(0.) tmp max: tensor(1.)
348 80 540 960
There are 15 prompts
current IoU is: 0.7508588433265686
Seok, iteration idx= 6 IoU = tensor(0.7509)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 1.6ms preprocess, 22.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9404
Instance 2: Confidence=0.9285
Instance 3: Confidence=0.9185
Instance 4: Confidence=0.8826
Selected instance: 4 (Confidence: 0.8826)
tmp min: tensor(0.) tmp max: tensor(1.)
326 72 540 960
There are 14 prompts
current IoU is: 0.7639438509941101
Seok, iteration idx= 7 IoU = tensor(0.7639)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.7ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9306
Instance 2: Confidence=0.9102
Instance 3: Confidence=0.9030
Instance 4: Confidence=0.8677
Instance 5: Confidence=0.8433
Selected instance: 4 (Confidence: 0.8677)
tmp min: tensor(0.) tmp max: tensor(1.)
323 72 540 960
There are 15 prompts
current IoU is: 0.7548122406005859
Seok, iteration idx= 8 IoU = tensor(0.7548)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.4ms preprocess, 23.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9367
Instance 2: Confidence=0.8905
Instance 3: Confidence=0.8844
Instance 4: Confidence=0.8646
Instance 5: Confidence=0.2912
Selected instance: 3 (Confidence: 0.8844)
tmp min: tensor(0.) tmp max: tensor(1.)
731 68 540 960
There are 15 prompts
current IoU is: 0.7646486759185791
Seok, iteration idx= 9 IoU = tensor(0.7646)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 1.5ms preprocess, 24.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9527
Instance 1: Confidence=0.9436
Instance 2: Confidence=0.9006
Instance 3: Confidence=0.8998
Instance 4: Confidence=0.8845
Instance 5: Confidence=0.4642
Selected instance: 2 (Confidence: 0.9006)
tmp min: tensor(0.) tmp max: tensor(1.)
724 64 540 960
There are 17 prompts
current IoU is: 0.788617730140686
Seok, iteration idx= 10 IoU = tensor(0.7886)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.9ms
Speed: 2.8ms preprocess, 21.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 8
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9309
Instance 2: Confidence=0.9081
Instance 3: Confidence=0.7502
Instance 4: Confidence=0.7004
Instance 5: Confidence=0.4914
Instance 6: Confidence=0.4399
Instance 7: Confidence=0.2941
Selected instance: 4 (Confidence: 0.7004)
tmp min: tensor(0.) tmp max: tensor(1.)
712 52 540 960
There are 16 prompts
current IoU is: 0.8254599571228027
Seok, iteration idx= 11 IoU = tensor(0.8255)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 2.8ms preprocess, 23.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9470
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.8950
Instance 4: Confidence=0.8500
Selected instance: 2 (Confidence: 0.9190)
tmp min: tensor(0.) tmp max: tensor(1.)
704 48 540 960
There are 15 prompts
current IoU is: 0.8422346711158752
Seok, iteration idx= 12 IoU = tensor(0.8422)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.7ms
Speed: 2.6ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 7
Instance 0: Confidence=0.9433
Instance 1: Confidence=0.9295
Instance 2: Confidence=0.9015
Instance 3: Confidence=0.8754
Instance 4: Confidence=0.8475
Instance 5: Confidence=0.5789
Instance 6: Confidence=0.4633
Selected instance: 2 (Confidence: 0.9015)
tmp min: tensor(0.) tmp max: tensor(1.)
668 56 540 960
There are 12 prompts
current IoU is: 0.9241452217102051
Seok, iteration idx= 13 IoU = tensor(0.9241)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.0ms
Speed: 1.6ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9409
Instance 1: Confidence=0.9153
Instance 2: Confidence=0.9146
Instance 3: Confidence=0.8973
Instance 4: Confidence=0.6037
Instance 5: Confidence=0.4515
Instance 6: Confidence=0.2713
Selected instance: 2 (Confidence: 0.9146)
tmp min: tensor(0.) tmp max: tensor(1.)
637 64 540 960
There are 14 prompts
current IoU is: 0.9351022839546204
Seok, iteration idx= 14 IoU = tensor(0.9351)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.0ms
Speed: 1.6ms preprocess, 21.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9345
Instance 1: Confidence=0.9176
Instance 2: Confidence=0.9114
Instance 3: Confidence=0.9028
Instance 4: Confidence=0.8976
Selected instance: 0 (Confidence: 0.9345)
tmp min: tensor(0.) tmp max: tensor(1.)
593 84 540 960
There are 13 prompts
current IoU is: 0.9340742230415344
Seok, iteration idx= 15 IoU = tensor(0.9341)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9384
Instance 2: Confidence=0.9249
Instance 3: Confidence=0.9049
Instance 4: Confidence=0.8864
Selected instance: 0 (Confidence: 0.9445)
tmp min: tensor(0.) tmp max: tensor(1.)
556 120 540 960
There are 16 prompts
current IoU is: 0.913017749786377
Seok, iteration idx= 16 IoU = tensor(0.9130)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.5ms
Speed: 1.6ms preprocess, 21.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9491
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9331
Instance 3: Confidence=0.9178
Instance 4: Confidence=0.9059
Instance 5: Confidence=0.8131
Selected instance: 5 (Confidence: 0.8131)
tmp min: tensor(0.) tmp max: tensor(1.)
381 84 540 960
There are 17 prompts
current IoU is: 0.765669584274292
Seok, iteration idx= 17 IoU = tensor(0.7657)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9408
Instance 2: Confidence=0.9396
Instance 3: Confidence=0.9338
Instance 4: Confidence=0.9225
Instance 5: Confidence=0.4237
Selected instance: 5 (Confidence: 0.4237)
tmp min: tensor(0.) tmp max: tensor(1.)
376 96 540 960
There are 12 prompts
current IoU is: 0.507602334022522
Seok, iteration idx= 18 IoU = tensor(0.5076)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.3ms
Speed: 1.6ms preprocess, 24.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9320
Instance 1: Confidence=0.9259
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.9090
Instance 4: Confidence=0.9060
Selected instance: 0 (Confidence: 0.9320)
tmp min: tensor(0.) tmp max: tensor(1.)
408 88 540 960
There are 13 prompts
current IoU is: 0.003452749690040946
Seok, iteration idx= 19 IoU = tensor(0.0035)
SKIP, unacceptable sam prediction, IoU is tensor(0.0035)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9356
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9268
Instance 3: Confidence=0.9164
Instance 4: Confidence=0.8873
Instance 5: Confidence=0.8672
Selected instance: 3 (Confidence: 0.9164)
tmp min: tensor(0.) tmp max: tensor(1.)
448 84 540 960
There are 14 prompts
current IoU is: 0.8371082544326782
Seok, iteration idx= 20 IoU = tensor(0.8371)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9388
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9012
Instance 3: Confidence=0.8933
Instance 4: Confidence=0.8737
Selected instance: 2 (Confidence: 0.9012)
tmp min: tensor(0.) tmp max: tensor(1.)
492 92 540 960
There are 13 prompts
current IoU is: 0.771895706653595
Seok, iteration idx= 21 IoU = tensor(0.7719)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.2ms
Speed: 1.6ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 7
Instance 0: Confidence=0.9264
Instance 1: Confidence=0.9138
Instance 2: Confidence=0.9107
Instance 3: Confidence=0.8424
Instance 4: Confidence=0.8102
Instance 5: Confidence=0.7175
Instance 6: Confidence=0.7047
Selected instance: 0 (Confidence: 0.9264)
tmp min: tensor(0.) tmp max: tensor(1.)
513 72 540 960
There are 13 prompts
current IoU is: 0.8862025737762451
Seok, iteration idx= 22 IoU = tensor(0.8862)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9346
Instance 1: Confidence=0.9336
Instance 2: Confidence=0.9319
Instance 3: Confidence=0.9087
Instance 4: Confidence=0.8680
Selected instance: 1 (Confidence: 0.9336)
tmp min: tensor(0.) tmp max: tensor(1.)
532 84 540 960
There are 16 prompts
current IoU is: 0.858391284942627
Seok, iteration idx= 23 IoU = tensor(0.8584)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 7
Instance 0: Confidence=0.9481
Instance 1: Confidence=0.9315
Instance 2: Confidence=0.9225
Instance 3: Confidence=0.9042
Instance 4: Confidence=0.8958
Instance 5: Confidence=0.6956
Instance 6: Confidence=0.3838
Selected instance: 4 (Confidence: 0.8958)
tmp min: tensor(0.) tmp max: tensor(1.)
599 72 540 960
There are 14 prompts
current IoU is: 0.7899425029754639
Seok, iteration idx= 24 IoU = tensor(0.7899)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.5ms
Speed: 1.6ms preprocess, 24.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9402
Instance 2: Confidence=0.9388
Instance 3: Confidence=0.9054
Instance 4: Confidence=0.8651
Selected instance: 0 (Confidence: 0.9447)
tmp min: tensor(0.) tmp max: tensor(1.)
624 0 540 960
There are 13 prompts
current IoU is: 0.0014222433092072606
Seok, iteration idx= 25 IoU = tensor(0.0014)
SKIP, unacceptable sam prediction, IoU is tensor(0.0014)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 3.2ms preprocess, 23.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9414
Instance 1: Confidence=0.9324
Instance 2: Confidence=0.9207
Instance 3: Confidence=0.9081
Instance 4: Confidence=0.9032
Instance 5: Confidence=0.6914
Selected instance: 5 (Confidence: 0.6914)
tmp min: tensor(0.) tmp max: tensor(1.)
635 88 540 960
There are 15 prompts
current IoU is: 0.3001479208469391
Seok, iteration idx= 26 IoU = tensor(0.3001)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 3.3ms preprocess, 22.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9473
Instance 2: Confidence=0.8913
Instance 3: Confidence=0.8832
Instance 4: Confidence=0.8511
Instance 5: Confidence=0.4380
Selected instance: 4 (Confidence: 0.8511)
tmp min: tensor(0.) tmp max: tensor(1.)
669 56 540 960
There are 15 prompts
current IoU is: 0.8027462959289551
Seok, iteration idx= 27 IoU = tensor(0.8027)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 2.6ms preprocess, 23.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9522
Instance 1: Confidence=0.9410
Instance 2: Confidence=0.9127
Instance 3: Confidence=0.7607
Instance 4: Confidence=0.3358
Selected instance: 4 (Confidence: 0.3358)
tmp min: tensor(0.) tmp max: tensor(1.)
656 136 540 960
There are 13 prompts
current IoU is: 0.3077964186668396
Seok, iteration idx= 28 IoU = tensor(0.3078)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.2ms
Speed: 2.9ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 8
Instance 0: Confidence=0.9434
Instance 1: Confidence=0.9339
Instance 2: Confidence=0.9202
Instance 3: Confidence=0.8963
Instance 4: Confidence=0.8529
Instance 5: Confidence=0.8451
Instance 6: Confidence=0.3002
Instance 7: Confidence=0.2701
Selected instance: 5 (Confidence: 0.8451)
tmp min: tensor(0.) tmp max: tensor(1.)
658 140 540 960
There are 12 prompts
current IoU is: 0.8710761070251465
Seok, iteration idx= 29 IoU = tensor(0.8711)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 2.6ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9313
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8973
Instance 4: Confidence=0.5839
Instance 5: Confidence=0.4561
Selected instance: 2 (Confidence: 0.9149)
tmp min: tensor(0.) tmp max: tensor(1.)
695 112 540 960
There are 16 prompts
current IoU is: 0.8980840444564819
Seok, iteration idx= 30 IoU = tensor(0.8981)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.1ms
Speed: 3.1ms preprocess, 21.1ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 7
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9330
Instance 3: Confidence=0.5783
Instance 4: Confidence=0.4017
Instance 5: Confidence=0.3446
Instance 6: Confidence=0.2606
Selected instance: 2 (Confidence: 0.9330)
tmp min: tensor(0.) tmp max: tensor(1.)
695 108 540 960
There are 16 prompts
current IoU is: 0.9221468567848206
Seok, iteration idx= 31 IoU = tensor(0.9221)
Selected Instance Confidence List: [tensor(0.9321), tensor(0.5398, device='cpu'), tensor(0.7660, device='cpu'), tensor(0.3853, device='cpu'), tensor(0.3793, device='cpu'), tensor(0.4532, device='cpu'), tensor(0.7404, device='cpu'), tensor(0.8114, device='cpu'), tensor(0.8000, device='cpu'), tensor(0.8125, device='cpu'), tensor(0.8334, device='cpu'), tensor(0.7754, device='cpu'), tensor(0.8729, device='cpu'), tensor(0.9151, device='cpu'), tensor(0.9269, device='cpu'), tensor(0.9342, device='cpu'), tensor(0.9256, device='cpu'), tensor(0.7846, device='cpu'), tensor(0.4740, device='cpu'), tensor(0.3749, device='cpu'), tensor(0.8688, device='cpu'), tensor(0.8236, device='cpu'), tensor(0.9023, device='cpu'), tensor(0.8885, device='cpu'), tensor(0.8323, device='cpu'), tensor(0.3787, device='cpu'), tensor(0.4566, device='cpu'), tensor(0.8221, device='cpu'), tensor(0.3979, device='cpu'), tensor(0.8607, device='cpu'), tensor(0.9048, device='cpu'), tensor(0.9265, device='cpu')]
Sorted Confidence Order: [tensor(0.9342, device='cpu'), tensor(0.9256, device='cpu'), tensor(0.9269, device='cpu'), tensor(0.9151, device='cpu'), tensor(0.8729, device='cpu'), tensor(0.7754, device='cpu'), tensor(0.8334, device='cpu'), tensor(0.8125, device='cpu'), tensor(0.9321), tensor(0.9265, device='cpu'), tensor(0.9048, device='cpu'), tensor(0.8607, device='cpu'), tensor(0.3979, device='cpu'), tensor(0.8221, device='cpu'), tensor(0.4566, device='cpu'), tensor(0.3787, device='cpu'), tensor(0.8323, device='cpu'), tensor(0.8885, device='cpu'), tensor(0.9023, device='cpu'), tensor(0.8236, device='cpu'), tensor(0.8688, device='cpu'), tensor(0.3749, device='cpu'), tensor(0.4740, device='cpu'), tensor(0.7846, device='cpu'), tensor(0.8000, device='cpu'), tensor(0.8114, device='cpu'), tensor(0.7404, device='cpu'), tensor(0.4532, device='cpu'), tensor(0.3793, device='cpu'), tensor(0.3853, device='cpu'), tensor(0.7660, device='cpu'), tensor(0.5398, device='cpu')]
sorted_indices: [15, 16, 14, 13, 12, 11, 10, 9, 0, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 8, 7, 6, 5, 4, 3, 2, 1]
Initial view (highest confidence): 16
New training order: [15, 16, 14, 13, 12, 11, 10, 9, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.3ms preprocess, 20.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 2.9ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9384
Instance 2: Confidence=0.9249
Instance 3: Confidence=0.9049
Instance 4: Confidence=0.8864
tmp min: tensor(0.) tmp max: tensor(1.)
556 120 540 960
There are 16 prompts
current IoU is: 0.9211635589599609
Seok, iteration idx= 1 IoU = tensor(0.9212)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 7
Instance 0: Confidence=0.9409
Instance 1: Confidence=0.9153
Instance 2: Confidence=0.9146
Instance 3: Confidence=0.8973
Instance 4: Confidence=0.6037
Instance 5: Confidence=0.4515
Instance 6: Confidence=0.2713
tmp min: tensor(0.) tmp max: tensor(1.)
637 64 540 960
There are 14 prompts
current IoU is: 0.9374890327453613
Seok, iteration idx= 2 IoU = tensor(0.9375)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 7
Instance 0: Confidence=0.9433
Instance 1: Confidence=0.9295
Instance 2: Confidence=0.9015
Instance 3: Confidence=0.8754
Instance 4: Confidence=0.8475
Instance 5: Confidence=0.5789
Instance 6: Confidence=0.4633
tmp min: tensor(0.) tmp max: tensor(1.)
668 56 540 960
There are 12 prompts
current IoU is: 0.9492505192756653
Seok, iteration idx= 3 IoU = tensor(0.9493)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9497
Instance 1: Confidence=0.9470
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.8950
Instance 4: Confidence=0.8500
tmp min: tensor(0.) tmp max: tensor(1.)
704 48 540 960
There are 15 prompts
current IoU is: 0.9519169926643372
Seok, iteration idx= 4 IoU = tensor(0.9519)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.8ms
Speed: 1.6ms preprocess, 24.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 8
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9309
Instance 2: Confidence=0.9081
Instance 3: Confidence=0.7502
Instance 4: Confidence=0.7004
Instance 5: Confidence=0.4914
Instance 6: Confidence=0.4399
Instance 7: Confidence=0.2941
tmp min: tensor(0.) tmp max: tensor(1.)
712 52 540 960
There are 16 prompts
current IoU is: 0.9413868188858032
Seok, iteration idx= 5 IoU = tensor(0.9414)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 2.8ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9527
Instance 1: Confidence=0.9436
Instance 2: Confidence=0.9006
Instance 3: Confidence=0.8998
Instance 4: Confidence=0.8845
Instance 5: Confidence=0.4642
tmp min: tensor(0.) tmp max: tensor(1.)
724 64 540 960
There are 17 prompts
current IoU is: 0.9099977016448975
Seok, iteration idx= 6 IoU = tensor(0.9100)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 1.6ms preprocess, 22.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9367
Instance 2: Confidence=0.8905
Instance 3: Confidence=0.8844
Instance 4: Confidence=0.8646
Instance 5: Confidence=0.2912
tmp min: tensor(0.) tmp max: tensor(1.)
731 68 540 960
There are 15 prompts
current IoU is: 0.9074718356132507
Seok, iteration idx= 7 IoU = tensor(0.9075)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 10 persons, 23.9ms
Speed: 1.6ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 10
Instance 0: Confidence=0.9473
Instance 1: Confidence=0.9353
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.6370
Instance 4: Confidence=0.5932
Instance 5: Confidence=0.5777
Instance 6: Confidence=0.4581
Instance 7: Confidence=0.3354
Instance 8: Confidence=0.3136
Instance 9: Confidence=0.2909
tmp min: tensor(0.) tmp max: tensor(1.)
726 88 540 960
There are 15 prompts
current IoU is: 0.9412345290184021
Seok, iteration idx= 8 IoU = tensor(0.9412)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.0ms
Speed: 1.7ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 7
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9330
Instance 3: Confidence=0.5783
Instance 4: Confidence=0.4017
Instance 5: Confidence=0.3446
Instance 6: Confidence=0.2606
tmp min: tensor(0.) tmp max: tensor(1.)
695 108 540 960
There are 16 prompts
current IoU is: 0.9277057647705078
Seok, iteration idx= 9 IoU = tensor(0.9277)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 2.4ms preprocess, 22.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9313
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.8973
Instance 4: Confidence=0.5839
Instance 5: Confidence=0.4561
tmp min: tensor(0.) tmp max: tensor(1.)
695 112 540 960
There are 16 prompts
current IoU is: 0.9329902529716492
Seok, iteration idx= 10 IoU = tensor(0.9330)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 8
Instance 0: Confidence=0.9434
Instance 1: Confidence=0.9339
Instance 2: Confidence=0.9202
Instance 3: Confidence=0.8963
Instance 4: Confidence=0.8529
Instance 5: Confidence=0.8451
Instance 6: Confidence=0.3002
Instance 7: Confidence=0.2701
tmp min: tensor(0.) tmp max: tensor(1.)
658 140 540 960
There are 12 prompts
current IoU is: 0.9089282155036926
Seok, iteration idx= 11 IoU = tensor(0.9089)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9522
Instance 1: Confidence=0.9410
Instance 2: Confidence=0.9127
Instance 3: Confidence=0.7607
Instance 4: Confidence=0.3358
tmp min: tensor(0.) tmp max: tensor(1.)
656 136 540 960
There are 13 prompts
current IoU is: 0.3063894212245941
Seok, iteration idx= 12 IoU = tensor(0.3064)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9473
Instance 2: Confidence=0.8913
Instance 3: Confidence=0.8832
Instance 4: Confidence=0.8511
Instance 5: Confidence=0.4380
tmp min: tensor(0.) tmp max: tensor(1.)
669 56 540 960
There are 15 prompts
current IoU is: 0.8405659794807434
Seok, iteration idx= 13 IoU = tensor(0.8406)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.9ms
Speed: 1.6ms preprocess, 24.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9414
Instance 1: Confidence=0.9324
Instance 2: Confidence=0.9207
Instance 3: Confidence=0.9081
Instance 4: Confidence=0.9032
Instance 5: Confidence=0.6914
tmp min: tensor(0.) tmp max: tensor(1.)
635 88 540 960
There are 15 prompts
current IoU is: 0.47421178221702576
Seok, iteration idx= 14 IoU = tensor(0.4742)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9402
Instance 2: Confidence=0.9388
Instance 3: Confidence=0.9054
Instance 4: Confidence=0.8651
tmp min: tensor(0.) tmp max: tensor(1.)
624 0 540 960
There are 13 prompts
current IoU is: 0.0013454011641442776
Seok, iteration idx= 15 IoU = tensor(0.0013)
SKIP, unacceptable sam prediction, IoU is tensor(0.0013)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.7ms
Speed: 2.6ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 7
Instance 0: Confidence=0.9481
Instance 1: Confidence=0.9315
Instance 2: Confidence=0.9225
Instance 3: Confidence=0.9042
Instance 4: Confidence=0.8958
Instance 5: Confidence=0.6956
Instance 6: Confidence=0.3838
tmp min: tensor(0.) tmp max: tensor(1.)
599 72 540 960
There are 14 prompts
current IoU is: 0.7975814938545227
Seok, iteration idx= 16 IoU = tensor(0.7976)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 2.8ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9346
Instance 1: Confidence=0.9336
Instance 2: Confidence=0.9319
Instance 3: Confidence=0.9087
Instance 4: Confidence=0.8680
tmp min: tensor(0.) tmp max: tensor(1.)
532 84 540 960
There are 16 prompts
current IoU is: 0.8701314330101013
Seok, iteration idx= 17 IoU = tensor(0.8701)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.6ms
Speed: 3.3ms preprocess, 22.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 7
Instance 0: Confidence=0.9264
Instance 1: Confidence=0.9138
Instance 2: Confidence=0.9107
Instance 3: Confidence=0.8424
Instance 4: Confidence=0.8102
Instance 5: Confidence=0.7175
Instance 6: Confidence=0.7047
tmp min: tensor(0.) tmp max: tensor(1.)
513 72 540 960
There are 13 prompts
current IoU is: 0.90913325548172
Seok, iteration idx= 18 IoU = tensor(0.9091)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 3.6ms preprocess, 23.1ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9388
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9012
Instance 3: Confidence=0.8933
Instance 4: Confidence=0.8737
tmp min: tensor(0.) tmp max: tensor(1.)
492 92 540 960
There are 13 prompts
current IoU is: 0.8808434009552002
Seok, iteration idx= 19 IoU = tensor(0.8808)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 2.4ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9356
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9268
Instance 3: Confidence=0.9164
Instance 4: Confidence=0.8873
Instance 5: Confidence=0.8672
tmp min: tensor(0.) tmp max: tensor(1.)
448 84 540 960
There are 14 prompts
current IoU is: 0.9060609340667725
Seok, iteration idx= 20 IoU = tensor(0.9061)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 3.5ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9320
Instance 1: Confidence=0.9259
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.9090
Instance 4: Confidence=0.9060
tmp min: tensor(0.) tmp max: tensor(1.)
408 88 540 960
There are 13 prompts
current IoU is: 0.0026241163723170757
Seok, iteration idx= 21 IoU = tensor(0.0026)
SKIP, unacceptable sam prediction, IoU is tensor(0.0026)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 3.8ms preprocess, 23.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9408
Instance 2: Confidence=0.9396
Instance 3: Confidence=0.9338
Instance 4: Confidence=0.9225
Instance 5: Confidence=0.4237
tmp min: tensor(0.) tmp max: tensor(1.)
376 96 540 960
There are 12 prompts
current IoU is: 0.6287381649017334
Seok, iteration idx= 22 IoU = tensor(0.6287)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.7ms preprocess, 24.3ms inference, 4.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9491
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9331
Instance 3: Confidence=0.9178
Instance 4: Confidence=0.9059
Instance 5: Confidence=0.8131
tmp min: tensor(0.) tmp max: tensor(1.)
381 84 540 960
There are 17 prompts
current IoU is: 0.7832024693489075
Seok, iteration idx= 23 IoU = tensor(0.7832)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9306
Instance 2: Confidence=0.9102
Instance 3: Confidence=0.9030
Instance 4: Confidence=0.8677
Instance 5: Confidence=0.8433
tmp min: tensor(0.) tmp max: tensor(1.)
323 72 540 960
There are 15 prompts
current IoU is: 0.8561701774597168
Seok, iteration idx= 24 IoU = tensor(0.8562)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 1.6ms preprocess, 23.2ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9404
Instance 2: Confidence=0.9285
Instance 3: Confidence=0.9185
Instance 4: Confidence=0.8826
tmp min: tensor(0.) tmp max: tensor(1.)
326 72 540 960
There are 14 prompts
current IoU is: 0.8370552659034729
Seok, iteration idx= 25 IoU = tensor(0.8371)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 2.1ms preprocess, 23.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9431
Instance 1: Confidence=0.9301
Instance 2: Confidence=0.9172
Instance 3: Confidence=0.9115
Instance 4: Confidence=0.8082
Instance 5: Confidence=0.7248
tmp min: tensor(0.) tmp max: tensor(1.)
348 80 540 960
There are 15 prompts
current IoU is: 0.793910801410675
Seok, iteration idx= 26 IoU = tensor(0.7939)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 25.0ms
Speed: 1.7ms preprocess, 25.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 8
Instance 0: Confidence=0.9402
Instance 1: Confidence=0.9296
Instance 2: Confidence=0.9254
Instance 3: Confidence=0.9197
Instance 4: Confidence=0.8924
Instance 5: Confidence=0.5797
Instance 6: Confidence=0.4707
Instance 7: Confidence=0.2998
tmp min: tensor(0.) tmp max: tensor(1.)
303 88 540 960
current IoU is: 0.6674535274505615
Seok, iteration idx= 27 IoU = tensor(0.6675)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9379
Instance 2: Confidence=0.9213
Instance 3: Confidence=0.9213
Instance 4: Confidence=0.8837
tmp min: tensor(0.) tmp max: tensor(1.)
268 48 540 960
There are 17 prompts
current IoU is: 0.0016727015608921647
Seok, iteration idx= 28 IoU = tensor(0.0017)
SKIP, unacceptable sam prediction, IoU is tensor(0.0017)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9453
Instance 1: Confidence=0.9352
Instance 2: Confidence=0.9312
Instance 3: Confidence=0.8691
Instance 4: Confidence=0.4903
tmp min: tensor(0.) tmp max: tensor(1.)
306 48 540 960
There are 17 prompts
current IoU is: 0.0087466761469841
Seok, iteration idx= 29 IoU = tensor(0.0087)
SKIP, unacceptable sam prediction, IoU is tensor(0.0087)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.1ms
Speed: 1.7ms preprocess, 24.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9402
Instance 1: Confidence=0.9144
Instance 2: Confidence=0.9030
Instance 3: Confidence=0.8917
Instance 4: Confidence=0.8304
Instance 5: Confidence=0.7796
Instance 6: Confidence=0.4827
tmp min: tensor(0.) tmp max: tensor(1.)
277 92 540 960
current IoU is: 0.7455145716667175
Seok, iteration idx= 30 IoU = tensor(0.7455)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.8ms
Speed: 1.5ms preprocess, 24.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9310
Instance 1: Confidence=0.9039
Instance 2: Confidence=0.8684
Instance 3: Confidence=0.8642
Instance 4: Confidence=0.8209
Instance 5: Confidence=0.6953
tmp min: tensor(0.) tmp max: tensor(1.)
283 104 540 960
There are 19 prompts
current IoU is: 0.816886305809021
Seok, iteration idx= 31 IoU = tensor(0.8169)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set4_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set4_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.25s/it]
Testing psnr 27.89732500910759 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set4_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.16it/s]
Testing psnr 3.219871139153838 (avg)
train: coarse segmentation in 00:03:43
train: finish (eps time 00:03:44 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set4_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set5/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 41.48it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set5 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set5
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set5_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.5ms
Speed: 2.8ms preprocess, 20.5ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.8ms
Speed: 1.2ms preprocess, 19.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.4ms
Speed: 1.3ms preprocess, 19.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.0ms
Speed: 1.3ms preprocess, 20.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.0ms
Speed: 1.5ms preprocess, 19.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.9ms
Speed: 1.4ms preprocess, 18.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.5ms preprocess, 19.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.3ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.5ms preprocess, 18.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.1ms
Speed: 1.4ms preprocess, 21.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.4ms
Speed: 1.4ms preprocess, 19.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.1ms
Speed: 1.4ms preprocess, 20.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.3ms preprocess, 19.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 1.2ms preprocess, 20.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.1ms
Speed: 1.3ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 1.5ms preprocess, 20.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.9ms
Speed: 1.3ms preprocess, 20.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.3ms preprocess, 19.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.5ms
Speed: 1.5ms preprocess, 19.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.2ms
Speed: 1.2ms preprocess, 19.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.3ms
Speed: 1.2ms preprocess, 20.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.9ms
Speed: 1.5ms preprocess, 18.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.6ms
Speed: 1.4ms preprocess, 19.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.2ms
Speed: 3.0ms preprocess, 20.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 24
view_order: [29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.5ms
Speed: 1.9ms preprocess, 20.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 7
Instance 0: Confidence=0.9386
Instance 1: Confidence=0.9359
Instance 2: Confidence=0.9328
Instance 3: Confidence=0.9221
Instance 4: Confidence=0.8036
Instance 5: Confidence=0.7507
Instance 6: Confidence=0.2664
Selected instance: 3 (Confidence: 0.9221)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

465 220 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 14 prompts
current IoU is: 0.7051503658294678
Seok, iteration idx= 1 IoU = tensor(0.7052)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9552
Instance 1: Confidence=0.9328
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.9105
Instance 4: Confidence=0.8768
Instance 5: Confidence=0.6113
Selected instance: 3 (Confidence: 0.9105)
tmp min: tensor(0.) tmp max: tensor(1.)
489 192 540 960
There are 12 prompts
current IoU is: 0.7338593602180481
Seok, iteration idx= 2 IoU = tensor(0.7339)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9494
Instance 1: Confidence=0.9387
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.8958
Instance 4: Confidence=0.8815
Selected instance: 4 (Confidence: 0.8815)
tmp min: tensor(0.) tmp max: tensor(1.)
504 200 540 960
There are 13 prompts
current IoU is: 0.8835017681121826
Seok, iteration idx= 3 IoU = tensor(0.8835)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.7ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9337
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.8928
Instance 3: Confidence=0.7319
Instance 4: Confidence=0.6180
Instance 5: Confidence=0.4375
Selected instance: 4 (Confidence: 0.6180)
tmp min: tensor(0.) tmp max: tensor(1.)
509 256 540 960
There are 16 prompts
current IoU is: 0.7182237505912781
Seok, iteration idx= 4 IoU = tensor(0.7182)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.2ms
Speed: 2.3ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 7
Instance 0: Confidence=0.9374
Instance 1: Confidence=0.9284
Instance 2: Confidence=0.9260
Instance 3: Confidence=0.9164
Instance 4: Confidence=0.9091
Instance 5: Confidence=0.5029
Instance 6: Confidence=0.2646
Selected instance: 5 (Confidence: 0.5029)
tmp min: tensor(0.) tmp max: tensor(1.)
544 244 540 960
There are 17 prompts
current IoU is: 0.6561897397041321
Seok, iteration idx= 5 IoU = tensor(0.6562)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9348
Instance 1: Confidence=0.9341
Instance 2: Confidence=0.9295
Instance 3: Confidence=0.9290
Instance 4: Confidence=0.9118
Instance 5: Confidence=0.5306
Selected instance: 5 (Confidence: 0.5306)
tmp min: tensor(0.) tmp max: tensor(1.)
554 244 540 960
There are 14 prompts
current IoU is: 0.5310830473899841
Seok, iteration idx= 6 IoU = tensor(0.5311)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 1.6ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9330
Instance 2: Confidence=0.9322
Instance 3: Confidence=0.9308
Instance 4: Confidence=0.8590
Instance 5: Confidence=0.5721
Instance 6: Confidence=0.3880
Selected instance: 5 (Confidence: 0.5721)
tmp min: tensor(0.) tmp max: tensor(1.)
571 232 540 960
There are 15 prompts
current IoU is: 0.8476522564888
Seok, iteration idx= 7 IoU = tensor(0.8477)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9482
Instance 1: Confidence=0.9339
Instance 2: Confidence=0.9185
Instance 3: Confidence=0.7674
Instance 4: Confidence=0.4578
Instance 5: Confidence=0.4412
Instance 6: Confidence=0.4175
Selected instance: 0 (Confidence: 0.9482)
tmp min: tensor(0.) tmp max: tensor(1.)
367 244 540 960
There are 14 prompts
current IoU is: 0.48122724890708923
Seok, iteration idx= 8 IoU = tensor(0.4812)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.4ms
Speed: 1.9ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 4
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9331
Instance 2: Confidence=0.9069
Instance 3: Confidence=0.5795
Selected instance: 0 (Confidence: 0.9579)
tmp min: tensor(0.) tmp max: tensor(1.)
350 240 540 960
There are 15 prompts
current IoU is: 0.8787800669670105
Seok, iteration idx= 9 IoU = tensor(0.8788)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.0ms
Speed: 4.4ms preprocess, 23.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 4
Instance 0: Confidence=0.9524
Instance 1: Confidence=0.9516
Instance 2: Confidence=0.9286
Instance 3: Confidence=0.8979
Selected instance: 0 (Confidence: 0.9524)
tmp min: tensor(0.) tmp max: tensor(1.)
336 244 540 960
There are 13 prompts
current IoU is: 0.9327006340026855
Seok, iteration idx= 10 IoU = tensor(0.9327)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.1ms
Speed: 4.2ms preprocess, 22.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9476
Instance 2: Confidence=0.8963
Instance 3: Confidence=0.8785
Instance 4: Confidence=0.8033
Selected instance: 0 (Confidence: 0.9539)
tmp min: tensor(0.) tmp max: tensor(1.)
297 244 540 960
There are 12 prompts
current IoU is: 0.9509750604629517
Seok, iteration idx= 11 IoU = tensor(0.9510)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 3.2ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 7
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.7916
Instance 4: Confidence=0.7327
Instance 5: Confidence=0.4687
Instance 6: Confidence=0.2725
Selected instance: 0 (Confidence: 0.9532)
tmp min: tensor(0.) tmp max: tensor(1.)
283 232 540 960
There are 14 prompts
current IoU is: 0.941879391670227
Seok, iteration idx= 12 IoU = tensor(0.9419)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 3.1ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9520
Instance 1: Confidence=0.9453
Instance 2: Confidence=0.9338
Instance 3: Confidence=0.8405
Instance 4: Confidence=0.7673
Selected instance: 0 (Confidence: 0.9520)
tmp min: tensor(0.) tmp max: tensor(1.)
324 228 540 960
There are 14 prompts
current IoU is: 0.9521476626396179
Seok, iteration idx= 13 IoU = tensor(0.9521)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.4ms
Speed: 1.6ms preprocess, 22.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 8
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9499
Instance 2: Confidence=0.9467
Instance 3: Confidence=0.8013
Instance 4: Confidence=0.4372
Instance 5: Confidence=0.3440
Instance 6: Confidence=0.3215
Instance 7: Confidence=0.2739
Selected instance: 2 (Confidence: 0.9467)
tmp min: tensor(0.) tmp max: tensor(1.)
295 224 540 960
There are 13 prompts
current IoU is: 0.9477412700653076
Seok, iteration idx= 14 IoU = tensor(0.9477)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.0ms
Speed: 1.5ms preprocess, 21.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9465
Instance 2: Confidence=0.9439
Instance 3: Confidence=0.8874
Instance 4: Confidence=0.6249
Instance 5: Confidence=0.2727
Selected instance: 0 (Confidence: 0.9483)
tmp min: tensor(0.) tmp max: tensor(1.)
279 228 540 960
There are 14 prompts
current IoU is: 0.9597774147987366
Seok, iteration idx= 15 IoU = tensor(0.9598)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 2.1ms preprocess, 22.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9385
Instance 3: Confidence=0.9341
Instance 4: Confidence=0.9008
Instance 5: Confidence=0.6692
Selected instance: 5 (Confidence: 0.6692)
tmp min: tensor(0.) tmp max: tensor(1.)
595 216 540 960
There are 15 prompts
current IoU is: 0.7767751216888428
Seok, iteration idx= 16 IoU = tensor(0.7768)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9584
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9329
Instance 3: Confidence=0.9113
Instance 4: Confidence=0.8125
Instance 5: Confidence=0.5363
Selected instance: 4 (Confidence: 0.8125)
tmp min: tensor(0.) tmp max: tensor(1.)
596 224 540 960
There are 18 prompts
current IoU is: 0.8090285062789917
Seok, iteration idx= 17 IoU = tensor(0.8090)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9408
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9217
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.7804
Instance 5: Confidence=0.3248
Selected instance: 4 (Confidence: 0.7804)
tmp min: tensor(0.) tmp max: tensor(1.)
608 212 540 960
There are 15 prompts
current IoU is: 0.8835671544075012
Seok, iteration idx= 18 IoU = tensor(0.8836)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 6
Instance 0: Confidence=0.9463
Instance 1: Confidence=0.9379
Instance 2: Confidence=0.9269
Instance 3: Confidence=0.9177
Instance 4: Confidence=0.8096
Instance 5: Confidence=0.5529
Selected instance: 4 (Confidence: 0.8096)
tmp min: tensor(0.) tmp max: tensor(1.)
616 216 540 960
There are 16 prompts
current IoU is: 0.7857746481895447
Seok, iteration idx= 19 IoU = tensor(0.7858)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 2.1ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9490
Instance 1: Confidence=0.9483
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9231
Instance 4: Confidence=0.6808
Instance 5: Confidence=0.6357
Selected instance: 2 (Confidence: 0.9392)
tmp min: tensor(0.) tmp max: tensor(1.)
615 224 540 960
There are 14 prompts
current IoU is: 0.8703604936599731
Seok, iteration idx= 20 IoU = tensor(0.8704)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 2.4ms preprocess, 23.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9424
Instance 1: Confidence=0.9364
Instance 2: Confidence=0.9296
Instance 3: Confidence=0.9162
Instance 4: Confidence=0.6830
Instance 5: Confidence=0.6813
Selected instance: 2 (Confidence: 0.9296)
tmp min: tensor(0.) tmp max: tensor(1.)
627 232 540 960
There are 14 prompts
current IoU is: 0.8656147122383118
Seok, iteration idx= 21 IoU = tensor(0.8656)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.7ms preprocess, 22.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9605
Instance 1: Confidence=0.9404
Instance 2: Confidence=0.9341
Instance 3: Confidence=0.9266
Instance 4: Confidence=0.9189
Selected instance: 1 (Confidence: 0.9404)
tmp min: tensor(0.) tmp max: tensor(1.)
611 244 540 960
There are 13 prompts
current IoU is: 0.8797123432159424
Seok, iteration idx= 22 IoU = tensor(0.8797)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.4ms
Speed: 1.5ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9216
Instance 3: Confidence=0.9211
Instance 4: Confidence=0.9179
Selected instance: 2 (Confidence: 0.9216)
tmp min: tensor(0.) tmp max: tensor(1.)
603 268 540 960
There are 16 prompts
current IoU is: 0.8637516498565674
Seok, iteration idx= 23 IoU = tensor(0.8638)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 2.9ms preprocess, 22.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9499
Instance 1: Confidence=0.9476
Instance 2: Confidence=0.9344
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.7513
Instance 5: Confidence=0.3441
Selected instance: 2 (Confidence: 0.9344)
tmp min: tensor(0.) tmp max: tensor(1.)
314 228 540 960
There are 14 prompts
current IoU is: 0.9122933745384216
Seok, iteration idx= 24 IoU = tensor(0.9123)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 4.6ms preprocess, 22.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9454
Instance 1: Confidence=0.9376
Instance 2: Confidence=0.9193
Instance 3: Confidence=0.8833
Instance 4: Confidence=0.8594
Instance 5: Confidence=0.7986
Selected instance: 4 (Confidence: 0.8594)
tmp min: tensor(0.) tmp max: tensor(1.)
299 236 540 960
There are 13 prompts
current IoU is: 0.9025993347167969
Seok, iteration idx= 25 IoU = tensor(0.9026)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 3.3ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9414
Instance 1: Confidence=0.9300
Instance 2: Confidence=0.8414
Instance 3: Confidence=0.7600
Instance 4: Confidence=0.7093
Instance 5: Confidence=0.6956
Selected instance: 5 (Confidence: 0.6956)
tmp min: tensor(0.) tmp max: tensor(1.)
307 296 540 960
There are 15 prompts
current IoU is: 0.8960258364677429
Seok, iteration idx= 26 IoU = tensor(0.8960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.7ms
Speed: 3.6ms preprocess, 21.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9378
Instance 1: Confidence=0.9341
Instance 2: Confidence=0.9259
Instance 3: Confidence=0.9210
Instance 4: Confidence=0.9059
Selected instance: 1 (Confidence: 0.9341)
tmp min: tensor(0.) tmp max: tensor(1.)
343 60 540 960
There are 14 prompts
current IoU is: 0.01911761984229088
Seok, iteration idx= 27 IoU = tensor(0.0191)
SKIP, unacceptable sam prediction, IoU is tensor(0.0191)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 3.2ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9140
Instance 3: Confidence=0.9125
Instance 4: Confidence=0.8638
Instance 5: Confidence=0.7469
Selected instance: 2 (Confidence: 0.9140)
tmp min: tensor(0.) tmp max: tensor(1.)
389 224 540 960
There are 13 prompts
current IoU is: 0.840667188167572
Seok, iteration idx= 28 IoU = tensor(0.8407)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 3.0ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9382
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9224
Instance 3: Confidence=0.9112
Instance 4: Confidence=0.8582
Instance 5: Confidence=0.4778
Instance 6: Confidence=0.3251
Selected instance: 1 (Confidence: 0.9361)
tmp min: tensor(0.) tmp max: tensor(1.)
377 204 540 960
There are 15 prompts
current IoU is: 0.9066613912582397
Seok, iteration idx= 29 IoU = tensor(0.9067)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 2.6ms preprocess, 23.5ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9496
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9297
Instance 3: Confidence=0.9274
Instance 4: Confidence=0.9144
Instance 5: Confidence=0.3458
Selected instance: 1 (Confidence: 0.9396)
tmp min: tensor(0.) tmp max: tensor(1.)
379 220 540 960
There are 14 prompts
current IoU is: 0.9542219638824463
Seok, iteration idx= 30 IoU = tensor(0.9542)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 3.5ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9542
Instance 1: Confidence=0.9425
Instance 2: Confidence=0.9398
Instance 3: Confidence=0.9328
Instance 4: Confidence=0.9250
Instance 5: Confidence=0.7913
Selected instance: 3 (Confidence: 0.9328)
tmp min: tensor(0.) tmp max: tensor(1.)
430 216 540 960
There are 13 prompts
current IoU is: 0.956538200378418
Seok, iteration idx= 31 IoU = tensor(0.9565)
Selected Instance Confidence List: [tensor(0.9404), tensor(0.7919, device='cpu'), tensor(0.8045, device='cpu'), tensor(0.8827, device='cpu'), tensor(0.6781, device='cpu'), tensor(0.5949, device='cpu'), tensor(0.5309, device='cpu'), tensor(0.7374, device='cpu'), tensor(0.6680, device='cpu'), tensor(0.9104, device='cpu'), tensor(0.9406, device='cpu'), tensor(0.9521, device='cpu'), tensor(0.9464, device='cpu'), tensor(0.9521, device='cpu'), tensor(0.9473, device='cpu'), tensor(0.9552, device='cpu'), tensor(0.7337, device='cpu'), tensor(0.8104, device='cpu'), tensor(0.8423, device='cpu'), tensor(0.7953, device='cpu'), tensor(0.8979, device='cpu'), tensor(0.8912, device='cpu'), tensor(0.9040, device='cpu'), tensor(0.8869, device='cpu'), tensor(0.9211, device='cpu'), tensor(0.8853, device='cpu'), tensor(0.8158, device='cpu'), tensor(0.3851, device='cpu'), tensor(0.8700, device='cpu'), tensor(0.9184, device='cpu'), tensor(0.9484, device='cpu'), tensor(0.9471, device='cpu')]
Sorted Confidence Order: [tensor(0.9552, device='cpu'), tensor(0.9473, device='cpu'), tensor(0.9521, device='cpu'), tensor(0.9464, device='cpu'), tensor(0.9521, device='cpu'), tensor(0.9406, device='cpu'), tensor(0.9104, device='cpu'), tensor(0.6680, device='cpu'), tensor(0.9211, device='cpu'), tensor(0.8853, device='cpu'), tensor(0.8158, device='cpu'), tensor(0.3851, device='cpu'), tensor(0.8700, device='cpu'), tensor(0.9184, device='cpu'), tensor(0.9484, device='cpu'), tensor(0.9471, device='cpu'), tensor(0.9404), tensor(0.7919, device='cpu'), tensor(0.8045, device='cpu'), tensor(0.8827, device='cpu'), tensor(0.6781, device='cpu'), tensor(0.5949, device='cpu'), tensor(0.5309, device='cpu'), tensor(0.7374, device='cpu'), tensor(0.7337, device='cpu'), tensor(0.8104, device='cpu'), tensor(0.8423, device='cpu'), tensor(0.7953, device='cpu'), tensor(0.8979, device='cpu'), tensor(0.8912, device='cpu'), tensor(0.9040, device='cpu'), tensor(0.8869, device='cpu')]
sorted_indices: [15, 14, 13, 12, 11, 10, 9, 8, 24, 25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 16, 17, 18, 19, 20, 21, 22, 23]
Initial view (highest confidence): 16
New training order: [8, 7, 6, 5, 4, 3, 2, 1, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 9, 10, 11, 12, 13, 14, 15, 16]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 1.3ms preprocess, 20.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.0ms
Speed: 1.6ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 8
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9499
Instance 2: Confidence=0.9467
Instance 3: Confidence=0.8013
Instance 4: Confidence=0.4372
Instance 5: Confidence=0.3440
Instance 6: Confidence=0.3215
Instance 7: Confidence=0.2739
tmp min: tensor(0.) tmp max: tensor(1.)
295 224 540 960
There are 13 prompts
current IoU is: 0.9561423659324646
Seok, iteration idx= 1 IoU = tensor(0.9561)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 1.6ms preprocess, 24.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 5
Instance 0: Confidence=0.9520
Instance 1: Confidence=0.9453
Instance 2: Confidence=0.9338
Instance 3: Confidence=0.8405
Instance 4: Confidence=0.7673
tmp min: tensor(0.) tmp max: tensor(1.)
324 228 540 960
There are 14 prompts
current IoU is: 0.9597967267036438
Seok, iteration idx= 2 IoU = tensor(0.9598)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 1.6ms preprocess, 23.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 7
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9337
Instance 3: Confidence=0.7916
Instance 4: Confidence=0.7327
Instance 5: Confidence=0.4687
Instance 6: Confidence=0.2725
tmp min: tensor(0.) tmp max: tensor(1.)
283 232 540 960
There are 14 prompts
current IoU is: 0.9629601240158081
Seok, iteration idx= 3 IoU = tensor(0.9630)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.6ms preprocess, 22.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9476
Instance 2: Confidence=0.8963
Instance 3: Confidence=0.8785
Instance 4: Confidence=0.8033
tmp min: tensor(0.) tmp max: tensor(1.)
297 244 540 960
There are 12 prompts
current IoU is: 0.9655520915985107
Seok, iteration idx= 4 IoU = tensor(0.9656)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.5ms
Speed: 1.7ms preprocess, 23.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 4
Instance 0: Confidence=0.9524
Instance 1: Confidence=0.9516
Instance 2: Confidence=0.9286
Instance 3: Confidence=0.8979
tmp min: tensor(0.) tmp max: tensor(1.)
336 244 540 960
There are 13 prompts
current IoU is: 0.9514172077178955
Seok, iteration idx= 5 IoU = tensor(0.9514)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 4
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9331
Instance 2: Confidence=0.9069
Instance 3: Confidence=0.5795
tmp min: tensor(0.) tmp max: tensor(1.)
350 240 540 960
There are 15 prompts
current IoU is: 0.907583475112915
Seok, iteration idx= 6 IoU = tensor(0.9076)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9482
Instance 1: Confidence=0.9339
Instance 2: Confidence=0.9185
Instance 3: Confidence=0.7674
Instance 4: Confidence=0.4578
Instance 5: Confidence=0.4412
Instance 6: Confidence=0.4175
tmp min: tensor(0.) tmp max: tensor(1.)
367 244 540 960
There are 14 prompts
current IoU is: 0.9388710856437683
Seok, iteration idx= 7 IoU = tensor(0.9389)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.6ms preprocess, 22.8ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9499
Instance 1: Confidence=0.9476
Instance 2: Confidence=0.9344
Instance 3: Confidence=0.9271
Instance 4: Confidence=0.7513
Instance 5: Confidence=0.3441
tmp min: tensor(0.) tmp max: tensor(1.)
314 228 540 960
There are 14 prompts
current IoU is: 0.9269821643829346
Seok, iteration idx= 8 IoU = tensor(0.9270)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9454
Instance 1: Confidence=0.9376
Instance 2: Confidence=0.9193
Instance 3: Confidence=0.8833
Instance 4: Confidence=0.8594
Instance 5: Confidence=0.7986
tmp min: tensor(0.) tmp max: tensor(1.)
299 236 540 960
There are 13 prompts
current IoU is: 0.9131019115447998
Seok, iteration idx= 9 IoU = tensor(0.9131)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9414
Instance 1: Confidence=0.9300
Instance 2: Confidence=0.8414
Instance 3: Confidence=0.7600
Instance 4: Confidence=0.7093
Instance 5: Confidence=0.6956
tmp min: tensor(0.) tmp max: tensor(1.)
307 296 540 960
There are 15 prompts
current IoU is: 0.912771463394165
Seok, iteration idx= 10 IoU = tensor(0.9128)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.7ms preprocess, 23.7ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9378
Instance 1: Confidence=0.9341
Instance 2: Confidence=0.9259
Instance 3: Confidence=0.9210
Instance 4: Confidence=0.9059
tmp min: tensor(0.) tmp max: tensor(1.)
343 60 540 960
There are 14 prompts
current IoU is: 0.01969055086374283
Seok, iteration idx= 11 IoU = tensor(0.0197)
SKIP, unacceptable sam prediction, IoU is tensor(0.0197)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9269
Instance 2: Confidence=0.9140
Instance 3: Confidence=0.9125
Instance 4: Confidence=0.8638
Instance 5: Confidence=0.7469
tmp min: tensor(0.) tmp max: tensor(1.)
389 224 540 960
There are 13 prompts
current IoU is: 0.8565366268157959
Seok, iteration idx= 12 IoU = tensor(0.8565)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 1.6ms preprocess, 23.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 7
Instance 0: Confidence=0.9382
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9224
Instance 3: Confidence=0.9112
Instance 4: Confidence=0.8582
Instance 5: Confidence=0.4778
Instance 6: Confidence=0.3251
tmp min: tensor(0.) tmp max: tensor(1.)
377 204 540 960
There are 15 prompts
current IoU is: 0.9071213006973267
Seok, iteration idx= 13 IoU = tensor(0.9071)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.6ms
Speed: 1.5ms preprocess, 24.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9496
Instance 1: Confidence=0.9396
Instance 2: Confidence=0.9297
Instance 3: Confidence=0.9274
Instance 4: Confidence=0.9144
Instance 5: Confidence=0.3458
tmp min: tensor(0.) tmp max: tensor(1.)
379 220 540 960
There are 14 prompts
current IoU is: 0.9504360556602478
Seok, iteration idx= 14 IoU = tensor(0.9504)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 1.4ms preprocess, 23.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9542
Instance 1: Confidence=0.9425
Instance 2: Confidence=0.9398
Instance 3: Confidence=0.9328
Instance 4: Confidence=0.9250
Instance 5: Confidence=0.7913
tmp min: tensor(0.) tmp max: tensor(1.)
430 216 540 960
There are 13 prompts
current IoU is: 0.9543358683586121
Seok, iteration idx= 15 IoU = tensor(0.9543)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.2ms
Speed: 2.5ms preprocess, 21.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 7
Instance 0: Confidence=0.9506
Instance 1: Confidence=0.9462
Instance 2: Confidence=0.9404
Instance 3: Confidence=0.9361
Instance 4: Confidence=0.9238
Instance 5: Confidence=0.5291
Instance 6: Confidence=0.4256
tmp min: tensor(0.) tmp max: tensor(1.)
471 192 540 960
There are 15 prompts
current IoU is: 0.9291955232620239
Seok, iteration idx= 16 IoU = tensor(0.9292)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.6ms
Speed: 2.7ms preprocess, 21.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 7
Instance 0: Confidence=0.9386
Instance 1: Confidence=0.9359
Instance 2: Confidence=0.9328
Instance 3: Confidence=0.9221
Instance 4: Confidence=0.8036
Instance 5: Confidence=0.7507
Instance 6: Confidence=0.2664
tmp min: tensor(0.) tmp max: tensor(1.)
465 220 540 960
There are 14 prompts
current IoU is: 0.894528329372406
Seok, iteration idx= 17 IoU = tensor(0.8945)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.7ms
Speed: 2.7ms preprocess, 21.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9552
Instance 1: Confidence=0.9328
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.9105
Instance 4: Confidence=0.8768
Instance 5: Confidence=0.6113
tmp min: tensor(0.) tmp max: tensor(1.)
489 192 540 960
There are 12 prompts
current IoU is: 0.9086883068084717
Seok, iteration idx= 18 IoU = tensor(0.9087)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.5ms
Speed: 2.8ms preprocess, 21.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9494
Instance 1: Confidence=0.9387
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.8958
Instance 4: Confidence=0.8815
tmp min: tensor(0.) tmp max: tensor(1.)
504 200 540 960
There are 13 prompts
current IoU is: 0.91255122423172
Seok, iteration idx= 19 IoU = tensor(0.9126)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 3.0ms preprocess, 22.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9337
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.8928
Instance 3: Confidence=0.7319
Instance 4: Confidence=0.6180
Instance 5: Confidence=0.4375
tmp min: tensor(0.) tmp max: tensor(1.)
509 256 540 960
There are 16 prompts
current IoU is: 0.8209291100502014
Seok, iteration idx= 20 IoU = tensor(0.8209)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.5ms
Speed: 4.0ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 7
Instance 0: Confidence=0.9374
Instance 1: Confidence=0.9284
Instance 2: Confidence=0.9260
Instance 3: Confidence=0.9164
Instance 4: Confidence=0.9091
Instance 5: Confidence=0.5029
Instance 6: Confidence=0.2646
tmp min: tensor(0.) tmp max: tensor(1.)
544 244 540 960
There are 17 prompts
current IoU is: 0.7253907918930054
Seok, iteration idx= 21 IoU = tensor(0.7254)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 1.7ms preprocess, 24.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9348
Instance 1: Confidence=0.9341
Instance 2: Confidence=0.9295
Instance 3: Confidence=0.9290
Instance 4: Confidence=0.9118
Instance 5: Confidence=0.5306
tmp min: tensor(0.) tmp max: tensor(1.)
554 244 540 960
There are 14 prompts
current IoU is: 0.5366683006286621
Seok, iteration idx= 22 IoU = tensor(0.5367)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.0ms
Speed: 2.5ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 7
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9330
Instance 2: Confidence=0.9322
Instance 3: Confidence=0.9308
Instance 4: Confidence=0.8590
Instance 5: Confidence=0.5721
Instance 6: Confidence=0.3880
tmp min: tensor(0.) tmp max: tensor(1.)
571 232 540 960
There are 15 prompts
current IoU is: 0.7821930646896362
Seok, iteration idx= 23 IoU = tensor(0.7822)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 3.2ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9385
Instance 3: Confidence=0.9341
Instance 4: Confidence=0.9008
Instance 5: Confidence=0.6692
tmp min: tensor(0.) tmp max: tensor(1.)
595 216 540 960
There are 15 prompts
current IoU is: 0.7805197834968567
Seok, iteration idx= 24 IoU = tensor(0.7805)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 4.5ms preprocess, 22.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9584
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9329
Instance 3: Confidence=0.9113
Instance 4: Confidence=0.8125
Instance 5: Confidence=0.5363
tmp min: tensor(0.) tmp max: tensor(1.)
596 224 540 960
There are 18 prompts
current IoU is: 0.8952133059501648
Seok, iteration idx= 25 IoU = tensor(0.8952)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.6ms
Speed: 2.8ms preprocess, 24.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9408
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.9217
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.7804
Instance 5: Confidence=0.3248
tmp min: tensor(0.) tmp max: tensor(1.)
608 212 540 960
There are 15 prompts
current IoU is: 0.8939575552940369
Seok, iteration idx= 26 IoU = tensor(0.8940)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 3.3ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9463
Instance 1: Confidence=0.9379
Instance 2: Confidence=0.9269
Instance 3: Confidence=0.9177
Instance 4: Confidence=0.8096
Instance 5: Confidence=0.5529
tmp min: tensor(0.) tmp max: tensor(1.)
616 216 540 960
There are 16 prompts
current IoU is: 0.8303730487823486
Seok, iteration idx= 27 IoU = tensor(0.8304)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 2.6ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9490
Instance 1: Confidence=0.9483
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9231
Instance 4: Confidence=0.6808
Instance 5: Confidence=0.6357
tmp min: tensor(0.) tmp max: tensor(1.)
615 224 540 960
There are 14 prompts
current IoU is: 0.9411367177963257
Seok, iteration idx= 28 IoU = tensor(0.9411)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9424
Instance 1: Confidence=0.9364
Instance 2: Confidence=0.9296
Instance 3: Confidence=0.9162
Instance 4: Confidence=0.6830
Instance 5: Confidence=0.6813
tmp min: tensor(0.) tmp max: tensor(1.)
627 232 540 960
There are 14 prompts
current IoU is: 0.9323559999465942
Seok, iteration idx= 29 IoU = tensor(0.9324)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.4ms
Speed: 1.4ms preprocess, 25.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9605
Instance 1: Confidence=0.9404
Instance 2: Confidence=0.9341
Instance 3: Confidence=0.9266
Instance 4: Confidence=0.9189
tmp min: tensor(0.) tmp max: tensor(1.)
611 244 540 960
There are 13 prompts
current IoU is: 0.9255585670471191
Seok, iteration idx= 30 IoU = tensor(0.9256)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9216
Instance 3: Confidence=0.9211
Instance 4: Confidence=0.9179
tmp min: tensor(0.) tmp max: tensor(1.)
603 268 540 960
There are 16 prompts
current IoU is: 0.9070800542831421
Seok, iteration idx= 31 IoU = tensor(0.9071)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set5_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set5_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:40<00:00,  1.26s/it]
Testing psnr 27.851903662085533 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set5_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.18it/s]
Testing psnr 3.1274591386318207 (avg)
train: coarse segmentation in 00:20:12
train: finish (eps time 00:20:12 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set5_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set6/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 47.62it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set6 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set6
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set6_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.8ms
Speed: 2.9ms preprocess, 19.8ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.6ms
Speed: 1.3ms preprocess, 19.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.9ms
Speed: 2.3ms preprocess, 18.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.4ms
Speed: 1.4ms preprocess, 19.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.5ms
Speed: 1.3ms preprocess, 19.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.5ms
Speed: 1.2ms preprocess, 19.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.6ms
Speed: 1.5ms preprocess, 19.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.6ms
Speed: 1.2ms preprocess, 19.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.2ms
Speed: 1.3ms preprocess, 19.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.9ms
Speed: 1.3ms preprocess, 19.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.2ms
Speed: 1.2ms preprocess, 19.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.4ms
Speed: 1.3ms preprocess, 19.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.3ms
Speed: 1.2ms preprocess, 19.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.1ms
Speed: 1.2ms preprocess, 19.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 18.9ms
Speed: 1.7ms preprocess, 18.9ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.2ms
Speed: 3.2ms preprocess, 22.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 13
view_order: [14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.6ms
Speed: 1.9ms preprocess, 20.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 3
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.9273
Instance 2: Confidence=0.8225
Selected instance: 2 (Confidence: 0.8225)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

315 168 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 14 prompts
current IoU is: 0.44688645005226135
Seok, iteration idx= 1 IoU = tensor(0.4469)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.8ms
Speed: 1.7ms preprocess, 22.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 3
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9196
Instance 2: Confidence=0.5705
Selected instance: 2 (Confidence: 0.5705)
tmp min: tensor(0.) tmp max: tensor(1.)
363 196 540 960
There are 11 prompts
current IoU is: 0.42496681213378906
Seok, iteration idx= 2 IoU = tensor(0.4250)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 1.6ms preprocess, 22.7ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 2
Instance 0: Confidence=0.9475
Instance 1: Confidence=0.8862
Selected instance: 0 (Confidence: 0.9475)
tmp min: tensor(0.) tmp max: tensor(1.)
754 32 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 3 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 3.4ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 2
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9560
Selected instance: 0 (Confidence: 0.9594)
tmp min: tensor(0.) tmp max: tensor(1.)
645 32 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 4 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.7ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9470
Selected instance: 0 (Confidence: 0.9592)
tmp min: tensor(0.) tmp max: tensor(1.)
619 72 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 5 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 1.6ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9518
Selected instance: 0 (Confidence: 0.9532)
tmp min: tensor(0.) tmp max: tensor(1.)
526 36 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 6 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 1.6ms preprocess, 22.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9422
Selected instance: 0 (Confidence: 0.9519)
tmp min: tensor(0.) tmp max: tensor(1.)
400 28 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 7 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.0ms
Speed: 2.2ms preprocess, 22.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9603
Instance 1: Confidence=0.9454
Selected instance: 0 (Confidence: 0.9603)
tmp min: tensor(0.) tmp max: tensor(1.)
313 4 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 8 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 3.2ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9480
Selected instance: 0 (Confidence: 0.9626)
tmp min: tensor(0.) tmp max: tensor(1.)
202 16 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 9 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 1.4ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9662
Instance 1: Confidence=0.8877
Selected instance: 0 (Confidence: 0.9662)
tmp min: tensor(0.) tmp max: tensor(1.)
144 12 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 10 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 1.6ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9667
Instance 1: Confidence=0.9419
Selected instance: 0 (Confidence: 0.9667)
tmp min: tensor(0.) tmp max: tensor(1.)
128 0 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 11 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 1.6ms preprocess, 22.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9518
Selected instance: 0 (Confidence: 0.9593)
tmp min: tensor(0.) tmp max: tensor(1.)
668 0 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 12 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.9ms
Speed: 4.1ms preprocess, 20.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9573
Instance 1: Confidence=0.9542
Selected instance: 0 (Confidence: 0.9573)
tmp min: tensor(0.) tmp max: tensor(1.)
555 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 13 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.9ms
Speed: 2.5ms preprocess, 21.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9631
Instance 1: Confidence=0.9505
Selected instance: 0 (Confidence: 0.9631)
tmp min: tensor(0.) tmp max: tensor(1.)
452 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 14 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.9ms
Speed: 1.5ms preprocess, 21.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9450
Selected instance: 0 (Confidence: 0.9626)
tmp min: tensor(0.) tmp max: tensor(1.)
345 68 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 15 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.6ms preprocess, 23.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9604
Instance 1: Confidence=0.6440
Selected instance: 0 (Confidence: 0.9604)
tmp min: tensor(0.) tmp max: tensor(1.)
212 20 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 16 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 1
Instance 0: Confidence=0.9642
Selected instance: 0 (Confidence: 0.9642)
tmp min: tensor(0.) tmp max: tensor(1.)
147 32 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 17 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.0ms
Speed: 1.6ms preprocess, 23.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 3
Instance 0: Confidence=0.9669
Instance 1: Confidence=0.4821
Instance 2: Confidence=0.4394
Selected instance: 0 (Confidence: 0.9669)
tmp min: tensor(0.) tmp max: tensor(1.)
82 0 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 18 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 3.7ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9351
Instance 1: Confidence=0.9205
Selected instance: 0 (Confidence: 0.9351)
tmp min: tensor(0.) tmp max: tensor(1.)
574 100 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 19 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.1ms
Speed: 2.5ms preprocess, 22.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 3
Instance 0: Confidence=0.9503
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.7235
Selected instance: 0 (Confidence: 0.9503)
tmp min: tensor(0.) tmp max: tensor(1.)
785 72 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 20 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 20.6ms
Speed: 1.5ms preprocess, 20.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 3
Instance 0: Confidence=0.9471
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.4658
Selected instance: 0 (Confidence: 0.9471)
tmp min: tensor(0.) tmp max: tensor(1.)
661 68 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 21 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.0ms
Speed: 1.6ms preprocess, 22.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 2
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9457
Selected instance: 0 (Confidence: 0.9618)
tmp min: tensor(0.) tmp max: tensor(1.)
811 56 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 22 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9676
Instance 1: Confidence=0.9445
Selected instance: 0 (Confidence: 0.9676)
tmp min: tensor(0.) tmp max: tensor(1.)
840 36 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 23 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.9ms
Speed: 4.3ms preprocess, 21.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9700
Instance 1: Confidence=0.9385
Selected instance: 0 (Confidence: 0.9700)
tmp min: tensor(0.) tmp max: tensor(1.)
848 24 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 24 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.1ms
Speed: 3.5ms preprocess, 22.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 3
Instance 0: Confidence=0.9535
Instance 1: Confidence=0.8235
Instance 2: Confidence=0.5369
Selected instance: 0 (Confidence: 0.9535)
tmp min: tensor(0.) tmp max: tensor(1.)
810 12 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 25 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.6ms
Speed: 1.5ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 3
Instance 0: Confidence=0.9589
Instance 1: Confidence=0.2834
Instance 2: Confidence=0.2770
Selected instance: 0 (Confidence: 0.9589)
tmp min: tensor(0.) tmp max: tensor(1.)
762 0 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 26 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 1.7ms preprocess, 22.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 2
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9059
Selected instance: 0 (Confidence: 0.9652)
tmp min: tensor(0.) tmp max: tensor(1.)
50 0 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 27 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.7ms preprocess, 23.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 2
Instance 0: Confidence=0.9586
Instance 1: Confidence=0.9416
Selected instance: 0 (Confidence: 0.9586)
tmp min: tensor(0.) tmp max: tensor(1.)
2 4 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 28 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.3ms
Speed: 2.4ms preprocess, 24.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 2
Instance 0: Confidence=0.9624
Instance 1: Confidence=0.9404
Selected instance: 0 (Confidence: 0.9624)
tmp min: tensor(0.) tmp max: tensor(1.)
2 0 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 29 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.5ms
Speed: 3.1ms preprocess, 22.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 3
Instance 0: Confidence=0.9538
Instance 1: Confidence=0.9460
Instance 2: Confidence=0.5105
Selected instance: 2 (Confidence: 0.5105)
tmp min: tensor(0.) tmp max: tensor(1.)
90 136 540 960
There are 12 prompts
current IoU is: 0.1487603336572647
Seok, iteration idx= 30 IoU = tensor(0.1488)
SKIP, unacceptable sam prediction, IoU is tensor(0.1488)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.8ms
Speed: 1.7ms preprocess, 23.8ms inference, 3.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 4
Instance 0: Confidence=0.9569
Instance 1: Confidence=0.9566
Instance 2: Confidence=0.8389
Instance 3: Confidence=0.3479
Selected instance: 2 (Confidence: 0.8389)
tmp min: tensor(0.) tmp max: tensor(1.)
173 144 540 960
There are 12 prompts
current IoU is: 0.6430801153182983
Seok, iteration idx= 31 IoU = tensor(0.6431)
Selected Instance Confidence List: [tensor(0.8401), tensor(0.5971, device='cpu'), tensor(0.4832, device='cpu'), tensor(0.3790, device='cpu'), tensor(0.3838, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3813, device='cpu'), tensor(0.3808, device='cpu'), tensor(0.3841, device='cpu'), tensor(0.3850, device='cpu'), tensor(0.3865, device='cpu'), tensor(0.3867, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3829, device='cpu'), tensor(0.3853, device='cpu'), tensor(0.3851, device='cpu'), tensor(0.3841, device='cpu'), tensor(0.3857, device='cpu'), tensor(0.3868, device='cpu'), tensor(0.3740, device='cpu'), tensor(0.3801, device='cpu'), tensor(0.3788, device='cpu'), tensor(0.3847, device='cpu'), tensor(0.3870, device='cpu'), tensor(0.3880, device='cpu'), tensor(0.3814, device='cpu'), tensor(0.3835, device='cpu'), tensor(0.3861, device='cpu'), tensor(0.3834, device='cpu'), tensor(0.3849, device='cpu'), tensor(0.3815, device='cpu'), tensor(0.7214, device='cpu')]
Sorted Confidence Order: [tensor(0.8401), tensor(0.7214, device='cpu'), tensor(0.3815, device='cpu'), tensor(0.3849, device='cpu'), tensor(0.3834, device='cpu'), tensor(0.3861, device='cpu'), tensor(0.3868, device='cpu'), tensor(0.3857, device='cpu'), tensor(0.3841, device='cpu'), tensor(0.3851, device='cpu'), tensor(0.3853, device='cpu'), tensor(0.3829, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3867, device='cpu'), tensor(0.3865, device='cpu'), tensor(0.3850, device='cpu'), tensor(0.3841, device='cpu'), tensor(0.3808, device='cpu'), tensor(0.3813, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3838, device='cpu'), tensor(0.3790, device='cpu'), tensor(0.3835, device='cpu'), tensor(0.3814, device='cpu'), tensor(0.3880, device='cpu'), tensor(0.3870, device='cpu'), tensor(0.3847, device='cpu'), tensor(0.3788, device='cpu'), tensor(0.3801, device='cpu'), tensor(0.3740, device='cpu'), tensor(0.4832, device='cpu'), tensor(0.5971, device='cpu')]
sorted_indices: [0, 31, 30, 29, 28, 27, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 26, 25, 24, 23, 22, 21, 20, 19, 2, 1]
Initial view (highest confidence): 1
New training order: [14, 13, 12, 11, 10, 9, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.5ms
Speed: 1.6ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 4
Instance 0: Confidence=0.9569
Instance 1: Confidence=0.9566
Instance 2: Confidence=0.8389
Instance 3: Confidence=0.3479
tmp min: tensor(0.) tmp max: tensor(1.)
26 20 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 1 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 3
Instance 0: Confidence=0.9538
Instance 1: Confidence=0.9460
Instance 2: Confidence=0.5105
tmp min: tensor(0.) tmp max: tensor(1.)
90 136 540 960
There are 12 prompts
current IoU is: 0.025830257683992386
Seok, iteration idx= 2 IoU = tensor(0.0258)
SKIP, unacceptable sam prediction, IoU is tensor(0.0258)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.6ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 2
Instance 0: Confidence=0.9624
Instance 1: Confidence=0.9404
tmp min: tensor(0.) tmp max: tensor(1.)
2 0 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 3 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 3.5ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 2
Instance 0: Confidence=0.9586
Instance 1: Confidence=0.9416
tmp min: tensor(0.) tmp max: tensor(1.)
2 4 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 4 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9059
tmp min: tensor(0.) tmp max: tensor(1.)
50 0 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 5 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.9ms
Speed: 1.6ms preprocess, 22.9ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 3
Instance 0: Confidence=0.9669
Instance 1: Confidence=0.4821
Instance 2: Confidence=0.4394
tmp min: tensor(0.) tmp max: tensor(1.)
82 0 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 6 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.7ms
Speed: 1.7ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 1
Instance 0: Confidence=0.9642
tmp min: tensor(0.) tmp max: tensor(1.)
147 32 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 7 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 1.7ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9604
Instance 1: Confidence=0.6440
tmp min: tensor(0.) tmp max: tensor(1.)
212 20 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 8 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.1ms
Speed: 2.8ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9450
tmp min: tensor(0.) tmp max: tensor(1.)
345 68 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 9 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.0ms
Speed: 5.3ms preprocess, 22.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9631
Instance 1: Confidence=0.9505
tmp min: tensor(0.) tmp max: tensor(1.)
452 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 10 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.6ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9573
Instance 1: Confidence=0.9542
tmp min: tensor(0.) tmp max: tensor(1.)
555 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 11 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 1.6ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9518
tmp min: tensor(0.) tmp max: tensor(1.)
668 0 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 12 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9667
Instance 1: Confidence=0.9419
tmp min: tensor(0.) tmp max: tensor(1.)
128 0 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 13 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 2.6ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9662
Instance 1: Confidence=0.8877
tmp min: tensor(0.) tmp max: tensor(1.)
144 12 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 14 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 2.7ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9480
tmp min: tensor(0.) tmp max: tensor(1.)
202 16 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 15 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9603
Instance 1: Confidence=0.9454
tmp min: tensor(0.) tmp max: tensor(1.)
313 4 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 16 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9422
tmp min: tensor(0.) tmp max: tensor(1.)
400 28 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 17 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9518
tmp min: tensor(0.) tmp max: tensor(1.)
526 36 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 18 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.5ms preprocess, 23.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9470
tmp min: tensor(0.) tmp max: tensor(1.)
619 72 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 19 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.0ms
Speed: 3.2ms preprocess, 21.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9560
tmp min: tensor(0.) tmp max: tensor(1.)
645 32 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 20 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 2.9ms preprocess, 22.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9475
Instance 1: Confidence=0.8862
tmp min: tensor(0.) tmp max: tensor(1.)
754 32 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 21 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 3
Instance 0: Confidence=0.9589
Instance 1: Confidence=0.2834
Instance 2: Confidence=0.2770
tmp min: tensor(0.) tmp max: tensor(1.)
762 0 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 22 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.8ms
Speed: 1.6ms preprocess, 23.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 3
Instance 0: Confidence=0.9535
Instance 1: Confidence=0.8235
Instance 2: Confidence=0.5369
tmp min: tensor(0.) tmp max: tensor(1.)
810 12 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 23 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9700
Instance 1: Confidence=0.9385
tmp min: tensor(0.) tmp max: tensor(1.)
848 24 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 24 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9676
Instance 1: Confidence=0.9445
tmp min: tensor(0.) tmp max: tensor(1.)
840 36 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 25 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 2.6ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 2
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9457
tmp min: tensor(0.) tmp max: tensor(1.)
811 56 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 26 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.6ms
Speed: 4.2ms preprocess, 21.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 3
Instance 0: Confidence=0.9471
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.4658
tmp min: tensor(0.) tmp max: tensor(1.)
661 68 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 27 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 3
Instance 0: Confidence=0.9503
Instance 1: Confidence=0.9361
Instance 2: Confidence=0.7235
tmp min: tensor(0.) tmp max: tensor(1.)
785 72 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 28 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 2
Instance 0: Confidence=0.9351
Instance 1: Confidence=0.9205
tmp min: tensor(0.) tmp max: tensor(1.)
574 100 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 29 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 3
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9196
Instance 2: Confidence=0.5705
tmp min: tensor(0.) tmp max: tensor(1.)
363 196 540 960
There are 11 prompts
current IoU is: 0.0850767120718956
Seok, iteration idx= 30 IoU = tensor(0.0851)
SKIP, unacceptable sam prediction, IoU is tensor(0.0851)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 3
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.9273
Instance 2: Confidence=0.8225
tmp min: tensor(0.) tmp max: tensor(1.)
315 168 540 960
There are 14 prompts
current IoU is: 0.0731523409485817
Seok, iteration idx= 31 IoU = tensor(0.0732)
SKIP, unacceptable sam prediction, IoU is tensor(0.0732)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set6_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set6_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:38<00:00,  1.20s/it]
Testing psnr 29.24417570233345 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set6_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:26<00:00,  1.23it/s]
Testing psnr 2.876105001196265 (avg)
train: coarse segmentation in 00:07:14
train: finish (eps time 00:07:14 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set6_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set7/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 37.64it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set7 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set7
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set7_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.7ms
Speed: 2.7ms preprocess, 19.7ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.2ms
Speed: 1.7ms preprocess, 19.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.6ms
Speed: 1.6ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.5ms
Speed: 1.5ms preprocess, 19.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.6ms
Speed: 1.2ms preprocess, 19.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 19.4ms
Speed: 1.3ms preprocess, 19.4ms inference, 3.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.6ms
Speed: 1.2ms preprocess, 19.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 19.3ms
Speed: 1.7ms preprocess, 19.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.6ms preprocess, 18.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.5ms
Speed: 1.4ms preprocess, 20.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.1ms
Speed: 1.5ms preprocess, 20.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.4ms preprocess, 18.6ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.6ms
Speed: 1.2ms preprocess, 18.6ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.3ms
Speed: 1.6ms preprocess, 19.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.4ms
Speed: 1.7ms preprocess, 20.4ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 30
view_order: [35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 20.2ms
Speed: 1.3ms preprocess, 20.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 2
Instance 0: Confidence=0.9563
Instance 1: Confidence=0.4461
Selected instance: 1 (Confidence: 0.4461)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

294 156 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 14 prompts
current IoU is: 0.7153996229171753
Seok, iteration idx= 1 IoU = tensor(0.7154)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.1ms
Speed: 1.7ms preprocess, 24.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 2
Instance 0: Confidence=0.9536
Instance 1: Confidence=0.9447
Selected instance: 0 (Confidence: 0.9536)
tmp min: tensor(0.) tmp max: tensor(1.)
713 108 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 2 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 3
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.3825
Selected instance: 0 (Confidence: 0.9540)
tmp min: tensor(0.) tmp max: tensor(1.)
751 80 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 3 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.5ms
Speed: 3.0ms preprocess, 21.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 3
Instance 0: Confidence=0.9624
Instance 1: Confidence=0.9555
Instance 2: Confidence=0.6049
Selected instance: 0 (Confidence: 0.9624)
tmp min: tensor(0.) tmp max: tensor(1.)
797 72 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 4 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.0ms
Speed: 3.0ms preprocess, 22.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9575
Selected instance: 0 (Confidence: 0.9618)
tmp min: tensor(0.) tmp max: tensor(1.)
780 68 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 5 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9701
Instance 1: Confidence=0.9441
Selected instance: 0 (Confidence: 0.9701)
tmp min: tensor(0.) tmp max: tensor(1.)
815 48 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 6 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.1ms
Speed: 1.7ms preprocess, 24.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 3
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.6308
Selected instance: 0 (Confidence: 0.9658)
tmp min: tensor(0.) tmp max: tensor(1.)
835 36 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 7 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9707
Instance 1: Confidence=0.9349
Selected instance: 0 (Confidence: 0.9707)
tmp min: tensor(0.) tmp max: tensor(1.)
804 28 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 8 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.9ms
Speed: 4.6ms preprocess, 21.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9734
Instance 1: Confidence=0.9361
Selected instance: 0 (Confidence: 0.9734)
tmp min: tensor(0.) tmp max: tensor(1.)
776 4 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 9 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.0ms
Speed: 2.7ms preprocess, 23.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 1
Instance 0: Confidence=0.9550
Selected instance: 0 (Confidence: 0.9550)
tmp min: tensor(0.) tmp max: tensor(1.)
184 64 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 10 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 21.4ms
Speed: 1.6ms preprocess, 21.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 1
Instance 0: Confidence=0.9572
Selected instance: 0 (Confidence: 0.9572)
tmp min: tensor(0.) tmp max: tensor(1.)
186 72 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 11 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 3
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.8823
Instance 2: Confidence=0.4506
Selected instance: 2 (Confidence: 0.4506)
tmp min: tensor(0.) tmp max: tensor(1.)
473 136 540 960
There are 13 prompts
current IoU is: 0.1854521632194519
Seok, iteration idx= 12 IoU = tensor(0.1855)
SKIP, unacceptable sam prediction, IoU is tensor(0.1855)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9674
Instance 1: Confidence=0.6939
Selected instance: 0 (Confidence: 0.9674)
tmp min: tensor(0.) tmp max: tensor(1.)
230 68 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 13 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.3ms
Speed: 2.6ms preprocess, 21.3ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9456
Instance 1: Confidence=0.8489
Selected instance: 0 (Confidence: 0.9456)
tmp min: tensor(0.) tmp max: tensor(1.)
268 80 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 14 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.7ms
Speed: 3.4ms preprocess, 21.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 3
Instance 0: Confidence=0.9496
Instance 1: Confidence=0.8183
Instance 2: Confidence=0.3549
Selected instance: 2 (Confidence: 0.3549)
tmp min: tensor(0.) tmp max: tensor(1.)
661 156 540 960
There are 13 prompts
current IoU is: 0.2574639916419983
Seok, iteration idx= 15 IoU = tensor(0.2575)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.5ms
Speed: 3.0ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 3
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9284
Instance 2: Confidence=0.7120
Selected instance: 0 (Confidence: 0.9486)
tmp min: tensor(0.) tmp max: tensor(1.)
338 112 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 16 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 3.0ms preprocess, 22.7ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9430
Selected instance: 0 (Confidence: 0.9680)
tmp min: tensor(0.) tmp max: tensor(1.)
886 36 540 960
There are 12 prompts
current IoU is: 0.003676163498312235
Seok, iteration idx= 17 IoU = tensor(0.0037)
SKIP, unacceptable sam prediction, IoU is tensor(0.0037)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9740
Instance 1: Confidence=0.9374
Selected instance: 0 (Confidence: 0.9740)
tmp min: tensor(0.) tmp max: tensor(1.)
783 48 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 18 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 1.6ms preprocess, 23.4ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9647
Instance 1: Confidence=0.9377
Selected instance: 0 (Confidence: 0.9647)
tmp min: tensor(0.) tmp max: tensor(1.)
703 48 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 19 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9654
Instance 1: Confidence=0.9447
Selected instance: 0 (Confidence: 0.9654)
tmp min: tensor(0.) tmp max: tensor(1.)
674 84 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 20 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9613
Instance 1: Confidence=0.9350
Selected instance: 0 (Confidence: 0.9613)
tmp min: tensor(0.) tmp max: tensor(1.)
616 48 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 21 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.8ms
Speed: 3.0ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 1
Instance 0: Confidence=0.9570
Selected instance: 0 (Confidence: 0.9570)
tmp min: tensor(0.) tmp max: tensor(1.)
498 36 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 22 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 3.0ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9596
Instance 1: Confidence=0.9353
Selected instance: 0 (Confidence: 0.9596)
tmp min: tensor(0.) tmp max: tensor(1.)
413 12 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 23 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.5ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9272
Selected instance: 0 (Confidence: 0.9555)
tmp min: tensor(0.) tmp max: tensor(1.)
300 20 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 24 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.6ms preprocess, 23.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9309
Selected instance: 0 (Confidence: 0.9518)
tmp min: tensor(0.) tmp max: tensor(1.)
238 12 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 25 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 2
Instance 0: Confidence=0.9582
Instance 1: Confidence=0.9248
Selected instance: 0 (Confidence: 0.9582)
tmp min: tensor(0.) tmp max: tensor(1.)
190 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 26 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9183
Selected instance: 0 (Confidence: 0.9626)
tmp min: tensor(0.) tmp max: tensor(1.)
155 52 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 27 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.9ms
Speed: 2.6ms preprocess, 23.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 2
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9258
Selected instance: 0 (Confidence: 0.9592)
tmp min: tensor(0.) tmp max: tensor(1.)
126 24 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 28 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 3.0ms preprocess, 23.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 2
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9293
Selected instance: 0 (Confidence: 0.9583)
tmp min: tensor(0.) tmp max: tensor(1.)
139 44 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 29 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 2
Instance 0: Confidence=0.9606
Instance 1: Confidence=0.9400
Selected instance: 0 (Confidence: 0.9606)
tmp min: tensor(0.) tmp max: tensor(1.)
156 132 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 30 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 1.6ms preprocess, 23.0ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 2
Instance 0: Confidence=0.9601
Instance 1: Confidence=0.8530
Selected instance: 0 (Confidence: 0.9601)
tmp min: tensor(0.) tmp max: tensor(1.)
153 104 540 960
There are 14 prompts
current IoU is: 0.0018223527586087584
Seok, iteration idx= 31 IoU = tensor(0.0018)
SKIP, unacceptable sam prediction, IoU is tensor(0.0018)
Selected Instance Confidence List: [tensor(0.4819), tensor(0.6077, device='cpu'), tensor(0.3815, device='cpu'), tensor(0.3816, device='cpu'), tensor(0.3849, device='cpu'), tensor(0.3847, device='cpu'), tensor(0.3880, device='cpu'), tensor(0.3863, device='cpu'), tensor(0.3883, device='cpu'), tensor(0.3894, device='cpu'), tensor(0.3820, device='cpu'), tensor(0.3829, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3870, device='cpu'), tensor(0.3782, device='cpu'), tensor(0.3798, device='cpu'), tensor(0.3795, device='cpu'), tensor(0.3894, device='cpu'), tensor(0.3896, device='cpu'), tensor(0.3859, device='cpu'), tensor(0.3862, device='cpu'), tensor(0.3845, device='cpu'), tensor(0.3828, device='cpu'), tensor(0.3838, device='cpu'), tensor(0.3822, device='cpu'), tensor(0.3807, device='cpu'), tensor(0.3833, device='cpu'), tensor(0.3850, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3833, device='cpu'), tensor(0.3843, device='cpu'), tensor(0.3851, device='cpu')]
Sorted Confidence Order: [tensor(0.6077, device='cpu'), tensor(0.4819), tensor(0.3851, device='cpu'), tensor(0.3820, device='cpu'), tensor(0.3829, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3870, device='cpu'), tensor(0.3782, device='cpu'), tensor(0.3798, device='cpu'), tensor(0.3795, device='cpu'), tensor(0.3894, device='cpu'), tensor(0.3843, device='cpu'), tensor(0.3833, device='cpu'), tensor(0.3837, device='cpu'), tensor(0.3850, device='cpu'), tensor(0.3833, device='cpu'), tensor(0.3807, device='cpu'), tensor(0.3822, device='cpu'), tensor(0.3838, device='cpu'), tensor(0.3828, device='cpu'), tensor(0.3845, device='cpu'), tensor(0.3862, device='cpu'), tensor(0.3859, device='cpu'), tensor(0.3896, device='cpu'), tensor(0.3894, device='cpu'), tensor(0.3883, device='cpu'), tensor(0.3863, device='cpu'), tensor(0.3880, device='cpu'), tensor(0.3847, device='cpu'), tensor(0.3849, device='cpu'), tensor(0.3816, device='cpu'), tensor(0.3815, device='cpu')]
sorted_indices: [1, 0, 31, 10, 11, 12, 13, 14, 15, 16, 17, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 9, 8, 7, 6, 5, 4, 3, 2]
Initial view (highest confidence): 2
New training order: [36, 35, 34, 9, 10, 11, 12, 13, 14, 15, 16, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.9ms
Speed: 1.6ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 4
Instance 0: Confidence=0.9627
Instance 1: Confidence=0.7309
Instance 2: Confidence=0.4819
Instance 3: Confidence=0.4511
tmp min: tensor(0.) tmp max: tensor(1.)
250 184 540 960
There are 12 prompts
current IoU is: 0.7355450391769409
Seok, iteration idx= 1 IoU = tensor(0.7355)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 2
Instance 0: Confidence=0.9601
Instance 1: Confidence=0.8530
tmp min: tensor(0.) tmp max: tensor(1.)
153 104 540 960
There are 14 prompts
current IoU is: 0.0016939339693635702
Seok, iteration idx= 2 IoU = tensor(0.0017)
SKIP, unacceptable sam prediction, IoU is tensor(0.0017)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.5ms
Speed: 2.9ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 1
Instance 0: Confidence=0.9550
tmp min: tensor(0.) tmp max: tensor(1.)
184 64 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 3 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.6ms
Speed: 2.9ms preprocess, 22.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 1
Instance 0: Confidence=0.9572
tmp min: tensor(0.) tmp max: tensor(1.)
186 72 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 4 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.5ms
Speed: 2.6ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 3
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.8823
Instance 2: Confidence=0.4506
tmp min: tensor(0.) tmp max: tensor(1.)
473 136 540 960
There are 13 prompts
current IoU is: 0.1612607091665268
Seok, iteration idx= 5 IoU = tensor(0.1613)
SKIP, unacceptable sam prediction, IoU is tensor(0.1613)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.5ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9674
Instance 1: Confidence=0.6939
tmp min: tensor(0.) tmp max: tensor(1.)
230 68 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 6 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 1.7ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9456
Instance 1: Confidence=0.8489
tmp min: tensor(0.) tmp max: tensor(1.)
268 80 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 7 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 3
Instance 0: Confidence=0.9496
Instance 1: Confidence=0.8183
Instance 2: Confidence=0.3549
tmp min: tensor(0.) tmp max: tensor(1.)
661 156 540 960
There are 13 prompts
current IoU is: 0.31231778860092163
Seok, iteration idx= 8 IoU = tensor(0.3123)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 25.1ms
Speed: 1.4ms preprocess, 25.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 3
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9284
Instance 2: Confidence=0.7120
tmp min: tensor(0.) tmp max: tensor(1.)
338 112 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 9 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9680
Instance 1: Confidence=0.9430
tmp min: tensor(0.) tmp max: tensor(1.)
886 36 540 960
There are 12 prompts
current IoU is: 0.002903989050537348
Seok, iteration idx= 10 IoU = tensor(0.0029)
SKIP, unacceptable sam prediction, IoU is tensor(0.0029)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.2ms
Speed: 4.3ms preprocess, 22.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9606
Instance 1: Confidence=0.9400
tmp min: tensor(0.) tmp max: tensor(1.)
156 132 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 11 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 21.2ms
Speed: 4.0ms preprocess, 21.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9293
tmp min: tensor(0.) tmp max: tensor(1.)
139 44 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 12 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 1.4ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9592
Instance 1: Confidence=0.9258
tmp min: tensor(0.) tmp max: tensor(1.)
126 24 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 13 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9626
Instance 1: Confidence=0.9183
tmp min: tensor(0.) tmp max: tensor(1.)
155 52 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 14 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 2.0ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 2
Instance 0: Confidence=0.9582
Instance 1: Confidence=0.9248
tmp min: tensor(0.) tmp max: tensor(1.)
190 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 15 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.8ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9309
tmp min: tensor(0.) tmp max: tensor(1.)
238 12 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 16 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9272
tmp min: tensor(0.) tmp max: tensor(1.)
300 20 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 17 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 2.7ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9596
Instance 1: Confidence=0.9353
tmp min: tensor(0.) tmp max: tensor(1.)
413 12 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 18 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.5ms
Speed: 4.2ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 1
Instance 0: Confidence=0.9570
tmp min: tensor(0.) tmp max: tensor(1.)
498 36 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 19 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 1.5ms preprocess, 23.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9613
Instance 1: Confidence=0.9350
tmp min: tensor(0.) tmp max: tensor(1.)
616 48 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 20 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.8ms
Speed: 1.5ms preprocess, 24.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9654
Instance 1: Confidence=0.9447
tmp min: tensor(0.) tmp max: tensor(1.)
674 84 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 21 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.9ms
Speed: 1.7ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 2
Instance 0: Confidence=0.9647
Instance 1: Confidence=0.9377
tmp min: tensor(0.) tmp max: tensor(1.)
703 48 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 22 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 1.6ms preprocess, 22.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9740
Instance 1: Confidence=0.9374
tmp min: tensor(0.) tmp max: tensor(1.)
783 48 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 23 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 2.5ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9734
Instance 1: Confidence=0.9361
tmp min: tensor(0.) tmp max: tensor(1.)
776 4 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 24 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 1.4ms preprocess, 22.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9707
Instance 1: Confidence=0.9349
tmp min: tensor(0.) tmp max: tensor(1.)
804 28 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 25 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.2ms
Speed: 2.2ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 3
Instance 0: Confidence=0.9658
Instance 1: Confidence=0.9446
Instance 2: Confidence=0.6308
tmp min: tensor(0.) tmp max: tensor(1.)
835 36 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 26 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 2
Instance 0: Confidence=0.9701
Instance 1: Confidence=0.9441
tmp min: tensor(0.) tmp max: tensor(1.)
815 48 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 27 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 1.6ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 2
Instance 0: Confidence=0.9618
Instance 1: Confidence=0.9575
tmp min: tensor(0.) tmp max: tensor(1.)
780 68 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 28 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.3ms
Speed: 2.7ms preprocess, 21.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 3
Instance 0: Confidence=0.9624
Instance 1: Confidence=0.9555
Instance 2: Confidence=0.6049
tmp min: tensor(0.) tmp max: tensor(1.)
797 72 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 29 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.9ms
Speed: 3.0ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 3
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.3825
tmp min: tensor(0.) tmp max: tensor(1.)
751 80 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 30 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.7ms
Speed: 1.4ms preprocess, 24.7ms inference, 4.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 2
Instance 0: Confidence=0.9536
Instance 1: Confidence=0.9447
tmp min: tensor(0.) tmp max: tensor(1.)
713 108 540 960
There are 14 prompts
current IoU is: 0.0
Seok, iteration idx= 31 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set7_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set7_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:38<00:00,  1.21s/it]
Testing psnr 29.035378023982048 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set7_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:26<00:00,  1.22it/s]
Testing psnr 3.116308208554983 (avg)
train: coarse segmentation in 00:03:52
train: finish (eps time 00:03:52 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set7_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set8/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 37.33it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set8 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set8
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set8_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.2ms
Speed: 2.7ms preprocess, 19.2ms inference, 3.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.5ms
Speed: 1.7ms preprocess, 19.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.2ms
Speed: 1.6ms preprocess, 19.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.7ms
Speed: 1.5ms preprocess, 19.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.7ms
Speed: 1.5ms preprocess, 19.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.1ms
Speed: 1.5ms preprocess, 19.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.6ms
Speed: 1.4ms preprocess, 19.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.8ms
Speed: 1.5ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.2ms
Speed: 2.1ms preprocess, 19.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.1ms
Speed: 1.5ms preprocess, 19.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 2.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 18.8ms
Speed: 1.5ms preprocess, 18.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 18.8ms
Speed: 1.5ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.8ms
Speed: 1.5ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.6ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.6ms
Speed: 1.5ms preprocess, 19.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.9ms
Speed: 1.4ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.3ms
Speed: 1.5ms preprocess, 19.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.5ms
Speed: 1.2ms preprocess, 19.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.7ms
Speed: 1.2ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.4ms
Speed: 1.2ms preprocess, 19.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.7ms
Speed: 1.7ms preprocess, 20.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 15
view_order: [16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.3ms
Speed: 1.9ms preprocess, 20.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 1
Instance 0: Confidence=0.9438
Selected instance: 0 (Confidence: 0.9438)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

400 40 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 15 prompts
current IoU is: 0.08018123358488083
Seok, iteration idx= 1 IoU = tensor(0.0802)
SKIP, unacceptable sam prediction, IoU is tensor(0.0802)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.6ms
Speed: 1.6ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 1
Instance 0: Confidence=0.9419
Selected instance: 0 (Confidence: 0.9419)
tmp min: tensor(0.) tmp max: tensor(1.)
375 52 540 960
There are 16 prompts
current IoU is: 0.07312680035829544
Seok, iteration idx= 2 IoU = tensor(0.0731)
SKIP, unacceptable sam prediction, IoU is tensor(0.0731)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.1ms
Speed: 1.6ms preprocess, 22.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 2
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.7583
Selected instance: 0 (Confidence: 0.9489)
tmp min: tensor(0.) tmp max: tensor(1.)
390 88 540 960
There are 16 prompts
current IoU is: 0.07053942233324051
Seok, iteration idx= 3 IoU = tensor(0.0705)
SKIP, unacceptable sam prediction, IoU is tensor(0.0705)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.7ms preprocess, 22.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 2
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9110
Selected instance: 0 (Confidence: 0.9526)
tmp min: tensor(0.) tmp max: tensor(1.)
386 44 540 960
There are 15 prompts
current IoU is: 0.08752166479825974
Seok, iteration idx= 4 IoU = tensor(0.0875)
SKIP, unacceptable sam prediction, IoU is tensor(0.0875)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 2
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9398
Selected instance: 0 (Confidence: 0.9530)
tmp min: tensor(0.) tmp max: tensor(1.)
395 52 540 960
There are 15 prompts
current IoU is: 0.07976526021957397
Seok, iteration idx= 5 IoU = tensor(0.0798)
SKIP, unacceptable sam prediction, IoU is tensor(0.0798)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 1.7ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9348
Selected instance: 0 (Confidence: 0.9594)
tmp min: tensor(0.) tmp max: tensor(1.)
388 32 540 960
There are 16 prompts
current IoU is: 0.0947895422577858
Seok, iteration idx= 6 IoU = tensor(0.0948)
SKIP, unacceptable sam prediction, IoU is tensor(0.0948)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.5ms
Speed: 3.1ms preprocess, 22.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9411
Selected instance: 0 (Confidence: 0.9540)
tmp min: tensor(0.) tmp max: tensor(1.)
374 48 540 960
There are 14 prompts
current IoU is: 0.10699914395809174
Seok, iteration idx= 7 IoU = tensor(0.1070)
SKIP, unacceptable sam prediction, IoU is tensor(0.1070)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 3.3ms preprocess, 22.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9531
Instance 1: Confidence=0.9502
Selected instance: 0 (Confidence: 0.9531)
tmp min: tensor(0.) tmp max: tensor(1.)
413 36 540 960
There are 14 prompts
current IoU is: 0.11431924253702164
Seok, iteration idx= 8 IoU = tensor(0.1143)
SKIP, unacceptable sam prediction, IoU is tensor(0.1143)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.9ms
Speed: 1.6ms preprocess, 22.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9479
Selected instance: 1 (Confidence: 0.9479)
tmp min: tensor(0.) tmp max: tensor(1.)
442 16 540 960
There are 13 prompts
current IoU is: 0.12579603493213654
Seok, iteration idx= 9 IoU = tensor(0.1258)
SKIP, unacceptable sam prediction, IoU is tensor(0.1258)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 3.1ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9527
Instance 1: Confidence=0.9453
Selected instance: 1 (Confidence: 0.9453)
tmp min: tensor(0.) tmp max: tensor(1.)
422 60 540 960
There are 17 prompts
current IoU is: 0.13407175242900848
Seok, iteration idx= 10 IoU = tensor(0.1341)
SKIP, unacceptable sam prediction, IoU is tensor(0.1341)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.0ms
Speed: 1.6ms preprocess, 24.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9330
Selected instance: 1 (Confidence: 0.9330)
tmp min: tensor(0.) tmp max: tensor(1.)
437 28 540 960
There are 16 prompts
current IoU is: 0.14450836181640625
Seok, iteration idx= 11 IoU = tensor(0.1445)
SKIP, unacceptable sam prediction, IoU is tensor(0.1445)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9514
Instance 1: Confidence=0.9420
Selected instance: 1 (Confidence: 0.9420)
tmp min: tensor(0.) tmp max: tensor(1.)
448 44 540 960
There are 14 prompts
current IoU is: 0.1477062851190567
Seok, iteration idx= 12 IoU = tensor(0.1477)
SKIP, unacceptable sam prediction, IoU is tensor(0.1477)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9259
Selected instance: 1 (Confidence: 0.9259)
tmp min: tensor(0.) tmp max: tensor(1.)
444 120 540 960
There are 15 prompts
current IoU is: 0.14413411915302277
Seok, iteration idx= 13 IoU = tensor(0.1441)
SKIP, unacceptable sam prediction, IoU is tensor(0.1441)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.4ms
Speed: 1.4ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 3
Instance 0: Confidence=0.9418
Instance 1: Confidence=0.9212
Instance 2: Confidence=0.5274
Selected instance: 1 (Confidence: 0.9212)
tmp min: tensor(0.) tmp max: tensor(1.)
466 92 540 960
There are 15 prompts
current IoU is: 0.1547790765762329
Seok, iteration idx= 14 IoU = tensor(0.1548)
SKIP, unacceptable sam prediction, IoU is tensor(0.1548)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.2ms
Speed: 3.0ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 3
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.2551
Selected instance: 1 (Confidence: 0.9302)
tmp min: tensor(0.) tmp max: tensor(1.)
469 92 540 960
There are 16 prompts
current IoU is: 0.15101201832294464
Seok, iteration idx= 15 IoU = tensor(0.1510)
SKIP, unacceptable sam prediction, IoU is tensor(0.1510)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 3.2ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9257
Selected instance: 1 (Confidence: 0.9257)
tmp min: tensor(0.) tmp max: tensor(1.)
468 64 540 960
There are 16 prompts
current IoU is: 0.15778999030590057
Seok, iteration idx= 16 IoU = tensor(0.1578)
SKIP, unacceptable sam prediction, IoU is tensor(0.1578)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 3.3ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9398
Instance 1: Confidence=0.8970
Selected instance: 0 (Confidence: 0.9398)
tmp min: tensor(0.) tmp max: tensor(1.)
463 76 540 960
There are 15 prompts
current IoU is: 0.0233912356197834
Seok, iteration idx= 17 IoU = tensor(0.0234)
SKIP, unacceptable sam prediction, IoU is tensor(0.0234)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 1.6ms preprocess, 22.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9516
Instance 1: Confidence=0.8899
Selected instance: 0 (Confidence: 0.9516)
tmp min: tensor(0.) tmp max: tensor(1.)
454 56 540 960
There are 17 prompts
current IoU is: 0.02709203027188778
Seok, iteration idx= 18 IoU = tensor(0.0271)
SKIP, unacceptable sam prediction, IoU is tensor(0.0271)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.9ms
Speed: 1.6ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 3
Instance 0: Confidence=0.9405
Instance 1: Confidence=0.9138
Instance 2: Confidence=0.4672
Selected instance: 0 (Confidence: 0.9405)
tmp min: tensor(0.) tmp max: tensor(1.)
449 44 540 960
There are 16 prompts
current IoU is: 0.03767090290784836
Seok, iteration idx= 19 IoU = tensor(0.0377)
SKIP, unacceptable sam prediction, IoU is tensor(0.0377)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 3
Instance 0: Confidence=0.9450
Instance 1: Confidence=0.8929
Instance 2: Confidence=0.7195
Selected instance: 0 (Confidence: 0.9450)
tmp min: tensor(0.) tmp max: tensor(1.)
418 40 540 960
There are 16 prompts
current IoU is: 0.06388083845376968
Seok, iteration idx= 20 IoU = tensor(0.0639)
SKIP, unacceptable sam prediction, IoU is tensor(0.0639)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 3
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9083
Instance 2: Confidence=0.7298
Selected instance: 0 (Confidence: 0.9458)
tmp min: tensor(0.) tmp max: tensor(1.)
405 20 540 960
There are 19 prompts
current IoU is: 0.0679488256573677
Seok, iteration idx= 21 IoU = tensor(0.0679)
SKIP, unacceptable sam prediction, IoU is tensor(0.0679)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.8ms
Speed: 3.0ms preprocess, 22.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 3
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.8985
Instance 2: Confidence=0.8365
Selected instance: 0 (Confidence: 0.9384)
tmp min: tensor(0.) tmp max: tensor(1.)
434 24 540 960
There are 19 prompts
current IoU is: 0.07627327740192413
Seok, iteration idx= 22 IoU = tensor(0.0763)
SKIP, unacceptable sam prediction, IoU is tensor(0.0763)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 2.8ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.8323
Selected instance: 0 (Confidence: 0.9477)
tmp min: tensor(0.) tmp max: tensor(1.)
397 20 540 960
There are 16 prompts
current IoU is: 0.07601305842399597
Seok, iteration idx= 23 IoU = tensor(0.0760)
SKIP, unacceptable sam prediction, IoU is tensor(0.0760)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.4ms
Speed: 1.5ms preprocess, 22.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.7016
Selected instance: 0 (Confidence: 0.9483)
tmp min: tensor(0.) tmp max: tensor(1.)
364 20 540 960
There are 15 prompts
current IoU is: 0.07549683004617691
Seok, iteration idx= 24 IoU = tensor(0.0755)
SKIP, unacceptable sam prediction, IoU is tensor(0.0755)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9293
Instance 1: Confidence=0.9154
Selected instance: 0 (Confidence: 0.9293)
tmp min: tensor(0.) tmp max: tensor(1.)
503 48 540 960
There are 16 prompts
current IoU is: 0.13675369322299957
Seok, iteration idx= 25 IoU = tensor(0.1368)
SKIP, unacceptable sam prediction, IoU is tensor(0.1368)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 2
Instance 0: Confidence=0.9417
Instance 1: Confidence=0.9213
Selected instance: 0 (Confidence: 0.9417)
tmp min: tensor(0.) tmp max: tensor(1.)
503 52 540 960
There are 17 prompts
current IoU is: 0.11177953332662582
Seok, iteration idx= 26 IoU = tensor(0.1118)
SKIP, unacceptable sam prediction, IoU is tensor(0.1118)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.2ms
Speed: 2.2ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 3
Instance 0: Confidence=0.9340
Instance 1: Confidence=0.9279
Instance 2: Confidence=0.8775
Selected instance: 0 (Confidence: 0.9340)
tmp min: tensor(0.) tmp max: tensor(1.)
502 40 540 960
There are 16 prompts
current IoU is: 0.09746230393648148
Seok, iteration idx= 27 IoU = tensor(0.0975)
SKIP, unacceptable sam prediction, IoU is tensor(0.0975)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 3
Instance 0: Confidence=0.9416
Instance 1: Confidence=0.9159
Instance 2: Confidence=0.5724
Selected instance: 0 (Confidence: 0.9416)
tmp min: tensor(0.) tmp max: tensor(1.)
513 40 540 960
There are 19 prompts
current IoU is: 0.08551724255084991
Seok, iteration idx= 28 IoU = tensor(0.0855)
SKIP, unacceptable sam prediction, IoU is tensor(0.0855)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.6ms
Speed: 3.1ms preprocess, 21.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 3
Instance 0: Confidence=0.9417
Instance 1: Confidence=0.9193
Instance 2: Confidence=0.8251
Selected instance: 0 (Confidence: 0.9417)
tmp min: tensor(0.) tmp max: tensor(1.)
516 48 540 960
There are 17 prompts
current IoU is: 0.08998652547597885
Seok, iteration idx= 29 IoU = tensor(0.0900)
SKIP, unacceptable sam prediction, IoU is tensor(0.0900)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.6ms
Speed: 3.2ms preprocess, 21.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 3
Instance 0: Confidence=0.9349
Instance 1: Confidence=0.9199
Instance 2: Confidence=0.8269
Selected instance: 0 (Confidence: 0.9349)
tmp min: tensor(0.) tmp max: tensor(1.)
532 60 540 960
There are 19 prompts
current IoU is: 0.07569281756877899
Seok, iteration idx= 30 IoU = tensor(0.0757)
SKIP, unacceptable sam prediction, IoU is tensor(0.0757)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 3
Instance 0: Confidence=0.8907
Instance 1: Confidence=0.8869
Instance 2: Confidence=0.8282
Selected instance: 0 (Confidence: 0.8907)
tmp min: tensor(0.) tmp max: tensor(1.)
526 80 540 960
There are 16 prompts
current IoU is: 0.1045427918434143
Seok, iteration idx= 31 IoU = tensor(0.1045)
SKIP, unacceptable sam prediction, IoU is tensor(0.1045)
Selected Instance Confidence List: [tensor(0.5240), tensor(0.4256, device='cpu'), tensor(0.4206, device='cpu'), tensor(0.4219, device='cpu'), tensor(0.4336, device='cpu'), tensor(0.4290, device='cpu'), tensor(0.4406, device='cpu'), tensor(0.4458, device='cpu'), tensor(0.4498, device='cpu'), tensor(0.4546, device='cpu'), tensor(0.4586, device='cpu'), tensor(0.4599, device='cpu'), tensor(0.4654, device='cpu'), tensor(0.4568, device='cpu'), tensor(0.4614, device='cpu'), tensor(0.4627, device='cpu'), tensor(0.4650, device='cpu'), tensor(0.3899, device='cpu'), tensor(0.3969, device='cpu'), tensor(0.3988, device='cpu'), tensor(0.4163, device='cpu'), tensor(0.4191, device='cpu'), tensor(0.4211, device='cpu'), tensor(0.4247, device='cpu'), tensor(0.4246, device='cpu'), tensor(0.4538, device='cpu'), tensor(0.4438, device='cpu'), tensor(0.4321, device='cpu'), tensor(0.4280, device='cpu'), tensor(0.4307, device='cpu'), tensor(0.4194, device='cpu'), tensor(0.4190, device='cpu')]
Sorted Confidence Order: [tensor(0.5240), tensor(0.4190, device='cpu'), tensor(0.4194, device='cpu'), tensor(0.4307, device='cpu'), tensor(0.4280, device='cpu'), tensor(0.4321, device='cpu'), tensor(0.4438, device='cpu'), tensor(0.4538, device='cpu'), tensor(0.4650, device='cpu'), tensor(0.4627, device='cpu'), tensor(0.4614, device='cpu'), tensor(0.4568, device='cpu'), tensor(0.4654, device='cpu'), tensor(0.4599, device='cpu'), tensor(0.4586, device='cpu'), tensor(0.4546, device='cpu'), tensor(0.4498, device='cpu'), tensor(0.4458, device='cpu'), tensor(0.4406, device='cpu'), tensor(0.4290, device='cpu'), tensor(0.4336, device='cpu'), tensor(0.4219, device='cpu'), tensor(0.4206, device='cpu'), tensor(0.4256, device='cpu'), tensor(0.4246, device='cpu'), tensor(0.4247, device='cpu'), tensor(0.4211, device='cpu'), tensor(0.4191, device='cpu'), tensor(0.4163, device='cpu'), tensor(0.3988, device='cpu'), tensor(0.3969, device='cpu'), tensor(0.3899, device='cpu')]
sorted_indices: [0, 31, 30, 29, 28, 27, 26, 25, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 24, 23, 22, 21, 20, 19, 18, 17]
Initial view (highest confidence): 1
New training order: [16, 15, 14, 13, 12, 11, 10, 9, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.9ms
Speed: 1.4ms preprocess, 18.9ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.1ms
Speed: 1.5ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 3
Instance 0: Confidence=0.8907
Instance 1: Confidence=0.8869
Instance 2: Confidence=0.8282
tmp min: tensor(0.) tmp max: tensor(1.)
526 80 540 960
There are 16 prompts
current IoU is: 0.042080171406269073
Seok, iteration idx= 1 IoU = tensor(0.0421)
SKIP, unacceptable sam prediction, IoU is tensor(0.0421)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.8ms
Speed: 1.6ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 3
Instance 0: Confidence=0.9349
Instance 1: Confidence=0.9199
Instance 2: Confidence=0.8269
tmp min: tensor(0.) tmp max: tensor(1.)
532 60 540 960
There are 19 prompts
current IoU is: 0.02275695838034153
Seok, iteration idx= 2 IoU = tensor(0.0228)
SKIP, unacceptable sam prediction, IoU is tensor(0.0228)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.9ms
Speed: 1.6ms preprocess, 22.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 3
Instance 0: Confidence=0.9417
Instance 1: Confidence=0.9193
Instance 2: Confidence=0.8251
tmp min: tensor(0.) tmp max: tensor(1.)
516 48 540 960
There are 17 prompts
current IoU is: 0.01695232093334198
Seok, iteration idx= 3 IoU = tensor(0.0170)
SKIP, unacceptable sam prediction, IoU is tensor(0.0170)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 3
Instance 0: Confidence=0.9416
Instance 1: Confidence=0.9159
Instance 2: Confidence=0.5724
tmp min: tensor(0.) tmp max: tensor(1.)
756 16 540 960
There are 14 prompts
current IoU is: 0.02234805002808571
Seok, iteration idx= 4 IoU = tensor(0.0223)
SKIP, unacceptable sam prediction, IoU is tensor(0.0223)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.4ms
Speed: 3.5ms preprocess, 22.4ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 3
Instance 0: Confidence=0.9340
Instance 1: Confidence=0.9279
Instance 2: Confidence=0.8775
tmp min: tensor(0.) tmp max: tensor(1.)
783 20 540 960
There are 15 prompts
current IoU is: 0.020436890423297882
Seok, iteration idx= 5 IoU = tensor(0.0204)
SKIP, unacceptable sam prediction, IoU is tensor(0.0204)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 2.7ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 2
Instance 0: Confidence=0.9417
Instance 1: Confidence=0.9213
tmp min: tensor(0.) tmp max: tensor(1.)
503 52 540 960
There are 17 prompts
current IoU is: 0.02279072254896164
Seok, iteration idx= 6 IoU = tensor(0.0228)
SKIP, unacceptable sam prediction, IoU is tensor(0.0228)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.6ms preprocess, 23.2ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9293
Instance 1: Confidence=0.9154
tmp min: tensor(0.) tmp max: tensor(1.)
503 48 540 960
There are 16 prompts
current IoU is: 0.021936941891908646
Seok, iteration idx= 7 IoU = tensor(0.0219)
SKIP, unacceptable sam prediction, IoU is tensor(0.0219)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 25.0ms
Speed: 1.5ms preprocess, 25.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9257
tmp min: tensor(0.) tmp max: tensor(1.)
468 64 540 960
There are 16 prompts
current IoU is: 0.022301653400063515
Seok, iteration idx= 8 IoU = tensor(0.0223)
SKIP, unacceptable sam prediction, IoU is tensor(0.0223)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.3ms
Speed: 1.6ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 3
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.2551
tmp min: tensor(0.) tmp max: tensor(1.)
469 92 540 960
There are 16 prompts
current IoU is: 0.022613396868109703
Seok, iteration idx= 9 IoU = tensor(0.0226)
SKIP, unacceptable sam prediction, IoU is tensor(0.0226)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.7ms
Speed: 1.4ms preprocess, 22.7ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 3
Instance 0: Confidence=0.9418
Instance 1: Confidence=0.9212
Instance 2: Confidence=0.5274
tmp min: tensor(0.) tmp max: tensor(1.)
466 92 540 960
There are 15 prompts
current IoU is: 0.022119253873825073
Seok, iteration idx= 10 IoU = tensor(0.0221)
SKIP, unacceptable sam prediction, IoU is tensor(0.0221)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 1.4ms preprocess, 22.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9259
tmp min: tensor(0.) tmp max: tensor(1.)
444 120 540 960
There are 15 prompts
current IoU is: 0.021121010184288025
Seok, iteration idx= 11 IoU = tensor(0.0211)
SKIP, unacceptable sam prediction, IoU is tensor(0.0211)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 2
Instance 0: Confidence=0.9514
Instance 1: Confidence=0.9420
tmp min: tensor(0.) tmp max: tensor(1.)
448 44 540 960
There are 14 prompts
current IoU is: 0.019151682034134865
Seok, iteration idx= 12 IoU = tensor(0.0192)
SKIP, unacceptable sam prediction, IoU is tensor(0.0192)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 3.1ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9554
Instance 1: Confidence=0.9330
tmp min: tensor(0.) tmp max: tensor(1.)
437 28 540 960
There are 16 prompts
current IoU is: 0.019067075103521347
Seok, iteration idx= 13 IoU = tensor(0.0191)
SKIP, unacceptable sam prediction, IoU is tensor(0.0191)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 2.4ms preprocess, 23.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9527
Instance 1: Confidence=0.9453
tmp min: tensor(0.) tmp max: tensor(1.)
422 60 540 960
There are 17 prompts
current IoU is: 0.01763095334172249
Seok, iteration idx= 14 IoU = tensor(0.0176)
SKIP, unacceptable sam prediction, IoU is tensor(0.0176)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 2.9ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 2
Instance 0: Confidence=0.9518
Instance 1: Confidence=0.9479
tmp min: tensor(0.) tmp max: tensor(1.)
442 16 540 960
There are 13 prompts
current IoU is: 0.015413410030305386
Seok, iteration idx= 15 IoU = tensor(0.0154)
SKIP, unacceptable sam prediction, IoU is tensor(0.0154)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 3.6ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 2
Instance 0: Confidence=0.9531
Instance 1: Confidence=0.9502
tmp min: tensor(0.) tmp max: tensor(1.)
413 36 540 960
There are 14 prompts
current IoU is: 0.01432574912905693
Seok, iteration idx= 16 IoU = tensor(0.0143)
SKIP, unacceptable sam prediction, IoU is tensor(0.0143)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.9ms
Speed: 1.7ms preprocess, 23.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9411
tmp min: tensor(0.) tmp max: tensor(1.)
374 48 540 960
There are 14 prompts
current IoU is: 0.013039253652095795
Seok, iteration idx= 17 IoU = tensor(0.0130)
SKIP, unacceptable sam prediction, IoU is tensor(0.0130)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 1.6ms preprocess, 23.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9594
Instance 1: Confidence=0.9348
tmp min: tensor(0.) tmp max: tensor(1.)
388 32 540 960
There are 16 prompts
current IoU is: 0.012307179160416126
Seok, iteration idx= 18 IoU = tensor(0.0123)
SKIP, unacceptable sam prediction, IoU is tensor(0.0123)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.2ms
Speed: 1.6ms preprocess, 23.2ms inference, 2.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9530
Instance 1: Confidence=0.9398
tmp min: tensor(0.) tmp max: tensor(1.)
395 52 540 960
There are 15 prompts
current IoU is: 0.011973333545029163
Seok, iteration idx= 19 IoU = tensor(0.0120)
SKIP, unacceptable sam prediction, IoU is tensor(0.0120)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9110
tmp min: tensor(0.) tmp max: tensor(1.)
386 44 540 960
There are 15 prompts
current IoU is: 0.012387052178382874
Seok, iteration idx= 20 IoU = tensor(0.0124)
SKIP, unacceptable sam prediction, IoU is tensor(0.0124)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.7583
tmp min: tensor(0.) tmp max: tensor(1.)
431 116 540 960
current IoU is: 0.030703013762831688
Seok, iteration idx= 21 IoU = tensor(0.0307)
SKIP, unacceptable sam prediction, IoU is tensor(0.0307)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.5ms
Speed: 2.9ms preprocess, 22.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 1
Instance 0: Confidence=0.9419
tmp min: tensor(0.) tmp max: tensor(1.)
375 52 540 960
There are 16 prompts
current IoU is: 0.015197347849607468
Seok, iteration idx= 22 IoU = tensor(0.0152)
SKIP, unacceptable sam prediction, IoU is tensor(0.0152)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 24.1ms
Speed: 2.9ms preprocess, 24.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 1
Instance 0: Confidence=0.9438
tmp min: tensor(0.) tmp max: tensor(1.)
400 40 540 960
There are 15 prompts
current IoU is: 0.013106100261211395
Seok, iteration idx= 23 IoU = tensor(0.0131)
SKIP, unacceptable sam prediction, IoU is tensor(0.0131)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.7016
tmp min: tensor(0.) tmp max: tensor(1.)
364 20 540 960
There are 15 prompts
current IoU is: 0.01109597459435463
Seok, iteration idx= 24 IoU = tensor(0.0111)
SKIP, unacceptable sam prediction, IoU is tensor(0.0111)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.6ms
Speed: 2.7ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.8323
tmp min: tensor(0.) tmp max: tensor(1.)
397 20 540 960
There are 16 prompts
current IoU is: 0.012207388877868652
Seok, iteration idx= 25 IoU = tensor(0.0122)
SKIP, unacceptable sam prediction, IoU is tensor(0.0122)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 3
Instance 0: Confidence=0.9384
Instance 1: Confidence=0.8985
Instance 2: Confidence=0.8365
tmp min: tensor(0.) tmp max: tensor(1.)
434 24 540 960
There are 19 prompts
current IoU is: 0.010591531172394753
Seok, iteration idx= 26 IoU = tensor(0.0106)
SKIP, unacceptable sam prediction, IoU is tensor(0.0106)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 3
Instance 0: Confidence=0.9458
Instance 1: Confidence=0.9083
Instance 2: Confidence=0.7298
tmp min: tensor(0.) tmp max: tensor(1.)
405 20 540 960
There are 19 prompts
current IoU is: 0.008233902975916862
Seok, iteration idx= 27 IoU = tensor(0.0082)
SKIP, unacceptable sam prediction, IoU is tensor(0.0082)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.4ms
Speed: 4.0ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 3
Instance 0: Confidence=0.9450
Instance 1: Confidence=0.8929
Instance 2: Confidence=0.7195
tmp min: tensor(0.) tmp max: tensor(1.)
418 40 540 960
There are 16 prompts
current IoU is: 0.0065314131788909435
Seok, iteration idx= 28 IoU = tensor(0.0065)
SKIP, unacceptable sam prediction, IoU is tensor(0.0065)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.5ms
Speed: 3.2ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 3
Instance 0: Confidence=0.9405
Instance 1: Confidence=0.9138
Instance 2: Confidence=0.4672
tmp min: tensor(0.) tmp max: tensor(1.)
449 44 540 960
There are 16 prompts
current IoU is: 0.008125703781843185
Seok, iteration idx= 29 IoU = tensor(0.0081)
SKIP, unacceptable sam prediction, IoU is tensor(0.0081)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.3ms
Speed: 2.8ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 2
Instance 0: Confidence=0.9516
Instance 1: Confidence=0.8899
tmp min: tensor(0.) tmp max: tensor(1.)
454 56 540 960
There are 17 prompts
current IoU is: 0.00833216868340969
Seok, iteration idx= 30 IoU = tensor(0.0083)
SKIP, unacceptable sam prediction, IoU is tensor(0.0083)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 2
Instance 0: Confidence=0.9398
Instance 1: Confidence=0.8970
tmp min: tensor(0.) tmp max: tensor(1.)
463 76 540 960
There are 15 prompts
current IoU is: 0.009390609338879585
Seok, iteration idx= 31 IoU = tensor(0.0094)
SKIP, unacceptable sam prediction, IoU is tensor(0.0094)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set8_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set8_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.23s/it]
Testing psnr 28.604390248656273 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set8_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:26<00:00,  1.20it/s]
Testing psnr 3.3514911495149136 (avg)
train: coarse segmentation in 00:03:38
train: finish (eps time 00:03:38 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set8_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set9/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 41.99it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set9 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set9
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set9_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.2ms
Speed: 2.4ms preprocess, 19.2ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.3ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.0ms
Speed: 1.2ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.1ms
Speed: 1.4ms preprocess, 19.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.3ms
Speed: 1.3ms preprocess, 19.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.3ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 21.3ms
Speed: 1.4ms preprocess, 21.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.1ms
Speed: 1.5ms preprocess, 19.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.7ms
Speed: 1.6ms preprocess, 19.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.2ms
Speed: 1.6ms preprocess, 19.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 1.2ms preprocess, 20.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.5ms
Speed: 1.9ms preprocess, 19.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.8ms
Speed: 1.5ms preprocess, 19.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.9ms
Speed: 1.5ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.0ms
Speed: 1.3ms preprocess, 20.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.4ms
Speed: 3.0ms preprocess, 21.4ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.1ms
Speed: 1.4ms preprocess, 20.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9530
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.8797
Instance 4: Confidence=0.8281
Instance 5: Confidence=0.7251
Selected instance: 5 (Confidence: 0.7251)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

343 84 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.6434693932533264
Seok, iteration idx= 1 IoU = tensor(0.6435)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 4
Instance 0: Confidence=0.9523
Instance 1: Confidence=0.9468
Instance 2: Confidence=0.9161
Instance 3: Confidence=0.8821
Selected instance: 2 (Confidence: 0.9161)
tmp min: tensor(0.) tmp max: tensor(1.)
252 72 540 960
There are 15 prompts
current IoU is: 0.005609320010989904
Seok, iteration idx= 2 IoU = tensor(0.0056)
SKIP, unacceptable sam prediction, IoU is tensor(0.0056)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 1.4ms preprocess, 22.4ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9327
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9102
Instance 3: Confidence=0.8415
Instance 4: Confidence=0.7714
Selected instance: 0 (Confidence: 0.9327)
tmp min: tensor(0.) tmp max: tensor(1.)
369 100 540 960
There are 15 prompts
current IoU is: 0.0018571399850770831
Seok, iteration idx= 3 IoU = tensor(0.0019)
SKIP, unacceptable sam prediction, IoU is tensor(0.0019)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.6ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9506
Instance 2: Confidence=0.8723
Instance 3: Confidence=0.8416
Instance 4: Confidence=0.8138
Instance 5: Confidence=0.3145
Selected instance: 1 (Confidence: 0.9506)
tmp min: tensor(0.) tmp max: tensor(1.)
731 24 540 960
There are 16 prompts
current IoU is: 0.28178671002388
Seok, iteration idx= 4 IoU = tensor(0.2818)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 2.0ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 6
Instance 0: Confidence=0.9543
Instance 1: Confidence=0.9481
Instance 2: Confidence=0.8723
Instance 3: Confidence=0.8448
Instance 4: Confidence=0.8141
Instance 5: Confidence=0.7543
Selected instance: 0 (Confidence: 0.9543)
tmp min: tensor(0.) tmp max: tensor(1.)
648 24 540 960
There are 16 prompts
current IoU is: 0.7525657415390015
Seok, iteration idx= 5 IoU = tensor(0.7526)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 8
Instance 0: Confidence=0.9574
Instance 1: Confidence=0.9518
Instance 2: Confidence=0.8906
Instance 3: Confidence=0.8743
Instance 4: Confidence=0.6790
Instance 5: Confidence=0.4519
Instance 6: Confidence=0.3982
Instance 7: Confidence=0.2843
Selected instance: 1 (Confidence: 0.9518)
tmp min: tensor(0.) tmp max: tensor(1.)
621 64 540 960
There are 13 prompts
current IoU is: 0.8904544711112976
Seok, iteration idx= 6 IoU = tensor(0.8905)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9355
Instance 2: Confidence=0.9115
Instance 3: Confidence=0.8830
Instance 4: Confidence=0.7381
Instance 5: Confidence=0.7063
Selected instance: 1 (Confidence: 0.9355)
tmp min: tensor(0.) tmp max: tensor(1.)
549 20 540 960
There are 13 prompts
current IoU is: 0.8559074401855469
Seok, iteration idx= 7 IoU = tensor(0.8559)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9499
Instance 1: Confidence=0.9225
Instance 2: Confidence=0.9120
Instance 3: Confidence=0.9019
Instance 4: Confidence=0.8923
Selected instance: 0 (Confidence: 0.9499)
tmp min: tensor(0.) tmp max: tensor(1.)
433 12 540 960
There are 15 prompts
current IoU is: 0.8965089917182922
Seok, iteration idx= 8 IoU = tensor(0.8965)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.7ms
Speed: 3.0ms preprocess, 22.7ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9663
Instance 1: Confidence=0.9506
Instance 2: Confidence=0.9380
Instance 3: Confidence=0.8953
Instance 4: Confidence=0.8884
Instance 5: Confidence=0.6212
Selected instance: 0 (Confidence: 0.9663)
tmp min: tensor(0.) tmp max: tensor(1.)
338 0 540 960
There are 13 prompts
current IoU is: 0.9409940838813782
Seok, iteration idx= 9 IoU = tensor(0.9410)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 3.8ms preprocess, 22.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9406
Instance 2: Confidence=0.8957
Instance 3: Confidence=0.8788
Instance 4: Confidence=0.6792
Instance 5: Confidence=0.2540
Selected instance: 0 (Confidence: 0.9652)
tmp min: tensor(0.) tmp max: tensor(1.)
244 0 540 960
There are 17 prompts
current IoU is: 0.9173933267593384
Seok, iteration idx= 10 IoU = tensor(0.9174)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9677
Instance 1: Confidence=0.9541
Instance 2: Confidence=0.9076
Instance 3: Confidence=0.8270
Instance 4: Confidence=0.6917
Selected instance: 1 (Confidence: 0.9541)
tmp min: tensor(0.) tmp max: tensor(1.)
187 0 540 960
There are 18 prompts
current IoU is: 0.937192440032959
Seok, iteration idx= 11 IoU = tensor(0.9372)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 1.5ms preprocess, 22.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9664
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.8923
Instance 3: Confidence=0.6204
Instance 4: Confidence=0.4815
Instance 5: Confidence=0.4394
Selected instance: 1 (Confidence: 0.9466)
tmp min: tensor(0.) tmp max: tensor(1.)
156 0 540 960
There are 14 prompts
current IoU is: 0.9088584780693054
Seok, iteration idx= 12 IoU = tensor(0.9089)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.6ms preprocess, 23.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9655
Instance 1: Confidence=0.9527
Instance 2: Confidence=0.9136
Instance 3: Confidence=0.8798
Instance 4: Confidence=0.8149
Instance 5: Confidence=0.6837
Selected instance: 1 (Confidence: 0.9527)
tmp min: tensor(0.) tmp max: tensor(1.)
145 36 540 960
There are 16 prompts
current IoU is: 0.9185401797294617
Seok, iteration idx= 13 IoU = tensor(0.9185)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 1.7ms preprocess, 23.1ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9565
Instance 1: Confidence=0.9201
Instance 2: Confidence=0.9047
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.8364
Instance 5: Confidence=0.4276
Instance 6: Confidence=0.3358
Selected instance: 2 (Confidence: 0.9047)
tmp min: tensor(0.) tmp max: tensor(1.)
129 8 540 960
There are 18 prompts
current IoU is: 0.9288920760154724
Seok, iteration idx= 14 IoU = tensor(0.9289)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9601
Instance 1: Confidence=0.9222
Instance 2: Confidence=0.9087
Instance 3: Confidence=0.8744
Instance 4: Confidence=0.7555
Selected instance: 2 (Confidence: 0.9087)
tmp min: tensor(0.) tmp max: tensor(1.)
147 32 540 960
There are 16 prompts
current IoU is: 0.9146614074707031
Seok, iteration idx= 15 IoU = tensor(0.9147)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 7
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9223
Instance 2: Confidence=0.9203
Instance 3: Confidence=0.8729
Instance 4: Confidence=0.7752
Instance 5: Confidence=0.6791
Instance 6: Confidence=0.3599
Selected instance: 1 (Confidence: 0.9223)
tmp min: tensor(0.) tmp max: tensor(1.)
171 120 540 960
There are 16 prompts
current IoU is: 0.9082751274108887
Seok, iteration idx= 16 IoU = tensor(0.9083)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9394
Instance 1: Confidence=0.9324
Instance 2: Confidence=0.9258
Instance 3: Confidence=0.9160
Instance 4: Confidence=0.9043
Selected instance: 3 (Confidence: 0.9160)
tmp min: tensor(0.) tmp max: tensor(1.)
177 92 540 960
There are 16 prompts
current IoU is: 0.8680069446563721
Seok, iteration idx= 17 IoU = tensor(0.8680)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 1.7ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 7
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9479
Instance 2: Confidence=0.9307
Instance 3: Confidence=0.9156
Instance 4: Confidence=0.8290
Instance 5: Confidence=0.7404
Instance 6: Confidence=0.3328
Selected instance: 3 (Confidence: 0.9156)
tmp min: tensor(0.) tmp max: tensor(1.)
177 100 540 960
There are 16 prompts
current IoU is: 0.8919255137443542
Seok, iteration idx= 18 IoU = tensor(0.8919)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9400
Instance 2: Confidence=0.9397
Instance 3: Confidence=0.8820
Instance 4: Confidence=0.8574
Instance 5: Confidence=0.5968
Instance 6: Confidence=0.3960
Selected instance: 3 (Confidence: 0.8820)
tmp min: tensor(0.) tmp max: tensor(1.)
185 64 540 960
There are 17 prompts
current IoU is: 0.8569977879524231
Seok, iteration idx= 19 IoU = tensor(0.8570)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 7
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9180
Instance 3: Confidence=0.8806
Instance 4: Confidence=0.7796
Instance 5: Confidence=0.4945
Instance 6: Confidence=0.4307
Selected instance: 4 (Confidence: 0.7796)
tmp min: tensor(0.) tmp max: tensor(1.)
714 96 540 960
There are 17 prompts
current IoU is: 0.8323850631713867
Seok, iteration idx= 20 IoU = tensor(0.8324)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9511
Instance 2: Confidence=0.9189
Instance 3: Confidence=0.8933
Instance 4: Confidence=0.8605
Instance 5: Confidence=0.8161
Selected instance: 3 (Confidence: 0.8933)
tmp min: tensor(0.) tmp max: tensor(1.)
758 60 540 960
There are 19 prompts
current IoU is: 0.822367250919342
Seok, iteration idx= 21 IoU = tensor(0.8224)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 3.4ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9659
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.9025
Instance 4: Confidence=0.8976
Instance 5: Confidence=0.8199
Selected instance: 2 (Confidence: 0.9149)
tmp min: tensor(0.) tmp max: tensor(1.)
797 52 540 960
There are 16 prompts
current IoU is: 0.8083176612854004
Seok, iteration idx= 22 IoU = tensor(0.8083)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.1ms
Speed: 3.5ms preprocess, 22.1ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 7
Instance 0: Confidence=0.9650
Instance 1: Confidence=0.9498
Instance 2: Confidence=0.9253
Instance 3: Confidence=0.8752
Instance 4: Confidence=0.6702
Instance 5: Confidence=0.4329
Instance 6: Confidence=0.3059
Selected instance: 2 (Confidence: 0.9253)
tmp min: tensor(0.) tmp max: tensor(1.)
777 44 540 960
There are 16 prompts
current IoU is: 0.8400762677192688
Seok, iteration idx= 23 IoU = tensor(0.8401)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.3ms
Speed: 3.0ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 8
Instance 0: Confidence=0.9547
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9168
Instance 3: Confidence=0.9027
Instance 4: Confidence=0.7627
Instance 5: Confidence=0.3927
Instance 6: Confidence=0.3073
Instance 7: Confidence=0.2968
Selected instance: 2 (Confidence: 0.9168)
tmp min: tensor(0.) tmp max: tensor(1.)
799 24 540 960
There are 16 prompts
current IoU is: 0.8651229739189148
Seok, iteration idx= 24 IoU = tensor(0.8651)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 3.0ms preprocess, 22.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9214
Instance 2: Confidence=0.9091
Instance 3: Confidence=0.8954
Instance 4: Confidence=0.8457
Instance 5: Confidence=0.6131
Selected instance: 1 (Confidence: 0.9214)
tmp min: tensor(0.) tmp max: tensor(1.)
819 12 540 960
There are 18 prompts
current IoU is: 0.9103904962539673
Seok, iteration idx= 25 IoU = tensor(0.9104)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 3.0ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9614
Instance 1: Confidence=0.9360
Instance 2: Confidence=0.9196
Instance 3: Confidence=0.8601
Instance 4: Confidence=0.8506
Instance 5: Confidence=0.4255
Selected instance: 1 (Confidence: 0.9360)
tmp min: tensor(0.) tmp max: tensor(1.)
777 4 540 960
There are 16 prompts
current IoU is: 0.9312726855278015
Seok, iteration idx= 26 IoU = tensor(0.9313)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 7
Instance 0: Confidence=0.9614
Instance 1: Confidence=0.9443
Instance 2: Confidence=0.9363
Instance 3: Confidence=0.7233
Instance 4: Confidence=0.5203
Instance 5: Confidence=0.3875
Instance 6: Confidence=0.3196
Selected instance: 1 (Confidence: 0.9443)
tmp min: tensor(0.) tmp max: tensor(1.)
718 0 540 960
There are 17 prompts
current IoU is: 0.9344889521598816
Seok, iteration idx= 27 IoU = tensor(0.9345)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 1.7ms preprocess, 23.2ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9562
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.9215
Instance 3: Confidence=0.8554
Instance 4: Confidence=0.7123
Selected instance: 4 (Confidence: 0.7123)
tmp min: tensor(0.) tmp max: tensor(1.)
210 56 540 960
There are 14 prompts
current IoU is: 0.2823145091533661
Seok, iteration idx= 28 IoU = tensor(0.2823)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9559
Instance 1: Confidence=0.9326
Instance 2: Confidence=0.9255
Instance 3: Confidence=0.8958
Instance 4: Confidence=0.8174
Instance 5: Confidence=0.2734
Selected instance: 1 (Confidence: 0.9326)
tmp min: tensor(0.) tmp max: tensor(1.)
210 12 540 960
There are 15 prompts
current IoU is: 0.01484376285225153
Seok, iteration idx= 29 IoU = tensor(0.0148)
SKIP, unacceptable sam prediction, IoU is tensor(0.0148)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 1.4ms preprocess, 22.8ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9356
Instance 2: Confidence=0.9105
Instance 3: Confidence=0.8693
Instance 4: Confidence=0.7860
Instance 5: Confidence=0.4345
Instance 6: Confidence=0.2986
Selected instance: 4 (Confidence: 0.7860)
tmp min: tensor(0.) tmp max: tensor(1.)
272 56 540 960
There are 17 prompts
current IoU is: 0.7329599261283875
Seok, iteration idx= 30 IoU = tensor(0.7330)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.3ms
Speed: 1.7ms preprocess, 24.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9608
Instance 1: Confidence=0.9245
Instance 2: Confidence=0.9014
Instance 3: Confidence=0.8902
Instance 4: Confidence=0.8448
Selected instance: 3 (Confidence: 0.8902)
tmp min: tensor(0.) tmp max: tensor(1.)
265 56 540 960
There are 16 prompts
current IoU is: 0.8737640976905823
Seok, iteration idx= 31 IoU = tensor(0.8738)
Selected Instance Confidence List: [tensor(0.9268), tensor(0.6761, device='cpu'), tensor(0.3830, device='cpu'), tensor(0.3742, device='cpu'), tensor(0.5493, device='cpu'), tensor(0.8333, device='cpu'), tensor(0.9150, device='cpu'), tensor(0.8877, device='cpu'), tensor(0.9179, device='cpu'), tensor(0.9511, device='cpu'), tensor(0.9365, device='cpu'), tensor(0.9439, device='cpu'), tensor(0.9240, device='cpu'), tensor(0.9322, device='cpu'), tensor(0.9192, device='cpu'), tensor(0.9123, device='cpu'), tensor(0.9139, device='cpu'), tensor(0.8872, device='cpu'), tensor(0.9014, device='cpu'), tensor(0.8670, device='cpu'), tensor(0.8113, device='cpu'), tensor(0.8507, device='cpu'), tensor(0.8510, device='cpu'), tensor(0.8742, device='cpu'), tensor(0.8858, device='cpu'), tensor(0.9148, device='cpu'), tensor(0.9332, device='cpu'), tensor(0.9384, device='cpu'), tensor(0.4543, device='cpu'), tensor(0.3824, device='cpu'), tensor(0.7542, device='cpu'), tensor(0.8804, device='cpu')]
Sorted Confidence Order: [tensor(0.9511, device='cpu'), tensor(0.9179, device='cpu'), tensor(0.9365, device='cpu'), tensor(0.9439, device='cpu'), tensor(0.9240, device='cpu'), tensor(0.9322, device='cpu'), tensor(0.9192, device='cpu'), tensor(0.9123, device='cpu'), tensor(0.9139, device='cpu'), tensor(0.8872, device='cpu'), tensor(0.9014, device='cpu'), tensor(0.8670, device='cpu'), tensor(0.4543, device='cpu'), tensor(0.3824, device='cpu'), tensor(0.7542, device='cpu'), tensor(0.8804, device='cpu'), tensor(0.9268), tensor(0.6761, device='cpu'), tensor(0.3830, device='cpu'), tensor(0.3742, device='cpu'), tensor(0.8113, device='cpu'), tensor(0.8507, device='cpu'), tensor(0.8510, device='cpu'), tensor(0.8742, device='cpu'), tensor(0.8858, device='cpu'), tensor(0.9148, device='cpu'), tensor(0.9332, device='cpu'), tensor(0.9384, device='cpu'), tensor(0.5493, device='cpu'), tensor(0.8333, device='cpu'), tensor(0.9150, device='cpu'), tensor(0.8877, device='cpu')]
sorted_indices: [9, 8, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 28, 29, 30, 31, 0, 1, 2, 3, 20, 21, 22, 23, 24, 25, 26, 27, 4, 5, 6, 7]
Initial view (highest confidence): 10
New training order: [26, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 9, 10, 11, 12, 13, 14, 15, 16, 1, 2, 3, 4, 5, 6, 7, 8, 21, 22, 23, 24]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.2ms
Speed: 1.3ms preprocess, 20.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 3.2ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9499
Instance 1: Confidence=0.9225
Instance 2: Confidence=0.9120
Instance 3: Confidence=0.9019
Instance 4: Confidence=0.8923
tmp min: tensor(0.) tmp max: tensor(1.)
433 12 540 960
There are 15 prompts
current IoU is: 0.9387190341949463
Seok, iteration idx= 1 IoU = tensor(0.9387)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 3.5ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9652
Instance 1: Confidence=0.9406
Instance 2: Confidence=0.8957
Instance 3: Confidence=0.8788
Instance 4: Confidence=0.6792
Instance 5: Confidence=0.2540
tmp min: tensor(0.) tmp max: tensor(1.)
244 0 540 960
There are 17 prompts
current IoU is: 0.9336214661598206
Seok, iteration idx= 2 IoU = tensor(0.9336)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.4ms
Speed: 1.5ms preprocess, 24.4ms inference, 3.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9677
Instance 1: Confidence=0.9541
Instance 2: Confidence=0.9076
Instance 3: Confidence=0.8270
Instance 4: Confidence=0.6917
tmp min: tensor(0.) tmp max: tensor(1.)
187 0 540 960
There are 18 prompts
current IoU is: 0.9516090750694275
Seok, iteration idx= 3 IoU = tensor(0.9516)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.3ms
Speed: 1.4ms preprocess, 22.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9664
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.8923
Instance 3: Confidence=0.6204
Instance 4: Confidence=0.4815
Instance 5: Confidence=0.4394
tmp min: tensor(0.) tmp max: tensor(1.)
156 0 540 960
There are 14 prompts
current IoU is: 0.9208399057388306
Seok, iteration idx= 4 IoU = tensor(0.9208)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 6
Instance 0: Confidence=0.9655
Instance 1: Confidence=0.9527
Instance 2: Confidence=0.9136
Instance 3: Confidence=0.8798
Instance 4: Confidence=0.8149
Instance 5: Confidence=0.6837
tmp min: tensor(0.) tmp max: tensor(1.)
145 36 540 960
There are 16 prompts
current IoU is: 0.9517795443534851
Seok, iteration idx= 5 IoU = tensor(0.9518)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.4ms
Speed: 1.6ms preprocess, 23.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 7
Instance 0: Confidence=0.9565
Instance 1: Confidence=0.9201
Instance 2: Confidence=0.9047
Instance 3: Confidence=0.9032
Instance 4: Confidence=0.8364
Instance 5: Confidence=0.4276
Instance 6: Confidence=0.3358
tmp min: tensor(0.) tmp max: tensor(1.)
129 8 540 960
There are 18 prompts
current IoU is: 0.9557198882102966
Seok, iteration idx= 6 IoU = tensor(0.9557)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9601
Instance 1: Confidence=0.9222
Instance 2: Confidence=0.9087
Instance 3: Confidence=0.8744
Instance 4: Confidence=0.7555
tmp min: tensor(0.) tmp max: tensor(1.)
147 32 540 960
There are 16 prompts
current IoU is: 0.9477088451385498
Seok, iteration idx= 7 IoU = tensor(0.9477)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.0ms
Speed: 1.6ms preprocess, 24.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 7
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9223
Instance 2: Confidence=0.9203
Instance 3: Confidence=0.8729
Instance 4: Confidence=0.7752
Instance 5: Confidence=0.6791
Instance 6: Confidence=0.3599
tmp min: tensor(0.) tmp max: tensor(1.)
171 120 540 960
There are 16 prompts
current IoU is: 0.9377193450927734
Seok, iteration idx= 8 IoU = tensor(0.9377)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.6ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9394
Instance 1: Confidence=0.9324
Instance 2: Confidence=0.9258
Instance 3: Confidence=0.9160
Instance 4: Confidence=0.9043
tmp min: tensor(0.) tmp max: tensor(1.)
177 92 540 960
There are 16 prompts
current IoU is: 0.9332055449485779
Seok, iteration idx= 9 IoU = tensor(0.9332)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 25.0ms
Speed: 1.5ms preprocess, 25.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 7
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9479
Instance 2: Confidence=0.9307
Instance 3: Confidence=0.9156
Instance 4: Confidence=0.8290
Instance 5: Confidence=0.7404
Instance 6: Confidence=0.3328
tmp min: tensor(0.) tmp max: tensor(1.)
177 100 540 960
There are 16 prompts
current IoU is: 0.9263058304786682
Seok, iteration idx= 10 IoU = tensor(0.9263)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.4ms
Speed: 1.7ms preprocess, 24.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9400
Instance 2: Confidence=0.9397
Instance 3: Confidence=0.8820
Instance 4: Confidence=0.8574
Instance 5: Confidence=0.5968
Instance 6: Confidence=0.3960
tmp min: tensor(0.) tmp max: tensor(1.)
185 64 540 960
There are 17 prompts
current IoU is: 0.8791139721870422
Seok, iteration idx= 11 IoU = tensor(0.8791)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9562
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.9215
Instance 3: Confidence=0.8554
Instance 4: Confidence=0.7123
tmp min: tensor(0.) tmp max: tensor(1.)
210 56 540 960
There are 14 prompts
current IoU is: 0.4713275730609894
Seok, iteration idx= 12 IoU = tensor(0.4713)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9559
Instance 1: Confidence=0.9326
Instance 2: Confidence=0.9255
Instance 3: Confidence=0.8958
Instance 4: Confidence=0.8174
Instance 5: Confidence=0.2734
tmp min: tensor(0.) tmp max: tensor(1.)
210 12 540 960
There are 15 prompts
current IoU is: 0.014741608873009682
Seok, iteration idx= 13 IoU = tensor(0.0147)
SKIP, unacceptable sam prediction, IoU is tensor(0.0147)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.5ms
Speed: 2.5ms preprocess, 24.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 7
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9356
Instance 2: Confidence=0.9105
Instance 3: Confidence=0.8693
Instance 4: Confidence=0.7860
Instance 5: Confidence=0.4345
Instance 6: Confidence=0.2986
tmp min: tensor(0.) tmp max: tensor(1.)
272 52 540 960
There are 15 prompts
current IoU is: 0.8204410076141357
Seok, iteration idx= 14 IoU = tensor(0.8204)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 3.0ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9608
Instance 1: Confidence=0.9245
Instance 2: Confidence=0.9014
Instance 3: Confidence=0.8902
Instance 4: Confidence=0.8448
tmp min: tensor(0.) tmp max: tensor(1.)
265 56 540 960
There are 16 prompts
current IoU is: 0.9014896154403687
Seok, iteration idx= 15 IoU = tensor(0.9015)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.4ms
Speed: 3.1ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 8
Instance 0: Confidence=0.9628
Instance 1: Confidence=0.9444
Instance 2: Confidence=0.9268
Instance 3: Confidence=0.9250
Instance 4: Confidence=0.9162
Instance 5: Confidence=0.8189
Instance 6: Confidence=0.3158
Instance 7: Confidence=0.2605
tmp min: tensor(0.) tmp max: tensor(1.)
300 68 540 960
There are 16 prompts
current IoU is: 0.9072258472442627
Seok, iteration idx= 16 IoU = tensor(0.9072)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 2.8ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9532
Instance 1: Confidence=0.9530
Instance 2: Confidence=0.9190
Instance 3: Confidence=0.8797
Instance 4: Confidence=0.8281
Instance 5: Confidence=0.7251
tmp min: tensor(0.) tmp max: tensor(1.)
343 84 540 960
There are 16 prompts
current IoU is: 0.8233633041381836
Seok, iteration idx= 17 IoU = tensor(0.8234)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.3ms
Speed: 2.6ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 4
Instance 0: Confidence=0.9523
Instance 1: Confidence=0.9468
Instance 2: Confidence=0.9161
Instance 3: Confidence=0.8821
tmp min: tensor(0.) tmp max: tensor(1.)
382 60 540 960
There are 15 prompts
current IoU is: 0.0018059719586744905
Seok, iteration idx= 18 IoU = tensor(0.0018)
SKIP, unacceptable sam prediction, IoU is tensor(0.0018)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 2.4ms preprocess, 23.5ms inference, 3.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9327
Instance 1: Confidence=0.9307
Instance 2: Confidence=0.9102
Instance 3: Confidence=0.8415
Instance 4: Confidence=0.7714
tmp min: tensor(0.) tmp max: tensor(1.)
369 100 540 960
There are 15 prompts
current IoU is: 0.004300805740058422
Seok, iteration idx= 19 IoU = tensor(0.0043)
SKIP, unacceptable sam prediction, IoU is tensor(0.0043)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 7
Instance 0: Confidence=0.9477
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9180
Instance 3: Confidence=0.8806
Instance 4: Confidence=0.7796
Instance 5: Confidence=0.4945
Instance 6: Confidence=0.4307
tmp min: tensor(0.) tmp max: tensor(1.)
714 96 540 960
There are 17 prompts
current IoU is: 0.9149817228317261
Seok, iteration idx= 20 IoU = tensor(0.9150)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 1.6ms preprocess, 24.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9591
Instance 1: Confidence=0.9511
Instance 2: Confidence=0.9189
Instance 3: Confidence=0.8933
Instance 4: Confidence=0.8605
Instance 5: Confidence=0.8161
tmp min: tensor(0.) tmp max: tensor(1.)
758 60 540 960
There are 19 prompts
current IoU is: 0.9155027270317078
Seok, iteration idx= 21 IoU = tensor(0.9155)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 2.1ms preprocess, 23.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9659
Instance 1: Confidence=0.9363
Instance 2: Confidence=0.9149
Instance 3: Confidence=0.9025
Instance 4: Confidence=0.8976
Instance 5: Confidence=0.8199
tmp min: tensor(0.) tmp max: tensor(1.)
797 52 540 960
There are 16 prompts
current IoU is: 0.9236316680908203
Seok, iteration idx= 22 IoU = tensor(0.9236)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 7
Instance 0: Confidence=0.9650
Instance 1: Confidence=0.9498
Instance 2: Confidence=0.9253
Instance 3: Confidence=0.8752
Instance 4: Confidence=0.6702
Instance 5: Confidence=0.4329
Instance 6: Confidence=0.3059
tmp min: tensor(0.) tmp max: tensor(1.)
777 44 540 960
There are 16 prompts
current IoU is: 0.9350568056106567
Seok, iteration idx= 23 IoU = tensor(0.9351)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 8
Instance 0: Confidence=0.9547
Instance 1: Confidence=0.9421
Instance 2: Confidence=0.9168
Instance 3: Confidence=0.9027
Instance 4: Confidence=0.7627
Instance 5: Confidence=0.3927
Instance 6: Confidence=0.3073
Instance 7: Confidence=0.2968
tmp min: tensor(0.) tmp max: tensor(1.)
799 24 540 960
There are 16 prompts
current IoU is: 0.9471104741096497
Seok, iteration idx= 24 IoU = tensor(0.9471)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9607
Instance 1: Confidence=0.9214
Instance 2: Confidence=0.9091
Instance 3: Confidence=0.8954
Instance 4: Confidence=0.8457
Instance 5: Confidence=0.6131
tmp min: tensor(0.) tmp max: tensor(1.)
819 12 540 960
There are 18 prompts
current IoU is: 0.9425212144851685
Seok, iteration idx= 25 IoU = tensor(0.9425)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 3.8ms preprocess, 24.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9614
Instance 1: Confidence=0.9360
Instance 2: Confidence=0.9196
Instance 3: Confidence=0.8601
Instance 4: Confidence=0.8506
Instance 5: Confidence=0.4255
tmp min: tensor(0.) tmp max: tensor(1.)
777 4 540 960
There are 16 prompts
current IoU is: 0.9530035257339478
Seok, iteration idx= 26 IoU = tensor(0.9530)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.6ms
Speed: 2.8ms preprocess, 24.6ms inference, 3.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 7
Instance 0: Confidence=0.9614
Instance 1: Confidence=0.9443
Instance 2: Confidence=0.9363
Instance 3: Confidence=0.7233
Instance 4: Confidence=0.5203
Instance 5: Confidence=0.3875
Instance 6: Confidence=0.3196
tmp min: tensor(0.) tmp max: tensor(1.)
718 0 540 960
There are 17 prompts
current IoU is: 0.9384109377861023
Seok, iteration idx= 27 IoU = tensor(0.9384)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 3.2ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9540
Instance 1: Confidence=0.9506
Instance 2: Confidence=0.8723
Instance 3: Confidence=0.8416
Instance 4: Confidence=0.8138
Instance 5: Confidence=0.3145
tmp min: tensor(0.) tmp max: tensor(1.)
731 24 540 960
There are 16 prompts
current IoU is: 0.9073871374130249
Seok, iteration idx= 28 IoU = tensor(0.9074)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 3.6ms preprocess, 22.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9543
Instance 1: Confidence=0.9481
Instance 2: Confidence=0.8723
Instance 3: Confidence=0.8448
Instance 4: Confidence=0.8141
Instance 5: Confidence=0.7543
tmp min: tensor(0.) tmp max: tensor(1.)
648 24 540 960
There are 16 prompts
current IoU is: 0.9527316093444824
Seok, iteration idx= 29 IoU = tensor(0.9527)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.1ms
Speed: 1.6ms preprocess, 24.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 8
Instance 0: Confidence=0.9574
Instance 1: Confidence=0.9518
Instance 2: Confidence=0.8906
Instance 3: Confidence=0.8743
Instance 4: Confidence=0.6790
Instance 5: Confidence=0.4519
Instance 6: Confidence=0.3982
Instance 7: Confidence=0.2843
tmp min: tensor(0.) tmp max: tensor(1.)
621 64 540 960
There are 13 prompts
current IoU is: 0.9583420753479004
Seok, iteration idx= 30 IoU = tensor(0.9583)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9355
Instance 2: Confidence=0.9115
Instance 3: Confidence=0.8830
Instance 4: Confidence=0.7381
Instance 5: Confidence=0.7063
tmp min: tensor(0.) tmp max: tensor(1.)
549 20 540 960
There are 13 prompts
current IoU is: 0.9383528232574463
Seok, iteration idx= 31 IoU = tensor(0.9384)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set9_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set9_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:38<00:00,  1.21s/it]
Testing psnr 27.148047611117363 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set9_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.15it/s]
Testing psnr 3.4367723017930984 (avg)
train: coarse segmentation in 00:03:57
train: finish (eps time 00:03:57 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set9_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set10/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 35.65it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set10 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set10
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set10_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.5ms
Speed: 2.9ms preprocess, 20.5ms inference, 2.9ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 1.4ms preprocess, 20.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.1ms
Speed: 1.4ms preprocess, 19.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.7ms
Speed: 1.6ms preprocess, 19.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.7ms
Speed: 1.5ms preprocess, 19.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.1ms
Speed: 1.9ms preprocess, 19.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.0ms
Speed: 1.4ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 21.0ms
Speed: 1.4ms preprocess, 21.0ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.0ms
Speed: 1.5ms preprocess, 19.0ms inference, 2.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.0ms
Speed: 1.6ms preprocess, 20.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 19.3ms
Speed: 1.6ms preprocess, 19.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.4ms
Speed: 1.5ms preprocess, 19.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.4ms
Speed: 1.5ms preprocess, 19.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.4ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.5ms preprocess, 18.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.5ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.4ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.5ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.8ms
Speed: 1.5ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.4ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.6ms
Speed: 1.5ms preprocess, 19.6ms inference, 2.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.2ms
Speed: 1.6ms preprocess, 19.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.6ms
Speed: 1.2ms preprocess, 19.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 20.5ms
Speed: 2.9ms preprocess, 20.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 12
view_order: [13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.0ms
Speed: 1.9ms preprocess, 21.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9428
Instance 1: Confidence=0.9198
Instance 2: Confidence=0.8951
Instance 3: Confidence=0.8149
Instance 4: Confidence=0.7098
Instance 5: Confidence=0.4333
Selected instance: 1 (Confidence: 0.9198)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

602 72 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 14 prompts
current IoU is: 0.8381158709526062
Seok, iteration idx= 1 IoU = tensor(0.8381)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.0ms
Speed: 1.9ms preprocess, 22.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 8
Instance 0: Confidence=0.9484
Instance 1: Confidence=0.9271
Instance 2: Confidence=0.9025
Instance 3: Confidence=0.7065
Instance 4: Confidence=0.5530
Instance 5: Confidence=0.4350
Instance 6: Confidence=0.2934
Instance 7: Confidence=0.2923
Selected instance: 1 (Confidence: 0.9271)
tmp min: tensor(0.) tmp max: tensor(1.)
565 96 540 960
There are 16 prompts
current IoU is: 0.7632334232330322
Seok, iteration idx= 2 IoU = tensor(0.7632)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 1.5ms preprocess, 22.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9401
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.7368
Instance 4: Confidence=0.3522
Selected instance: 1 (Confidence: 0.9317)
tmp min: tensor(0.) tmp max: tensor(1.)
544 128 540 960
There are 14 prompts
current IoU is: 0.8139534592628479
Seok, iteration idx= 3 IoU = tensor(0.8140)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 2.8ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9338
Instance 1: Confidence=0.9123
Instance 2: Confidence=0.8407
Instance 3: Confidence=0.4946
Instance 4: Confidence=0.4087
Instance 5: Confidence=0.3586
Selected instance: 4 (Confidence: 0.4087)
tmp min: tensor(0.) tmp max: tensor(1.)
413 88 540 960
There are 12 prompts
current IoU is: 0.21167315542697906
Seok, iteration idx= 4 IoU = tensor(0.2117)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 3.0ms preprocess, 22.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.8207
Instance 3: Confidence=0.7721
Instance 4: Confidence=0.7155
Selected instance: 4 (Confidence: 0.7155)
tmp min: tensor(0.) tmp max: tensor(1.)
377 92 540 960
There are 18 prompts
current IoU is: 0.5176998376846313
Seok, iteration idx= 5 IoU = tensor(0.5177)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.8ms
Speed: 3.0ms preprocess, 21.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9373
Instance 1: Confidence=0.9227
Instance 2: Confidence=0.8916
Instance 3: Confidence=0.8082
Instance 4: Confidence=0.3235
Selected instance: 3 (Confidence: 0.8082)
tmp min: tensor(0.) tmp max: tensor(1.)
402 124 540 960
There are 14 prompts
current IoU is: 0.6883882880210876
Seok, iteration idx= 6 IoU = tensor(0.6884)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.6ms
Speed: 3.6ms preprocess, 22.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9313
Instance 1: Confidence=0.8929
Instance 2: Confidence=0.8629
Instance 3: Confidence=0.8365
Instance 4: Confidence=0.7943
Instance 5: Confidence=0.7689
Instance 6: Confidence=0.3691
Selected instance: 4 (Confidence: 0.7943)
tmp min: tensor(0.) tmp max: tensor(1.)
435 80 540 960
current IoU is: 0.5682283639907837
Seok, iteration idx= 7 IoU = tensor(0.5682)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 3.0ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9403
Instance 1: Confidence=0.9039
Instance 2: Confidence=0.8857
Instance 3: Confidence=0.8587
Instance 4: Confidence=0.7733
Selected instance: 3 (Confidence: 0.8587)
tmp min: tensor(0.) tmp max: tensor(1.)
364 80 540 960
There are 18 prompts
current IoU is: 0.0024435895029455423
Seok, iteration idx= 8 IoU = tensor(0.0024)
SKIP, unacceptable sam prediction, IoU is tensor(0.0024)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.0ms
Speed: 3.4ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 8
Instance 0: Confidence=0.9461
Instance 1: Confidence=0.9275
Instance 2: Confidence=0.9187
Instance 3: Confidence=0.7332
Instance 4: Confidence=0.5451
Instance 5: Confidence=0.3224
Instance 6: Confidence=0.3072
Instance 7: Confidence=0.2709
Selected instance: 3 (Confidence: 0.7332)
tmp min: tensor(0.) tmp max: tensor(1.)
506 80 540 960
There are 15 prompts
current IoU is: 0.27387458086013794
Seok, iteration idx= 9 IoU = tensor(0.2739)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.8ms
Speed: 1.4ms preprocess, 21.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9400
Instance 2: Confidence=0.8922
Instance 3: Confidence=0.7839
Instance 4: Confidence=0.7346
Instance 5: Confidence=0.6675
Selected instance: 4 (Confidence: 0.7346)
tmp min: tensor(0.) tmp max: tensor(1.)
486 84 540 960
There are 15 prompts
current IoU is: 0.4206361174583435
Seok, iteration idx= 10 IoU = tensor(0.4206)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.7ms
Speed: 2.6ms preprocess, 24.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9128
Instance 2: Confidence=0.8616
Instance 3: Confidence=0.7378
Instance 4: Confidence=0.4551
Selected instance: 0 (Confidence: 0.9489)
tmp min: tensor(0.) tmp max: tensor(1.)
559 8 540 960
There are 14 prompts
current IoU is: 0.0008165593026205897
Seok, iteration idx= 11 IoU = tensor(0.0008)
SKIP, unacceptable sam prediction, IoU is tensor(0.0008)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.7ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9553
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.8795
Instance 3: Confidence=0.5983
Instance 4: Confidence=0.4742
Selected instance: 3 (Confidence: 0.5983)
tmp min: tensor(0.) tmp max: tensor(1.)
450 44 540 960
There are 15 prompts
current IoU is: 0.002045338274911046
Seok, iteration idx= 12 IoU = tensor(0.0020)
SKIP, unacceptable sam prediction, IoU is tensor(0.0020)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 8
Instance 0: Confidence=0.9589
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.8897
Instance 3: Confidence=0.8221
Instance 4: Confidence=0.7976
Instance 5: Confidence=0.7491
Instance 6: Confidence=0.3801
Instance 7: Confidence=0.2839
Selected instance: 7 (Confidence: 0.2839)
tmp min: tensor(0.) tmp max: tensor(1.)
579 84 540 960
There are 14 prompts
current IoU is: 0.6555749177932739
Seok, iteration idx= 13 IoU = tensor(0.6556)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 1.4ms preprocess, 23.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 6
Instance 0: Confidence=0.9545
Instance 1: Confidence=0.9200
Instance 2: Confidence=0.8959
Instance 3: Confidence=0.8240
Instance 4: Confidence=0.8171
Instance 5: Confidence=0.3278
Selected instance: 4 (Confidence: 0.8171)
tmp min: tensor(0.) tmp max: tensor(1.)
599 56 540 960
There are 17 prompts
current IoU is: 0.7783006429672241
Seok, iteration idx= 14 IoU = tensor(0.7783)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 2.3ms preprocess, 23.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9534
Instance 1: Confidence=0.9170
Instance 2: Confidence=0.9081
Instance 3: Confidence=0.7840
Instance 4: Confidence=0.7586
Selected instance: 4 (Confidence: 0.7586)
tmp min: tensor(0.) tmp max: tensor(1.)
596 76 540 960
There are 17 prompts
current IoU is: 0.7661448121070862
Seok, iteration idx= 15 IoU = tensor(0.7661)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.7ms preprocess, 23.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9128
Instance 2: Confidence=0.9021
Instance 3: Confidence=0.7538
Instance 4: Confidence=0.6958
Instance 5: Confidence=0.4477
Selected instance: 2 (Confidence: 0.9021)
tmp min: tensor(0.) tmp max: tensor(1.)
570 100 540 960
There are 14 prompts
current IoU is: 0.03409497067332268
Seok, iteration idx= 16 IoU = tensor(0.0341)
SKIP, unacceptable sam prediction, IoU is tensor(0.0341)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 2.2ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9349
Instance 2: Confidence=0.8948
Instance 3: Confidence=0.8225
Instance 4: Confidence=0.7823
Selected instance: 3 (Confidence: 0.8225)
tmp min: tensor(0.) tmp max: tensor(1.)
619 116 540 960
There are 15 prompts
current IoU is: 0.6789987087249756
Seok, iteration idx= 17 IoU = tensor(0.6790)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.4ms
Speed: 1.7ms preprocess, 24.4ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9343
Instance 1: Confidence=0.9156
Instance 2: Confidence=0.8866
Instance 3: Confidence=0.8747
Instance 4: Confidence=0.7347
Instance 5: Confidence=0.5717
Selected instance: 3 (Confidence: 0.8747)
tmp min: tensor(0.) tmp max: tensor(1.)
618 112 540 960
There are 18 prompts
current IoU is: 0.8755031228065491
Seok, iteration idx= 18 IoU = tensor(0.8755)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.5ms
Speed: 1.6ms preprocess, 24.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9327
Instance 2: Confidence=0.8889
Instance 3: Confidence=0.8410
Instance 4: Confidence=0.7670
Instance 5: Confidence=0.3930
Instance 6: Confidence=0.3173
Selected instance: 2 (Confidence: 0.8889)
tmp min: tensor(0.) tmp max: tensor(1.)
639 92 540 960
There are 18 prompts
current IoU is: 0.8773115277290344
Seok, iteration idx= 19 IoU = tensor(0.8773)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9357
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.8987
Instance 3: Confidence=0.8981
Instance 4: Confidence=0.8441
Instance 5: Confidence=0.7465
Selected instance: 2 (Confidence: 0.8987)
tmp min: tensor(0.) tmp max: tensor(1.)
335 104 540 960
There are 16 prompts
current IoU is: 0.7801346778869629
Seok, iteration idx= 20 IoU = tensor(0.7801)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 5.0ms preprocess, 22.4ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9505
Instance 1: Confidence=0.9323
Instance 2: Confidence=0.8850
Instance 3: Confidence=0.8476
Instance 4: Confidence=0.6034
Instance 5: Confidence=0.3047
Selected instance: 2 (Confidence: 0.8850)
tmp min: tensor(0.) tmp max: tensor(1.)
331 88 540 960
There are 15 prompts
current IoU is: 0.8547667860984802
Seok, iteration idx= 21 IoU = tensor(0.8548)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.9ms
Speed: 2.9ms preprocess, 22.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 7
Instance 0: Confidence=0.9535
Instance 1: Confidence=0.9077
Instance 2: Confidence=0.8941
Instance 3: Confidence=0.7788
Instance 4: Confidence=0.7653
Instance 5: Confidence=0.6566
Instance 6: Confidence=0.4216
Selected instance: 3 (Confidence: 0.7788)
tmp min: tensor(0.) tmp max: tensor(1.)
333 80 540 960
There are 16 prompts
current IoU is: 0.7874025702476501
Seok, iteration idx= 22 IoU = tensor(0.7874)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.9ms
Speed: 3.2ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 7
Instance 0: Confidence=0.9425
Instance 1: Confidence=0.9028
Instance 2: Confidence=0.8830
Instance 3: Confidence=0.8673
Instance 4: Confidence=0.8513
Instance 5: Confidence=0.6991
Instance 6: Confidence=0.4623
Selected instance: 6 (Confidence: 0.4623)
tmp min: tensor(0.) tmp max: tensor(1.)
311 83 540 960
There are 17 prompts
current IoU is: 0.7286906838417053
Seok, iteration idx= 23 IoU = tensor(0.7287)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 3.1ms preprocess, 22.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9449
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9027
Instance 3: Confidence=0.8698
Instance 4: Confidence=0.7552
Instance 5: Confidence=0.5370
Selected instance: 5 (Confidence: 0.5370)
tmp min: tensor(0.) tmp max: tensor(1.)
295 100 540 960
There are 13 prompts
current IoU is: 0.5439692735671997
Seok, iteration idx= 24 IoU = tensor(0.5440)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 3.9ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9103
Instance 2: Confidence=0.9077
Instance 3: Confidence=0.8864
Instance 4: Confidence=0.3265
Selected instance: 1 (Confidence: 0.9103)
tmp min: tensor(0.) tmp max: tensor(1.)
347 56 540 960
There are 15 prompts
current IoU is: 0.01260287407785654
Seok, iteration idx= 25 IoU = tensor(0.0126)
SKIP, unacceptable sam prediction, IoU is tensor(0.0126)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.3ms
Speed: 1.4ms preprocess, 21.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9350
Instance 1: Confidence=0.9340
Instance 2: Confidence=0.8964
Instance 3: Confidence=0.8023
Instance 4: Confidence=0.4329
Selected instance: 2 (Confidence: 0.8964)
tmp min: tensor(0.) tmp max: tensor(1.)
312 52 540 960
There are 16 prompts
current IoU is: 0.02370872162282467
Seok, iteration idx= 26 IoU = tensor(0.0237)
SKIP, unacceptable sam prediction, IoU is tensor(0.0237)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 4
Instance 0: Confidence=0.9348
Instance 1: Confidence=0.9073
Instance 2: Confidence=0.9057
Instance 3: Confidence=0.7642
Selected instance: 2 (Confidence: 0.9057)
tmp min: tensor(0.) tmp max: tensor(1.)
290 52 540 960
There are 17 prompts
current IoU is: 0.0017284136265516281
Seok, iteration idx= 27 IoU = tensor(0.0017)
SKIP, unacceptable sam prediction, IoU is tensor(0.0017)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.4ms
Speed: 1.6ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9387
Instance 1: Confidence=0.9300
Instance 2: Confidence=0.9169
Instance 3: Confidence=0.6203
Instance 4: Confidence=0.5186
Instance 5: Confidence=0.2775
Selected instance: 2 (Confidence: 0.9169)
tmp min: tensor(0.) tmp max: tensor(1.)
648 72 540 960
There are 17 prompts
current IoU is: 0.8656296133995056
Seok, iteration idx= 28 IoU = tensor(0.8656)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 8
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9200
Instance 2: Confidence=0.9052
Instance 3: Confidence=0.5757
Instance 4: Confidence=0.3700
Instance 5: Confidence=0.3422
Instance 6: Confidence=0.3060
Instance 7: Confidence=0.2816
Selected instance: 2 (Confidence: 0.9052)
tmp min: tensor(0.) tmp max: tensor(1.)
643 68 540 960
There are 15 prompts
current IoU is: 0.8884887099266052
Seok, iteration idx= 29 IoU = tensor(0.8885)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.1ms
Speed: 1.5ms preprocess, 21.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9583
Instance 1: Confidence=0.9051
Instance 2: Confidence=0.9033
Instance 3: Confidence=0.8099
Instance 4: Confidence=0.2907
Selected instance: 1 (Confidence: 0.9051)
tmp min: tensor(0.) tmp max: tensor(1.)
634 60 540 960
There are 16 prompts
current IoU is: 0.9358718991279602
Seok, iteration idx= 30 IoU = tensor(0.9359)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9487
Instance 1: Confidence=0.9292
Instance 2: Confidence=0.8816
Instance 3: Confidence=0.8691
Instance 4: Confidence=0.7868
Instance 5: Confidence=0.2647
Selected instance: 2 (Confidence: 0.8816)
tmp min: tensor(0.) tmp max: tensor(1.)
625 60 540 960
There are 15 prompts
current IoU is: 0.9412450194358826
Seok, iteration idx= 31 IoU = tensor(0.9412)
Selected Instance Confidence List: [tensor(0.9182), tensor(0.8708, device='cpu'), tensor(0.8288, device='cpu'), tensor(0.8610, device='cpu'), tensor(0.3735, device='cpu'), tensor(0.5968, device='cpu'), tensor(0.7363, device='cpu'), tensor(0.6586, device='cpu'), tensor(0.3773, device='cpu'), tensor(0.4576, device='cpu'), tensor(0.5462, device='cpu'), tensor(0.3801, device='cpu'), tensor(0.3824, device='cpu'), tensor(0.5375, device='cpu'), tensor(0.7938, device='cpu'), tensor(0.7631, device='cpu'), tensor(0.3813, device='cpu'), tensor(0.7364, device='cpu'), tensor(0.8752, device='cpu'), tensor(0.8819, device='cpu'), tensor(0.8276, device='cpu'), tensor(0.8669, device='cpu'), tensor(0.7840, device='cpu'), tensor(0.6666, device='cpu'), tensor(0.5412, device='cpu'), tensor(0.3805, device='cpu'), tensor(0.3742, device='cpu'), tensor(0.3739, device='cpu'), tensor(0.8861, device='cpu'), tensor(0.8952, device='cpu'), tensor(0.9236, device='cpu'), tensor(0.9174, device='cpu')]
Sorted Confidence Order: [tensor(0.9236, device='cpu'), tensor(0.8952, device='cpu'), tensor(0.8861, device='cpu'), tensor(0.8819, device='cpu'), tensor(0.8752, device='cpu'), tensor(0.7364, device='cpu'), tensor(0.3813, device='cpu'), tensor(0.7631, device='cpu'), tensor(0.7938, device='cpu'), tensor(0.5375, device='cpu'), tensor(0.3824, device='cpu'), tensor(0.3801, device='cpu'), tensor(0.5462, device='cpu'), tensor(0.4576, device='cpu'), tensor(0.3773, device='cpu'), tensor(0.6586, device='cpu'), tensor(0.7363, device='cpu'), tensor(0.5968, device='cpu'), tensor(0.3735, device='cpu'), tensor(0.3739, device='cpu'), tensor(0.3742, device='cpu'), tensor(0.3805, device='cpu'), tensor(0.5412, device='cpu'), tensor(0.6666, device='cpu'), tensor(0.7840, device='cpu'), tensor(0.8669, device='cpu'), tensor(0.8276, device='cpu'), tensor(0.8610, device='cpu'), tensor(0.8288, device='cpu'), tensor(0.8708, device='cpu'), tensor(0.9182), tensor(0.9174, device='cpu')]
sorted_indices: [30, 29, 28, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 27, 26, 25, 24, 23, 22, 21, 20, 3, 2, 1, 0, 31]
Initial view (highest confidence): 35
New training order: [11, 10, 9, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15, 14, 13, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.0ms
Speed: 1.3ms preprocess, 20.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.8ms
Speed: 3.4ms preprocess, 22.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 8
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9200
Instance 2: Confidence=0.9052
Instance 3: Confidence=0.5757
Instance 4: Confidence=0.3700
Instance 5: Confidence=0.3422
Instance 6: Confidence=0.3060
Instance 7: Confidence=0.2816
tmp min: tensor(0.) tmp max: tensor(1.)
643 68 540 960
There are 15 prompts
current IoU is: 0.938894510269165
Seok, iteration idx= 1 IoU = tensor(0.9389)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.8ms
Speed: 2.7ms preprocess, 24.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9387
Instance 1: Confidence=0.9300
Instance 2: Confidence=0.9169
Instance 3: Confidence=0.6203
Instance 4: Confidence=0.5186
Instance 5: Confidence=0.2775
tmp min: tensor(0.) tmp max: tensor(1.)
648 72 540 960
There are 17 prompts
current IoU is: 0.9121423363685608
Seok, iteration idx= 2 IoU = tensor(0.9121)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.4ms
Speed: 1.6ms preprocess, 24.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 7
Instance 0: Confidence=0.9486
Instance 1: Confidence=0.9327
Instance 2: Confidence=0.8889
Instance 3: Confidence=0.8410
Instance 4: Confidence=0.7670
Instance 5: Confidence=0.3930
Instance 6: Confidence=0.3173
tmp min: tensor(0.) tmp max: tensor(1.)
639 92 540 960
There are 18 prompts
current IoU is: 0.9247096180915833
Seok, iteration idx= 3 IoU = tensor(0.9247)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9343
Instance 1: Confidence=0.9156
Instance 2: Confidence=0.8866
Instance 3: Confidence=0.8747
Instance 4: Confidence=0.7347
Instance 5: Confidence=0.5717
tmp min: tensor(0.) tmp max: tensor(1.)
618 112 540 960
There are 18 prompts
current IoU is: 0.9095533490180969
Seok, iteration idx= 4 IoU = tensor(0.9096)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9358
Instance 1: Confidence=0.9349
Instance 2: Confidence=0.8948
Instance 3: Confidence=0.8225
Instance 4: Confidence=0.7823
tmp min: tensor(0.) tmp max: tensor(1.)
619 116 540 960
There are 15 prompts
current IoU is: 0.8634210228919983
Seok, iteration idx= 5 IoU = tensor(0.8634)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.4ms
Speed: 1.6ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 6
Instance 0: Confidence=0.9436
Instance 1: Confidence=0.9128
Instance 2: Confidence=0.9021
Instance 3: Confidence=0.7538
Instance 4: Confidence=0.6958
Instance 5: Confidence=0.4477
tmp min: tensor(0.) tmp max: tensor(1.)
570 100 540 960
There are 14 prompts
current IoU is: 0.03462107479572296
Seok, iteration idx= 6 IoU = tensor(0.0346)
SKIP, unacceptable sam prediction, IoU is tensor(0.0346)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 1.5ms preprocess, 23.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9534
Instance 1: Confidence=0.9170
Instance 2: Confidence=0.9081
Instance 3: Confidence=0.7840
Instance 4: Confidence=0.7586
tmp min: tensor(0.) tmp max: tensor(1.)
596 76 540 960
There are 17 prompts
current IoU is: 0.8691186308860779
Seok, iteration idx= 7 IoU = tensor(0.8691)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.6ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9545
Instance 1: Confidence=0.9200
Instance 2: Confidence=0.8959
Instance 3: Confidence=0.8240
Instance 4: Confidence=0.8171
Instance 5: Confidence=0.3278
tmp min: tensor(0.) tmp max: tensor(1.)
599 56 540 960
There are 17 prompts
current IoU is: 0.811776340007782
Seok, iteration idx= 8 IoU = tensor(0.8118)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.2ms
Speed: 1.6ms preprocess, 23.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 8
Instance 0: Confidence=0.9589
Instance 1: Confidence=0.9509
Instance 2: Confidence=0.8897
Instance 3: Confidence=0.8221
Instance 4: Confidence=0.7976
Instance 5: Confidence=0.7491
Instance 6: Confidence=0.3801
Instance 7: Confidence=0.2839
tmp min: tensor(0.) tmp max: tensor(1.)
579 84 540 960
There are 14 prompts
current IoU is: 0.8527548909187317
Seok, iteration idx= 9 IoU = tensor(0.8528)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.4ms
Speed: 1.6ms preprocess, 25.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9553
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.8795
Instance 3: Confidence=0.5983
Instance 4: Confidence=0.4742
tmp min: tensor(0.) tmp max: tensor(1.)
538 0 540 960
There are 14 prompts
current IoU is: 0.000509146018885076
Seok, iteration idx= 10 IoU = tensor(0.0005)
SKIP, unacceptable sam prediction, IoU is tensor(0.0005)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9489
Instance 1: Confidence=0.9128
Instance 2: Confidence=0.8616
Instance 3: Confidence=0.7378
Instance 4: Confidence=0.4551
tmp min: tensor(0.) tmp max: tensor(1.)
559 8 540 960
There are 14 prompts
current IoU is: 0.0008865363779477775
Seok, iteration idx= 11 IoU = tensor(0.0009)
SKIP, unacceptable sam prediction, IoU is tensor(0.0009)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.6ms preprocess, 24.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 6
Instance 0: Confidence=0.9510
Instance 1: Confidence=0.9400
Instance 2: Confidence=0.8922
Instance 3: Confidence=0.7839
Instance 4: Confidence=0.7346
Instance 5: Confidence=0.6675
tmp min: tensor(0.) tmp max: tensor(1.)
486 84 540 960
There are 15 prompts
current IoU is: 0.8145309686660767
Seok, iteration idx= 12 IoU = tensor(0.8145)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 8
Instance 0: Confidence=0.9461
Instance 1: Confidence=0.9275
Instance 2: Confidence=0.9187
Instance 3: Confidence=0.7332
Instance 4: Confidence=0.5451
Instance 5: Confidence=0.3224
Instance 6: Confidence=0.3072
Instance 7: Confidence=0.2709
tmp min: tensor(0.) tmp max: tensor(1.)
506 80 540 960
There are 15 prompts
current IoU is: 0.7262591123580933
Seok, iteration idx= 13 IoU = tensor(0.7263)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.4ms
Speed: 1.4ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9403
Instance 1: Confidence=0.9039
Instance 2: Confidence=0.8857
Instance 3: Confidence=0.8587
Instance 4: Confidence=0.7733
tmp min: tensor(0.) tmp max: tensor(1.)
433 36 540 960
There are 13 prompts
current IoU is: 0.0022615231573581696
Seok, iteration idx= 14 IoU = tensor(0.0023)
SKIP, unacceptable sam prediction, IoU is tensor(0.0023)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.2ms
Speed: 2.7ms preprocess, 22.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 7
Instance 0: Confidence=0.9313
Instance 1: Confidence=0.8929
Instance 2: Confidence=0.8629
Instance 3: Confidence=0.8365
Instance 4: Confidence=0.7943
Instance 5: Confidence=0.7689
Instance 6: Confidence=0.3691
tmp min: tensor(0.) tmp max: tensor(1.)
435 80 540 960
current IoU is: 0.7573925852775574
Seok, iteration idx= 15 IoU = tensor(0.7574)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 3.3ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9373
Instance 1: Confidence=0.9227
Instance 2: Confidence=0.8916
Instance 3: Confidence=0.8082
Instance 4: Confidence=0.3235
tmp min: tensor(0.) tmp max: tensor(1.)
402 124 540 960
There are 14 prompts
current IoU is: 0.8291267156600952
Seok, iteration idx= 16 IoU = tensor(0.8291)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 3.2ms preprocess, 23.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9302
Instance 2: Confidence=0.8207
Instance 3: Confidence=0.7721
Instance 4: Confidence=0.7155
tmp min: tensor(0.) tmp max: tensor(1.)
377 92 540 960
There are 18 prompts
current IoU is: 0.8299097418785095
Seok, iteration idx= 17 IoU = tensor(0.8299)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 3.7ms preprocess, 23.2ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 6
Instance 0: Confidence=0.9338
Instance 1: Confidence=0.9123
Instance 2: Confidence=0.8407
Instance 3: Confidence=0.4946
Instance 4: Confidence=0.4087
Instance 5: Confidence=0.3586
tmp min: tensor(0.) tmp max: tensor(1.)
413 88 540 960
There are 12 prompts
current IoU is: 0.5236156582832336
Seok, iteration idx= 18 IoU = tensor(0.5236)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.8ms
Speed: 3.0ms preprocess, 22.8ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 4
Instance 0: Confidence=0.9348
Instance 1: Confidence=0.9073
Instance 2: Confidence=0.9057
Instance 3: Confidence=0.7642
tmp min: tensor(0.) tmp max: tensor(1.)
290 52 540 960
There are 17 prompts
current IoU is: 0.0014254098059609532
Seok, iteration idx= 19 IoU = tensor(0.0014)
SKIP, unacceptable sam prediction, IoU is tensor(0.0014)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 25.5ms
Speed: 1.5ms preprocess, 25.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 5
Instance 0: Confidence=0.9350
Instance 1: Confidence=0.9340
Instance 2: Confidence=0.8964
Instance 3: Confidence=0.8023
Instance 4: Confidence=0.4329
tmp min: tensor(0.) tmp max: tensor(1.)
312 52 540 960
There are 16 prompts
current IoU is: 0.022856121882796288
Seok, iteration idx= 20 IoU = tensor(0.0229)
SKIP, unacceptable sam prediction, IoU is tensor(0.0229)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.6ms preprocess, 22.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9103
Instance 2: Confidence=0.9077
Instance 3: Confidence=0.8864
Instance 4: Confidence=0.3265
tmp min: tensor(0.) tmp max: tensor(1.)
347 56 540 960
There are 15 prompts
current IoU is: 0.013528693467378616
Seok, iteration idx= 21 IoU = tensor(0.0135)
SKIP, unacceptable sam prediction, IoU is tensor(0.0135)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.9ms
Speed: 1.5ms preprocess, 22.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9449
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9027
Instance 3: Confidence=0.8698
Instance 4: Confidence=0.7552
Instance 5: Confidence=0.5370
tmp min: tensor(0.) tmp max: tensor(1.)
295 100 540 960
There are 13 prompts
current IoU is: 0.5987361669540405
Seok, iteration idx= 22 IoU = tensor(0.5987)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 7
Instance 0: Confidence=0.9425
Instance 1: Confidence=0.9028
Instance 2: Confidence=0.8830
Instance 3: Confidence=0.8673
Instance 4: Confidence=0.8513
Instance 5: Confidence=0.6991
Instance 6: Confidence=0.4623
tmp min: tensor(0.) tmp max: tensor(1.)
311 83 540 960
There are 17 prompts
current IoU is: 0.7548297643661499
Seok, iteration idx= 23 IoU = tensor(0.7548)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 7
Instance 0: Confidence=0.9535
Instance 1: Confidence=0.9077
Instance 2: Confidence=0.8941
Instance 3: Confidence=0.7788
Instance 4: Confidence=0.7653
Instance 5: Confidence=0.6566
Instance 6: Confidence=0.4216
tmp min: tensor(0.) tmp max: tensor(1.)
333 80 540 960
There are 16 prompts
current IoU is: 0.8670116066932678
Seok, iteration idx= 24 IoU = tensor(0.8670)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 3.5ms preprocess, 23.7ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9505
Instance 1: Confidence=0.9323
Instance 2: Confidence=0.8850
Instance 3: Confidence=0.8476
Instance 4: Confidence=0.6034
Instance 5: Confidence=0.3047
tmp min: tensor(0.) tmp max: tensor(1.)
331 88 540 960
There are 15 prompts
current IoU is: 0.8820580244064331
Seok, iteration idx= 25 IoU = tensor(0.8821)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.4ms
Speed: 1.6ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9357
Instance 1: Confidence=0.9320
Instance 2: Confidence=0.8987
Instance 3: Confidence=0.8981
Instance 4: Confidence=0.8441
Instance 5: Confidence=0.7465
tmp min: tensor(0.) tmp max: tensor(1.)
335 104 540 960
There are 16 prompts
current IoU is: 0.872314453125
Seok, iteration idx= 26 IoU = tensor(0.8723)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.5ms
Speed: 1.4ms preprocess, 24.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9401
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9104
Instance 3: Confidence=0.7368
Instance 4: Confidence=0.3522
tmp min: tensor(0.) tmp max: tensor(1.)
544 128 540 960
There are 14 prompts
current IoU is: 0.925564706325531
Seok, iteration idx= 27 IoU = tensor(0.9256)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.0ms
Speed: 1.7ms preprocess, 24.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 8
Instance 0: Confidence=0.9484
Instance 1: Confidence=0.9271
Instance 2: Confidence=0.9025
Instance 3: Confidence=0.7065
Instance 4: Confidence=0.5530
Instance 5: Confidence=0.4350
Instance 6: Confidence=0.2934
Instance 7: Confidence=0.2923
tmp min: tensor(0.) tmp max: tensor(1.)
565 96 540 960
There are 16 prompts
current IoU is: 0.9252284169197083
Seok, iteration idx= 28 IoU = tensor(0.9252)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.6ms preprocess, 23.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 6
Instance 0: Confidence=0.9428
Instance 1: Confidence=0.9198
Instance 2: Confidence=0.8951
Instance 3: Confidence=0.8149
Instance 4: Confidence=0.7098
Instance 5: Confidence=0.4333
tmp min: tensor(0.) tmp max: tensor(1.)
602 72 540 960
There are 14 prompts
current IoU is: 0.9460025429725647
Seok, iteration idx= 29 IoU = tensor(0.9460)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 23.4ms
Speed: 3.3ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 9
Instance 0: Confidence=0.9370
Instance 1: Confidence=0.9310
Instance 2: Confidence=0.9182
Instance 3: Confidence=0.7854
Instance 4: Confidence=0.6226
Instance 5: Confidence=0.5370
Instance 6: Confidence=0.5030
Instance 7: Confidence=0.4030
Instance 8: Confidence=0.3007
tmp min: tensor(0.) tmp max: tensor(1.)
607 64 540 960
There are 17 prompts
current IoU is: 0.9445829391479492
Seok, iteration idx= 30 IoU = tensor(0.9446)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.5ms
Speed: 2.9ms preprocess, 22.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9487
Instance 1: Confidence=0.9292
Instance 2: Confidence=0.8816
Instance 3: Confidence=0.8691
Instance 4: Confidence=0.7868
Instance 5: Confidence=0.2647
tmp min: tensor(0.) tmp max: tensor(1.)
625 60 540 960
There are 15 prompts
current IoU is: 0.9478949308395386
Seok, iteration idx= 31 IoU = tensor(0.9479)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set10_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set10_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:39<00:00,  1.24s/it]
Testing psnr 27.642518803477287 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set10_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.15it/s]
Testing psnr 3.027428984642029 (avg)
train: coarse segmentation in 00:03:48
train: finish (eps time 00:03:48 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set10_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set11/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 37.72it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set11 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set11
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set11_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.9ms
Speed: 3.6ms preprocess, 19.9ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 20.0ms
Speed: 1.2ms preprocess, 20.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 20.1ms
Speed: 1.3ms preprocess, 20.1ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.8ms
Speed: 1.3ms preprocess, 19.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.5ms
Speed: 1.3ms preprocess, 19.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 19.3ms
Speed: 1.4ms preprocess, 19.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.4ms
Speed: 1.3ms preprocess, 19.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.1ms
Speed: 1.3ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.4ms
Speed: 1.3ms preprocess, 19.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 19.1ms
Speed: 1.2ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.5ms preprocess, 18.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.5ms
Speed: 1.4ms preprocess, 19.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.7ms
Speed: 1.5ms preprocess, 19.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.5ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.5ms
Speed: 1.4ms preprocess, 19.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.0ms
Speed: 1.5ms preprocess, 20.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.0ms
Speed: 1.4ms preprocess, 19.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.4ms preprocess, 19.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 18.7ms
Speed: 1.7ms preprocess, 18.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.8ms
Speed: 1.5ms preprocess, 18.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.8ms
Speed: 1.4ms preprocess, 19.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.4ms
Speed: 1.4ms preprocess, 19.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.4ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.5ms
Speed: 1.5ms preprocess, 19.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 18.7ms
Speed: 1.5ms preprocess, 18.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 20.5ms
Speed: 2.9ms preprocess, 20.5ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 10
view_order: [11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.6ms
Speed: 1.3ms preprocess, 18.6ms inference, 3.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9456
Instance 2: Confidence=0.9313
Instance 3: Confidence=0.8808
Instance 4: Confidence=0.8715
Instance 5: Confidence=0.8483
Selected instance: 3 (Confidence: 0.8808)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

572 64 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.6577376127243042
Seok, iteration idx= 1 IoU = tensor(0.6577)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 7
Instance 0: Confidence=0.9597
Instance 1: Confidence=0.9420
Instance 2: Confidence=0.9354
Instance 3: Confidence=0.8429
Instance 4: Confidence=0.8336
Instance 5: Confidence=0.6522
Instance 6: Confidence=0.4532
Selected instance: 4 (Confidence: 0.8336)
tmp min: tensor(0.) tmp max: tensor(1.)
594 72 540 960
There are 16 prompts
current IoU is: 0.7197445034980774
Seok, iteration idx= 2 IoU = tensor(0.7197)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.5ms preprocess, 22.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9577
Instance 1: Confidence=0.9560
Instance 2: Confidence=0.9503
Instance 3: Confidence=0.8193
Instance 4: Confidence=0.7426
Selected instance: 0 (Confidence: 0.9577)
tmp min: tensor(0.) tmp max: tensor(1.)
614 40 540 960
There are 16 prompts
current IoU is: 0.002392282010987401
Seok, iteration idx= 3 IoU = tensor(0.0024)
SKIP, unacceptable sam prediction, IoU is tensor(0.0024)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 6
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9427
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9067
Instance 4: Confidence=0.8978
Instance 5: Confidence=0.6321
Selected instance: 4 (Confidence: 0.8978)
tmp min: tensor(0.) tmp max: tensor(1.)
622 100 540 960
There are 17 prompts
current IoU is: 0.6780259013175964
Seok, iteration idx= 4 IoU = tensor(0.6780)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9471
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.9224
Instance 4: Confidence=0.8923
Selected instance: 3 (Confidence: 0.9224)
tmp min: tensor(0.) tmp max: tensor(1.)
623 128 540 960
There are 15 prompts
current IoU is: 0.7231748104095459
Seok, iteration idx= 5 IoU = tensor(0.7232)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.9ms
Speed: 1.4ms preprocess, 22.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9479
Instance 2: Confidence=0.9416
Instance 3: Confidence=0.8988
Instance 4: Confidence=0.8421
Selected instance: 2 (Confidence: 0.9416)
tmp min: tensor(0.) tmp max: tensor(1.)
205 40 540 960
There are 14 prompts
current IoU is: 0.6565477252006531
Seok, iteration idx= 6 IoU = tensor(0.6565)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.0ms
Speed: 2.4ms preprocess, 23.0ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 7
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9253
Instance 2: Confidence=0.8717
Instance 3: Confidence=0.8405
Instance 4: Confidence=0.5369
Instance 5: Confidence=0.3214
Instance 6: Confidence=0.2665
Selected instance: 2 (Confidence: 0.8717)
tmp min: tensor(0.) tmp max: tensor(1.)
194 56 540 960
There are 14 prompts
current IoU is: 0.7444440722465515
Seok, iteration idx= 7 IoU = tensor(0.7444)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.4ms
Speed: 1.5ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9245
Instance 2: Confidence=0.9200
Instance 3: Confidence=0.7033
Instance 4: Confidence=0.6931
Selected instance: 2 (Confidence: 0.9200)
tmp min: tensor(0.) tmp max: tensor(1.)
216 96 540 960
There are 16 prompts
current IoU is: 0.7232152223587036
Seok, iteration idx= 8 IoU = tensor(0.7232)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.0ms
Speed: 1.5ms preprocess, 22.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9556
Instance 1: Confidence=0.9451
Instance 2: Confidence=0.9042
Instance 3: Confidence=0.7678
Instance 4: Confidence=0.6133
Instance 5: Confidence=0.3890
Selected instance: 2 (Confidence: 0.9042)
tmp min: tensor(0.) tmp max: tensor(1.)
199 48 540 960
There are 17 prompts
current IoU is: 0.5954195261001587
Seok, iteration idx= 9 IoU = tensor(0.5954)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.6ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9671
Instance 1: Confidence=0.9570
Instance 2: Confidence=0.9262
Instance 3: Confidence=0.8464
Instance 4: Confidence=0.6664
Selected instance: 3 (Confidence: 0.8464)
tmp min: tensor(0.) tmp max: tensor(1.)
347 84 540 960
There are 16 prompts
current IoU is: 0.038117147982120514
Seok, iteration idx= 10 IoU = tensor(0.0381)
SKIP, unacceptable sam prediction, IoU is tensor(0.0381)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 7
Instance 0: Confidence=0.9659
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9171
Instance 3: Confidence=0.8072
Instance 4: Confidence=0.7156
Instance 5: Confidence=0.4521
Instance 6: Confidence=0.3306
Selected instance: 5 (Confidence: 0.4521)
tmp min: tensor(0.) tmp max: tensor(1.)
231 48 540 960
current IoU is: 0.41443195939064026
Seok, iteration idx= 11 IoU = tensor(0.4144)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.9ms
Speed: 1.6ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 7
Instance 0: Confidence=0.9631
Instance 1: Confidence=0.9326
Instance 2: Confidence=0.9224
Instance 3: Confidence=0.8920
Instance 4: Confidence=0.8891
Instance 5: Confidence=0.5450
Instance 6: Confidence=0.4295
Selected instance: 3 (Confidence: 0.8920)
tmp min: tensor(0.) tmp max: tensor(1.)
217 60 540 960
There are 17 prompts
current IoU is: 0.8005568385124207
Seok, iteration idx= 12 IoU = tensor(0.8006)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.6ms
Speed: 3.1ms preprocess, 22.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 6
Instance 0: Confidence=0.9710
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9314
Instance 3: Confidence=0.9307
Instance 4: Confidence=0.7829
Instance 5: Confidence=0.5400
Selected instance: 4 (Confidence: 0.7829)
tmp min: tensor(0.) tmp max: tensor(1.)
264 56 540 960
There are 17 prompts
current IoU is: 0.815496563911438
Seok, iteration idx= 13 IoU = tensor(0.8155)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 22.7ms
Speed: 3.5ms preprocess, 22.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 8
Instance 0: Confidence=0.9684
Instance 1: Confidence=0.9498
Instance 2: Confidence=0.9438
Instance 3: Confidence=0.8761
Instance 4: Confidence=0.7452
Instance 5: Confidence=0.5554
Instance 6: Confidence=0.4846
Instance 7: Confidence=0.4124
Selected instance: 6 (Confidence: 0.4846)
tmp min: tensor(0.) tmp max: tensor(1.)
310 36 540 960
There are 13 prompts
current IoU is: 0.33066970109939575
Seok, iteration idx= 14 IoU = tensor(0.3307)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.1ms
Speed: 3.0ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 7
Instance 0: Confidence=0.9550
Instance 1: Confidence=0.9468
Instance 2: Confidence=0.9211
Instance 3: Confidence=0.8658
Instance 4: Confidence=0.3527
Instance 5: Confidence=0.3313
Instance 6: Confidence=0.2660
Selected instance: 4 (Confidence: 0.3527)
tmp min: tensor(0.) tmp max: tensor(1.)
343 84 540 960
There are 12 prompts
current IoU is: 0.17893511056900024
Seok, iteration idx= 15 IoU = tensor(0.1789)
SKIP, unacceptable sam prediction, IoU is tensor(0.1789)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.3ms
Speed: 1.4ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 6
Instance 0: Confidence=0.9542
Instance 1: Confidence=0.9452
Instance 2: Confidence=0.8901
Instance 3: Confidence=0.8789
Instance 4: Confidence=0.8606
Instance 5: Confidence=0.7636
Selected instance: 5 (Confidence: 0.7636)
tmp min: tensor(0.) tmp max: tensor(1.)
350 48 540 960
There are 16 prompts
current IoU is: 0.7851225137710571
Seok, iteration idx= 16 IoU = tensor(0.7851)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 1.6ms preprocess, 23.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9487
Instance 1: Confidence=0.9423
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.8932
Instance 4: Confidence=0.8345
Instance 5: Confidence=0.7952
Selected instance: 4 (Confidence: 0.8345)
tmp min: tensor(0.) tmp max: tensor(1.)
374 64 540 960
There are 16 prompts
current IoU is: 0.8574409484863281
Seok, iteration idx= 17 IoU = tensor(0.8574)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9577
Instance 1: Confidence=0.9502
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8409
Instance 4: Confidence=0.8097
Selected instance: 4 (Confidence: 0.8097)
tmp min: tensor(0.) tmp max: tensor(1.)
401 136 540 960
There are 16 prompts
current IoU is: 0.7332944273948669
Seok, iteration idx= 18 IoU = tensor(0.7333)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.7ms
Speed: 1.6ms preprocess, 22.7ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9568
Instance 1: Confidence=0.9337
Instance 2: Confidence=0.9183
Instance 3: Confidence=0.9098
Instance 4: Confidence=0.7857
Instance 5: Confidence=0.4356
Instance 6: Confidence=0.2723
Selected instance: 6 (Confidence: 0.2723)
tmp min: tensor(0.) tmp max: tensor(1.)
441 120 540 960
There are 12 prompts
current IoU is: 0.180867537856102
Seok, iteration idx= 19 IoU = tensor(0.1809)
SKIP, unacceptable sam prediction, IoU is tensor(0.1809)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.6ms
Speed: 1.5ms preprocess, 24.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 7
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9389
Instance 2: Confidence=0.9162
Instance 3: Confidence=0.9079
Instance 4: Confidence=0.8868
Instance 5: Confidence=0.5165
Instance 6: Confidence=0.4232
Selected instance: 5 (Confidence: 0.5165)
tmp min: tensor(0.) tmp max: tensor(1.)
475 112 540 960
There are 18 prompts
current IoU is: 0.36810001730918884
Seok, iteration idx= 20 IoU = tensor(0.3681)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.2ms
Speed: 1.6ms preprocess, 22.2ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 7
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9321
Instance 2: Confidence=0.9290
Instance 3: Confidence=0.9221
Instance 4: Confidence=0.8640
Instance 5: Confidence=0.7488
Instance 6: Confidence=0.3407
Selected instance: 5 (Confidence: 0.7488)
tmp min: tensor(0.) tmp max: tensor(1.)
495 90 540 960
There are 18 prompts
current IoU is: 0.6549328565597534
Seok, iteration idx= 21 IoU = tensor(0.6549)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.7ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 6
Instance 0: Confidence=0.9415
Instance 1: Confidence=0.9146
Instance 2: Confidence=0.9040
Instance 3: Confidence=0.8978
Instance 4: Confidence=0.8853
Instance 5: Confidence=0.3458
Selected instance: 0 (Confidence: 0.9415)
tmp min: tensor(0.) tmp max: tensor(1.)
484 72 540 960
There are 15 prompts
current IoU is: 0.8064284920692444
Seok, iteration idx= 22 IoU = tensor(0.8064)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.8ms
Speed: 1.7ms preprocess, 24.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 8
Instance 0: Confidence=0.9570
Instance 1: Confidence=0.9254
Instance 2: Confidence=0.9230
Instance 3: Confidence=0.9228
Instance 4: Confidence=0.9172
Instance 5: Confidence=0.5296
Instance 6: Confidence=0.4528
Instance 7: Confidence=0.3554
Selected instance: 0 (Confidence: 0.9570)
tmp min: tensor(0.) tmp max: tensor(1.)
453 44 540 960
There are 17 prompts
current IoU is: 0.8357642889022827
Seok, iteration idx= 23 IoU = tensor(0.8358)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.4ms
Speed: 2.9ms preprocess, 22.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9401
Instance 1: Confidence=0.9391
Instance 2: Confidence=0.9293
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9041
Instance 5: Confidence=0.8093
Selected instance: 4 (Confidence: 0.9041)
tmp min: tensor(0.) tmp max: tensor(1.)
413 32 540 960
There are 15 prompts
current IoU is: 0.9222135543823242
Seok, iteration idx= 24 IoU = tensor(0.9222)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 1.7ms preprocess, 23.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 6
Instance 0: Confidence=0.9441
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9204
Instance 3: Confidence=0.8937
Instance 4: Confidence=0.8811
Instance 5: Confidence=0.6694
Selected instance: 2 (Confidence: 0.9204)
tmp min: tensor(0.) tmp max: tensor(1.)
336 32 540 960
There are 14 prompts
current IoU is: 0.8910916447639465
Seok, iteration idx= 25 IoU = tensor(0.8911)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.3ms
Speed: 2.6ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 4
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9497
Instance 2: Confidence=0.9269
Instance 3: Confidence=0.9004
Selected instance: 0 (Confidence: 0.9579)
tmp min: tensor(0.) tmp max: tensor(1.)
288 8 540 960
There are 14 prompts
current IoU is: 0.9031094908714294
Seok, iteration idx= 26 IoU = tensor(0.9031)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.0ms
Speed: 1.7ms preprocess, 23.0ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 8
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9354
Instance 2: Confidence=0.9341
Instance 3: Confidence=0.8591
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.6447
Instance 6: Confidence=0.4165
Instance 7: Confidence=0.2997
Selected instance: 0 (Confidence: 0.9445)
tmp min: tensor(0.) tmp max: tensor(1.)
281 20 540 960
There are 17 prompts
current IoU is: 0.6535999774932861
Seok, iteration idx= 27 IoU = tensor(0.6536)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.1ms
Speed: 1.7ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9518
Instance 2: Confidence=0.9162
Instance 3: Confidence=0.8995
Instance 4: Confidence=0.8007
Instance 5: Confidence=0.7572
Selected instance: 1 (Confidence: 0.9518)
tmp min: tensor(0.) tmp max: tensor(1.)
233 16 540 960
There are 16 prompts
current IoU is: 0.8750629425048828
Seok, iteration idx= 28 IoU = tensor(0.8751)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9464
Instance 1: Confidence=0.9412
Instance 2: Confidence=0.9307
Instance 3: Confidence=0.8961
Instance 4: Confidence=0.8483
Selected instance: 1 (Confidence: 0.9412)
tmp min: tensor(0.) tmp max: tensor(1.)
180 20 540 960
There are 13 prompts
current IoU is: 0.9054436087608337
Seok, iteration idx= 29 IoU = tensor(0.9054)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.4ms
Speed: 1.6ms preprocess, 22.4ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9355
Instance 1: Confidence=0.9264
Instance 2: Confidence=0.9218
Instance 3: Confidence=0.8835
Instance 4: Confidence=0.8732
Instance 5: Confidence=0.7672
Instance 6: Confidence=0.3035
Selected instance: 4 (Confidence: 0.8732)
tmp min: tensor(0.) tmp max: tensor(1.)
523 72 540 960
There are 18 prompts
current IoU is: 0.8361855149269104
Seok, iteration idx= 30 IoU = tensor(0.8362)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 3.0ms preprocess, 23.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9406
Instance 2: Confidence=0.9377
Instance 3: Confidence=0.8722
Instance 4: Confidence=0.2874
Selected instance: 2 (Confidence: 0.9377)
tmp min: tensor(0.) tmp max: tensor(1.)
534 76 540 960
There are 17 prompts
current IoU is: 0.8593631982803345
Seok, iteration idx= 31 IoU = tensor(0.8594)
Selected Instance Confidence List: [tensor(0.9321), tensor(0.7469, device='cpu'), tensor(0.7653, device='cpu'), tensor(0.3845, device='cpu'), tensor(0.7659, device='cpu'), tensor(0.8029, device='cpu'), tensor(0.7706, device='cpu'), tensor(0.7954, device='cpu'), tensor(0.8019, device='cpu'), tensor(0.7189, device='cpu'), tensor(0.3870, device='cpu'), tensor(0.4447, device='cpu'), tensor(0.8372, device='cpu'), tensor(0.8025, device='cpu'), tensor(0.4624, device='cpu'), tensor(0.3855, device='cpu'), tensor(0.7765, device='cpu'), tensor(0.8483, device='cpu'), tensor(0.7639, device='cpu'), tensor(0.3828, device='cpu'), tensor(0.4274, device='cpu'), tensor(0.6925, device='cpu'), tensor(0.8605, device='cpu'), tensor(0.8842, device='cpu'), tensor(0.9150, device='cpu'), tensor(0.9028, device='cpu'), tensor(0.9250, device='cpu'), tensor(0.7700, device='cpu'), tensor(0.9058, device='cpu'), tensor(0.9197, device='cpu'), tensor(0.8510, device='cpu'), tensor(0.8907, device='cpu')]
Sorted Confidence Order: [tensor(0.9321), tensor(0.8907, device='cpu'), tensor(0.8510, device='cpu'), tensor(0.6925, device='cpu'), tensor(0.4274, device='cpu'), tensor(0.3828, device='cpu'), tensor(0.7639, device='cpu'), tensor(0.8483, device='cpu'), tensor(0.7765, device='cpu'), tensor(0.3855, device='cpu'), tensor(0.4624, device='cpu'), tensor(0.8025, device='cpu'), tensor(0.8372, device='cpu'), tensor(0.4447, device='cpu'), tensor(0.3870, device='cpu'), tensor(0.7189, device='cpu'), tensor(0.8019, device='cpu'), tensor(0.7954, device='cpu'), tensor(0.7706, device='cpu'), tensor(0.9197, device='cpu'), tensor(0.9058, device='cpu'), tensor(0.7700, device='cpu'), tensor(0.9250, device='cpu'), tensor(0.9028, device='cpu'), tensor(0.9150, device='cpu'), tensor(0.8842, device='cpu'), tensor(0.8605, device='cpu'), tensor(0.8029, device='cpu'), tensor(0.7659, device='cpu'), tensor(0.3845, device='cpu'), tensor(0.7653, device='cpu'), tensor(0.7469, device='cpu')]
sorted_indices: [0, 31, 30, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 29, 28, 27, 26, 25, 24, 23, 22, 5, 4, 3, 2, 1]
Initial view (highest confidence): 1
New training order: [11, 10, 9, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15, 14, 13, 12]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 9 persons, 18.9ms
Speed: 1.7ms preprocess, 18.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 3.7ms preprocess, 22.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9406
Instance 2: Confidence=0.9377
Instance 3: Confidence=0.8722
Instance 4: Confidence=0.2874
tmp min: tensor(0.) tmp max: tensor(1.)
534 76 540 960
There are 17 prompts
current IoU is: 0.20109328627586365
Seok, iteration idx= 1 IoU = tensor(0.2011)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 22.8ms
Speed: 2.9ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 7
Instance 0: Confidence=0.9355
Instance 1: Confidence=0.9264
Instance 2: Confidence=0.9218
Instance 3: Confidence=0.8835
Instance 4: Confidence=0.8732
Instance 5: Confidence=0.7672
Instance 6: Confidence=0.3035
tmp min: tensor(0.) tmp max: tensor(1.)
523 72 540 960
There are 18 prompts
current IoU is: 0.219796821475029
Seok, iteration idx= 2 IoU = tensor(0.2198)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 1.7ms preprocess, 23.6ms inference, 5.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 7
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9321
Instance 2: Confidence=0.9290
Instance 3: Confidence=0.9221
Instance 4: Confidence=0.8640
Instance 5: Confidence=0.7488
Instance 6: Confidence=0.3407
tmp min: tensor(0.) tmp max: tensor(1.)
495 90 540 960
There are 18 prompts
current IoU is: 0.12523634731769562
Seok, iteration idx= 3 IoU = tensor(0.1252)
SKIP, unacceptable sam prediction, IoU is tensor(0.1252)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.4ms
Speed: 1.4ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 7
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9389
Instance 2: Confidence=0.9162
Instance 3: Confidence=0.9079
Instance 4: Confidence=0.8868
Instance 5: Confidence=0.5165
Instance 6: Confidence=0.4232
tmp min: tensor(0.) tmp max: tensor(1.)
474 112 540 960
There are 13 prompts
current IoU is: 0.035748790949583054
Seok, iteration idx= 4 IoU = tensor(0.0357)
SKIP, unacceptable sam prediction, IoU is tensor(0.0357)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.6ms
Speed: 1.4ms preprocess, 23.6ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 7
Instance 0: Confidence=0.9568
Instance 1: Confidence=0.9337
Instance 2: Confidence=0.9183
Instance 3: Confidence=0.9098
Instance 4: Confidence=0.7857
Instance 5: Confidence=0.4356
Instance 6: Confidence=0.2723
tmp min: tensor(0.) tmp max: tensor(1.)
441 120 540 960
There are 12 prompts
current IoU is: 0.1602373868227005
Seok, iteration idx= 5 IoU = tensor(0.1602)
SKIP, unacceptable sam prediction, IoU is tensor(0.1602)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.6ms preprocess, 23.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9577
Instance 1: Confidence=0.9502
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.8409
Instance 4: Confidence=0.8097
tmp min: tensor(0.) tmp max: tensor(1.)
401 136 540 960
There are 16 prompts
current IoU is: 0.5031428933143616
Seok, iteration idx= 6 IoU = tensor(0.5031)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 2.3ms preprocess, 22.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 6
Instance 0: Confidence=0.9487
Instance 1: Confidence=0.9423
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.8932
Instance 4: Confidence=0.8345
Instance 5: Confidence=0.7952
tmp min: tensor(0.) tmp max: tensor(1.)
374 64 540 960
There are 16 prompts
current IoU is: 0.4815017580986023
Seok, iteration idx= 7 IoU = tensor(0.4815)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.3ms
Speed: 3.1ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 6
Instance 0: Confidence=0.9542
Instance 1: Confidence=0.9452
Instance 2: Confidence=0.8901
Instance 3: Confidence=0.8789
Instance 4: Confidence=0.8606
Instance 5: Confidence=0.7636
tmp min: tensor(0.) tmp max: tensor(1.)
350 48 540 960
There are 16 prompts
current IoU is: 0.49661993980407715
Seok, iteration idx= 8 IoU = tensor(0.4966)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 1.6ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 7
Instance 0: Confidence=0.9550
Instance 1: Confidence=0.9468
Instance 2: Confidence=0.9211
Instance 3: Confidence=0.8658
Instance 4: Confidence=0.3527
Instance 5: Confidence=0.3313
Instance 6: Confidence=0.2660
tmp min: tensor(0.) tmp max: tensor(1.)
343 84 540 960
There are 12 prompts
current IoU is: 0.6399572491645813
Seok, iteration idx= 9 IoU = tensor(0.6400)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 8
Instance 0: Confidence=0.9684
Instance 1: Confidence=0.9498
Instance 2: Confidence=0.9438
Instance 3: Confidence=0.8761
Instance 4: Confidence=0.7452
Instance 5: Confidence=0.5554
Instance 6: Confidence=0.4846
Instance 7: Confidence=0.4124
tmp min: tensor(0.) tmp max: tensor(1.)
306 40 540 960
There are 15 prompts
current IoU is: 0.5815538167953491
Seok, iteration idx= 10 IoU = tensor(0.5816)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 1.7ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 6
Instance 0: Confidence=0.9710
Instance 1: Confidence=0.9317
Instance 2: Confidence=0.9314
Instance 3: Confidence=0.9307
Instance 4: Confidence=0.7829
Instance 5: Confidence=0.5400
tmp min: tensor(0.) tmp max: tensor(1.)
264 56 540 960
There are 17 prompts
current IoU is: 0.6968489289283752
Seok, iteration idx= 11 IoU = tensor(0.6968)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.1ms
Speed: 3.1ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 7
Instance 0: Confidence=0.9631
Instance 1: Confidence=0.9326
Instance 2: Confidence=0.9224
Instance 3: Confidence=0.8920
Instance 4: Confidence=0.8891
Instance 5: Confidence=0.5450
Instance 6: Confidence=0.4295
tmp min: tensor(0.) tmp max: tensor(1.)
217 60 540 960
There are 17 prompts
current IoU is: 0.693725049495697
Seok, iteration idx= 12 IoU = tensor(0.6937)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.2ms
Speed: 2.8ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 7
Instance 0: Confidence=0.9659
Instance 1: Confidence=0.9437
Instance 2: Confidence=0.9171
Instance 3: Confidence=0.8072
Instance 4: Confidence=0.7156
Instance 5: Confidence=0.4521
Instance 6: Confidence=0.3306
tmp min: tensor(0.) tmp max: tensor(1.)
231 48 540 960
current IoU is: 0.47999128699302673
Seok, iteration idx= 13 IoU = tensor(0.4800)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 3.2ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9671
Instance 1: Confidence=0.9570
Instance 2: Confidence=0.9262
Instance 3: Confidence=0.8464
Instance 4: Confidence=0.6664
tmp min: tensor(0.) tmp max: tensor(1.)
224 4 540 960
There are 15 prompts
current IoU is: 0.0060614426620304585
Seok, iteration idx= 14 IoU = tensor(0.0061)
SKIP, unacceptable sam prediction, IoU is tensor(0.0061)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.4ms
Speed: 2.6ms preprocess, 23.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 6
Instance 0: Confidence=0.9556
Instance 1: Confidence=0.9451
Instance 2: Confidence=0.9042
Instance 3: Confidence=0.7678
Instance 4: Confidence=0.6133
Instance 5: Confidence=0.3890
tmp min: tensor(0.) tmp max: tensor(1.)
199 48 540 960
There are 17 prompts
current IoU is: 0.7256752252578735
Seok, iteration idx= 15 IoU = tensor(0.7257)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 3.1ms preprocess, 23.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9519
Instance 1: Confidence=0.9245
Instance 2: Confidence=0.9200
Instance 3: Confidence=0.7033
Instance 4: Confidence=0.6931
tmp min: tensor(0.) tmp max: tensor(1.)
216 96 540 960
There are 16 prompts
current IoU is: 0.8391587734222412
Seok, iteration idx= 16 IoU = tensor(0.8392)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.2ms
Speed: 3.0ms preprocess, 24.2ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 7
Instance 0: Confidence=0.9526
Instance 1: Confidence=0.9253
Instance 2: Confidence=0.8717
Instance 3: Confidence=0.8405
Instance 4: Confidence=0.5369
Instance 5: Confidence=0.3214
Instance 6: Confidence=0.2665
tmp min: tensor(0.) tmp max: tensor(1.)
194 56 540 960
There are 14 prompts
current IoU is: 0.8725737929344177
Seok, iteration idx= 17 IoU = tensor(0.8726)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.5ms
Speed: 2.8ms preprocess, 21.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9479
Instance 2: Confidence=0.9416
Instance 3: Confidence=0.8988
Instance 4: Confidence=0.8421
tmp min: tensor(0.) tmp max: tensor(1.)
205 40 540 960
There are 14 prompts
current IoU is: 0.8731539249420166
Seok, iteration idx= 18 IoU = tensor(0.8732)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9464
Instance 1: Confidence=0.9412
Instance 2: Confidence=0.9307
Instance 3: Confidence=0.8961
Instance 4: Confidence=0.8483
tmp min: tensor(0.) tmp max: tensor(1.)
180 20 540 960
There are 13 prompts
current IoU is: 0.9191386103630066
Seok, iteration idx= 19 IoU = tensor(0.9191)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.9518
Instance 2: Confidence=0.9162
Instance 3: Confidence=0.8995
Instance 4: Confidence=0.8007
Instance 5: Confidence=0.7572
tmp min: tensor(0.) tmp max: tensor(1.)
233 16 540 960
There are 16 prompts
current IoU is: 0.8935759663581848
Seok, iteration idx= 20 IoU = tensor(0.8936)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 24.1ms
Speed: 1.5ms preprocess, 24.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 8
Instance 0: Confidence=0.9445
Instance 1: Confidence=0.9354
Instance 2: Confidence=0.9341
Instance 3: Confidence=0.8591
Instance 4: Confidence=0.8415
Instance 5: Confidence=0.6447
Instance 6: Confidence=0.4165
Instance 7: Confidence=0.2997
tmp min: tensor(0.) tmp max: tensor(1.)
281 20 540 960
There are 17 prompts
current IoU is: 0.7428525686264038
Seok, iteration idx= 21 IoU = tensor(0.7429)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 4
Instance 0: Confidence=0.9579
Instance 1: Confidence=0.9497
Instance 2: Confidence=0.9269
Instance 3: Confidence=0.9004
tmp min: tensor(0.) tmp max: tensor(1.)
288 8 540 960
There are 14 prompts
current IoU is: 0.9134864211082458
Seok, iteration idx= 22 IoU = tensor(0.9135)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9441
Instance 1: Confidence=0.9429
Instance 2: Confidence=0.9204
Instance 3: Confidence=0.8937
Instance 4: Confidence=0.8811
Instance 5: Confidence=0.6694
tmp min: tensor(0.) tmp max: tensor(1.)
336 32 540 960
There are 14 prompts
current IoU is: 0.9285535216331482
Seok, iteration idx= 23 IoU = tensor(0.9286)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 2.9ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 6
Instance 0: Confidence=0.9401
Instance 1: Confidence=0.9391
Instance 2: Confidence=0.9293
Instance 3: Confidence=0.9217
Instance 4: Confidence=0.9041
Instance 5: Confidence=0.8093
tmp min: tensor(0.) tmp max: tensor(1.)
413 32 540 960
There are 15 prompts
current IoU is: 0.9507054090499878
Seok, iteration idx= 24 IoU = tensor(0.9507)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 8 persons, 26.0ms
Speed: 1.7ms preprocess, 26.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 8
Instance 0: Confidence=0.9570
Instance 1: Confidence=0.9254
Instance 2: Confidence=0.9230
Instance 3: Confidence=0.9228
Instance 4: Confidence=0.9172
Instance 5: Confidence=0.5296
Instance 6: Confidence=0.4528
Instance 7: Confidence=0.3554
tmp min: tensor(0.) tmp max: tensor(1.)
453 44 540 960
There are 17 prompts
current IoU is: 0.8625631332397461
Seok, iteration idx= 25 IoU = tensor(0.8626)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.5ms
Speed: 1.6ms preprocess, 24.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 6
Instance 0: Confidence=0.9415
Instance 1: Confidence=0.9146
Instance 2: Confidence=0.9040
Instance 3: Confidence=0.8978
Instance 4: Confidence=0.8853
Instance 5: Confidence=0.3458
tmp min: tensor(0.) tmp max: tensor(1.)
484 72 540 960
There are 15 prompts
current IoU is: 0.881176233291626
Seok, iteration idx= 26 IoU = tensor(0.8812)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.5ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9471
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9240
Instance 3: Confidence=0.9224
Instance 4: Confidence=0.8923
tmp min: tensor(0.) tmp max: tensor(1.)
623 128 540 960
There are 15 prompts
current IoU is: 0.39662694931030273
Seok, iteration idx= 27 IoU = tensor(0.3966)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9427
Instance 2: Confidence=0.9145
Instance 3: Confidence=0.9067
Instance 4: Confidence=0.8978
Instance 5: Confidence=0.6321
tmp min: tensor(0.) tmp max: tensor(1.)
622 100 540 960
There are 17 prompts
current IoU is: 0.4104066789150238
Seok, iteration idx= 28 IoU = tensor(0.4104)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9577
Instance 1: Confidence=0.9560
Instance 2: Confidence=0.9503
Instance 3: Confidence=0.8193
Instance 4: Confidence=0.7426
tmp min: tensor(0.) tmp max: tensor(1.)
614 40 540 960
There are 16 prompts
current IoU is: 0.0012292138999328017
Seok, iteration idx= 29 IoU = tensor(0.0012)
SKIP, unacceptable sam prediction, IoU is tensor(0.0012)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.8ms
Speed: 1.5ms preprocess, 24.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 7
Instance 0: Confidence=0.9597
Instance 1: Confidence=0.9420
Instance 2: Confidence=0.9354
Instance 3: Confidence=0.8429
Instance 4: Confidence=0.8336
Instance 5: Confidence=0.6522
Instance 6: Confidence=0.4532
tmp min: tensor(0.) tmp max: tensor(1.)
594 72 540 960
There are 16 prompts
current IoU is: 0.5815753936767578
Seok, iteration idx= 30 IoU = tensor(0.5816)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.7ms
Speed: 2.3ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9457
Instance 1: Confidence=0.9456
Instance 2: Confidence=0.9313
Instance 3: Confidence=0.8808
Instance 4: Confidence=0.8715
Instance 5: Confidence=0.8483
tmp min: tensor(0.) tmp max: tensor(1.)
572 64 540 960
There are 16 prompts
current IoU is: 0.5590741634368896
Seok, iteration idx= 31 IoU = tensor(0.5591)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set11_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set11_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:40<00:00,  1.25s/it]
Testing psnr 26.62242643535137 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set11_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.16it/s]
Testing psnr 3.462593909353018 (avg)
train: coarse segmentation in 00:03:39
train: finish (eps time 00:03:39 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set11_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set12/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 42.03it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set12 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set12
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set12_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.2ms
Speed: 3.2ms preprocess, 21.2ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.7ms
Speed: 1.4ms preprocess, 19.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.5ms
Speed: 1.5ms preprocess, 19.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.9ms
Speed: 1.5ms preprocess, 19.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.2ms
Speed: 2.2ms preprocess, 19.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.3ms
Speed: 1.5ms preprocess, 19.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.0ms
Speed: 1.3ms preprocess, 20.0ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.1ms
Speed: 1.3ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.0ms
Speed: 1.2ms preprocess, 20.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.9ms
Speed: 1.3ms preprocess, 19.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.7ms
Speed: 1.3ms preprocess, 18.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.8ms
Speed: 1.2ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.5ms
Speed: 1.4ms preprocess, 19.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.9ms
Speed: 1.3ms preprocess, 19.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 19.2ms
Speed: 1.3ms preprocess, 19.2ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.9ms
Speed: 1.2ms preprocess, 19.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.1ms
Speed: 1.3ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.2ms
Speed: 1.4ms preprocess, 21.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.2ms
Speed: 1.3ms preprocess, 19.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.6ms
Speed: 1.5ms preprocess, 19.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.1ms
Speed: 1.3ms preprocess, 19.1ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.8ms
Speed: 1.2ms preprocess, 19.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.1ms
Speed: 1.5ms preprocess, 19.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 19.6ms
Speed: 2.1ms preprocess, 19.6ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.5ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.7ms
Speed: 1.3ms preprocess, 19.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 20.6ms
Speed: 1.7ms preprocess, 20.6ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 20
view_order: [25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 20.8ms
Speed: 1.4ms preprocess, 20.8ms inference, 1.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 4
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.8929
Instance 3: Confidence=0.7493
Selected instance: 2 (Confidence: 0.8929)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

294 68 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 16 prompts
current IoU is: 0.7435640692710876
Seok, iteration idx= 1 IoU = tensor(0.7436)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 6
Instance 0: Confidence=0.9285
Instance 1: Confidence=0.8933
Instance 2: Confidence=0.8802
Instance 3: Confidence=0.7548
Instance 4: Confidence=0.6740
Instance 5: Confidence=0.4509
Selected instance: 1 (Confidence: 0.8933)
tmp min: tensor(0.) tmp max: tensor(1.)
326 80 540 960
There are 16 prompts
current IoU is: 0.8040663599967957
Seok, iteration idx= 2 IoU = tensor(0.8041)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.6ms
Speed: 1.5ms preprocess, 22.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9410
Instance 1: Confidence=0.9132
Instance 2: Confidence=0.8935
Instance 3: Confidence=0.8732
Instance 4: Confidence=0.5436
Selected instance: 3 (Confidence: 0.8732)
tmp min: tensor(0.) tmp max: tensor(1.)
398 72 540 960
There are 16 prompts
current IoU is: 0.86817866563797
Seok, iteration idx= 3 IoU = tensor(0.8682)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 1.5ms preprocess, 23.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9265
Instance 1: Confidence=0.9139
Instance 2: Confidence=0.8982
Instance 3: Confidence=0.8130
Instance 4: Confidence=0.7903
Selected instance: 4 (Confidence: 0.7903)
tmp min: tensor(0.) tmp max: tensor(1.)
498 32 540 960
current IoU is: 0.009079445153474808
Seok, iteration idx= 4 IoU = tensor(0.0091)
SKIP, unacceptable sam prediction, IoU is tensor(0.0091)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.3ms
Speed: 1.5ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9261
Instance 2: Confidence=0.9165
Instance 3: Confidence=0.8297
Instance 4: Confidence=0.7494
Selected instance: 4 (Confidence: 0.7494)
tmp min: tensor(0.) tmp max: tensor(1.)
470 72 540 960
There are 18 prompts
current IoU is: 0.004264805465936661
Seok, iteration idx= 5 IoU = tensor(0.0043)
SKIP, unacceptable sam prediction, IoU is tensor(0.0043)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.6ms preprocess, 22.2ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9550
Instance 1: Confidence=0.9480
Instance 2: Confidence=0.9431
Instance 3: Confidence=0.9207
Instance 4: Confidence=0.5784
Selected instance: 0 (Confidence: 0.9550)
tmp min: tensor(0.) tmp max: tensor(1.)
530 0 540 960
There are 15 prompts
current IoU is: 0.0057695284485816956
Seok, iteration idx= 6 IoU = tensor(0.0058)
SKIP, unacceptable sam prediction, IoU is tensor(0.0058)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.5ms
Speed: 3.1ms preprocess, 23.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 4
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.8809
Selected instance: 3 (Confidence: 0.8809)
tmp min: tensor(0.) tmp max: tensor(1.)
556 72 540 960
There are 16 prompts
current IoU is: 0.846439003944397
Seok, iteration idx= 7 IoU = tensor(0.8464)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.5ms
Speed: 1.7ms preprocess, 22.5ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9471
Instance 2: Confidence=0.9431
Instance 3: Confidence=0.6623
Instance 4: Confidence=0.2560
Selected instance: 3 (Confidence: 0.6623)
tmp min: tensor(0.) tmp max: tensor(1.)
584 136 540 960
There are 14 prompts
current IoU is: 0.3242320716381073
Seok, iteration idx= 8 IoU = tensor(0.3242)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 6
Instance 0: Confidence=0.9649
Instance 1: Confidence=0.9461
Instance 2: Confidence=0.9441
Instance 3: Confidence=0.8727
Instance 4: Confidence=0.7388
Instance 5: Confidence=0.3397
Selected instance: 4 (Confidence: 0.7388)
tmp min: tensor(0.) tmp max: tensor(1.)
662 112 540 960
There are 15 prompts
current IoU is: 0.4367942810058594
Seok, iteration idx= 9 IoU = tensor(0.4368)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 5
Instance 0: Confidence=0.9661
Instance 1: Confidence=0.9528
Instance 2: Confidence=0.9436
Instance 3: Confidence=0.9059
Instance 4: Confidence=0.7484
Selected instance: 4 (Confidence: 0.7484)
tmp min: tensor(0.) tmp max: tensor(1.)
677 112 540 960
There are 18 prompts
current IoU is: 0.7343720197677612
Seok, iteration idx= 10 IoU = tensor(0.7344)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.5ms
Speed: 1.5ms preprocess, 24.5ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9573
Instance 1: Confidence=0.9485
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.9090
Instance 4: Confidence=0.9048
Selected instance: 4 (Confidence: 0.9048)
tmp min: tensor(0.) tmp max: tensor(1.)
720 92 540 960
There are 16 prompts
current IoU is: 0.8428862690925598
Seok, iteration idx= 11 IoU = tensor(0.8429)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 2.3ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 5
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9406
Instance 3: Confidence=0.9326
Instance 4: Confidence=0.8584
Selected instance: 1 (Confidence: 0.9569)
tmp min: tensor(0.) tmp max: tensor(1.)
114 56 540 960
There are 13 prompts
current IoU is: 0.6900110840797424
Seok, iteration idx= 12 IoU = tensor(0.6900)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 3.0ms preprocess, 22.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9605
Instance 1: Confidence=0.9523
Instance 2: Confidence=0.9335
Instance 3: Confidence=0.9316
Instance 4: Confidence=0.8775
Selected instance: 0 (Confidence: 0.9605)
tmp min: tensor(0.) tmp max: tensor(1.)
59 40 540 960
There are 15 prompts
current IoU is: 0.8404029011726379
Seok, iteration idx= 13 IoU = tensor(0.8404)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 2.9ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9609
Instance 1: Confidence=0.9444
Instance 2: Confidence=0.9416
Instance 3: Confidence=0.9373
Instance 4: Confidence=0.9147
Selected instance: 0 (Confidence: 0.9609)
tmp min: tensor(0.) tmp max: tensor(1.)
9 36 540 960
There are 14 prompts
current IoU is: 0.8749287128448486
Seok, iteration idx= 14 IoU = tensor(0.8749)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 3.3ms preprocess, 22.3ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9470
Instance 1: Confidence=0.9424
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9360
Instance 4: Confidence=0.9339
Selected instance: 0 (Confidence: 0.9470)
tmp min: tensor(0.) tmp max: tensor(1.)
2 36 540 960
There are 15 prompts
current IoU is: 0.9212562441825867
Seok, iteration idx= 15 IoU = tensor(0.9213)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.3ms
Speed: 3.5ms preprocess, 22.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9436
Instance 3: Confidence=0.9424
Instance 4: Confidence=0.9320
Selected instance: 2 (Confidence: 0.9436)
tmp min: tensor(0.) tmp max: tensor(1.)
2 28 540 960
There are 17 prompts
current IoU is: 0.9257004261016846
Seok, iteration idx= 16 IoU = tensor(0.9257)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 4.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 5
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9525
Instance 2: Confidence=0.9508
Instance 3: Confidence=0.9356
Instance 4: Confidence=0.9341
Selected instance: 2 (Confidence: 0.9508)
tmp min: tensor(0.) tmp max: tensor(1.)
25 40 540 960
There are 15 prompts
current IoU is: 0.9224533438682556
Seok, iteration idx= 17 IoU = tensor(0.9225)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.4ms preprocess, 23.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 5
Instance 0: Confidence=0.9560
Instance 1: Confidence=0.9556
Instance 2: Confidence=0.9446
Instance 3: Confidence=0.9356
Instance 4: Confidence=0.9297
Selected instance: 0 (Confidence: 0.9560)
tmp min: tensor(0.) tmp max: tensor(1.)
15 40 540 960
There are 14 prompts
current IoU is: 0.926164448261261
Seok, iteration idx= 18 IoU = tensor(0.9262)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.7ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 5
Instance 0: Confidence=0.9584
Instance 1: Confidence=0.9531
Instance 2: Confidence=0.9364
Instance 3: Confidence=0.9357
Instance 4: Confidence=0.8459
Selected instance: 1 (Confidence: 0.9531)
tmp min: tensor(0.) tmp max: tensor(1.)
17 56 540 960
There are 13 prompts
current IoU is: 0.87868732213974
Seok, iteration idx= 19 IoU = tensor(0.8787)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 5
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9486
Instance 2: Confidence=0.9481
Instance 3: Confidence=0.9425
Instance 4: Confidence=0.9152
Selected instance: 3 (Confidence: 0.9425)
tmp min: tensor(0.) tmp max: tensor(1.)
761 72 540 960
There are 17 prompts
current IoU is: 0.8573908805847168
Seok, iteration idx= 20 IoU = tensor(0.8574)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 5
Instance 0: Confidence=0.9641
Instance 1: Confidence=0.9486
Instance 2: Confidence=0.9464
Instance 3: Confidence=0.9459
Instance 4: Confidence=0.9247
Selected instance: 2 (Confidence: 0.9464)
tmp min: tensor(0.) tmp max: tensor(1.)
792 68 540 960
There are 13 prompts
current IoU is: 0.871181070804596
Seok, iteration idx= 21 IoU = tensor(0.8712)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 5
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.9499
Instance 3: Confidence=0.9484
Instance 4: Confidence=0.9239
Selected instance: 0 (Confidence: 0.9539)
tmp min: tensor(0.) tmp max: tensor(1.)
818 56 540 960
There are 14 prompts
current IoU is: 0.8691912293434143
Seok, iteration idx= 22 IoU = tensor(0.8692)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.4ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 5
Instance 0: Confidence=0.9541
Instance 1: Confidence=0.9507
Instance 2: Confidence=0.9499
Instance 3: Confidence=0.9434
Instance 4: Confidence=0.9244
Selected instance: 1 (Confidence: 0.9507)
tmp min: tensor(0.) tmp max: tensor(1.)
850 56 540 960
There are 14 prompts
current IoU is: 0.9113265872001648
Seok, iteration idx= 23 IoU = tensor(0.9113)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 2.7ms preprocess, 22.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9393
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.9061
Selected instance: 0 (Confidence: 0.9515)
tmp min: tensor(0.) tmp max: tensor(1.)
869 56 540 960
There are 16 prompts
current IoU is: 0.9235284328460693
Seok, iteration idx= 24 IoU = tensor(0.9235)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.4ms
Speed: 4.0ms preprocess, 21.4ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9574
Instance 1: Confidence=0.9514
Instance 2: Confidence=0.9313
Instance 3: Confidence=0.9223
Instance 4: Confidence=0.9072
Selected instance: 0 (Confidence: 0.9574)
tmp min: tensor(0.) tmp max: tensor(1.)
892 56 540 960
There are 16 prompts
current IoU is: 0.917219340801239
Seok, iteration idx= 25 IoU = tensor(0.9172)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.1ms
Speed: 3.4ms preprocess, 23.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9655
Instance 1: Confidence=0.9410
Instance 2: Confidence=0.9096
Instance 3: Confidence=0.9021
Instance 4: Confidence=0.8728
Selected instance: 0 (Confidence: 0.9655)
tmp min: tensor(0.) tmp max: tensor(1.)
867 80 540 960
There are 16 prompts
current IoU is: 0.9334747791290283
Seok, iteration idx= 26 IoU = tensor(0.9335)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.5ms
Speed: 3.1ms preprocess, 21.5ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 6
Instance 0: Confidence=0.9578
Instance 1: Confidence=0.9251
Instance 2: Confidence=0.8965
Instance 3: Confidence=0.8850
Instance 4: Confidence=0.8000
Instance 5: Confidence=0.6041
Selected instance: 0 (Confidence: 0.9578)
tmp min: tensor(0.) tmp max: tensor(1.)
846 104 540 960
There are 16 prompts
current IoU is: 0.9327380657196045
Seok, iteration idx= 27 IoU = tensor(0.9327)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 2.8ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 6
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9413
Instance 3: Confidence=0.9286
Instance 4: Confidence=0.8911
Instance 5: Confidence=0.8629
Selected instance: 3 (Confidence: 0.9286)
tmp min: tensor(0.) tmp max: tensor(1.)
101 56 540 960
There are 14 prompts
current IoU is: 0.9249699115753174
Seok, iteration idx= 28 IoU = tensor(0.9250)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.2ms
Speed: 3.2ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 7
Instance 0: Confidence=0.9563
Instance 1: Confidence=0.9416
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.9166
Instance 4: Confidence=0.6422
Instance 5: Confidence=0.3537
Instance 6: Confidence=0.3190
Selected instance: 1 (Confidence: 0.9416)
tmp min: tensor(0.) tmp max: tensor(1.)
118 76 540 960
There are 14 prompts
current IoU is: 0.9120479822158813
Seok, iteration idx= 29 IoU = tensor(0.9120)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.8ms
Speed: 3.7ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 6
Instance 0: Confidence=0.9407
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9287
Instance 3: Confidence=0.9253
Instance 4: Confidence=0.5503
Instance 5: Confidence=0.4910
Selected instance: 2 (Confidence: 0.9287)
tmp min: tensor(0.) tmp max: tensor(1.)
166 112 540 960
There are 15 prompts
current IoU is: 0.8867396712303162
Seok, iteration idx= 30 IoU = tensor(0.8867)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.2ms
Speed: 3.0ms preprocess, 23.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 6
Instance 0: Confidence=0.9480
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.9271
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9137
Instance 5: Confidence=0.4320
Selected instance: 3 (Confidence: 0.9219)
tmp min: tensor(0.) tmp max: tensor(1.)
206 64 540 960
There are 16 prompts
current IoU is: 0.8868795037269592
Seok, iteration idx= 31 IoU = tensor(0.8869)
Selected Instance Confidence List: [tensor(0.8986), tensor(0.8033, device='cpu'), tensor(0.8398, device='cpu'), tensor(0.8702, device='cpu'), tensor(0.3708, device='cpu'), tensor(0.3772, device='cpu'), tensor(0.3855, device='cpu'), tensor(0.8602, device='cpu'), tensor(0.4595, device='cpu'), tensor(0.5576, device='cpu'), tensor(0.7400, device='cpu'), tensor(0.8677, device='cpu'), tensor(0.7968, device='cpu'), tensor(0.8885, device='cpu'), tensor(0.9093, device='cpu'), tensor(0.9316, device='cpu'), tensor(0.9328, device='cpu'), tensor(0.9338, device='cpu'), tensor(0.9381, device='cpu'), tensor(0.9085, device='cpu'), tensor(0.8914, device='cpu'), tensor(0.9013, device='cpu'), tensor(0.9031, device='cpu'), tensor(0.9271, device='cpu'), tensor(0.9347, device='cpu'), tensor(0.9333, device='cpu'), tensor(0.9463, device='cpu'), tensor(0.9427, device='cpu'), tensor(0.9264, device='cpu'), tensor(0.9239, device='cpu'), tensor(0.9035, device='cpu'), tensor(0.9009, device='cpu')]
Sorted Confidence Order: [tensor(0.9463, device='cpu'), tensor(0.9427, device='cpu'), tensor(0.9333, device='cpu'), tensor(0.9347, device='cpu'), tensor(0.9271, device='cpu'), tensor(0.9031, device='cpu'), tensor(0.9013, device='cpu'), tensor(0.8914, device='cpu'), tensor(0.8677, device='cpu'), tensor(0.7400, device='cpu'), tensor(0.5576, device='cpu'), tensor(0.4595, device='cpu'), tensor(0.8602, device='cpu'), tensor(0.3855, device='cpu'), tensor(0.3772, device='cpu'), tensor(0.3708, device='cpu'), tensor(0.8702, device='cpu'), tensor(0.8398, device='cpu'), tensor(0.8033, device='cpu'), tensor(0.8986), tensor(0.9009, device='cpu'), tensor(0.9035, device='cpu'), tensor(0.9239, device='cpu'), tensor(0.9264, device='cpu'), tensor(0.9085, device='cpu'), tensor(0.9381, device='cpu'), tensor(0.9338, device='cpu'), tensor(0.9328, device='cpu'), tensor(0.9316, device='cpu'), tensor(0.9093, device='cpu'), tensor(0.8885, device='cpu'), tensor(0.7968, device='cpu')]
sorted_indices: [26, 27, 25, 24, 23, 22, 21, 20, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 31, 30, 29, 28, 19, 18, 17, 16, 15, 14, 13, 12]
Initial view (highest confidence): 31
New training order: [15, 16, 14, 13, 12, 11, 10, 9, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 21.6ms
Speed: 3.3ms preprocess, 21.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 6
Instance 0: Confidence=0.9578
Instance 1: Confidence=0.9251
Instance 2: Confidence=0.8965
Instance 3: Confidence=0.8850
Instance 4: Confidence=0.8000
Instance 5: Confidence=0.6041
tmp min: tensor(0.) tmp max: tensor(1.)
846 104 540 960
There are 16 prompts
current IoU is: 0.9251613020896912
Seok, iteration idx= 1 IoU = tensor(0.9252)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 3.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 5
Instance 0: Confidence=0.9574
Instance 1: Confidence=0.9514
Instance 2: Confidence=0.9313
Instance 3: Confidence=0.9223
Instance 4: Confidence=0.9072
tmp min: tensor(0.) tmp max: tensor(1.)
892 56 540 960
There are 16 prompts
current IoU is: 0.9416927099227905
Seok, iteration idx= 2 IoU = tensor(0.9417)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9515
Instance 1: Confidence=0.9477
Instance 2: Confidence=0.9393
Instance 3: Confidence=0.9352
Instance 4: Confidence=0.9061
tmp min: tensor(0.) tmp max: tensor(1.)
869 56 540 960
There are 16 prompts
current IoU is: 0.9377533197402954
Seok, iteration idx= 3 IoU = tensor(0.9378)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9541
Instance 1: Confidence=0.9507
Instance 2: Confidence=0.9499
Instance 3: Confidence=0.9434
Instance 4: Confidence=0.9244
tmp min: tensor(0.) tmp max: tensor(1.)
850 56 540 960
There are 14 prompts
current IoU is: 0.9368628263473511
Seok, iteration idx= 4 IoU = tensor(0.9369)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.5ms
Speed: 2.2ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9539
Instance 1: Confidence=0.9503
Instance 2: Confidence=0.9499
Instance 3: Confidence=0.9484
Instance 4: Confidence=0.9239
tmp min: tensor(0.) tmp max: tensor(1.)
818 56 540 960
There are 14 prompts
current IoU is: 0.9253643751144409
Seok, iteration idx= 5 IoU = tensor(0.9254)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.6ms
Speed: 1.5ms preprocess, 24.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9641
Instance 1: Confidence=0.9486
Instance 2: Confidence=0.9464
Instance 3: Confidence=0.9459
Instance 4: Confidence=0.9247
tmp min: tensor(0.) tmp max: tensor(1.)
792 68 540 960
There are 13 prompts
current IoU is: 0.9267817139625549
Seok, iteration idx= 6 IoU = tensor(0.9268)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 5
Instance 0: Confidence=0.9610
Instance 1: Confidence=0.9486
Instance 2: Confidence=0.9481
Instance 3: Confidence=0.9425
Instance 4: Confidence=0.9152
tmp min: tensor(0.) tmp max: tensor(1.)
761 72 540 960
There are 17 prompts
current IoU is: 0.9020007252693176
Seok, iteration idx= 7 IoU = tensor(0.9020)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.7ms
Speed: 1.4ms preprocess, 23.7ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 5
Instance 0: Confidence=0.9573
Instance 1: Confidence=0.9485
Instance 2: Confidence=0.9414
Instance 3: Confidence=0.9090
Instance 4: Confidence=0.9048
tmp min: tensor(0.) tmp max: tensor(1.)
720 92 540 960
There are 16 prompts
current IoU is: 0.86177659034729
Seok, iteration idx= 8 IoU = tensor(0.8618)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 2.3ms preprocess, 24.0ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 5
Instance 0: Confidence=0.9661
Instance 1: Confidence=0.9528
Instance 2: Confidence=0.9436
Instance 3: Confidence=0.9059
Instance 4: Confidence=0.7484
tmp min: tensor(0.) tmp max: tensor(1.)
677 112 540 960
There are 18 prompts
current IoU is: 0.8767215609550476
Seok, iteration idx= 9 IoU = tensor(0.8767)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 6
Instance 0: Confidence=0.9649
Instance 1: Confidence=0.9461
Instance 2: Confidence=0.9441
Instance 3: Confidence=0.8727
Instance 4: Confidence=0.7388
Instance 5: Confidence=0.3397
tmp min: tensor(0.) tmp max: tensor(1.)
662 112 540 960
There are 19 prompts
current IoU is: 0.6434003114700317
Seok, iteration idx= 10 IoU = tensor(0.6434)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.7ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 5
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9471
Instance 2: Confidence=0.9431
Instance 3: Confidence=0.6623
Instance 4: Confidence=0.2560
tmp min: tensor(0.) tmp max: tensor(1.)
584 136 540 960
There are 14 prompts
current IoU is: 0.5235814452171326
Seok, iteration idx= 11 IoU = tensor(0.5236)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 4
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9434
Instance 2: Confidence=0.9333
Instance 3: Confidence=0.8809
tmp min: tensor(0.) tmp max: tensor(1.)
556 72 540 960
There are 16 prompts
current IoU is: 0.9054778814315796
Seok, iteration idx= 12 IoU = tensor(0.9055)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 5
Instance 0: Confidence=0.9550
Instance 1: Confidence=0.9480
Instance 2: Confidence=0.9431
Instance 3: Confidence=0.9207
Instance 4: Confidence=0.5784
tmp min: tensor(0.) tmp max: tensor(1.)
530 0 540 960
There are 15 prompts
current IoU is: 0.0028272666968405247
Seok, iteration idx= 13 IoU = tensor(0.0028)
SKIP, unacceptable sam prediction, IoU is tensor(0.0028)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.4ms
Speed: 1.5ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 5
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9261
Instance 2: Confidence=0.9165
Instance 3: Confidence=0.8297
Instance 4: Confidence=0.7494
tmp min: tensor(0.) tmp max: tensor(1.)
470 72 540 960
There are 18 prompts
current IoU is: 0.004148576874285936
Seok, iteration idx= 14 IoU = tensor(0.0041)
SKIP, unacceptable sam prediction, IoU is tensor(0.0041)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 3.1ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 5
Instance 0: Confidence=0.9265
Instance 1: Confidence=0.9139
Instance 2: Confidence=0.8982
Instance 3: Confidence=0.8130
Instance 4: Confidence=0.7903
tmp min: tensor(0.) tmp max: tensor(1.)
498 32 540 960
current IoU is: 0.00937630794942379
Seok, iteration idx= 15 IoU = tensor(0.0094)
SKIP, unacceptable sam prediction, IoU is tensor(0.0094)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.6ms
Speed: 3.0ms preprocess, 21.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 5
Instance 0: Confidence=0.9410
Instance 1: Confidence=0.9132
Instance 2: Confidence=0.8935
Instance 3: Confidence=0.8732
Instance 4: Confidence=0.5436
tmp min: tensor(0.) tmp max: tensor(1.)
398 72 540 960
There are 16 prompts
current IoU is: 0.8917045593261719
Seok, iteration idx= 16 IoU = tensor(0.8917)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 22.2ms
Speed: 3.0ms preprocess, 22.2ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 6
Instance 0: Confidence=0.9285
Instance 1: Confidence=0.8933
Instance 2: Confidence=0.8802
Instance 3: Confidence=0.7548
Instance 4: Confidence=0.6740
Instance 5: Confidence=0.4509
tmp min: tensor(0.) tmp max: tensor(1.)
326 80 540 960
There are 16 prompts
current IoU is: 0.8971500992774963
Seok, iteration idx= 17 IoU = tensor(0.8972)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.3ms
Speed: 3.0ms preprocess, 23.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 4
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.8929
Instance 3: Confidence=0.7493
tmp min: tensor(0.) tmp max: tensor(1.)
294 68 540 960
There are 16 prompts
current IoU is: 0.901199996471405
Seok, iteration idx= 18 IoU = tensor(0.9012)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 24.1ms
Speed: 3.2ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 7
Instance 0: Confidence=0.9241
Instance 1: Confidence=0.9137
Instance 2: Confidence=0.8986
Instance 3: Confidence=0.8831
Instance 4: Confidence=0.8546
Instance 5: Confidence=0.7726
Instance 6: Confidence=0.2917
tmp min: tensor(0.) tmp max: tensor(1.)
277 80 540 960
There are 16 prompts
current IoU is: 0.9052222967147827
Seok, iteration idx= 19 IoU = tensor(0.9052)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.5ms
Speed: 3.3ms preprocess, 23.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 6
Instance 0: Confidence=0.9480
Instance 1: Confidence=0.9348
Instance 2: Confidence=0.9271
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.9137
Instance 5: Confidence=0.4320
tmp min: tensor(0.) tmp max: tensor(1.)
206 64 540 960
There are 16 prompts
current IoU is: 0.898232638835907
Seok, iteration idx= 20 IoU = tensor(0.8982)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.1ms
Speed: 2.8ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 6
Instance 0: Confidence=0.9407
Instance 1: Confidence=0.9303
Instance 2: Confidence=0.9287
Instance 3: Confidence=0.9253
Instance 4: Confidence=0.5503
Instance 5: Confidence=0.4910
tmp min: tensor(0.) tmp max: tensor(1.)
166 112 540 960
There are 15 prompts
current IoU is: 0.8986461162567139
Seok, iteration idx= 21 IoU = tensor(0.8986)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 7 persons, 23.8ms
Speed: 2.7ms preprocess, 23.8ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 7
Instance 0: Confidence=0.9563
Instance 1: Confidence=0.9416
Instance 2: Confidence=0.9321
Instance 3: Confidence=0.9166
Instance 4: Confidence=0.6422
Instance 5: Confidence=0.3537
Instance 6: Confidence=0.3190
tmp min: tensor(0.) tmp max: tensor(1.)
118 76 540 960
There are 14 prompts
current IoU is: 0.9151697158813477
Seok, iteration idx= 22 IoU = tensor(0.9152)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 6 persons, 23.6ms
Speed: 3.7ms preprocess, 23.6ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 6
Instance 0: Confidence=0.9616
Instance 1: Confidence=0.9558
Instance 2: Confidence=0.9413
Instance 3: Confidence=0.9286
Instance 4: Confidence=0.8911
Instance 5: Confidence=0.8629
tmp min: tensor(0.) tmp max: tensor(1.)
101 56 540 960
There are 14 prompts
current IoU is: 0.9392284750938416
Seok, iteration idx= 23 IoU = tensor(0.9392)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.1ms
Speed: 1.6ms preprocess, 24.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 5
Instance 0: Confidence=0.9584
Instance 1: Confidence=0.9531
Instance 2: Confidence=0.9364
Instance 3: Confidence=0.9357
Instance 4: Confidence=0.8459
tmp min: tensor(0.) tmp max: tensor(1.)
17 56 540 960
There are 13 prompts
current IoU is: 0.9523974061012268
Seok, iteration idx= 24 IoU = tensor(0.9524)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 3.4ms preprocess, 23.8ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 5
Instance 0: Confidence=0.9560
Instance 1: Confidence=0.9556
Instance 2: Confidence=0.9446
Instance 3: Confidence=0.9356
Instance 4: Confidence=0.9297
tmp min: tensor(0.) tmp max: tensor(1.)
15 40 540 960
There are 14 prompts
current IoU is: 0.9481783509254456
Seok, iteration idx= 25 IoU = tensor(0.9482)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.4ms
Speed: 1.6ms preprocess, 21.4ms inference, 2.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9555
Instance 1: Confidence=0.9525
Instance 2: Confidence=0.9508
Instance 3: Confidence=0.9356
Instance 4: Confidence=0.9341
tmp min: tensor(0.) tmp max: tensor(1.)
25 40 540 960
There are 15 prompts
current IoU is: 0.9469159841537476
Seok, iteration idx= 26 IoU = tensor(0.9469)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.6ms
Speed: 1.6ms preprocess, 24.6ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9521
Instance 1: Confidence=0.9466
Instance 2: Confidence=0.9436
Instance 3: Confidence=0.9424
Instance 4: Confidence=0.9320
tmp min: tensor(0.) tmp max: tensor(1.)
2 28 540 960
There are 17 prompts
current IoU is: 0.9429658055305481
Seok, iteration idx= 27 IoU = tensor(0.9430)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.5ms
Speed: 1.9ms preprocess, 24.5ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9470
Instance 1: Confidence=0.9424
Instance 2: Confidence=0.9392
Instance 3: Confidence=0.9360
Instance 4: Confidence=0.9339
tmp min: tensor(0.) tmp max: tensor(1.)
2 36 540 960
There are 15 prompts
current IoU is: 0.9460561275482178
Seok, iteration idx= 28 IoU = tensor(0.9461)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9609
Instance 1: Confidence=0.9444
Instance 2: Confidence=0.9416
Instance 3: Confidence=0.9373
Instance 4: Confidence=0.9147
tmp min: tensor(0.) tmp max: tensor(1.)
9 36 540 960
There are 14 prompts
current IoU is: 0.9482797980308533
Seok, iteration idx= 29 IoU = tensor(0.9483)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.6ms
Speed: 1.5ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 5
Instance 0: Confidence=0.9605
Instance 1: Confidence=0.9523
Instance 2: Confidence=0.9335
Instance 3: Confidence=0.9316
Instance 4: Confidence=0.8775
tmp min: tensor(0.) tmp max: tensor(1.)
59 40 540 960
There are 15 prompts
current IoU is: 0.9000146389007568
Seok, iteration idx= 30 IoU = tensor(0.9000)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.4ms preprocess, 23.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9621
Instance 1: Confidence=0.9569
Instance 2: Confidence=0.9406
Instance 3: Confidence=0.9326
Instance 4: Confidence=0.8584
tmp min: tensor(0.) tmp max: tensor(1.)
114 56 540 960
There are 13 prompts
current IoU is: 0.8835672736167908
Seok, iteration idx= 31 IoU = tensor(0.8836)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set12_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set12_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:40<00:00,  1.26s/it]
Testing psnr 27.958649545907974 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set12_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:27<00:00,  1.17it/s]
Testing psnr 3.495478006079793 (avg)
train: coarse segmentation in 00:03:40
train: finish (eps time 00:03:41 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set12_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/render_utils_cuda/build.ninja...
Building extension module render_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/total_variation_cuda/build.ninja...
Building extension module total_variation_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module total_variation_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
No modifications detected for re-loaded extension module render_utils_cuda, skipping build step...
Loading extension module render_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/ub360_utils_cuda/build.ninja...
Building extension module ub360_utils_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module ub360_utils_cuda...
Using /home/lab/.cache/torch_extensions/py310_cu116 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/lab/.cache/torch_extensions/py310_cu116/adam_upd_cuda/build.ninja...
Building extension module adam_upd_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module adam_upd_cuda...
UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
Loading images from ./data/360_v2/Set13/images_4
100%|███████████████████████████████████████████| 32/32 [00:00<00:00, 48.96it/s]
Loaded image data (540, 960, 3, 32) [        540         960       755.4]
Loaded ./data/360_v2/Set13 1.0377994298596556 56.06785458628859
Data:
(32, 3, 5) (32, 540, 960, 3) (32, 2)
HOLDOUT view is 23
Loaded llff (32, 540, 960, 3) torch.Size([200, 3, 5]) [        540         960       755.4] ./data/360_v2/Set13
Auto LLFF holdout, 8
DEFINING BOUNDS
near_clip 0.213833025097847
original far 12.836090087890625
NEAR FAR 0 2.2574854
train: start
compute_bbox_by_cam_frustrm: start
UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484803030/work/aten/src/ATen/native/TensorShape.cpp:2894.)
compute_bbox_by_cam_frustrm: xyz_min tensor([-1.1254, -0.9728, -0.8908])
compute_bbox_by_cam_frustrm: xyz_max tensor([0.7559, 0.9084, 0.9904])
compute_bbox_by_cam_frustrm: finish
SAM initializd.
scene_rep_reconstruction (coarse): reload from ./logs/nerf_unbounded/dcvgo_Set13_unbounded/fine_last.tar
Load model with num_objects = 1
dcvgo: voxel_size       tensor(0.0075)
dcvgo: world_size       tensor([320, 320, 320])
dcvgo: voxel_size_base  tensor(0.0150)
dcvgo: voxel_size_ratio tensor(0.5000)
dcvgo: set density bias shift to tensor([-9.2102], device='cpu')
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
tensor([-1.2000, -1.2000, -1.2000]) tensor([1.2000, 1.2000, 1.2000]) tensor([320, 320, 320])
dcvgo: feature voxel grid TensoRFGrid(channels=12, world_size=[320, 320, 320], n_comp=48)
dcvgo: mlp Sequential(
  (0): Linear(in_features=39, out_features=128, bias=True)
  (1): ReLU(inplace=True)
  (2): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
  )
  (3): Linear(in_features=128, out_features=3, bias=True)
)
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
create_optimizer_or_freeze_model: param seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1.0
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze
NeRF loaded with msg:  _IncompatibleKeys(missing_keys=['seg_mask_grid.grid', 'seg_mask_grid.xyz_min', 'seg_mask_grid.xyz_max', 'dual_seg_mask_grid.grid', 'dual_seg_mask_grid.xyz_min', 'dual_seg_mask_grid.xyz_max'], unexpected_keys=[])
Segmentation model: COARSE MODE.
create_optimizer_or_freeze_model: param seg_mask_grid lr 1
create_optimizer_or_freeze_model: param dual_seg_mask_grid lr 1
create_optimizer_or_freeze_model: param density freeze
create_optimizer_or_freeze_model: param k0 freeze
create_optimizer_or_freeze_model: param rgbnet freeze

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.5ms
Speed: 2.8ms preprocess, 20.5ms inference, 2.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.3ms
Speed: 1.2ms preprocess, 20.3ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 19.5ms
Speed: 1.3ms preprocess, 19.5ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 19.2ms
Speed: 1.4ms preprocess, 19.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.2ms
Speed: 1.6ms preprocess, 20.2ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.4ms
Speed: 1.3ms preprocess, 20.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.5ms
Speed: 1.3ms preprocess, 19.5ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.9ms
Speed: 1.2ms preprocess, 18.9ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.9ms
Speed: 1.9ms preprocess, 19.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.2ms
Speed: 1.5ms preprocess, 19.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.1ms
Speed: 1.5ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 18.9ms
Speed: 1.5ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.1ms
Speed: 1.3ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.1ms
Speed: 1.3ms preprocess, 19.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 19.8ms
Speed: 1.8ms preprocess, 19.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 18.9ms
Speed: 1.4ms preprocess, 18.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 19.9ms
Speed: 1.6ms preprocess, 19.9ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.3ms
Speed: 1.4ms preprocess, 19.3ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 18.8ms
Speed: 1.3ms preprocess, 18.8ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.4ms
Speed: 2.2ms preprocess, 19.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.5ms
Speed: 1.5ms preprocess, 20.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.4ms preprocess, 18.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 19.0ms
Speed: 1.3ms preprocess, 19.0ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.6ms
Speed: 1.3ms preprocess, 19.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 19.0ms
Speed: 1.5ms preprocess, 19.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.3ms preprocess, 18.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 18.9ms
Speed: 1.4ms preprocess, 18.9ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)
Dash is running on http://127.0.0.1:8050/

INFO:lib.gui:Dash is running on http://127.0.0.1:8050/

 * Serving Flask app 'lib.gui' (lazy loading)
 * Environment: production
[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m
[2m   Use a production WSGI server instead.[0m
 * Debug mode: off

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.4ms
Speed: 1.7ms preprocess, 21.4ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)
valid_views: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
best_view_idx: 25
view_order: [30, 31, 32, 33, 34, 35, 36, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 27, 28, 29]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 20.3ms
Speed: 1.2ms preprocess, 20.3ms inference, 1.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9473
Instance 1: Confidence=0.9204
Instance 2: Confidence=0.9187
Instance 3: Confidence=0.9093
Instance 4: Confidence=0.7686
Selected instance: 3 (Confidence: 0.9093)
tmp min: tensor(0.) tmp max: tensor(1.)
/home/lab/SA3D_YOLO/lib/self_prompting.py:32: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

/home/lab/SA3D_YOLO/lib/self_prompting.py:34: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

444 68 540 960
/home/lab/SA3D_YOLO/lib/self_prompting.py:88: UserWarning:

__floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').

There are 15 prompts
current IoU is: 0.7316279411315918
Seok, iteration idx= 1 IoU = tensor(0.7316)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.7ms
Speed: 1.5ms preprocess, 22.7ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 4
Instance 0: Confidence=0.9493
Instance 1: Confidence=0.9198
Instance 2: Confidence=0.9132
Instance 3: Confidence=0.8117
Selected instance: 2 (Confidence: 0.9132)
tmp min: tensor(0.) tmp max: tensor(1.)
484 84 540 960
There are 16 prompts
current IoU is: 0.7205477356910706
Seok, iteration idx= 2 IoU = tensor(0.7205)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 21.2ms
Speed: 1.6ms preprocess, 21.2ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 5
Instance 0: Confidence=0.9467
Instance 1: Confidence=0.9218
Instance 2: Confidence=0.9005
Instance 3: Confidence=0.8803
Instance 4: Confidence=0.8561
Selected instance: 2 (Confidence: 0.9005)
tmp min: tensor(0.) tmp max: tensor(1.)
541 144 540 960
There are 16 prompts
current IoU is: 0.7895104289054871
Seok, iteration idx= 3 IoU = tensor(0.7895)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.8ms
Speed: 3.1ms preprocess, 22.8ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 5
Instance 0: Confidence=0.9544
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9241
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.7200
Selected instance: 1 (Confidence: 0.9288)
tmp min: tensor(0.) tmp max: tensor(1.)
633 128 540 960
There are 16 prompts
current IoU is: 0.8467008471488953
Seok, iteration idx= 4 IoU = tensor(0.8467)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.4ms
Speed: 2.8ms preprocess, 22.4ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 5
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9280
Instance 2: Confidence=0.9266
Instance 3: Confidence=0.9235
Instance 4: Confidence=0.7901
Selected instance: 2 (Confidence: 0.9266)
tmp min: tensor(0.) tmp max: tensor(1.)
666 124 540 960
There are 14 prompts
current IoU is: 0.8693032264709473
Seok, iteration idx= 5 IoU = tensor(0.8693)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.0ms
Speed: 2.9ms preprocess, 23.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 5
Instance 0: Confidence=0.9459
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9226
Instance 3: Confidence=0.9140
Instance 4: Confidence=0.6220
Selected instance: 2 (Confidence: 0.9226)
tmp min: tensor(0.) tmp max: tensor(1.)
714 108 540 960
There are 13 prompts
current IoU is: 0.9005520343780518
Seok, iteration idx= 6 IoU = tensor(0.9006)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.7ms
Speed: 1.7ms preprocess, 23.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 1
Instance 0: Confidence=0.9169
Selected instance: 0 (Confidence: 0.9169)
tmp min: tensor(0.) tmp max: tensor(1.)
200 88 540 960
There are 18 prompts
current IoU is: 0.0
Seok, iteration idx= 7 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.9ms
Speed: 2.9ms preprocess, 23.9ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 1
Instance 0: Confidence=0.9297
Selected instance: 0 (Confidence: 0.9297)
tmp min: tensor(0.) tmp max: tensor(1.)
208 76 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 8 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 21.9ms
Speed: 1.6ms preprocess, 21.9ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 1
Instance 0: Confidence=0.9227
Selected instance: 0 (Confidence: 0.9227)
tmp min: tensor(0.) tmp max: tensor(1.)
220 68 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 9 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 20.8ms
Speed: 1.6ms preprocess, 20.8ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 1
Instance 0: Confidence=0.9274
Selected instance: 0 (Confidence: 0.9274)
tmp min: tensor(0.) tmp max: tensor(1.)
226 68 540 960
There are 13 prompts
current IoU is: 0.0
Seok, iteration idx= 10 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.6ms
Speed: 2.9ms preprocess, 23.6ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 1
Instance 0: Confidence=0.9171
Selected instance: 0 (Confidence: 0.9171)
tmp min: tensor(0.) tmp max: tensor(1.)
239 48 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 11 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.6ms
Speed: 2.9ms preprocess, 22.6ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 1
Instance 0: Confidence=0.9199
Selected instance: 0 (Confidence: 0.9199)
tmp min: tensor(0.) tmp max: tensor(1.)
296 60 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 12 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.8ms
Speed: 1.5ms preprocess, 22.8ms inference, 2.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 2
Instance 0: Confidence=0.9370
Instance 1: Confidence=0.9239
Selected instance: 0 (Confidence: 0.9370)
tmp min: tensor(0.) tmp max: tensor(1.)
2 100 540 960
There are 19 prompts
current IoU is: 0.0
Seok, iteration idx= 13 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.4ms
Speed: 1.6ms preprocess, 24.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 2
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9040
Selected instance: 0 (Confidence: 0.9483)
tmp min: tensor(0.) tmp max: tensor(1.)
48 116 540 960
There are 16 prompts
current IoU is: 0.0
Seok, iteration idx= 14 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.2ms
Speed: 1.6ms preprocess, 23.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 4
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9207
Instance 2: Confidence=0.8929
Instance 3: Confidence=0.5436
Selected instance: 1 (Confidence: 0.9207)
tmp min: tensor(0.) tmp max: tensor(1.)
771 92 540 960
There are 15 prompts
current IoU is: 0.9173771142959595
Seok, iteration idx= 15 IoU = tensor(0.9174)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.9ms
Speed: 1.6ms preprocess, 23.9ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 3
Instance 0: Confidence=0.9560
Instance 1: Confidence=0.8635
Instance 2: Confidence=0.7620
Selected instance: 1 (Confidence: 0.8635)
tmp min: tensor(0.) tmp max: tensor(1.)
821 92 540 960
There are 16 prompts
current IoU is: 0.8174121975898743
Seok, iteration idx= 16 IoU = tensor(0.8174)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.5ms
Speed: 2.0ms preprocess, 23.5ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 2
Instance 0: Confidence=0.9567
Instance 1: Confidence=0.7969
Selected instance: 0 (Confidence: 0.9567)
tmp min: tensor(0.) tmp max: tensor(1.)
881 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 17 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.1ms
Speed: 3.1ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 3
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.7888
Instance 2: Confidence=0.4837
Selected instance: 2 (Confidence: 0.4837)
tmp min: tensor(0.) tmp max: tensor(1.)
925 100 540 960
There are 19 prompts
current IoU is: 0.600281298160553
Seok, iteration idx= 18 IoU = tensor(0.6003)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 21.5ms
Speed: 2.8ms preprocess, 21.5ms inference, 2.0ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 4
Instance 0: Confidence=0.9485
Instance 1: Confidence=0.7439
Instance 2: Confidence=0.5048
Instance 3: Confidence=0.2655
Selected instance: 1 (Confidence: 0.7439)
tmp min: tensor(0.) tmp max: tensor(1.)
950 148 540 960
There are 16 prompts
current IoU is: 0.6195651888847351
Seok, iteration idx= 19 IoU = tensor(0.6196)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.7ms
Speed: 3.1ms preprocess, 22.7ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9561
Instance 1: Confidence=0.6777
Selected instance: 0 (Confidence: 0.9561)
tmp min: tensor(0.) tmp max: tensor(1.)
691 0 540 960
There are 15 prompts
current IoU is: 2.4810509785311297e-05
Seok, iteration idx= 20 IoU = tensor(2.4811e-05)
SKIP, unacceptable sam prediction, IoU is tensor(2.4811e-05)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.8ms
Speed: 1.6ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 2
Instance 0: Confidence=0.9415
Instance 1: Confidence=0.7778
Selected instance: 0 (Confidence: 0.9415)
tmp min: tensor(0.) tmp max: tensor(1.)
611 12 540 960
There are 14 prompts
current IoU is: 0.004325140733271837
Seok, iteration idx= 21 IoU = tensor(0.0043)
SKIP, unacceptable sam prediction, IoU is tensor(0.0043)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 2
Instance 0: Confidence=0.9420
Instance 1: Confidence=0.8016
Selected instance: 0 (Confidence: 0.9420)
tmp min: tensor(0.) tmp max: tensor(1.)
535 56 540 960
There are 13 prompts
current IoU is: 0.005579743068665266
Seok, iteration idx= 22 IoU = tensor(0.0056)
SKIP, unacceptable sam prediction, IoU is tensor(0.0056)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.1ms
Speed: 1.5ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9039
Selected instance: 1 (Confidence: 0.9039)
tmp min: tensor(0.) tmp max: tensor(1.)
397 68 540 960
There are 15 prompts
current IoU is: 0.01036008819937706
Seok, iteration idx= 23 IoU = tensor(0.0104)
SKIP, unacceptable sam prediction, IoU is tensor(0.0104)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 1.6ms preprocess, 22.3ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 2
Instance 0: Confidence=0.9440
Instance 1: Confidence=0.9201
Selected instance: 1 (Confidence: 0.9201)
tmp min: tensor(0.) tmp max: tensor(1.)
402 80 540 960
There are 14 prompts
current IoU is: 0.00835911650210619
Seok, iteration idx= 24 IoU = tensor(0.0084)
SKIP, unacceptable sam prediction, IoU is tensor(0.0084)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 22.3ms
Speed: 3.1ms preprocess, 22.3ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 2
Instance 0: Confidence=0.9452
Instance 1: Confidence=0.9129
Selected instance: 1 (Confidence: 0.9129)
tmp min: tensor(0.) tmp max: tensor(1.)
437 112 540 960
There are 12 prompts
current IoU is: 0.007619927171617746
Seok, iteration idx= 25 IoU = tensor(0.0076)
SKIP, unacceptable sam prediction, IoU is tensor(0.0076)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.9ms
Speed: 2.7ms preprocess, 21.9ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 3
Instance 0: Confidence=0.9407
Instance 1: Confidence=0.9229
Instance 2: Confidence=0.9179
Selected instance: 1 (Confidence: 0.9229)
tmp min: tensor(0.) tmp max: tensor(1.)
2 90 540 960
There are 18 prompts
current IoU is: 0.854651153087616
Seok, iteration idx= 26 IoU = tensor(0.8547)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 21.6ms
Speed: 3.4ms preprocess, 21.6ms inference, 1.5ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 3
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9345
Instance 2: Confidence=0.9300
Selected instance: 0 (Confidence: 0.9447)
tmp min: tensor(0.) tmp max: tensor(1.)
79 92 540 960
There are 17 prompts
current IoU is: 0.8102379441261292
Seok, iteration idx= 27 IoU = tensor(0.8102)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.5ms
Speed: 1.5ms preprocess, 23.5ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 4
Instance 0: Confidence=0.9410
Instance 1: Confidence=0.9318
Instance 2: Confidence=0.9127
Instance 3: Confidence=0.5230
Selected instance: 0 (Confidence: 0.9410)
tmp min: tensor(0.) tmp max: tensor(1.)
119 80 540 960
There are 14 prompts
current IoU is: 0.8406462669372559
Seok, iteration idx= 28 IoU = tensor(0.8406)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 22.1ms
Speed: 2.6ms preprocess, 22.1ms inference, 2.1ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 4
Instance 0: Confidence=0.9267
Instance 1: Confidence=0.9262
Instance 2: Confidence=0.9231
Instance 3: Confidence=0.4524
Selected instance: 0 (Confidence: 0.9267)
tmp min: tensor(0.) tmp max: tensor(1.)
172 88 540 960
There are 16 prompts
current IoU is: 0.8236850500106812
Seok, iteration idx= 29 IoU = tensor(0.8237)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.1ms
Speed: 1.6ms preprocess, 23.1ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 4
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9273
Instance 2: Confidence=0.9198
Instance 3: Confidence=0.7961
Selected instance: 2 (Confidence: 0.9198)
tmp min: tensor(0.) tmp max: tensor(1.)
260 84 540 960
There are 16 prompts
current IoU is: 0.8498957753181458
Seok, iteration idx= 30 IoU = tensor(0.8499)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.4ms preprocess, 24.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9217
Instance 2: Confidence=0.9215
Instance 3: Confidence=0.9189
Instance 4: Confidence=0.8922
Selected instance: 2 (Confidence: 0.9215)
tmp min: tensor(0.) tmp max: tensor(1.)
346 60 540 960
There are 16 prompts
current IoU is: 0.8618329167366028
Seok, iteration idx= 31 IoU = tensor(0.8618)
Selected Instance Confidence List: [tensor(0.9239), tensor(0.8027, device='cpu'), tensor(0.7976, device='cpu'), tensor(0.8339, device='cpu'), tensor(0.8796, device='cpu'), tensor(0.8922, device='cpu'), tensor(0.9094, device='cpu'), tensor(0.3667, device='cpu'), tensor(0.3719, device='cpu'), tensor(0.3691, device='cpu'), tensor(0.3710, device='cpu'), tensor(0.3668, device='cpu'), tensor(0.3680, device='cpu'), tensor(0.3748, device='cpu'), tensor(0.3793, device='cpu'), tensor(0.9187, device='cpu'), tensor(0.8358, device='cpu'), tensor(0.3827, device='cpu'), tensor(0.5536, device='cpu'), tensor(0.6693, device='cpu'), tensor(0.3824, device='cpu'), tensor(0.3792, device='cpu'), tensor(0.3801, device='cpu'), tensor(0.3774, device='cpu'), tensor(0.3776, device='cpu'), tensor(0.3781, device='cpu'), tensor(0.8819, device='cpu'), tensor(0.8640, device='cpu'), tensor(0.8808, device='cpu'), tensor(0.8649, device='cpu'), tensor(0.8779, device='cpu'), tensor(0.8857, device='cpu')]
Sorted Confidence Order: [tensor(0.9239), tensor(0.8857, device='cpu'), tensor(0.8779, device='cpu'), tensor(0.8649, device='cpu'), tensor(0.8808, device='cpu'), tensor(0.8640, device='cpu'), tensor(0.8819, device='cpu'), tensor(0.3781, device='cpu'), tensor(0.3776, device='cpu'), tensor(0.3774, device='cpu'), tensor(0.3793, device='cpu'), tensor(0.3748, device='cpu'), tensor(0.3680, device='cpu'), tensor(0.3668, device='cpu'), tensor(0.3710, device='cpu'), tensor(0.3691, device='cpu'), tensor(0.3719, device='cpu'), tensor(0.3667, device='cpu'), tensor(0.3801, device='cpu'), tensor(0.3792, device='cpu'), tensor(0.3824, device='cpu'), tensor(0.6693, device='cpu'), tensor(0.5536, device='cpu'), tensor(0.3827, device='cpu'), tensor(0.8358, device='cpu'), tensor(0.9187, device='cpu'), tensor(0.9094, device='cpu'), tensor(0.8922, device='cpu'), tensor(0.8796, device='cpu'), tensor(0.8339, device='cpu'), tensor(0.7976, device='cpu'), tensor(0.8027, device='cpu')]
sorted_indices: [0, 31, 30, 29, 28, 27, 26, 25, 24, 23, 14, 13, 12, 11, 10, 9, 8, 7, 22, 21, 20, 19, 18, 17, 16, 15, 6, 5, 4, 3, 2, 1]
Initial view (highest confidence): 1
New training order: [30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 8, 7, 6, 5, 4, 3, 2, 1, 16, 15, 14, 13, 12, 11, 10, 9, 36, 35, 34, 33, 32, 31]

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 32.7ms
Speed: 1.5ms preprocess, 32.7ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.2ms
Speed: 1.6ms preprocess, 22.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 1 ===
Detected instances: 5
Instance 0: Confidence=0.9385
Instance 1: Confidence=0.9217
Instance 2: Confidence=0.9215
Instance 3: Confidence=0.9189
Instance 4: Confidence=0.8922
tmp min: tensor(0.) tmp max: tensor(1.)
346 60 540 960
There are 16 prompts
current IoU is: 0.48080965876579285
Seok, iteration idx= 1 IoU = tensor(0.4808)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.9ms
Speed: 1.7ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 2 ===
Detected instances: 4
Instance 0: Confidence=0.9367
Instance 1: Confidence=0.9273
Instance 2: Confidence=0.9198
Instance 3: Confidence=0.7961
tmp min: tensor(0.) tmp max: tensor(1.)
260 84 540 960
There are 16 prompts
current IoU is: 0.5667643547058105
Seok, iteration idx= 2 IoU = tensor(0.5668)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.3ms
Speed: 1.5ms preprocess, 24.3ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 3 ===
Detected instances: 4
Instance 0: Confidence=0.9267
Instance 1: Confidence=0.9262
Instance 2: Confidence=0.9231
Instance 3: Confidence=0.4524
tmp min: tensor(0.) tmp max: tensor(1.)
172 88 540 960
There are 16 prompts
current IoU is: 0.6296391487121582
Seok, iteration idx= 3 IoU = tensor(0.6296)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.0ms
Speed: 1.5ms preprocess, 23.0ms inference, 1.7ms postprocess per image at shape (1, 3, 544, 960)

=== View 4 ===
Detected instances: 4
Instance 0: Confidence=0.9410
Instance 1: Confidence=0.9318
Instance 2: Confidence=0.9127
Instance 3: Confidence=0.5230
tmp min: tensor(0.) tmp max: tensor(1.)
119 80 540 960
There are 14 prompts
current IoU is: 0.770634651184082
Seok, iteration idx= 4 IoU = tensor(0.7706)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.9ms
Speed: 1.5ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 5 ===
Detected instances: 3
Instance 0: Confidence=0.9447
Instance 1: Confidence=0.9345
Instance 2: Confidence=0.9300
tmp min: tensor(0.) tmp max: tensor(1.)
79 92 540 960
There are 17 prompts
current IoU is: 0.8106841444969177
Seok, iteration idx= 5 IoU = tensor(0.8107)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.4ms
Speed: 2.9ms preprocess, 22.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 6 ===
Detected instances: 3
Instance 0: Confidence=0.9407
Instance 1: Confidence=0.9229
Instance 2: Confidence=0.9179
tmp min: tensor(0.) tmp max: tensor(1.)
2 90 540 960
There are 18 prompts
current IoU is: 0.8528265953063965
Seok, iteration idx= 6 IoU = tensor(0.8528)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.0ms
Speed: 3.0ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 7 ===
Detected instances: 2
Instance 0: Confidence=0.9452
Instance 1: Confidence=0.9129
tmp min: tensor(0.) tmp max: tensor(1.)
437 112 540 960
There are 12 prompts
current IoU is: 0.0030183421913534403
Seok, iteration idx= 7 IoU = tensor(0.0030)
SKIP, unacceptable sam prediction, IoU is tensor(0.0030)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 2.2ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 8 ===
Detected instances: 2
Instance 0: Confidence=0.9440
Instance 1: Confidence=0.9201
tmp min: tensor(0.) tmp max: tensor(1.)
402 80 540 960
There are 14 prompts
current IoU is: 0.0036452666390687227
Seok, iteration idx= 8 IoU = tensor(0.0036)
SKIP, unacceptable sam prediction, IoU is tensor(0.0036)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 1.6ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 9 ===
Detected instances: 2
Instance 0: Confidence=0.9435
Instance 1: Confidence=0.9039
tmp min: tensor(0.) tmp max: tensor(1.)
397 68 540 960
There are 15 prompts
current IoU is: 0.004380885045975447
Seok, iteration idx= 9 IoU = tensor(0.0044)
SKIP, unacceptable sam prediction, IoU is tensor(0.0044)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.2ms
Speed: 1.5ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 10 ===
Detected instances: 2
Instance 0: Confidence=0.9483
Instance 1: Confidence=0.9040
tmp min: tensor(0.) tmp max: tensor(1.)
324 60 540 960
There are 13 prompts
current IoU is: 0.0042891609482467175
Seok, iteration idx= 10 IoU = tensor(0.0043)
SKIP, unacceptable sam prediction, IoU is tensor(0.0043)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.5ms
Speed: 1.6ms preprocess, 24.5ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 11 ===
Detected instances: 2
Instance 0: Confidence=0.9370
Instance 1: Confidence=0.9239
tmp min: tensor(0.) tmp max: tensor(1.)
311 56 540 960
There are 15 prompts
current IoU is: 0.003931363113224506
Seok, iteration idx= 11 IoU = tensor(0.0039)
SKIP, unacceptable sam prediction, IoU is tensor(0.0039)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 24.2ms
Speed: 1.6ms preprocess, 24.2ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 12 ===
Detected instances: 1
Instance 0: Confidence=0.9199
tmp min: tensor(0.) tmp max: tensor(1.)
296 60 540 960
There are 16 prompts
current IoU is: 0.003400281071662903
Seok, iteration idx= 12 IoU = tensor(0.0034)
SKIP, unacceptable sam prediction, IoU is tensor(0.0034)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.0ms
Speed: 2.6ms preprocess, 23.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 13 ===
Detected instances: 1
Instance 0: Confidence=0.9171
tmp min: tensor(0.) tmp max: tensor(1.)
239 48 540 960
There are 16 prompts
current IoU is: 0.0030444408766925335
Seok, iteration idx= 13 IoU = tensor(0.0030)
SKIP, unacceptable sam prediction, IoU is tensor(0.0030)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 22.1ms
Speed: 2.9ms preprocess, 22.1ms inference, 1.8ms postprocess per image at shape (1, 3, 544, 960)

=== View 14 ===
Detected instances: 1
Instance 0: Confidence=0.9274
tmp min: tensor(0.) tmp max: tensor(1.)
226 68 540 960
There are 13 prompts
current IoU is: 0.0027890915516763926
Seok, iteration idx= 14 IoU = tensor(0.0028)
SKIP, unacceptable sam prediction, IoU is tensor(0.0028)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.9ms
Speed: 1.9ms preprocess, 23.9ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 15 ===
Detected instances: 1
Instance 0: Confidence=0.9227
tmp min: tensor(0.) tmp max: tensor(1.)
220 68 540 960
There are 15 prompts
current IoU is: 0.003178235376253724
Seok, iteration idx= 15 IoU = tensor(0.0032)
SKIP, unacceptable sam prediction, IoU is tensor(0.0032)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 24.4ms
Speed: 1.6ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 16 ===
Detected instances: 1
Instance 0: Confidence=0.9297
tmp min: tensor(0.) tmp max: tensor(1.)
208 76 540 960
There are 16 prompts
current IoU is: 0.0033489929046481848
Seok, iteration idx= 16 IoU = tensor(0.0033)
SKIP, unacceptable sam prediction, IoU is tensor(0.0033)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 1 person, 23.7ms
Speed: 1.6ms preprocess, 23.7ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 17 ===
Detected instances: 1
Instance 0: Confidence=0.9169
tmp min: tensor(0.) tmp max: tensor(1.)
200 88 540 960
There are 18 prompts
current IoU is: 0.005934868473559618
Seok, iteration idx= 17 IoU = tensor(0.0059)
SKIP, unacceptable sam prediction, IoU is tensor(0.0059)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.1ms
Speed: 1.6ms preprocess, 24.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 18 ===
Detected instances: 2
Instance 0: Confidence=0.9420
Instance 1: Confidence=0.8016
tmp min: tensor(0.) tmp max: tensor(1.)
535 56 540 960
There are 13 prompts
current IoU is: 0.00523733114823699
Seok, iteration idx= 18 IoU = tensor(0.0052)
SKIP, unacceptable sam prediction, IoU is tensor(0.0052)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 19 ===
Detected instances: 2
Instance 0: Confidence=0.9415
Instance 1: Confidence=0.7778
tmp min: tensor(0.) tmp max: tensor(1.)
611 12 540 960
There are 14 prompts
current IoU is: 0.0036660716868937016
Seok, iteration idx= 19 IoU = tensor(0.0037)
SKIP, unacceptable sam prediction, IoU is tensor(0.0037)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 23.1ms
Speed: 3.1ms preprocess, 23.1ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 20 ===
Detected instances: 2
Instance 0: Confidence=0.9561
Instance 1: Confidence=0.6777
tmp min: tensor(0.) tmp max: tensor(1.)
691 0 540 960
There are 15 prompts
current IoU is: 0.0
Seok, iteration idx= 20 IoU = tensor(0.)
SKIP, unacceptable sam prediction, IoU is tensor(0.)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.1ms
Speed: 2.9ms preprocess, 23.1ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 21 ===
Detected instances: 4
Instance 0: Confidence=0.9485
Instance 1: Confidence=0.7439
Instance 2: Confidence=0.5048
Instance 3: Confidence=0.2655
tmp min: tensor(0.) tmp max: tensor(1.)
950 148 540 960
There are 16 prompts
current IoU is: 0.7627159953117371
Seok, iteration idx= 21 IoU = tensor(0.7627)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 22.4ms
Speed: 3.1ms preprocess, 22.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 22 ===
Detected instances: 3
Instance 0: Confidence=0.9593
Instance 1: Confidence=0.7888
Instance 2: Confidence=0.4837
tmp min: tensor(0.) tmp max: tensor(1.)
925 100 540 960
There are 19 prompts
current IoU is: 0.5859976410865784
Seok, iteration idx= 22 IoU = tensor(0.5860)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 2 persons, 25.3ms
Speed: 1.5ms preprocess, 25.3ms inference, 3.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 23 ===
Detected instances: 2
Instance 0: Confidence=0.9567
Instance 1: Confidence=0.7969
tmp min: tensor(0.) tmp max: tensor(1.)
881 0 540 960
There are 15 prompts
current IoU is: 4.6788001782260835e-05
Seok, iteration idx= 23 IoU = tensor(4.6788e-05)
SKIP, unacceptable sam prediction, IoU is tensor(4.6788e-05)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 3 persons, 23.7ms
Speed: 1.5ms preprocess, 23.7ms inference, 1.4ms postprocess per image at shape (1, 3, 544, 960)

=== View 24 ===
Detected instances: 3
Instance 0: Confidence=0.9560
Instance 1: Confidence=0.8635
Instance 2: Confidence=0.7620
tmp min: tensor(0.) tmp max: tensor(1.)
821 92 540 960
There are 16 prompts
current IoU is: 0.7632075548171997
Seok, iteration idx= 24 IoU = tensor(0.7632)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 24.4ms
Speed: 1.6ms preprocess, 24.4ms inference, 1.2ms postprocess per image at shape (1, 3, 544, 960)

=== View 25 ===
Detected instances: 4
Instance 0: Confidence=0.9460
Instance 1: Confidence=0.9207
Instance 2: Confidence=0.8929
Instance 3: Confidence=0.5436
tmp min: tensor(0.) tmp max: tensor(1.)
771 92 540 960
There are 15 prompts
current IoU is: 0.8820817470550537
Seok, iteration idx= 25 IoU = tensor(0.8821)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.2ms
Speed: 2.7ms preprocess, 23.2ms inference, 1.6ms postprocess per image at shape (1, 3, 544, 960)

=== View 26 ===
Detected instances: 5
Instance 0: Confidence=0.9459
Instance 1: Confidence=0.9241
Instance 2: Confidence=0.9226
Instance 3: Confidence=0.9140
Instance 4: Confidence=0.6220
tmp min: tensor(0.) tmp max: tensor(1.)
714 108 540 960
There are 13 prompts
current IoU is: 0.8633871078491211
Seok, iteration idx= 26 IoU = tensor(0.8634)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 22.7ms
Speed: 1.6ms preprocess, 22.7ms inference, 1.9ms postprocess per image at shape (1, 3, 544, 960)

=== View 27 ===
Detected instances: 5
Instance 0: Confidence=0.9430
Instance 1: Confidence=0.9280
Instance 2: Confidence=0.9266
Instance 3: Confidence=0.9235
Instance 4: Confidence=0.7901
tmp min: tensor(0.) tmp max: tensor(1.)
666 124 540 960
There are 14 prompts
current IoU is: 0.8624187111854553
Seok, iteration idx= 27 IoU = tensor(0.8624)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.0ms
Speed: 1.5ms preprocess, 24.0ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 28 ===
Detected instances: 5
Instance 0: Confidence=0.9544
Instance 1: Confidence=0.9288
Instance 2: Confidence=0.9241
Instance 3: Confidence=0.9219
Instance 4: Confidence=0.7200
tmp min: tensor(0.) tmp max: tensor(1.)
633 128 540 960
There are 16 prompts
current IoU is: 0.8411429524421692
Seok, iteration idx= 28 IoU = tensor(0.8411)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 24.4ms
Speed: 1.6ms preprocess, 24.4ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 29 ===
Detected instances: 5
Instance 0: Confidence=0.9467
Instance 1: Confidence=0.9218
Instance 2: Confidence=0.9005
Instance 3: Confidence=0.8803
Instance 4: Confidence=0.8561
tmp min: tensor(0.) tmp max: tensor(1.)
541 144 540 960
There are 16 prompts
current IoU is: 0.7971137762069702
Seok, iteration idx= 29 IoU = tensor(0.7971)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 4 persons, 23.3ms
Speed: 2.3ms preprocess, 23.3ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 30 ===
Detected instances: 4
Instance 0: Confidence=0.9493
Instance 1: Confidence=0.9198
Instance 2: Confidence=0.9132
Instance 3: Confidence=0.8117
tmp min: tensor(0.) tmp max: tensor(1.)
484 84 540 960
There are 16 prompts
current IoU is: 0.7972704172134399
Seok, iteration idx= 30 IoU = tensor(0.7973)

WARNING ⚠️ imgsz=[540, 960] must be multiple of max stride 32, updating to [544, 960]
0: 544x960 5 persons, 23.8ms
Speed: 1.6ms preprocess, 23.8ms inference, 1.3ms postprocess per image at shape (1, 3, 544, 960)

=== View 31 ===
Detected instances: 5
Instance 0: Confidence=0.9473
Instance 1: Confidence=0.9204
Instance 2: Confidence=0.9187
Instance 3: Confidence=0.9093
Instance 4: Confidence=0.7686
tmp min: tensor(0.) tmp max: tensor(1.)
444 68 540 960
There are 15 prompts
current IoU is: 0.8425101041793823
Seok, iteration idx= 31 IoU = tensor(0.8425)
scene_rep_reconstruction (coarse): saved checkpoints at ./logs/nerf_unbounded/dcvgo_Set13_unbounded/coarse_segmentation_gui.tar
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set13_unbounded/render_train_coarse_segmentation_gui
Render seg_img...:   0%|                                 | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_img...: 100%|████████████████████████| 32/32 [00:38<00:00,  1.21s/it]
Testing psnr 29.099098816514015 (avg)
All results are dumped into ./logs/nerf_unbounded/dcvgo_Set13_unbounded/render_train_coarse_segmentation_gui
Render seg_density...:   0%|                             | 0/32 [00:00<?, ?it/s]Testing, rgb shape:  (540, 960, 3)
Render seg_density...: 100%|████████████████████| 32/32 [00:26<00:00,  1.20it/s]
Testing psnr 3.6306753661483526 (avg)
train: coarse segmentation in 00:03:41
train: finish (eps time 00:03:41 )
[96mRendering with ckpt ./logs/nerf_unbounded/dcvgo_Set13_unbounded/coarse_segmentation_gui.tar[0m
^C
Traceback (most recent call last):
  File "/home/lab/SA3D_YOLO/run_seg_gui.py", line 119, in <module>
    model, optimizer, start = utils.load_existed_model(args, cfg, cfg.fine_train, ckpt_path, device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 75, in load_existed_model
    model = load_model(model_class, reload_ckpt_path).to(device)
  File "/home/lab/SA3D_YOLO/lib/utils.py", line 205, in load_model
    ckpt = torch.load(ckpt_path)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/ultralytics/utils/patches.py", line 86, in torch_load
    return _torch_load(*args, **kwargs)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 712, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1049, in _load
    result = unpickler.load()
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 1019, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/lab/anaconda3/envs/sa3d_yolo/lib/python3.10/site-packages/torch/serialization.py", line 997, in load_tensor
    storage = zip_file.get_storage_from_record(name, numel, torch._UntypedStorage).storage()._untyped()
KeyboardInterrupt
